/*! For license information please see extension.js.LICENSE.txt */
(()=>{var e,t={2729:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=2729,e.exports=t},9668:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=9668,e.exports=t},3329:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionStatus=void 0,(r=t.ConnectionStatus||(t.ConnectionStatus={})).None="none",r.Connecting="connecting",r.RefreshingTunnelAccessToken="refreshingTunnelAccessToken",r.Connected="connected",r.Disconnected="disconnected"},1480:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionStatusChangedEventArgs=void 0,t.ConnectionStatusChangedEventArgs=class{constructor(e,t,r){this.previousStatus=e,this.status=t,this.disconnectError=r}}},6589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTunnelRelayStreamFactory=void 0;const n=r(9696);t.DefaultTunnelRelayStreamFactory=class{async createRelayStream(e,t,r,s){if((0,n.isNode)()){const i=await n.SshHelpers.openConnection(e,t,Object.assign({},r&&{Authorization:`tunnel ${r}`}),s);return{stream:i,protocol:i.protocol}}{r&&(t=[...t,r]);const s=await n.SshHelpers.openConnection(e,t);return{stream:s,protocol:s.protocol}}}}},1139:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(4736),t),s(r(1194),t),s(r(9470),t),s(r(2616),t),s(r(7449),t),s(r(3226),t),s(r(9696),t),s(r(4736),t),s(r(3190),t),s(r(1194),t),s(r(7875),t),s(r(1306),t),s(r(6589),t),s(r(3559),t),s(r(82),t),s(r(5368),t),s(r(4513),t),s(r(3329),t),s(r(1480),t),s(r(7455),t),s(r(7511),t),s(r(3390),t)},2040:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortRelayConnectRequestMessage=void 0;const n=r(9361);class s extends n.PortForwardChannelOpenMessage{constructor(){super(...arguments),this.isE2EEncryptionRequested=!1}onWrite(e){var t;super.onWrite(e),e.writeString(null!==(t=this.accessToken)&&void 0!==t?t:"","utf8"),e.writeBoolean(this.isE2EEncryptionRequested)}onRead(e){super.onRead(e),this.accessToken=e.readString("utf8"),this.isE2EEncryptionRequested=e.readBoolean()}}t.PortRelayConnectRequestMessage=s},7752:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortRelayConnectResponseMessage=void 0;const n=r(2727);class s extends n.ChannelOpenConfirmationMessage{constructor(){super(...arguments),this.isE2EEncryptionEnabled=!1}onWrite(e){super.onWrite(e),e.writeBoolean(this.isE2EEncryptionEnabled)}onRead(e){super.onRead(e),this.isE2EEncryptionEnabled=e.readBoolean()}}t.PortRelayConnectResponseMessage=s},7012:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortRelayRequestMessage=void 0;const n=r(9361);class s extends n.PortForwardRequestMessage{onWrite(e){if(super.onWrite(e),!this.accessToken)throw new Error("An access token is required.");e.writeString(this.accessToken,"utf8")}onRead(e){super.onRead(e),this.accessToken=e.readString("utf8")}}t.PortRelayRequestMessage=s},9470:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiModeTunnelClient=void 0;const n=r(3399),s=r(4513);class i extends s.TunnelConnectionBase{constructor(){super(n.TunnelAccessScopes.Connect),this.clients=[],this.connectionModes=this.clients?[...new Set(...this.clients.map((e=>e.connectionModes)))]:[]}get acceptLocalConnectionsForForwardedPorts(){return!!this.clients.find((e=>e.acceptLocalConnectionsForForwardedPorts))}set acceptLocalConnectionsForForwardedPorts(e){this.clients.forEach((t=>t.acceptLocalConnectionsForForwardedPorts=e))}get localForwardingHostAddress(){var e;return null===(e=this.clients[0])||void 0===e?void 0:e.localForwardingHostAddress}set localForwardingHostAddress(e){this.clients.forEach((t=>t.localForwardingHostAddress=e))}connect(e,t){if(!e)throw new Error("Tunnel cannot be null");return new Promise((e=>{}))}connectToForwardedPort(e,t){throw new Error("Method not implemented.")}waitForForwardedPort(e,t){throw new Error("Method not implemented.")}async refreshPorts(){throw new Error("Method not implemented.")}async dispose(){await super.dispose(),await Promise.all(this.clients.map((e=>e.dispose())))}}t.MultiModeTunnelClient=i},2616:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiModeTunnelHost=void 0;const n=r(3399),s=r(1328),i=r(4513);class o extends i.TunnelConnectionBase{constructor(){super(n.TunnelAccessScopes.Host),this.hosts=[]}async start(e){const t=[];this.hosts.forEach((r=>{t.push(r.start(e))})),await Promise.all(t)}async refreshPorts(){const e=[];this.hosts.forEach((t=>{e.push(t.refreshPorts())})),await Promise.all(e)}async dispose(){await Promise.all(this.hosts.map((e=>e.dispose()))),await super.dispose()}}t.MultiModeTunnelHost=o,o.hostId=(0,s.v4)()},7455:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RefreshingTunnelAccessTokenEventArgs=void 0,t.RefreshingTunnelAccessTokenEventArgs=class{constructor(e,t){this.tunnelAccessScope=e,this.cancellation=t}}},3831:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelayTunnelConnector=void 0;const n=r(2727),s=r(4327),i=r(9696),o=r(7511);t.RelayTunnelConnector=class{constructor(e){this.tunnelSession=e}get trace(){return this.tunnelSession.trace}async connectSession(e,t,r){var c;let l,u;function h(e){if(e instanceof n.CancellationError&&t.isCancellationRequested)throw u=void 0,l=n.SshDisconnectReason.byApplication,e}function d(e){throw u?u.message=e:u=new Error(e),u}let p,f=0,g=100,m=!1,y=!0;for(let v=0;;v++){if(t.isCancellationRequested)throw new n.CancellationError;if(v>0){if(u){const e=new o.RetryingTunnelConnectionEventArgs(u,g);if(this.tunnelSession.onRetrying(e),!e.retry)throw u;e.delayMs>=100?g=e.delayMs:y=!1}const e=y?" in "+(g<1e3?`0.${g/100}s`:g/1e3+"s"):"";this.trace(n.TraceLevel.Verbose,0,`Error connecting to tunnel SSH session, retrying${e}${p?`: ${p}`:""}`),y&&(await(0,s.delay)(g,t),g<13e3&&(g<<=1))}let w;y=!0,p=void 0,l=n.SshDisconnectReason.connectionLost,u=void 0;try{const n=await this.tunnelSession.createSessionStream(t,r);return w=n.stream,await this.tunnelSession.configureSession(w,n.protocol,e,t),w=void 0,void(l=void 0)}catch(r){if(r instanceof Error||d(`Failed to connect to the tunnel service and start tunnel SSH session: ${r}`),h(r),u=r,p=u.message,r instanceof i.BrowserWebSocketRelayError){if(f++>=5)throw r;continue}if(r instanceof n.SshReconnectError){l=n.SshDisconnectReason.protocolError,y=!1,e=!1;continue}if(r instanceof n.SshConnectionError){const e=r.reason;if(e===n.SshDisconnectReason.connectionLost)continue;l=e||n.SshDisconnectReason.byApplication,d(`Failed to start tunnel SSH session: ${p}`)}if(r instanceof i.RelayConnectionError){const e=null===(c=r.errorContext)||void 0===c?void 0:c.statusCode,n=e?` (${e})`:"";switch(p){case"error.relayClientUnauthorized":{const e="Not authorized"+n;m&&d(`${e}. Refreshed tunnel access token also does not work.`);try{m=await this.tunnelSession.refreshTunnelAccessToken(t)}catch(t){h(t),d(`${e}. Refreshing tunnel access token failed with error ${(0,s.getErrorMessage)(t)}`)}m||d(`${e}. Provide a fresh tunnel access token with '${this.tunnelSession.tunnelAccessScope}' scope.`),y=!1,p="The tunnel access token was no longer valid and had just been refreshed.";continue}case"error.relayClientForbidden":d(`Forbidden${n}. Provide a fresh tunnel access token with '${this.tunnelSession.tunnelAccessScope}' scope.`);break;case"error.tunnelPortNotFound":d(`The tunnel or port is not found${n}`);break;case"error.serviceUnavailable":p=`Service temporarily unavailable${n}`;continue;case"error.tooManyRequests":p=`Rate limit exceeded${n}. Too many requests in a given amount of time.`,v>3&&d(p),g<13e3&&(g<<=1);continue;default:if(null==p?void 0:p.startsWith("error.relayConnectionError ")){const e=a.find((e=>p.includes(e)));if(e){p=`Failed to connect to Relay server: ${e}`;continue}}}}throw r}finally{u&&l&&!u.reason&&(u.reason=l),l&&await this.tunnelSession.closeSession(u),w&&await w.close(u)}}}};const a=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE","EAI_AGAIN","EBUSY"]},7449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryTcpListenerFactory=void 0;const n=r(1808);t.RetryTcpListenerFactory=class{constructor(e){this.localAddress=e}async createTcpListener(e,t,r,s){e.indexOf(":")>=0?"0.0.0.0"===this.localAddress?e="::":"127.0.0.1"===this.localAddress&&(e="::1"):e=this.localAddress;const i=n.createServer();for(let r=0;;r++){const s=10===r?0:t+r;try{return await new Promise(((t,r)=>{i.listen({host:e,port:s,ipv6Only:n.isIPv6(e)}),i.on("listening",(()=>{t(i)})),i.on("error",(e=>{r(e)}))}))}catch(e){console.log("Listening on port "+s+" failed: "+e),console.log("Incrementing port and trying again");continue}}}}},7511:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryingTunnelConnectionEventArgs=void 0,t.RetryingTunnelConnectionEventArgs=class{constructor(e,t){this.error=e,this.delayMs=t,this.retry=!0}}},3226:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionPortKey=void 0,t.SessionPortKey=class{constructor(e,t){this.sessionId=null!=e?e:null,this.port=t}equals(e){return this.port===e.port&&(!this.sessionId&&!e.sessionId||this.sessionId&&e.sessionId&&this.sessionId===e.sessionId)}toString(){return this.port+(this.sessionId?"_"+this.sessionId.toString("base64"):"")}}},9696:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelayConnectionError=t.RelayErrorType=t.isNode=t.SshHelpers=t.BrowserWebSocketRelayError=void 0;const n=r(2727),s=r(8766);class i extends Error{constructor(e){super(e)}}t.BrowserWebSocketRelayError=i;class o{static openConnection(e,r,n,s){return(0,t.isNode)()?o.nodeSshStreamFactory(e,r,n,s):o.webSshStreamFactory(new WebSocket(e,r))}static createSshClientSession(e){return o.createSshSession((t=>(e&&e(t),new n.SshClientSession(t))))}static createSshServerSession(e,t){return o.createSshSession((r=>(t&&t(r),new n.SshServerSession(r,e))))}static createWebSocketStreamAdapter(e){return new n.WebSocketStream(new a(e))}static webSshStreamFactory(e){return e.binaryType="arraybuffer",new Promise(((t,r)=>{e.onopen=()=>{t(new n.WebSocketStream(e))},e.onerror=e=>{r(new i("Failed to connect to relay url"))}}))}static createSshSession(e){const t=new n.SshSessionConfiguration;return t.keyExchangeAlgorithms.splice(0),t.keyExchangeAlgorithms.push(n.SshAlgorithms.keyExchange.ecdhNistp384Sha384),t.keyExchangeAlgorithms.push(n.SshAlgorithms.keyExchange.ecdhNistp256Sha256),t.keyExchangeAlgorithms.push(n.SshAlgorithms.keyExchange.dhGroup14Sha256),t.protocolExtensions.push(n.SshProtocolExtensionNames.sessionReconnect),t.protocolExtensions.push(n.SshProtocolExtensionNames.sessionLatency),e(t)}static nodeSshStreamFactory(e,t,r,i){const o=new s.client(i);return new Promise(((s,i)=>{o.on("connect",(e=>{s(new n.WebSocketStream(new a(e)))})),o.on("httpResponse",(({statusCode:e,statusMessage:t})=>{var r;const n=null!==(r=u.find((t=>t.statusCode===e)))&&void 0!==r?r:{statusCode:e,errorType:c.ServerError,error:`relayConnectionError Server responded with a non-101 status: ${e} ${t}`};i(new l(`error.${n.error}`,n))})),o.on("connectFailed",(({message:e})=>{var t;e&&e.startsWith("Error: ")&&(e=e.substr(7));const r=null!==(t=u.find((t=>t.regex&&t.regex.test(e))))&&void 0!==t?t:{errorType:c.ServerError,error:`relayConnectionError ${e}`};i(new l(`error.${r.error}`,r))})),o.connect(e,t,void 0,r)}))}}t.SshHelpers=o;class a{constructor(e){this.connection=e}get protocol(){return this.connection.protocol}set onmessage(e){e&&this.connection.on("message",(t=>{e({data:t.binaryData})}))}set onclose(e){e&&this.connection.on("close",((t,r)=>{e({code:t,reason:r,wasClean:!(t||r)})}))}send(e){Buffer.isBuffer(e)?this.connection.sendBytes(e):this.connection.sendBytes(Buffer.from(e))}close(e,t){e||t?this.connection.drop(e,t):this.connection.close()}}var c;t.isNode=()=>"undefined"!=typeof process&&void 0!==process.release&&"node"===process.release.name,function(e){e[e.ConnectionError=1]="ConnectionError",e[e.Unauthorized=2]="Unauthorized",e[e.EndpointNotFound=3]="EndpointNotFound",e[e.ListenerOffline=4]="ListenerOffline",e[e.ServerError=5]="ServerError",e[e.TunnelPortNotFound=6]="TunnelPortNotFound",e[e.TooManyRequests=7]="TooManyRequests",e[e.ServiceUnavailable=8]="ServiceUnavailable"}(c=t.RelayErrorType||(t.RelayErrorType={}));class l extends Error{constructor(e,t){super(e),this.errorContext=t}}t.RelayConnectionError=l;const u=[{regex:/status: 401/,statusCode:401,error:"relayClientUnauthorized",errorType:c.Unauthorized},{regex:/status: 403/,statusCode:403,error:"relayClientForbidden",errorType:c.Unauthorized},{regex:/status: 404/,statusCode:404,error:"tunnelPortNotFound",errorType:c.TunnelPortNotFound},{regex:/status: 429/,statusCode:429,error:"tooManyRequests",errorType:c.TooManyRequests},{regex:/status: 500/,statusCode:500,error:"relayServerError",errorType:c.ServerError},{regex:/status: 503/,statusCode:503,error:"serviceUnavailable",errorType:c.ServiceUnavailable}]},4736:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3190:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelClientBase=t.webSocketSubProtocolv2=t.webSocketSubProtocol=void 0;const n=r(3399),s=r(2727),i=r(9361),o=r(7449),a=r(9696),c=r(4327),l=r(5844),u=r(4966),h=r(9053),d=r(7752);t.webSocketSubProtocol="tunnel-relay-client",t.webSocketSubProtocolv2="tunnel-relay-client-v2-dev";class p extends((0,h.tunnelSshSessionClass)(u.TunnelConnectionSession)){get isSshSessionActive(){var e;return!!(null===(e=this.sshSession)||void 0===e?void 0:e.isConnected)}hasForwardedChannels(e){var t;if(!this.isSshSessionActive)return!1;const r=null===(t=this.sshSession)||void 0===t?void 0:t.activateService(i.PortForwardingService),n=null==r?void 0:r.remoteForwardedPorts,s=null==n?void 0:n.find((t=>t.remotePort===e));return!!s&&n.getChannels(s).length>0}get acceptLocalConnectionsForForwardedPorts(){return this.acceptLocalConnectionsForForwardedPortsValue}set acceptLocalConnectionsForForwardedPorts(e){if(e!==this.acceptLocalConnectionsForForwardedPortsValue){if(e&&!(0,a.isNode)())throw new Error("Cannot accept local connections for forwarded ports on this platform.");this.acceptLocalConnectionsForForwardedPortsValue=e,this.configurePortForwardingService()}}get localForwardingHostAddress(){return this.localForwardingHostAddressValue}set localForwardingHostAddress(e){e!==this.localForwardingHostAddressValue&&(this.localForwardingHostAddressValue=e,this.configurePortForwardingService())}get forwardedPorts(){var e;const t=null===(e=this.sshSession)||void 0===e?void 0:e.activateService(i.PortForwardingService);return null==t?void 0:t.remoteForwardedPorts}constructor(e,t){super(n.TunnelAccessScopes.Connect,e,t),this.sshSessionClosedEmitter=new l.Emitter,this.acceptLocalConnectionsForForwardedPortsValue=(0,a.isNode)(),this.localForwardingHostAddressValue="127.0.0.1",this.connectionModes=[],this.sshSessionClosed=this.sshSessionClosedEmitter.event,this.httpAgent=null==t?void 0:t.httpsAgent}async connectClient(e,t){this.endpoints=t,await this.connectTunnelSession(e,this.httpAgent)}async connect(e,t){const r=p.getEndpoints(e,t);await this.connectClient(e,r)}async onConnectingToTunnel(e){this.endpoints||(this.endpoints=p.getEndpoints(e)),await super.onConnectingToTunnel(e)}static getEndpoints(e,t){if(!e)throw new Error("Tunnel must be defined.");if(!e.endpoints)throw new Error("Tunnel endpoints cannot be null");if(0===e.endpoints.length)throw new Error("No hosts are currently accepting connections for the tunnel.");const r=c.List.groupBy(e.endpoints,(e=>e.hostId));let n;if(t){if(n=r.get(t),!n)throw new Error("The specified host is not currently accepting connections to the tunnel.")}else{if(r.size>1)throw new Error("There are multiple hosts for the tunnel. Specify a host ID to connect to.");n=r.entries().next().value[1]}return n}onRequest(e){e.request.requestType!==i.PortForwardingService.portForwardRequestType&&e.request.requestType!==i.PortForwardingService.cancelPortForwardRequestType||(e.isAuthorized=!0)}startSshSession(e,t){return this.connectSession((async()=>{this.sshSession=a.SshHelpers.createSshClientSession((e=>{e.addService(i.PortForwardingService)})),this.sshSession.trace=this.trace,this.sshSession.onClosed((e=>this.onSshSessionClosed(e))),this.sshSession.onAuthenticating((e=>this.onSshServerAuthenticating(e))),this.sshSession.onDisconnected((e=>this.onSshSessionDisconnected()));try{if(this.configurePortForwardingService(),this.sshSession.onRequest((e=>this.onRequest(e))),await this.sshSession.connect(e,t),this.sshSession.sessionId){const e={username:"tunnel"};if(!await this.sshSession.authenticate(e,t))throw new Error(this.sshSession.principal?"SSH client authentication failed.":"SSH server authentication failed.")}}catch(e){const t=(0,c.getError)(e,"Error starting tunnel client SSH session: ");throw await this.closeSession(t),t}}))}configurePortForwardingService(){if(!this.sshSession)return;const e=this.sshSession.activateService(i.PortForwardingService);this.acceptLocalConnectionsForForwardedPortsValue&&(0,a.isNode)()?e.tcpListenerFactory=new o.RetryTcpListenerFactory(this.localForwardingHostAddressValue):e.acceptLocalConnectionsForForwardedPorts=!1,this.connectionProtocol===t.webSocketSubProtocolv2&&(e.messageFactory=this,e.onForwardedPortConnecting((e=>this.onForwardedPortConnecting(e))))}onForwardedPortConnecting(e){if(e.stream.channel.openConfirmationMessage.convertTo(new d.PortRelayConnectResponseMessage).isE2EEncryptionEnabled){const t={username:"tunnel"};e.transformPromise=new Promise(((r,n)=>{const i=new s.SecureStream(e.stream,t);i.trace=this.trace,i.onAuthenticating((e=>e.authenticationPromise=this.onHostAuthenticating(e).catch())),i.connect().then((()=>r(i))).catch(n)}))}super.onForwardedPortConnecting(e)}async onHostAuthenticating(e){var t,r;if(e.authenticationType!==s.SshAuthenticationType.serverPublicKey||!e.publicKey)return this.trace(s.TraceLevel.Warning,0,"Invalid host authenticating event."),null;const n=null!==(r=null===(t=await e.publicKey.getPublicKeyBytes(e.publicKey.keyAlgorithmName))||void 0===t?void 0:t.toString("base64"))&&void 0!==r?r:"";return this.hostPublicKeys?this.hostPublicKeys.includes(n)?(this.trace(s.TraceLevel.Verbose,0,"Verified host identity with public key "+n),{}):(this.trace(s.TraceLevel.Error,0,"Host public key verificiation failed."),this.trace(s.TraceLevel.Verbose,0,"Host key: "+n),this.trace(s.TraceLevel.Verbose,0,"Expected key(s): "+this.hostPublicKeys.join(", ")),null):(this.trace(s.TraceLevel.Warning,0,"Host identity could not be verified because no public keys were provided."),this.trace(s.TraceLevel.Verbose,0,"Host key: "+n),{})}onSshServerAuthenticating(e){this.connectionProtocol===t.webSocketSubProtocol?e.authenticationPromise=this.onHostAuthenticating(e):e.authenticationPromise=Promise.resolve({})}async connectToForwardedPort(e,t){const r=this.getSshSessionPfs();if(!r)throw new Error("Failed to connect to remote port. Ensure that the client has connected by calling connectClient.");return r.connectToForwardedPort(e,t)}async waitForForwardedPort(e,t){const r=this.getSshSessionPfs();if(!r)throw new Error("Port forwarding has not been started. Ensure that the client has connected by calling connectClient.");this.trace(s.TraceLevel.Verbose,0,"Waiting for forwarded port "+e),await r.waitForForwardedPort(e,t),this.trace(s.TraceLevel.Verbose,0,"Forwarded port "+e+" is ready.")}getSshSessionPfs(){var e,t;return null!==(t=null===(e=this.sshSession)||void 0===e?void 0:e.getService(i.PortForwardingService))&&void 0!==t?t:void 0}async refreshPorts(){if(!this.sshSession||this.sshSession.isClosed)throw new Error("Not connected.");const e=new s.SessionRequestMessage;e.requestType="RefreshPorts",e.wantReply=!0,await this.sshSession.request(e)}onSshSessionClosed(e){this.sshSessionClosedEmitter.fire(this),e.reason===s.SshDisconnectReason.connectionLost&&this.startReconnectingIfNotDisposed()}onSshSessionDisconnected(){this.startReconnectingIfNotDisposed()}}t.TunnelClientBase=p},5368:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4513:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelConnectionBase=void 0;const n=r(2727),s=r(5844),i=r(3329),o=r(1480),a=r(7455),c=r(5927);t.TunnelConnectionBase=class{constructor(e){this.tunnelAccessScope=e,this.disposeCts=new s.CancellationTokenSource,this.status=i.ConnectionStatus.None,this.isRefreshingTunnelAccessTokenEventHandled=!1,this.refreshingTunnelAccessTokenEmitter=new s.Emitter({onFirstListenerAdd:()=>this.isRefreshingTunnelAccessTokenEventHandled=!0,onLastListenerRemove:()=>this.isRefreshingTunnelAccessTokenEventHandled=!1}),this.connectionStatusChangedEmitter=new s.Emitter,this.retryingTunnelConnectionEmitter=new s.Emitter,this.forwardedPortConnectingEmitter=new s.Emitter,this.refreshingTunnelAccessToken=this.refreshingTunnelAccessTokenEmitter.event,this.connectionStatusChanged=this.connectionStatusChangedEmitter.event,this.retryingTunnelConnection=this.retryingTunnelConnectionEmitter.event,this.forwardedPortConnecting=this.forwardedPortConnectingEmitter.event}get isDisposed(){return this.disposeCts.token.isCancellationRequested}get disposeToken(){return this.disposeCts.token}get connectionStatus(){return this.status}set connectionStatus(e){if(this.isDisposed&&e!==i.ConnectionStatus.Disconnected&&this.throwIfDisposed(),e!==this.status){const t=this.connectionStatus;this.status=e,e===i.ConnectionStatus.Connected&&(this.error=void 0),this.onConnectionStatusChanged(t,e)}}get disconnectError(){return this.error}set disconnectError(e){this.error=e}onForwardedPortConnecting(e){this.forwardedPortConnectingEmitter.fire(e)}dispose(){return this.disposeCts.cancel(),this.connectionStatus=i.ConnectionStatus.Disconnected,Promise.resolve()}onRetrying(e){this.retryingTunnelConnectionEmitter.fire(e)}async getFreshTunnelAccessToken(e){const t=new a.RefreshingTunnelAccessTokenEventArgs(this.tunnelAccessScope,e);this.refreshingTunnelAccessTokenEmitter.fire(t);const r=t.tunnelAccessToken?await t.tunnelAccessToken:void 0;return r&&c.TunnelAccessTokenProperties.validateTokenExpiration(r),r}onConnectionStatusChanged(e,t){const r=new o.ConnectionStatusChangedEventArgs(e,t,this.disconnectError);this.connectionStatusChangedEmitter.fire(r)}throwIfDisposed(){if(this.isDisposed)throw new n.CancellationError("The tunnel connection is disposed.")}}},4966:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelConnectionSession=void 0;const n=r(3399),s=r(5927),i=r(2727),o=r(3329),a=r(3831),c=r(4327),l=r(4513),u=r(9361),h=r(7012),d=r(2040);class p extends l.TunnelConnectionBase{get connectionProtocol(){return this.connectionProtocolValue}set connectionProtocol(e){this.connectionProtocolValue=e}constructor(e,t,r){super(e),this.managementClient=r,this.connectedTunnel=null,this.enableE2EEncryption=!0,this.trace=null!=t?t:()=>{}}get tunnel(){return this.connectedTunnel}set tunnel(e){this.connectedTunnel=e}get isReconnectable(){return!!this.connector}createSessionStream(e){throw new Error("Not implemented")}configureSession(e,t,r,n){throw new Error("Not implemented")}closeSession(e){return this.disconnectError=e,Promise.resolve()}async refreshTunnelAccessToken(e){if(this.isDisposed)return!1;const t=this.connectionStatus;this.connectionStatus=o.ConnectionStatus.RefreshingTunnelAccessToken;try{this.traceInfo(`Refreshing tunnel access token. Current token: ${s.TunnelAccessTokenProperties.getTokenTrace(this.accessToken)}`);const r=await this.getFreshTunnelAccessToken(e);if(r)return s.TunnelAccessTokenProperties.validateTokenExpiration(r),this.traceInfo(`Refreshed tunnel access token. New token: ${s.TunnelAccessTokenProperties.getTokenTrace(r)}`),this.accessToken=r,!0}finally{this.connectionStatus=t}return!1}async getFreshTunnelAccessToken(e){var t;if(!this.isRefreshingTunnelAccessTokenEventHandled){if(!this.tunnel||!this.managementClient)return;const r={tokenScopes:[this.tunnelAccessScope]},n=await(0,c.withCancellation)(this.managementClient.getTunnel(this.tunnel,r),e);if(!n)return;let i=s.TunnelAccessTokenProperties.getTunnelAccessToken(n,this.tunnelAccessScope);return i||(i=s.TunnelAccessTokenProperties.getTunnelAccessToken(this.tunnel,this.tunnelAccessScope),i&&(null!==(t=n.accessTokens)&&void 0!==t||(n.accessTokens={}),n.accessTokens[this.tunnelAccessScope]=i)),this.tunnel=n,i}return await super.getFreshTunnelAccessToken(e)}createTunnelConnector(){return new a.RelayTunnelConnector(this)}traceInfo(e){this.trace(i.TraceLevel.Info,0,e)}traceVerbose(e){this.trace(i.TraceLevel.Verbose,0,e)}traceError(e,t){this.trace(i.TraceLevel.Error,0,e,t)}startReconnectingIfNotDisposed(){this.isDisposed||this.reconnectPromise||(this.reconnectPromise=(async()=>{try{await this.connectTunnelSession()}catch(e){}this.reconnectPromise=void 0})())}async connectSession(e){this.connectionStatus=o.ConnectionStatus.Connecting;try{await e(),this.connectionStatus=o.ConnectionStatus.Connected}catch(e){if(!(e instanceof i.CancellationError)){const t=this.tunnelAccessScope===n.TunnelAccessScopes.Connect?"client":"host";if(e instanceof Error)this.traceError(`Error connecting ${t} tunnel session: ${e.message}`,e),this.disconnectError=e;else{const r=`Error connecting ${t} tunnel session: ${e}`;this.traceError(r),this.disconnectError=new Error(r)}}throw this.connectionStatus=o.ConnectionStatus.Disconnected,e}}async connectTunnelSession(e,t){if(e&&this.tunnel)throw new Error("Already connected to a tunnel. Use separate instances to connect to multiple tunnels.");await this.connectSession((async()=>{const r=this.isReconnectable&&!e;await this.onConnectingToTunnel(e),e&&(this.tunnel=e,this.accessToken=s.TunnelAccessTokenProperties.getTunnelAccessToken(e,this.tunnelAccessScope)),this.connector||(this.connector=this.createTunnelConnector()),await this.connector.connectSession(r,this.disposeToken,t)}))}onConnectingToTunnel(e){return Promise.resolve()}validateAccessToken(){if(this.accessToken)return s.TunnelAccessTokenProperties.validateTokenExpiration(this.accessToken),this.accessToken}createRequestMessageAsync(e){const t=new h.PortRelayRequestMessage;return t.accessToken=this.accessToken,Promise.resolve(t)}createSuccessMessageAsync(e){const t=new u.PortForwardSuccessMessage;return Promise.resolve(t)}createChannelOpenMessageAsync(e){const t=new d.PortRelayConnectRequestMessage;return t.accessToken=this.accessToken,t.isE2EEncryptionRequested=this.enableE2EEncryption,Promise.resolve(t)}}t.TunnelConnectionSession=p},3390:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1194:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7875:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelHostBase=void 0;const n=r(3399),s=r(2727),i=r(3226),o=r(4966),a=r(9053),c=r(9696);class l extends((0,a.tunnelSshSessionClass)(o.TunnelConnectionSession)){constructor(e,t){super(n.TunnelAccessScopes.Host,t,e),this.sshSessions=[],this.remoteForwarders=new Map,this.loopbackIp="127.0.0.1",this.forwardConnectionsToLocalPortsValue=(0,c.isNode)();const r=s.SshAlgorithms.publicKey.ecdsaSha2Nistp384;r&&(this.hostPrivateKeyPromise=r.generateKeyPair())}get forwardConnectionsToLocalPorts(){return this.forwardConnectionsToLocalPortsValue}set forwardConnectionsToLocalPorts(e){if(e!==this.forwardConnectionsToLocalPortsValue){if(e&&!(0,c.isNode)())throw new Error("Cannot forward connections to local TCP sockets on this platform.");this.forwardConnectionsToLocalPortsValue=e}}async start(e){await this.connectTunnelSession(e)}refreshPorts(){return Promise.resolve()}async forwardPort(e,t){const r=Number(t.portNumber);if(e.localForwardedPorts.find((e=>e.localPort===r)))return;const n=await e.forwardFromRemotePort(this.loopbackIp,r,this.loopbackIp,r);if(!n)return;const s=new i.SessionPortKey(e.session.sessionId,Number(n.localPort));this.remoteForwarders.set(s.toString(),n)}async onConnectingToTunnel(e){if(this.hostPrivateKey&&this.hostPublicKeys)return;if(!e)throw new Error("Tunnel is required");if(!this.hostPrivateKeyPromise)throw new Error("Cannot create host keys");this.hostPrivateKey=await this.hostPrivateKeyPromise;const t=await this.hostPrivateKey.getPublicKeyBytes(this.hostPrivateKey.keyAlgorithmName);if(!t)throw new Error("Host private key public key bytes is not initialized");this.hostPublicKeys=[t.toString("base64")]}}t.TunnelHostBase=l},2979:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tunnelRelaySessionClass=void 0;const n=r(3399),s=r(5927),i=r(2727),o=r(1139);t.tunnelRelaySessionClass=function(e,t){return class extends e{constructor(){super(...arguments),this.streamFactory=new o.DefaultTunnelRelayStreamFactory}async createSessionStream(e,r){if(!this.relayUri)throw new Error("Cannot create tunnel session stream. Tunnel relay endpoint URI is missing");const o=this.tunnelAccessScope===n.TunnelAccessScopes.Connect?"client":"host",a=this.validateAccessToken();if(this.trace(i.TraceLevel.Info,0,`Connecting to ${o} tunnel relay ${this.relayUri}`),this.trace(i.TraceLevel.Verbose,0,`Sec-WebSocket-Protocol: ${t.join(", ")}`),a){const e=s.TunnelAccessTokenProperties.getTokenTrace(a);this.trace(i.TraceLevel.Verbose,0,`Authorization: tunnel <${e}>`)}const c={tlsOptions:{agent:r}},l=await this.streamFactory.createRelayStream(this.relayUri,t,a,c);return this.trace(i.TraceLevel.Verbose,0,`Connected with subprotocol '${l.protocol}'`),l}async connectTunnelSession(e,t){try{await super.connectTunnelSession(e,t)}catch(e){throw new Error("Failed to connect to tunnel relay. "+e)}}async onConnectingToTunnel(e){if(await super.onConnectingToTunnel(e),!this.relayUri&&(this.relayUri=await this.getTunnelRelayUri(e),!this.relayUri))throw new Error("The tunnel relay endpoint URI is missing.")}async getTunnelRelayUri(e){throw new Error("getTunnelRelayUri() is not implemented")}}}},1306:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3559:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelRelayTunnelClient=void 0;const n=r(3399),s=r(3190),i=r(2979),o=(null===process||void 0===process?void 0:process.env)&&process.env.DEVTUNNELS_PROTOCOL_VERSION,a="1"===o?[s.webSocketSubProtocol]:"2"===o?[s.webSocketSubProtocolv2]:[s.webSocketSubProtocolv2,s.webSocketSubProtocol];class c extends((0,i.tunnelRelaySessionClass)(s.TunnelClientBase,a)){constructor(e,t){super(e,t),this.connectionModes=[]}async getTunnelRelayUri(e){if(!this.endpoints||0===this.endpoints.length)throw new Error("No hosts are currently accepting connections for the tunnel.");const t=this.endpoints.filter((e=>e.connectionMode===n.TunnelConnectionMode.TunnelRelay));if(0===t.length)throw new Error("The host is not currently accepting Tunnel relay connections.");const r=t[0];return this.hostPublicKeys=r.hostPublicKeys,r.clientRelayUri}async connectClientToRelayServer(e,t){if(!e)throw new Error("Client relay URI must be a non-empty string");this.relayUri=e,this.accessToken=t,await this.connectTunnelSession()}async configureSession(e,t,r,n){this.connectionProtocol=t,r&&this.sshSession&&!this.sshSession.isClosed?await this.sshSession.reconnect(e,n):await this.startSshSession(e,n)}}t.TunnelRelayTunnelClient=c,c.webSocketSubProtocol=s.webSocketSubProtocol,c.webSocketSubProtocolv2=s.webSocketSubProtocolv2},82:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelRelayTunnelHost=void 0;const n=r(3399),s=r(2727),i=r(9361),o=r(9696),a=r(2616),c=r(7875),l=r(2979),u=r(3226),h=r(2040),d=r(7752),p="tunnel-relay-host",f="tunnel-relay-host-v2-dev",g=(null===process||void 0===process?void 0:process.env)&&process.env.DEVTUNNELS_PROTOCOL_VERSION,m="1"===g?[p]:"2"===g?[f]:[f,p];class y extends((0,l.tunnelRelaySessionClass)(c.TunnelHostBase,m)){constructor(e,t){super(e,t),this.clientSessionPromises=[],this.reconnectableSessions=[],this.hostId=a.MultiModeTunnelHost.hostId}async configureSession(e,t,r,n){if(this.connectionProtocol=t,this.connectionProtocol===p)this.sshSession=new s.SshClientSession(new s.SshSessionConfiguration(!1));else{const e=new s.SshSessionConfiguration;e.keyExchangeAlgorithms.splice(0,e.keyExchangeAlgorithms.length,s.SshAlgorithms.keyExchange.none,s.SshAlgorithms.keyExchange.ecdhNistp384Sha384,s.SshAlgorithms.keyExchange.ecdhNistp256Sha256,s.SshAlgorithms.keyExchange.dhGroup16Sha512,s.SshAlgorithms.keyExchange.dhGroup14Sha256),e.addService(i.PortForwardingService),this.sshSession=new s.SshClientSession(e);const t=this.sshSession.activateService(i.PortForwardingService);t.messageFactory=this,t.onForwardedPortConnecting((e=>this.onForwardedPortConnecting(e)))}const o=this.sshSession.onChannelOpening((e=>{this.hostSession_ChannelOpening(this.sshSession,e)})),a=this.sshSession.onClosed((e=>{this.hostSession_Closed(e,o,a)}));this.sshSession.trace=this.trace,await this.sshSession.connect(e,n),this.sshSession.sessionId&&await this.sshSession.authenticate({username:"tunnel"}),this.connectionProtocol===f&&await this.startForwardingExistingPorts(this.sshSession)}async getTunnelRelayUri(e){if(!e)throw new Error("Tunnel is required");let t,r={hostId:this.hostId,hostPublicKeys:this.hostPublicKeys,connectionMode:n.TunnelConnectionMode.TunnelRelay};return null!=e.ports&&e.ports.find((e=>e.protocol===n.TunnelProtocol.Ssh))&&(t={includeSshGatewayPublicKey:"true"}),r=await this.managementClient.updateTunnelEndpoint(e,r,{additionalQueryParameters:t}),r.hostRelayUri}hostSession_ChannelOpening(e,t){if(!t.isRemoteRequest)return;if(this.connectionProtocol===f&&"forwarded-tcpip"===t.channel.channelType){const e=t.channel.openMessage.convertTo(new h.PortRelayConnectRequestMessage),r=new d.PortRelayConnectResponseMessage;return r.isE2EEncryptionEnabled=this.enableE2EEncryption&&e.isE2EEncryptionRequested,void(t.openingPromise=Promise.resolve(r))}if(t.channel.channelType!==y.clientStreamChannelType)return t.failureDescription=`Unknown channel type: ${t.channel.channelType}`,void(t.failureReason=s.SshChannelOpenFailureReason.unknownChannelType);if(t.channel.maxWindowSize=5*s.SshChannel.defaultMaxWindowSize,this.isDisposed)return t.failureDescription="The host is disconnecting.",void(t.failureReason=s.SshChannelOpenFailureReason.connectFailed);const r=this.acceptClientSession(t.channel,this.disposeToken);this.clientSessionPromises.push(r),r.then((()=>{const e=this.clientSessionPromises.indexOf(r);this.clientSessionPromises.splice(e,1)}))}onForwardedPortConnecting(e){const t=e.stream.channel,r=t.openMessage.convertTo(new h.PortRelayConnectRequestMessage);if(this.enableE2EEncryption&&r.isE2EEncryptionRequested){t.maxWindowSize=2*s.SshChannel.defaultMaxWindowSize;const r={publicKeys:[this.hostPrivateKey]},n=new s.SecureStream(e.stream,r);n.trace=this.trace,n.onAuthenticating((e=>e.authenticationPromise=Promise.resolve({}))),n.connect().catch((e=>{this.trace(s.TraceLevel.Error,0,`Error connecting encrypted channel: ${e}`)})),e.transformPromise=Promise.resolve(n)}super.onForwardedPortConnecting(e)}async acceptClientSession(e,t){try{const r=new s.SshStream(e);await this.connectAndRunClientSession(r,t)}catch(e){e instanceof s.CancellationError&&t.isCancellationRequested||this.trace(s.TraceLevel.Error,0,`Error running client SSH session: ${e}`)}}async connectAndRunClientSession(e,t){if(t.isCancellationRequested)throw e.destroy(),new s.CancellationError;const r=o.SshHelpers.createSshServerSession(this.reconnectableSessions,(e=>{e.addService(i.PortForwardingService)}));r.trace=this.trace,r.credentials={publicKeys:[this.hostPrivateKey]};const n=new s.PromiseCompletionSource,a=r.onAuthenticating((e=>{this.onSshClientAuthenticating(e)}));r.onClientAuthenticated((()=>{this.onSshClientAuthenticated(r)}));const c=r.onRequest((e=>{this.onSshSessionRequest(e,r)})),l=r.onChannelOpening((e=>{this.onSshChannelOpening(e,r)})),u=r.onClosed((e=>{this.session_Closed(r,e,t),n.resolve()}));try{const i=new s.NodeStream(e);await r.connect(i),this.sshSessions.push(r),t.onCancellationRequested((e=>{n.reject(new s.CancellationError)})),await n.promise}finally{a.dispose(),c.dispose(),l.dispose(),u.dispose(),await r.close(s.SshDisconnectReason.byApplication),r.dispose()}}onSshClientAuthenticating(e){e.authenticationType===s.SshAuthenticationType.clientNone&&(e.authenticationPromise=Promise.resolve({}))}async onSshClientAuthenticated(e){this.startForwardingExistingPorts(e)}async startForwardingExistingPorts(e){var t,r;const n=e.activateService(i.PortForwardingService);n.forwardConnectionsToLocalPorts=this.forwardConnectionsToLocalPorts;for(const e of null!==(r=null===(t=this.tunnel)||void 0===t?void 0:t.ports)&&void 0!==r?r:[]){this.trace(s.TraceLevel.Verbose,0,`Forwarding port ${e.portNumber}`);try{await this.forwardPort(n,e)}catch(t){this.traceError(`Error forwarding port ${e.portNumber}: ${t}`)}}}onSshSessionRequest(e,t){"RefreshPorts"===e.requestType&&(e.responsePromise=(async()=>(await this.refreshPorts(),new s.SessionRequestSuccessMessage))())}onSshChannelOpening(e,t){if(!(e.request instanceof i.PortForwardChannelOpenMessage)){if(e.request.channelType===s.SshChannel.sessionChannelType)return;return this.trace(s.TraceLevel.Warning,0,"Rejecting request to open non-portforwarding channel."),void(e.failureReason=s.SshChannelOpenFailureReason.administrativelyProhibited)}const r=e.request;if("direct-tcpip"===r.channelType)this.tunnel.ports.some((e=>e.portNumber===r.port))||(this.trace(s.TraceLevel.Warning,0,"Rejecting request to connect to non-forwarded port:"+r.port),e.failureReason=s.SshChannelOpenFailureReason.administrativelyProhibited);else if("forwarded-tcpip"===r.channelType){const t=new i.ForwardedPortConnectingEventArgs(r.port,!1,new s.SshStream(e.channel));super.onForwardedPortConnecting(t)}else this.trace(s.TraceLevel.Warning,0,"Nonrecognized channel type "+r.channelType),e.failureReason=s.SshChannelOpenFailureReason.unknownChannelType}session_Closed(e,t,r){t.reason===s.SshDisconnectReason.byApplication?this.traceInfo("Client ssh session closed."):r.isCancellationRequested?this.traceInfo("Client ssh session cancelled."):this.traceError(`Client ssh session closed unexpectely due to ${t.reason}, "${t.message}"\n${t.error}`);for(const[t,r]of this.remoteForwarders.entries())r.session===e&&(r.dispose(),this.remoteForwarders.delete(t));const n=this.sshSessions.indexOf(e);n>=0&&this.sshSessions.splice(n,1)}hostSession_Closed(e,t,r){r.dispose(),t.dispose(),this.sshSession=void 0,this.traceInfo("Connection to host tunnel relay closed."+(this.isDisposed?"":" Reconnecting.")),e.reason===s.SshDisconnectReason.connectionLost&&this.startReconnectingIfNotDisposed()}async refreshPorts(){var e;if(!this.tunnel||!this.managementClient)return;const t=await this.managementClient.getTunnel(this.tunnel,void 0),r=null!==(e=null==t?void 0:t.ports)&&void 0!==e?e:[];this.tunnel.ports=r;let n=this.sshSessions;this.connectionProtocol===f&&this.sshSession&&(n=[...n,this.sshSession]);const s=[];for(const e of r)for(const t of n.filter((e=>e.isConnected&&e.sessionId))){const r=new u.SessionPortKey(t.sessionId,Number(e.portNumber));if(!this.remoteForwarders.get(r.toString())){const r=t.getService(i.PortForwardingService);s.push(this.forwardPort(r,e))}}for(const[e,t]of Object.entries(this.remoteForwarders))r.some((e=>e.portNumber===t.localPort))||(this.remoteForwarders.delete(e),t.dispose());await Promise.all(s)}async dispose(){await super.dispose();const e=Object.assign([],this.clientSessionPromises);if(this.clientSessionPromises.length=0,this.tunnel){const t=this.managementClient.deleteTunnelEndpoints(this.tunnel,this.hostId,n.TunnelConnectionMode.TunnelRelay);e.push(t)}for(const e of this.remoteForwarders.values())e.dispose();await Promise.all(e)}}t.TunnelRelayTunnelHost=y,y.webSocketSubProtocol=p,y.webSocketSubProtocolv2=f,y.clientStreamChannelType="client-ssh-session-stream"},9053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tunnelSshSessionClass=void 0;const n=r(2727);t.tunnelSshSessionClass=function(e){return class extends e{async closeSession(e){var t;if(await super.closeSession(e),this.sshSession){if(!this.sshSession.isClosed){let r=n.SshDisconnectReason.byApplication;e&&(r=e instanceof n.SshConnectionError?null!==(t=e.reason)&&void 0!==t?t:n.SshDisconnectReason.connectionLost:e instanceof n.SshReconnectError||e instanceof n.SshChannelError?n.SshDisconnectReason.protocolError:n.SshDisconnectReason.connectionLost),await this.sshSession.close(r,void 0,e)}this.sshSession&&(this.sshSession.dispose(),this.sshSession=void 0)}}async dispose(){await super.dispose();try{await this.closeSession(this.disconnectError)}catch(e){if(!(e instanceof n.ObjectDisposedError))throw e}}}}},4327:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withCancellation=t.getError=t.getErrorMessage=t.delay=t.List=void 0;const n=r(2727);t.List=class{static groupBy(e,t){const r=new Map;return e.forEach((e=>{const n=t(e),s=r.get(n);s?s.push(e):r.set(n,[e])})),r}},t.delay=function(e,t){return new Promise(((r,s)=>{let i,o;if(t){if(t.isCancellationRequested)return void s(new n.CancellationError);i=t.onCancellationRequested((()=>{o&&clearTimeout(o),null==i||i.dispose(),s(new n.CancellationError)}))}o=setTimeout((()=>{null==i||i.dispose(),r()}),e)}))},t.getErrorMessage=function(e){var t;return String(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e)},t.getError=function(e,t){return e instanceof Error?e:new Error(`${null!=t?t:""}${e}`)},t.withCancellation=function(e,t){return t?Promise.race([e,new Promise(((e,r)=>{t.isCancellationRequested?r(new n.CancellationError):t.onCancellationRequested((()=>{r(new n.CancellationError)}))}))]):e}},3399:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelServiceProperties=t.TunnelProtocol=t.TunnelHeaderNames=t.TunnelEndpoint=t.TunnelConnectionMode=t.TunnelAccessScopes=t.TunnelAccessControlEntryType=t.TunnelAccessControl=void 0;var n=r(6056);Object.defineProperty(t,"TunnelAccessControl",{enumerable:!0,get:function(){return n.TunnelAccessControl}});var s=r(4318);Object.defineProperty(t,"TunnelAccessControlEntryType",{enumerable:!0,get:function(){return s.TunnelAccessControlEntryType}});var i=r(8401);Object.defineProperty(t,"TunnelAccessScopes",{enumerable:!0,get:function(){return i.TunnelAccessScopes}});var o=r(2491);Object.defineProperty(t,"TunnelConnectionMode",{enumerable:!0,get:function(){return o.TunnelConnectionMode}});var a=r(5301);Object.defineProperty(t,"TunnelEndpoint",{enumerable:!0,get:function(){return a.TunnelEndpoint}});var c=r(113);Object.defineProperty(t,"TunnelHeaderNames",{enumerable:!0,get:function(){return c.TunnelHeaderNames}});var l=r(4856);Object.defineProperty(t,"TunnelProtocol",{enumerable:!0,get:function(){return l.TunnelProtocol}});var u=r(736);Object.defineProperty(t,"TunnelServiceProperties",{enumerable:!0,get:function(){return u.TunnelServiceProperties}})},6056:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessControl=void 0;const n=r(6538);t.TunnelAccessControl={validateScopes:n.validateScopes}},4318:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessControlEntryType=void 0,(r=t.TunnelAccessControlEntryType||(t.TunnelAccessControlEntryType={})).None="None",r.Anonymous="Anonymous",r.Users="Users",r.Groups="Groups",r.Organizations="Organizations",r.Repositories="Repositories",r.PublicKeys="PublicKeys",r.IPAddressRanges="IPAddressRanges"},6538:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateScopes=void 0;const n=r(8401),s=[n.TunnelAccessScopes.Manage,n.TunnelAccessScopes.ManagePorts,n.TunnelAccessScopes.Host,n.TunnelAccessScopes.Inspect,n.TunnelAccessScopes.Connect];t.validateScopes=function(e,t,r){if(!Array.isArray(e))throw new TypeError("A scopes array was expected.");r&&(e=e.map((e=>e.split(" "))).reduce(((e,t)=>e.concat(t)),[])),e.forEach((e=>{if(!e)throw new Error("Tunnel access scopes include a null/empty item.");if(!s.includes(e))throw new Error("Invalid tunnel access scope: "+e)})),Array.isArray(t)&&e.forEach((e=>{if(!t.includes(e))throw new Error("Tunnel access scope is invalid for current request: scope")}))}},8401:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessScopes=void 0,(r=t.TunnelAccessScopes||(t.TunnelAccessScopes={})).Create="create",r.Manage="manage",r.ManagePorts="manage:ports",r.Host="host",r.Inspect="inspect",r.Connect="connect"},2491:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelConnectionMode=void 0,(r=t.TunnelConnectionMode||(t.TunnelConnectionMode={})).LocalNetwork="LocalNetwork",r.TunnelRelay="TunnelRelay"},5301:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelEndpoint=t.portToken=void 0,t.portToken="{port}";const n=r(6729);t.TunnelEndpoint={portToken:t.portToken,getPortUri:n.getPortUri,getPortSshCommand:n.getPortSshCommand}},6729:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPortSshCommand=t.getPortUri=void 0;const n=r(5301);t.getPortUri=function(e,t){if(!e)throw new TypeError("A tunnel endpoint is required.");return"number"==typeof t||e.tunnelUri?"number"==typeof t&&e.portUriFormat?e.portUriFormat.replace(n.portToken,t.toString()):void 0:e.tunnelUri},t.getPortSshCommand=function(e,t){if(!e)throw new TypeError("A tunnel endpoint is required.");return"number"==typeof t||e.tunnelSshCommand?"number"==typeof t&&e.portSshCommandFormat?e.portSshCommandFormat.replace(n.portToken,t.toString()):void 0:e.tunnelSshCommand}},113:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelHeaderNames=void 0,(r=t.TunnelHeaderNames||(t.TunnelHeaderNames={})).XTunnelAuthorization="X-Tunnel-Authorization",r.XRequestID="X-Request-ID",r.XGithubSshKey="X-Github-Ssh-Key",r.XTunnelSkipAntiPhishingPage="X-Tunnel-Skip-AntiPhishing-Page"},4856:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelProtocol=void 0,(r=t.TunnelProtocol||(t.TunnelProtocol={})).Auto="auto",r.Tcp="tcp",r.Udp="udp",r.Ssh="ssh",r.Rdp="rdp",r.Http="http",r.Https="https"},736:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelServiceProperties=t.nonProdGitHubAppClientId=t.prodGitHubAppClientId=t.devThirdPartyAppId=t.ppeThirdPartyAppId=t.prodThirdPartyAppId=t.nonProdFirstPartyAppId=t.prodFirstPartyAppId=t.devDnsName=t.ppeDnsName=t.prodDnsName=void 0,t.prodDnsName="global.rel.tunnels.api.visualstudio.com",t.ppeDnsName="global.rel.tunnels.ppe.api.visualstudio.com",t.devDnsName="global.ci.tunnels.dev.api.visualstudio.com",t.prodFirstPartyAppId="46da2f7e-b5ef-422a-88d4-2a7f9de6a0b2",t.nonProdFirstPartyAppId="54c45752-bacd-424a-b928-652f3eca2b18",t.prodThirdPartyAppId="ce65d243-a913-4cae-a7dd-cb52e9f77647",t.ppeThirdPartyAppId="544167a6-f431-4518-aac6-2fd50071928e",t.devThirdPartyAppId="a118c979-0249-44bb-8f95-eb0457127aeb",t.prodGitHubAppClientId="Iv1.e7b89e013f801f03",t.nonProdGitHubAppClientId="Iv1.b231c327f1eaa229";const n=r(7193);t.TunnelServiceProperties={production:n.production,staging:n.staging,development:n.development,environment:n.environment}},7193:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.environment=t.development=t.staging=t.production=void 0;const n=r(736);t.production={serviceUri:`https://${n.prodDnsName}/`,serviceAppId:n.prodFirstPartyAppId,serviceInternalAppId:n.prodThirdPartyAppId,gitHubAppClientId:n.prodGitHubAppClientId},t.staging={serviceUri:`https://${n.ppeDnsName}/`,serviceAppId:n.nonProdFirstPartyAppId,serviceInternalAppId:n.ppeThirdPartyAppId,gitHubAppClientId:n.nonProdGitHubAppClientId},t.development={serviceUri:`https://${n.devDnsName}/`,serviceAppId:n.nonProdFirstPartyAppId,serviceInternalAppId:n.devThirdPartyAppId,gitHubAppClientId:n.nonProdGitHubAppClientId},t.environment=function(e){if(!e)throw new Error(`Invalid argument: ${e}`);switch(e.toLowerCase()){case"prod":case"production":return t.production;case"ppe":case"preprod":return t.staging;case"dev":case"development":return t.development;default:throw new Error(`Invalid service environment: ${e}`)}}},5927:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(153),t),s(r(1005),t),s(r(9146),t),s(r(7021),t)},7021:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessTokenProperties=void 0;class r{constructor(e,t,r,n,s,i){this.clusterId=e,this.tunnelId=t,this.tunnelPorts=r,this.scopes=n,this.issuer=s,this.expiration=i}toString(){let e="";return this.tunnelId&&(e+="tunnel=",e+=this.tunnelId,this.clusterId&&(e+=".",e+=this.clusterId)),this.tunnelPorts&&this.tunnelPorts.length>0&&(e.length>0&&(e+=", "),1===this.tunnelPorts.length?e+=`port=${this.tunnelPorts[0]}`:e+=`ports=[${this.tunnelPorts.join(", ")}]`),this.scopes&&(e.length>0&&(e+=", "),e+=`scopes=[${this.scopes.join(", ")}]`),this.issuer&&(e.length>0&&(e+=", "),e+="issuer=",e+=this.issuer),this.expiration&&(e.length>0&&(e+=", "),e+=`expiration=${this.expiration.toString().replace(".000Z","Z")}`),e}static validateTokenExpiration(e){const t=r.tryParse(e);if((null==t?void 0:t.expiration)&&t.expiration<new Date)throw new Error("The access token is expired: "+t)}static tryParse(e){if("string"!=typeof e)throw new TypeError("Token string expected.");const t=e.split(".");if(3!==t.length)return null;const n=r.base64UrlDecode(t[1]);if(!n)return null;try{const e=JSON.parse(n),t=e.clusterId,s=e.tunnelId,i=e.tunnelPorts,o=e.scp,a=e.iss,c=e.exp;return new r(t,s,"number"==typeof i?[i]:i,null==o?void 0:o.split(" "),a,"number"==typeof c?new Date(1e3*c):void 0)}catch(e){return null}}static getTokenTrace(e){var t,n;return e?null!==(n=null===(t=r.tryParse(e))||void 0===t?void 0:t.toString())&&void 0!==n?n:"token":"none"}static getTunnelAccessToken(e,t){if((null==e?void 0:e.accessTokens)&&t){Array.isArray(t)||(t=[t]);for(const n of t)for(const[t,s]of Object.entries(e.accessTokens))if(s&&t.split(" ").includes(n))return r.validateTokenExpiration(s),s}}static base64UrlDecode(e){for(e=e.replace("-","+");e.length%4!=0;)e+="=";try{return atob(e)}catch(e){return null}}}t.TunnelAccessTokenProperties=r},1005:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAuthenticationSchemes=void 0;class r{}t.TunnelAuthenticationSchemes=r,r.aad="aad",r.github="github",r.tunnel="tunnel"},153:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelManagementHttpClient=void 0;const n=r(3399),s=r(1005),i=r(7021),o=r(8534),a=r(751),c="/api/v1/tunnels",l="/ports",u="Authorization";function h(e,t){var r,n;return(null!==(r=e.portNumber)&&void 0!==r?r:Number.MAX_SAFE_INTEGER)-(null!==(n=t.portNumber)&&void 0!==n?n:Number.MAX_SAFE_INTEGER)}function d(e){return"string"==typeof e?new Date(Date.parse(e)):e}function p(e){e&&(e.created=d(e.created),e.status&&(e.status.lastHostConnectionTime=d(e.status.lastHostConnectionTime),e.status.lastClientConnectionTime=d(e.status.lastClientConnectionTime)))}function f(e){e&&e.status&&(e.status.lastClientConnectionTime=d(e.status.lastClientConnectionTime))}const g=[n.TunnelAccessScopes.Manage],m=[n.TunnelAccessScopes.Host],y=[n.TunnelAccessScopes.Manage,n.TunnelAccessScopes.ManagePorts,n.TunnelAccessScopes.Host],v=[n.TunnelAccessScopes.Manage,n.TunnelAccessScopes.ManagePorts,n.TunnelAccessScopes.Host,n.TunnelAccessScopes.Connect];class w{constructor(e,t,r,s,i){var o;if(this.httpsAgent=s,this.adapter=i,this.trace=e=>{},!e)throw new TypeError("User agent must be provided.");if(Array.isArray(e)){if(0===e.length)throw new TypeError("User agents cannot be empty.");let t="";e.forEach((e=>{var r;if("string"!=typeof e){if(!e.name)throw new TypeError("Invalid user agent. The name must be provided.");if("string"!=typeof e.name)throw new TypeError("Invalid user agent. The name must be a string.");if(e.version&&"string"!=typeof e.version)throw new TypeError("Invalid user agent. The version must be a string.");t=`${t}${e.name}/${null!==(r=e.version)&&void 0!==r?r:"unknown"} `}else t=`${t}${e} `})),this.userAgents=t.trim()}else if("string"!=typeof e){if(!e.name)throw new TypeError("Invalid user agent. The name must be provided.");if("string"!=typeof e.name)throw new TypeError("Invalid user agent. The name must be a string.");if(e.version&&"string"!=typeof e.version)throw new TypeError("Invalid user agent. The version must be a string.");this.userAgents=`${e.name}/${null!==(o=e.version)&&void 0!==o?o:"unknown"}`}else this.userAgents=e;this.userTokenCallback=null!=t?t:()=>Promise.resolve(null),r||(r=n.TunnelServiceProperties.production.serviceUri);const a=new URL(r);if(!a||"/"!==a.pathname)throw new TypeError(`Invalid tunnel service URI: ${r}`);this.baseAddress=r}async listTunnels(e,t,r){const n=[e?null:"global=true",t?`domain=${t}`:null].filter((e=>!!e)).join("&"),s=await this.sendRequest("GET",e,c,n,r);return s.forEach(p),s}async getTunnel(e,t){const r=await this.sendTunnelRequest("GET",e,v,void 0,void 0,t);return p(r),r}async createTunnel(e,t){if(e.tunnelId)throw new Error("An ID may not be specified when creating a tunnel.");e=this.convertTunnelForRequest(e);const r=await this.sendRequest("POST",e.clusterId,c,void 0,t,e);return p(r),r}async updateTunnel(e,t){const r=await this.sendTunnelRequest("PUT",e,g,void 0,void 0,t,this.convertTunnelForRequest(e));return(null==t?void 0:t.tokenScopes)||(r.accessTokens=e.accessTokens),p(r),r}async deleteTunnel(e,t){return await this.sendTunnelRequest("DELETE",e,g,void 0,void 0,t,void 0,!0)}async updateTunnelEndpoint(e,t,r){const n=`/endpoints/${t.hostId}/${t.connectionMode}`,s=await this.sendTunnelRequest("PUT",e,m,n,void 0,r,t);return e.endpoints&&(e.endpoints=e.endpoints.filter((e=>e.hostId!==t.hostId||e.connectionMode!==t.connectionMode)).concat(s)),s}async deleteTunnelEndpoints(e,t,r,n){const s=null==r?`/endpoints/${t}`:`/endpoints/${t}/${r}`,i=await this.sendTunnelRequest("DELETE",e,m,s,void 0,n,void 0,!0);return i&&e.endpoints&&(e.endpoints=e.endpoints.filter((e=>e.hostId!==t||e.connectionMode!==r))),i}async listUserLimits(){return await this.sendRequest("GET",void 0,"/api/v1/userlimits",void 0,void 0)||[]}async listTunnelPorts(e,t){const r=await this.sendTunnelRequest("GET",e,v,l,void 0,t);return r.forEach(f),r}async getTunnelPort(e,t,r){const n=`/ports/${t}`,s=await this.sendTunnelRequest("GET",e,v,n,void 0,r);return f(s),s}async createTunnelPort(e,t,r){t=this.convertTunnelPortForRequest(e,t);const n=await this.sendTunnelRequest("POST",e,y,l,void 0,r,t);return e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t.portNumber)).concat(n).sort(h)),f(n),n}async updateTunnelPort(e,t,r){if(t.clusterId&&e.clusterId&&t.clusterId!==e.clusterId)throw new Error("Tunnel port cluster ID is not consistent.");const n=`/ports/${t.portNumber}`;t=this.convertTunnelPortForRequest(e,t);const s=await this.sendTunnelRequest("PUT",e,y,n,void 0,r,t);return e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t.portNumber)).concat(s).sort(h)),(null==r?void 0:r.tokenScopes)||(s.accessTokens=t.accessTokens),f(s),s}async deleteTunnelPort(e,t,r){const n=`/ports/${t}`,s=await this.sendTunnelRequest("DELETE",e,y,n,void 0,r,void 0,!0);return s&&e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t)).sort(h)),s}async listClusters(){return await this.sendRequest("GET",void 0,"/api/v1/clusters",void 0,void 0,void 0,!1)}async sendTunnelRequest(e,t,r,n,s,i,o,a){const c=this.buildUriForTunnel(t,n,s,i),l=await this.getAxiosRequestConfig(t,i,r);return await this.request(e,c,o,l,a)}async sendRequest(e,t,r,n,s,i,o){const a=this.buildUri(t,r,n,s),c=await this.getAxiosRequestConfig(void 0,s);return await this.request(e,a,i,c,o)}async checkNameAvailablility(e){e=encodeURI(e);const t=this.buildUri(void 0,`/api/v1/tunnels/${e}/checkAvailability`),r={httpsAgent:this.httpsAgent,adapter:this.adapter};return await this.request("GET",t,void 0,r)}getResponseErrorMessage(e){var t,r,n,s;let i="";if(null===(t=e.response)||void 0===t?void 0:t.data){const t=e.response.data;(t.title||t.detail)&&(i=`Tunnel service error: ${t.title}`,t.detail&&(i+=" "+t.detail),t.errors&&(i+=JSON.stringify(t.errors)))}i||(i=(null==e?void 0:e.response)?`Tunnel service returned status code: ${e.response.status} ${e.response.statusText}`:null!==(n=null!==(r=null==e?void 0:e.message)&&void 0!==r?r:e)&&void 0!==n?n:"Unknown tunnel service request error.");const o="VsSaaS-Request-Id";return(null===(s=e.response)||void 0===s?void 0:s.headers)&&e.response.headers[o]&&(i+=`\nRequest ID: ${e.response.headers[o]}`),i}buildUri(e,t,r,n){let s=this.baseAddress;if(e){const t=new URL(s),r=parseInt(t.port,10);if("localhost"===t.hostname||t.hostname.startsWith(`${e}.`)){if("https:"===t.protocol&&e.startsWith("localhost")&&r%10>0){const n=parseInt(e.substring("localhost".length),10);n>0&&n<10&&(t.port=(r-r%10+n).toString(),s=t.toString())}}else t.hostname=`${e}.${t.hostname}`.replace("global.",""),s=t.toString()}s=`${s.replace(/\/$/,"")}${t}`;const i=this.tunnelRequestOptionsToQueryString(n,r);return i&&(s+=`?${i}`),s}buildUriForTunnel(e,t,r,n){let s="";if(e.clusterId&&e.tunnelId)s=`/api/v1/tunnels/${e.tunnelId}`;else{if(!e.name)throw new Error("Tunnel object must include either a name or tunnel ID and cluster ID.");s=`/api/v1/tunnels/${e.name}`}if(null==n?void 0:n.additionalQueryParameters)for(const[e,t]of Object.entries(n.additionalQueryParameters))r?r+=`&${e}=${t}`:r=`${e}=${t}`;return this.buildUri(e.clusterId,s+(t||""),r,n)}async getAxiosRequestConfig(e,t,r){const n={};if(t&&t.accessToken&&(i.TunnelAccessTokenProperties.validateTokenExpiration(t.accessToken),n.Authorization=`${s.TunnelAuthenticationSchemes.tunnel} ${t.accessToken}`),!(u in n)&&this.userTokenCallback){const e=await this.userTokenCallback();e&&(n.Authorization=e)}if(!(u in n)){const t=i.TunnelAccessTokenProperties.getTunnelAccessToken(e,r);t&&(n.Authorization=`${s.TunnelAuthenticationSchemes.tunnel} ${t}`)}const a=e=>{if(e)for(const[t,r]of Object.entries(e))n[t]=r};a(this.additionalRequestHeaders),a(null==t?void 0:t.additionalHeaders);const c=n["User-Agent"]?n["User-Agent"]+" ":"";n["User-Agent"]=`${c}${this.userAgents} ${o.tunnelSdkUserAgent}`;const l=Object.assign(Object.assign({headers:n},this.httpsAgent&&{httpsAgent:this.httpsAgent}),this.adapter&&{adapter:this.adapter});return!1===(null==t?void 0:t.followRedirects)&&(l.maxRedirects=0),l}convertTunnelForRequest(e){var t;return{name:e.name,domain:e.domain,description:e.description,tags:e.tags,options:e.options,accessControl:e.accessControl?{entries:e.accessControl.entries.filter((e=>!e.isInherited))}:void 0,endpoints:e.endpoints,ports:null===(t=e.ports)||void 0===t?void 0:t.map((t=>this.convertTunnelPortForRequest(e,t)))}}convertTunnelPortForRequest(e,t){if(t.clusterId&&e.clusterId&&t.clusterId!==e.clusterId)throw new Error("Tunnel port cluster ID does not match tunnel.");if(t.tunnelId&&e.tunnelId&&t.tunnelId!==e.tunnelId)throw new Error("Tunnel port tunnel ID does not match tunnel.");return{portNumber:t.portNumber,protocol:t.protocol,isDefault:t.isDefault,description:t.description,tags:t.tags,sshUser:t.sshUser,options:t.options,accessControl:t.accessControl?{entries:t.accessControl.entries.filter((e=>!e.isInherited))}:void 0}}tunnelRequestOptionsToQueryString(e,t){const r={},s=[];return e&&(e.includePorts&&(r.includePorts=["true"]),e.includeAccessControl&&(r.includeAccessControl=["true"]),e.tokenScopes&&(n.TunnelAccessControl.validateScopes(e.tokenScopes,void 0,!0),r.tokenScopes=e.tokenScopes),e.forceRename&&(r.forceRename=["true"]),e.tags&&(r.tags=e.tags,e.requireAllTags&&(r.allTags=["true"])),e.limit&&(r.limit=[e.limit.toString()]),s.push(...Object.keys(r).map((e=>`${e}=${r[e].map(encodeURIComponent).join(",")}`)))),t&&s.push(t),s.join("&")}async request(e,t,r,n,s){this.trace(`${e} ${t}`),this.traceHeaders(n.headers),this.traceContent(r);const i=e=>{this.trace(`${e.status} ${e.statusText}`),this.traceHeaders(e.headers),this.traceContent(e.data)};try{n.url=t,n.method=e,n.data=r;const s=await a.default.request(n);return i(s),"DELETE"===e||s.data}catch(t){if(!(t instanceof Error&&t.isAxiosError))throw t;const r=t;if(r.response&&(i(r.response),s&&404===r.response.status))return"DELETE"!==e&&null;throw r.message=this.getResponseErrorMessage(r),delete r.request,r.response&&(delete r.config.httpAgent,delete r.config.httpsAgent,delete r.response.request),r}}traceHeaders(e){for(const[t,r]of Object.entries(e)){if("Authorization"===t)return void this.traceAuthorizationHeader(t,r);this.trace(`${t}: ${null!=r?r:""}`)}}traceAuthorizationHeader(e,t){if("string"!=typeof t)return;const r=t.indexOf(" ");if(r<0)return void this.trace(`${e}: [${t.length}]`);const n=t.substring(0,r),o=t.substring(r+1);if(n.toLowerCase()===s.TunnelAuthenticationSchemes.tunnel.toLowerCase()){const t=i.TunnelAccessTokenProperties.tryParse(o);if(t)return void this.trace(`${e}: ${n} <${t}>`)}this.trace(`${e}: ${n} <token>`)}traceContent(e){"object"==typeof e&&(e=JSON.stringify(e,void 0,"  ")),"string"==typeof e&&this.trace(w.replaceTokensInContent(e))}static replaceTokensInContent(e){var t;const r=/"(eyJ[a-zA-z0-9\-_]+\.[a-zA-z0-9\-_]+\.[a-zA-z0-9\-_]+)"/;let n=r.exec(e);for(;n;){let s=n[1];const o=i.TunnelAccessTokenProperties.tryParse(s);s=null!==(t=null==o?void 0:o.toString())&&void 0!==t?t:"token",e=e.substring(0,n.index+1)+"<"+s+">"+e.substring(n.index+n[0].length-1),n=r.exec(e)}return e}}t.TunnelManagementHttpClient=w},9146:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8534:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tunnelSdkUserAgent=void 0;const n=r(8492).version;t.tunnelSdkUserAgent=`Dev-Tunnels-Service-TypeScript-SDK/${n}`},3817:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPort=void 0,t.ForwardedPort=class{constructor(e,t,r){if(null===e&&null===t)throw new TypeError("Local and remote ports cannot both be null.");if(!r&&null===t)throw new TypeError("The report port number must not be null for locally forwarded ports.");if(null!==e&&("number"!=typeof e||e<=0))throw new TypeError("Local port must be a positive integer.");if(null!==t&&("number"!=typeof t||t<=0))throw new TypeError("Remote port must be a positive integer: "+t);this.localPort=e,this.remotePort=t;const n=r?"->":"<-";null===this.localPort?this.str=`${n}${this.remotePort}`:null==this.remotePort?this.str=`${this.localPort}${n}`:this.str=`${this.localPort}${n}${this.remotePort}`}toString(){return this.str}}},1074:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPortConnectingEventArgs=t.ForwardedPortChannelEventArgs=t.ForwardedPortEventArgs=void 0;class r{constructor(e){this.port=e}toString(){return this.port.toString()}}t.ForwardedPortEventArgs=r,t.ForwardedPortChannelEventArgs=class extends r{constructor(e,t){super(e),this.port=e,this.channel=t}toString(){return`${this.port} ${this.channel}`}},t.ForwardedPortConnectingEventArgs=class{constructor(e,t,r,n){this.port=e,this.isIncoming=t,this.stream=r,this.cancellation=n}toString(){return`${this.port} isIncoming=${this.isIncoming}`}}},1678:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPortsCollection=void 0;const n=r(5844),s=r(1074);class i{constructor(){this.portChannelMap=new Map,this.portAddedEmitter=new n.Emitter,this.onPortAdded=this.portAddedEmitter.event,this.portRemovedEmitter=new n.Emitter,this.onPortRemoved=this.portRemovedEmitter.event,this.portChannelAddedEmitter=new n.Emitter,this.onPortChannelAdded=this.portChannelAddedEmitter.event,this.portChannelRemovedEmitter=new n.Emitter,this.onPortChannelRemoved=this.portChannelRemovedEmitter.event}get size(){return this.portChannelMap.size}has(e){return this.portChannelMap.has(e.toString())}*values(){for(const[e,t]of this.portChannelMap.values())yield e}[Symbol.iterator](){return this.values()}*entries(){for(const[e,t]of this.portChannelMap.values())yield[e,e]}keys(){return this.values()}forEach(e,t){for(const[r,n]of this.portChannelMap.values())e.apply(t,[r,r,this])}getChannels(e){const t=this.portChannelMap.get(e.toString());if(!t)throw new Error(`Port ${e} is not in the collection.`);return t[1]}find(e){for(const t of this.values())if(e(t))return t}addPort(e){if(this.has(e))throw new Error(`Port ${e} is already in the collection.`);this.portChannelMap.set(e.toString(),[e,[]]),this.portAddedEmitter.fire(new s.ForwardedPortEventArgs(e))}removePort(e){return!!this.has(e)&&(this.portChannelMap.delete(e.toString()),this.portRemovedEmitter.fire(new s.ForwardedPortEventArgs(e)),!0)}addChannel(e,t){const r=this.portChannelMap.get(e.toString());if(!r)throw new Error(`Port ${e} is not in the collection.`);const n=r[1];if(n.find((e=>e.channelId===t.channelId)))throw new Error(`Channel ${t.channelId} is already in the collection for port ${e}`);n.push(t),t.onClosed((()=>this.tryRemoveChannel(e,t))),this.portChannelAddedEmitter.fire(new s.ForwardedPortChannelEventArgs(e,t))}tryRemoveChannel(e,t){const r=this.portChannelMap.get(e.toString());if(r){const n=r[1],i=n.findIndex((e=>e.channelId===t.channelId));i>=0&&(n.splice(i,1),this.portChannelRemovedEmitter.fire(new s.ForwardedPortChannelEventArgs(e,t)))}}toString(){return[...this].join(", ")}}t.ForwardedPortsCollection=i},9361:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPortConnectingEventArgs=t.ForwardedPortChannelEventArgs=t.ForwardedPortEventArgs=t.ForwardedPortsCollection=t.ForwardedPort=t.PortForwardChannelOpenMessage=t.PortForwardSuccessMessage=t.PortForwardRequestMessage=t.RemotePortStreamer=t.RemotePortForwarder=t.LocalPortForwarder=t.PortForwardingService=t.SshServer=t.SshClient=void 0;var n=r(7178);Object.defineProperty(t,"SshClient",{enumerable:!0,get:function(){return n.SshClient}});var s=r(9340);Object.defineProperty(t,"SshServer",{enumerable:!0,get:function(){return s.SshServer}});var i=r(3738);Object.defineProperty(t,"PortForwardingService",{enumerable:!0,get:function(){return i.PortForwardingService}});var o=r(8258);Object.defineProperty(t,"LocalPortForwarder",{enumerable:!0,get:function(){return o.LocalPortForwarder}});var a=r(3427);Object.defineProperty(t,"RemotePortForwarder",{enumerable:!0,get:function(){return a.RemotePortForwarder}});var c=r(8338);Object.defineProperty(t,"RemotePortStreamer",{enumerable:!0,get:function(){return c.RemotePortStreamer}});var l=r(9566);Object.defineProperty(t,"PortForwardRequestMessage",{enumerable:!0,get:function(){return l.PortForwardRequestMessage}});var u=r(8842);Object.defineProperty(t,"PortForwardSuccessMessage",{enumerable:!0,get:function(){return u.PortForwardSuccessMessage}});var h=r(2516);Object.defineProperty(t,"PortForwardChannelOpenMessage",{enumerable:!0,get:function(){return h.PortForwardChannelOpenMessage}});var d=r(3817);Object.defineProperty(t,"ForwardedPort",{enumerable:!0,get:function(){return d.ForwardedPort}});var p=r(1678);Object.defineProperty(t,"ForwardedPortsCollection",{enumerable:!0,get:function(){return p.ForwardedPortsCollection}});var f=r(1074);Object.defineProperty(t,"ForwardedPortEventArgs",{enumerable:!0,get:function(){return f.ForwardedPortEventArgs}}),Object.defineProperty(t,"ForwardedPortChannelEventArgs",{enumerable:!0,get:function(){return f.ForwardedPortChannelEventArgs}}),Object.defineProperty(t,"ForwardedPortConnectingEventArgs",{enumerable:!0,get:function(){return f.ForwardedPortConnectingEventArgs}})},5021:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IPAddressConversions=void 0,t.IPAddressConversions=class{static fromSshAddress(e){return e?"localhost"===e?"127.0.0.1":e:"0.0.0.0"}static toSshAddress(e){return e?"0.0.0.0"===e?"":"127.0.0.1"===e?"localhost":e:null}}},2516:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortForwardChannelOpenMessage=void 0;const n=r(2727);class s extends n.ChannelOpenMessage{constructor(){super(...arguments),this.host="",this.port=0,this.originatorIPAddress="",this.originatorPort=0}onRead(e){super.onRead(e),this.host=e.readString("ascii"),this.port=e.readUInt32(),this.originatorIPAddress=e.readString("ascii"),this.originatorPort=e.readUInt32()}onWrite(e){super.onWrite(e),e.writeString(this.validateField(this.host,"host"),"ascii"),e.writeUInt32(this.validateField(this.port,"port")),e.writeString(this.originatorIPAddress||"","ascii"),e.writeUInt32(this.originatorPort||0)}toString(){return`${super.toString()} (host=${this.host} port=${this.port})`}}t.PortForwardChannelOpenMessage=s},9566:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortForwardRequestMessage=void 0;const n=r(2727),s=r(3738);class i extends n.SessionRequestMessage{constructor(){super(),this.addressToBind="",this.port=0,this.requestType=s.PortForwardingService.portForwardRequestType,this.wantReply=!0}onRead(e){super.onRead(e),this.addressToBind=e.readString("ascii"),this.port=e.readUInt32()}onWrite(e){super.onWrite(e),e.writeString(this.validateField(this.addressToBind,"address"),"ascii"),e.writeUInt32(this.validateField(this.port,"port"))}toString(){return`${super.toString()} (addressToBind=${this.addressToBind} port=${this.port})`}}t.PortForwardRequestMessage=i},8842:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortForwardSuccessMessage=void 0;const n=r(2727);class s extends n.SessionRequestSuccessMessage{constructor(){super(...arguments),this.port=0}onRead(e){super.onRead(e),e.available>=4&&(this.port=e.readUInt32())}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.port,"port"))}toString(){return`${super.toString()} (port=${this.port})`}}t.PortForwardSuccessMessage=s},5270:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultPortForwardMessageFactory=void 0;const n=r(2516),s=r(9566),i=r(8842);t.DefaultPortForwardMessageFactory=class{createRequestMessageAsync(e){return Promise.resolve(new s.PortForwardRequestMessage)}createSuccessMessageAsync(e){return Promise.resolve(new i.PortForwardSuccessMessage)}createChannelOpenMessageAsync(e){return Promise.resolve(new n.PortForwardChannelOpenMessage)}}},8258:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalPortForwarder=void 0;const n=r(2727),s=r(9998);class i extends n.SshService{constructor(e,t,r,n,s,i,o){super(t),this.pfs=e,this.channelType=r,this.localIPAddress=n,this.port=s,this.remoteHost=i,this.remotePort=null!=o?o:0!==s?s:void 0}get localPort(){return this.port}async startForwarding(e){var t;let r=this.localIPAddress;try{this.tcpListener=await this.pfs.tcpListenerFactory.createTcpListener(r,this.port,!0);const e=this.tcpListener.address();if(!(e.port>0))throw this.tcpListener.close(),new Error("Could not get server port.");if(this.port=e.port,"127.0.0.1"===this.localIPAddress||"0.0.0.0"===this.localIPAddress){r="0.0.0.0"===this.localIPAddress?"::":"::1";try{this.tcpListener2=await this.pfs.tcpListenerFactory.createTcpListener(r,this.port,!1)}catch(e){if(!(e instanceof Error)||"EADDRNOTAVAIL"!==e.code)throw e;this.trace(n.TraceLevel.Warning,n.SshTraceEventIds.portForwardServerListenFailed,`PortForwardingService failed to listen on ${r}:{this.port}: ${e.message}`,e)}}}catch(e){if(!(e instanceof Error))throw e;throw this.trace(n.TraceLevel.Error,n.SshTraceEventIds.portForwardServerListenFailed,`PortForwardingService failed to listen on ${r}:${this.port}: ${e.message}`,e),e}this.tcpListener.on("connection",this.acceptConnection.bind(this)),null===(t=this.tcpListener2)||void 0===t||t.on("connection",this.acceptConnection.bind(this)),this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardServerListening,`PortForwardingService listening on ${this.localIPAddress}:${this.port}.`),this.tcpListener2&&this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardServerListening,`PortForwardingService also listening on ${r}:${this.port}.`)}async acceptConnection(e){var t,r,i,o,a;let c;this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardConnectionAccepted,`PortForwardingService accepted connection from: ${e.remoteAddress} on port ${this.port}`);try{c=await this.pfs.openChannel(this.session,this.channelType,null!==(t=e.remoteAddress)&&void 0!==t?t:null,null!==(r=e.remotePort)&&void 0!==r?r:null,null!==(i=this.remoteHost)&&void 0!==i?i:this.localIPAddress,null!==(o=this.remotePort)&&void 0!==o?o:this.localPort)}catch(t){if(!(t instanceof Error))throw t;return void e.destroy()}const l=await this.pfs.forwardedPortConnecting(null!==(a=this.remotePort)&&void 0!==a?a:this.localPort,!1,new n.SshStream(c));if(!l)return;const u=new s.StreamForwarder(e,l,c.session.trace);this.pfs.streamForwarders.push(u)}dispose(){var e,t;null===(e=this.tcpListener)||void 0===e||e.close(),null===(t=this.tcpListener2)||void 0===t||t.close(),this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardServerListening,`PortForwardingService stopped listening on ${this.localIPAddress}:${this.port}.`),super.dispose()}}t.LocalPortForwarder=i},3738:function(e,t,r){"use strict";var n,s=this&&this.__decorate||function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.PortForwardingService=void 0;const i=r(2727),o=r(5844),a=r(3817),c=r(1678),l=r(5021),u=r(2516),h=r(9566),d=r(8842),p=r(7285),f=r(5270),g=r(8258),m=r(3427),y=r(8338),v=r(1074);let w=n=class extends i.SshService{constructor(e){super(e),this.localForwarders=new Map,this.remoteConnectors=new Map,this.streamForwarders=[],this.acceptLocalConnectionsForForwardedPorts=!0,this.forwardConnectionsToLocalPorts=!0,this.acceptRemoteConnectionsForNonForwardedPorts=!0,this.localForwardedPorts=new c.ForwardedPortsCollection,this.remoteForwardedPorts=new c.ForwardedPortsCollection,this.tcpListenerFactory=new p.DefaultTcpListenerFactory,this.messageFactory=new f.DefaultPortForwardMessageFactory,this.forwardedPortConnectingEmitter=new o.Emitter,this.onForwardedPortConnecting=this.forwardedPortConnectingEmitter.event}async forwardedPortConnecting(e,t,r,n){try{const s=new v.ForwardedPortConnectingEventArgs(e,t,r,n);if(this.forwardedPortConnectingEmitter.fire(s),s.transformPromise)return await s.transformPromise}catch(e){if(!(e instanceof Error))throw e;return this.trace(i.TraceLevel.Warning,i.SshTraceEventIds.portForwardConnectionFailed,`Forwarded port connecting event-handler failed: ${e.message}`),null}return r}async forwardFromRemotePort(e,t,r,n,s){const i="string"==typeof r?r:"127.0.0.1";if(void 0===n&&(n=t),!e)throw new TypeError("Remote IP address is required.");if(!Number.isInteger(t)||t<0)throw new TypeError("Remote port must be a non-negative integer.");if(!i)throw new TypeError("Local host is required.");if(!Number.isInteger(n)||n<=0)throw new TypeError("Local port must be a positive integer.");if(this.localForwardedPorts.find((e=>e.localPort===n)))throw new Error(`Local port ${n} is already forwarded.`);if(t>0&&this.localForwardedPorts.find((e=>e.remotePort===t)))throw new Error(`Remote port ${t} is already forwarded.`);const o=new m.RemotePortForwarder(this,this.session,e,t,i,n),c=await this.messageFactory.createRequestMessageAsync(t);if(!await o.request(c,s))return o.dispose(),null;t=o.remotePort,this.remoteConnectors.set(t,o);const l=new a.ForwardedPort(n,t,!1);return this.localForwardedPorts.addPort(l),o.onDisposed((()=>{this.localForwardedPorts.removePort(l),this.remoteConnectors.delete(t)})),o}async forwardToRemotePort(e,t,r,s,i){const o="string"==typeof r?r:"127.0.0.1";if(void 0===s&&(s=t),!e)throw new TypeError("Local IP address is required.");if(!Number.isInteger(t)||t<0)throw new TypeError("Local port must be a non-negative integer.");if(!o)throw new TypeError("Remote host is required.");if(!Number.isInteger(s)||s<=0)throw new TypeError("Remote port must be a positive integer.");if(this.localForwarders.has(s))throw new Error(`Port ${s} is already forwarded.`);const a=new g.LocalPortForwarder(this,this.session,n.reversePortForwardChannelType,e,t,o,s);return await a.startForwarding(i),this.localForwarders.set(s,a),a.onDisposed((()=>{this.localForwarders.delete(s)})),a}async streamFromRemotePort(e,t,r){if(!e)throw new TypeError("Remote IP address is required.");if(!Number.isInteger(t)||t<0)throw new TypeError("Remote port must be a non-negative integer.");const n=new y.RemotePortStreamer(this.session,e,t),s=await this.messageFactory.createRequestMessageAsync(t);if(!await n.request(s,r))return n.dispose(),null;t=n.remotePort,this.remoteConnectors.set(t,n);const i=new a.ForwardedPort(null,t,!1);return this.localForwardedPorts.addPort(i),n.onDisposed((()=>{this.localForwardedPorts.removePort(i),this.remoteConnectors.delete(t)})),n}async streamToRemotePort(e,t,r){if(!e)throw new TypeError("Remote host is required.");if(!Number.isInteger(t)||t<=0)throw new TypeError("Remote port must be a positive integer.");const s=await this.openChannel(this.session,n.reversePortForwardChannelType,null,null,e,t,r);return new i.SshStream(s)}async connectToForwardedPort(e,t){if(!Number.isInteger(e)||e<=0)throw new TypeError("Forwarded port must be a positive integer.");const r=await this.openChannel(this.session,n.portForwardChannelType,null,null,"127.0.0.1",e,t),s=await this.forwardedPortConnecting(e,!1,new i.SshStream(r),t);if(!s)throw r.close().catch((e=>{})),new i.SshChannelError("The connection to the forwarded port was rejected by the connecting event-handler.");return s}async waitForForwardedPort(e,t){if(this.remoteForwardedPorts.find((t=>t.remotePort===e)))return;const r=new i.PromiseCompletionSource;let n,s,o;t&&(n=t.onCancellationRequested((()=>r.reject(new i.CancellationError))));try{s=this.remoteForwardedPorts.onPortAdded((t=>{t.port.remotePort===e&&r.resolve()})),o=this.session.onClosed((()=>{r.reject(new i.ObjectDisposedError("The session was closed."))})),await r.promise}finally{null==s||s.dispose(),null==o||o.dispose(),null==n||n.dispose()}}async onSessionRequest(e,t){if(!e)throw new TypeError("Request is required.");if(e.requestType!==n.portForwardRequestType&&e.requestType!==n.cancelPortForwardRequestType)throw new Error(`Unexpected request type: ${e.requestType}`);const r=e.request.convertTo(new h.PortForwardRequestMessage),s=l.IPAddressConversions.fromSshAddress(r.addressToBind);if(e.requestType===n.portForwardRequestType&&0!==r.port&&this.localForwarders.has(r.port)){const t=`PortForwardingService blocking attempt to re-forward already-forwarded port ${r.port}.`;return this.session.trace(i.TraceLevel.Warning,i.SshTraceEventIds.portForwardRequestInvalid,t),void(e.isAuthorized=!1)}const o=new i.SshRequestEventArgs(e.requestType,r,this.session.principal);let c;await super.onSessionRequest(o,t);let u=null;if(o.isAuthorized)if(e.requestType===n.portForwardRequestType){try{u=await this.startForwarding(s,r.port,t)}catch(e){}if(null!==u){const e=0===r.port?u:r.port,t=await this.messageFactory.createSuccessMessageAsync(e);t.port=e,c=t}}else e.requestType===n.cancelPortForwardRequestType&&await this.cancelForwarding(r.port,t)&&(c=new i.SessionRequestSuccessMessage);if(e.responsePromise=Promise.resolve(null!=c?c:new i.SessionRequestFailureMessage),c instanceof d.PortForwardSuccessMessage){const e=new a.ForwardedPort(null!=u?u:c.port,c.port,!0);this.remoteForwardedPorts.addPort(e)}}async startForwarding(e,t,r){if("number"!=typeof t)throw new TypeError("Remote port must be an integer.");if(this.acceptLocalConnectionsForForwardedPorts){let s=t;const i=new g.LocalPortForwarder(this,this.session,n.portForwardChannelType,e,s,void 0,0===t?void 0:t);return await i.startForwarding(r),s=i.localPort,0===t&&(t=s),this.localForwarders.has(t)?(i.dispose(),null):(this.localForwarders.set(t,i),s=i.localPort,i.onDisposed((()=>{const e=new a.ForwardedPort(s,t,!0);this.remoteForwardedPorts.removePort(e),this.localForwarders.delete(t)})),s)}return 0!==t?t:null}async cancelForwarding(e,t){const r=this.localForwarders.get(e);if(r)return this.localForwarders.delete(e),r.dispose(),!0;const n=new a.ForwardedPort(e,e,!0);return!!this.remoteForwardedPorts.removePort(n)}async onChannelOpening(e,t){var r;if(!e)throw new TypeError("Request is required.");const s=e.request.channelType;if(s!==n.portForwardChannelType&&s!==n.reversePortForwardChannelType)return void(e.failureReason=i.SshChannelOpenFailureReason.unknownChannelType);let o=null;const c=e.request instanceof u.PortForwardChannelOpenMessage?e.request:e.request.convertTo(new u.PortForwardChannelOpenMessage);if(e.isRemoteRequest)if(s===n.portForwardChannelType){const t=`${l.IPAddressConversions.fromSshAddress(c.host)}:${c.port}`;if(o=null!==(r=this.remoteConnectors.get(c.port))&&void 0!==r?r:null,!o)return this.trace(i.TraceLevel.Error,i.SshTraceEventIds.portForwardRequestInvalid,`PortForwardingService received forwarding channel for ${t} that was not requested.`),e.failureReason=i.SshChannelOpenFailureReason.connectFailed,void(e.failureDescription="Forwarding channel was not requested.")}else if(!this.acceptRemoteConnectionsForNonForwardedPorts){const t="The session has disabled connections to non-forwarded ports.";return this.session.trace(i.TraceLevel.Warning,i.SshTraceEventIds.portForwardChannelOpenFailed,t),e.failureReason=i.SshChannelOpenFailureReason.administrativelyProhibited,void(e.failureDescription=t)}const h=new i.SshChannelOpeningEventArgs(c,e.channel,e.isRemoteRequest);if(await super.onChannelOpening(h,t),e.failureReason=h.failureReason,e.failureDescription=h.failureDescription,e.openingPromise=h.openingPromise,e.failureReason===i.SshChannelOpenFailureReason.none&&e.isRemoteRequest&&this.forwardConnectionsToLocalPorts)if(o){await o.onPortChannelOpening(e,t);const r=o instanceof m.RemotePortForwarder?o.localPort:null,n=o instanceof m.RemotePortForwarder?o.remotePort:c.port,s=new a.ForwardedPort(r,n,!1);this.localForwardedPorts.addChannel(s,e.channel)}else await m.RemotePortForwarder.forwardChannel(this,e,c.host,c.port,c.port,this.trace,t)}async openChannel(e,t,r,s,o,a,c){let l;if(t===n.portForwardChannelType&&(l=this.remoteForwardedPorts.find((e=>e.remotePort===a||null===e.remotePort&&e.localPort===a)),!l))throw new Error(`Port ${a} is not being forwarded.`);const u=await this.messageFactory.createChannelOpenMessageAsync(a);u.channelType=t,u.originatorIPAddress=null!=r?r:"",u.originatorPort=null!=s?s:0,u.host=o,u.port=a;const h=this.session.trace;let d;try{d=await e.openChannel(u,null,c),h(i.TraceLevel.Info,i.SshTraceEventIds.portForwardChannelOpened,`PortForwardingService opened ${t} channel #${d.channelId} for ${o}:${a}.`)}catch(e){if(!(e instanceof Error))throw e;throw h(i.TraceLevel.Error,i.SshTraceEventIds.portForwardChannelOpenFailed,`PortForwardingService failed to open ${t} channel for ${o}:${a}: ${e.message}`,e),e}return t===n.portForwardChannelType&&this.remoteForwardedPorts.addChannel(l,d),d}dispose(){const e=[...this.streamForwarders,...this.localForwarders.values(),...this.remoteConnectors.values()];this.streamForwarders.splice(0,this.streamForwarders.length),this.localForwarders.clear(),this.remoteConnectors.clear();for(const t of e)t.dispose();super.dispose()}};w.portForwardRequestType="tcpip-forward",w.cancelPortForwardRequestType="cancel-tcpip-forward",w.portForwardChannelType="forwarded-tcpip",w.reversePortForwardChannelType="direct-tcpip",w=n=s([(0,i.serviceActivation)({sessionRequest:n.portForwardRequestType}),(0,i.serviceActivation)({sessionRequest:n.cancelPortForwardRequestType}),(0,i.serviceActivation)({channelType:n.portForwardChannelType}),(0,i.serviceActivation)({channelType:n.reversePortForwardChannelType})],w),t.PortForwardingService=w},1852:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemotePortConnector=void 0;const n=r(2727),s=r(9566),i=r(8842),o=r(3738);class a extends n.SshService{constructor(e,t,r){super(e),this.forwarding=!1,this.remoteIPAddress=t,this.port=r}get remotePort(){return this.port}async request(e,t){if(this.forwarding)throw new Error("Already forwarding.");e.addressToBind=this.remoteIPAddress,e.port=this.remotePort,e.wantReply=!0;const r=await this.session.requestResponse(e,i.PortForwardSuccessMessage,n.SessionRequestFailureMessage,t);let s=!1;return r instanceof i.PortForwardSuccessMessage&&(0!==r.port&&(this.port=r.port),s=!0),this.forwarding=s,s}dispose(){if(this.forwarding){this.forwarding=!1;const e=new s.PortForwardRequestMessage;e.requestType=o.PortForwardingService.cancelPortForwardRequestType,e.addressToBind=this.remoteIPAddress,e.port=this.remotePort,e.wantReply=!1;try{this.session.request(e).catch((e=>{}))}catch(e){}}super.dispose()}}t.RemotePortConnector=a},3427:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemotePortForwarder=void 0;const n=r(1808),s=r(2727),i=r(9998),o=r(1852);class a extends o.RemotePortConnector{constructor(e,t,r,n,s,i){super(t,r,n),this.pfs=e,this.localHost=s,this.localPort=i}async onPortChannelOpening(e,t){await a.forwardChannel(this.pfs,e,this.localHost,this.localPort,this.remotePort,this.trace,t)}static async forwardChannel(e,t,r,o,a,c,l){const u=t.channel,h=await e.forwardedPortConnecting(null!=a?a:o,!0,new s.SshStream(u),l);if(!h)return void(t.failureReason=s.SshChannelOpenFailureReason.connectFailed);const d=n.createConnection({host:r,port:o}),p=new s.PromiseCompletionSource,f=l?l.onCancellationRequested((()=>d.destroy(new Error("Cancelled.")))):null;try{d.once("connect",(()=>{p.resolve()})),d.once("error",(e=>{p.reject(e)})),await p.promise}catch(e){if(!(e instanceof Error)||(null==l?void 0:l.isCancellationRequested))throw e;c(s.TraceLevel.Error,s.SshTraceEventIds.portForwardConnectionFailed,`${u.session} PortForwardingService forwarded channel #${u.channelId} connection to ${r}:${o} failed: ${e.message}`,e),t.failureReason=s.SshChannelOpenFailureReason.connectFailed,t.failureDescription=e.message}finally{null==f||f.dispose()}const g=new i.StreamForwarder(d,h,u.session.trace);c(s.TraceLevel.Info,s.SshTraceEventIds.portForwardConnectionOpened,`${u.session} PortForwardingService forwarded channel #${u.channelId} connection to ${r}:${o}.`),e.streamForwarders.push(g)}}t.RemotePortForwarder=a},8338:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemotePortStreamer=void 0;const n=r(5844),s=r(2727),i=r(1852);class o extends i.RemotePortConnector{constructor(e,t,r){super(e,t,r),this.streamOpenedEmitter=new n.Emitter,this.onStreamOpened=this.streamOpenedEmitter.event}async onPortChannelOpening(e,t){const r=new s.SshStream(e.channel);this.streamOpenedEmitter.fire(r)}}t.RemotePortStreamer=o},9998:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamForwarder=void 0;const n=r(2727),s=r(1808);t.StreamForwarder=class{constructor(e,t,r){if(this.localStream=e,this.remoteStream=t,this.trace=r,this.disposed=!1,!e)throw new TypeError("Local stream is required.");if(!t)throw new TypeError("Remote stream is required.");e.pipe(t),t.pipe(e)}close(e,t){try{e&&this.localStream instanceof s.Socket?this.localStream.destroy():this.localStream.end(),this.remoteStream instanceof n.SshStream?this.remoteStream.channel.close("SIGABRT",t).catch((e=>{})):this.remoteStream.end(),this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardChannelClosed,`Stream forwarder ${e?"aborted":"closed"} connection.`)}catch(e){if(!(e instanceof Error))throw e;this.trace(n.TraceLevel.Warning,n.SshTraceEventIds.unknownError,`Stream forwarder unexpected error closing connection:  ${e.message}`)}}dispose(){this.disposed||(this.disposed=!0,this.close(!0))}}},7178:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshClient=void 0;const n=r(1808),s=r(2727);class i{constructor(e){if(this.config=e,this.sessions=[],this.trace=(e,t,r,n)=>{},!e)throw new TypeError("SshSessionConfiguration is required.")}async openSession(e,t,r){if(!e)throw new TypeError("Server host is reqiured.");const n=await this.openConnection(e,t,r),i=new s.SshClientSession(this.config);return i.trace=this.trace,await i.connect(n,r),this.sessions.push(i),i}async openConnection(e,t,r){const o=new n.Socket;return await new Promise(((n,a)=>{if(o.on("connect",n),o.on("error",a),r){if(r.isCancellationRequested)return void a(new s.CancellationError);r.onCancellationRequested(a)}o.connect(t||i.defaultServerPort,e)})),new s.NodeStream(o)}async reconnectSession(e,t,r,n){const s=await this.openConnection(t,r,n);await e.reconnect(s,n)}dispose(){for(;this.sessions.length>0;)this.sessions.shift().dispose()}}t.SshClient=i,i.defaultServerPort=22},9340:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshServer=void 0;const n=r(5844),s=r(2727),i=r(7285);t.SshServer=class{constructor(e){if(this.config=e,this.sessions=[],this.trace=(e,t,r,n)=>{},this.errorEmitter=new n.Emitter,this.onError=this.errorEmitter.event,this.sessionOpenedEmitter=new n.Emitter,this.onSessionOpened=this.sessionOpenedEmitter.event,this.credentials={publicKeys:[]},this.tcpListenerFactory=new i.DefaultTcpListenerFactory,!e)throw new TypeError("SshSessionConfiguration is required.");e.protocolExtensions.includes(s.SshProtocolExtensionNames.sessionReconnect)&&(this.reconnectableSessions=[])}async acceptSessions(e,t){t||(t="0.0.0.0");const r="0.0.0.0"===t?"port ":t+":";try{this.tcpListener=await this.tcpListenerFactory.createTcpListener(t,e,!1)}catch(t){if(!(t instanceof Error))throw t;throw this.trace(s.TraceLevel.Error,s.SshTraceEventIds.serverListenFailed,`SshServer failed to listen on ${r}${e}: ${t.message}`,t),t}this.tcpListener.addListener("connection",this.acceptSession.bind(this)),this.trace(s.TraceLevel.Info,s.SshTraceEventIds.serverListening,`SshServer listening on ${r}${e}.`)}async acceptConnection(e){return e.setNoDelay(!0),new s.NodeStream(e)}async acceptSession(e){this.trace(s.TraceLevel.Info,s.SshTraceEventIds.serverClientConnected,"SshServer client connected.");const t=await this.acceptConnection(e),r=new s.SshServerSession(this.config,this.reconnectableSessions);r.trace=this.trace,r.credentials=this.credentials,this.sessions.push(r),r.onClosed((e=>{const t=this.sessions.indexOf(r);t>=0&&this.sessions.splice(t,1)})),this.sessionOpenedEmitter.fire(r);try{await r.connect(t)}catch(e){if(!(e instanceof Error))throw e;e instanceof s.SshConnectionError?await r.close(e.reason||s.SshDisconnectReason.connectionLost,e.message,e):await r.close(s.SshDisconnectReason.protocolError,e.message,e),this.errorEmitter.fire(e)}}dispose(){var e;null===(e=this.tcpListener)||void 0===e||e.close()}}},7285:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTcpListenerFactory=void 0;const n=r(1808);t.DefaultTcpListenerFactory=class{async createTcpListener(e,t,r,s){if(!e)throw new TypeError("Local IP address is required.");if(!Number.isInteger(t)||t<0)throw new TypeError("Local port must be a non-negative integer.");const i=n.createServer();return await new Promise(((r,s)=>{i.listen({host:e,port:t,ipv6Only:n.isIPv6(e),exclusive:!1}),i.on("listening",r),i.on("error",s)})),i}}},3926:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.curves=void 0,t.curves=[{shortName:"P-256",name:"nistp256",oid:"1.2.840.10045.3.1.7",keySize:256},{shortName:"P-384",name:"nistp384",oid:"1.3.132.0.34",keySize:384},{shortName:"P-521",name:"nistp521",oid:"1.3.132.0.35",keySize:521}]},3687:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptionAlgorithm=void 0,t.EncryptionAlgorithm=class{constructor(e){this.name=e}}},4953:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HmacAlgorithm=void 0,t.HmacAlgorithm=class{constructor(e,t,r,n){this.name=e,this.algorithmName=t,this.keyLength=r,this.digestLength=n}}},1263:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyExchangeAlgorithm=void 0,t.KeyExchangeAlgorithm=class{constructor(e,t,r,n){this.name=e,this.keySizeInBits=t,this.hashAlgorithmName=r,this.hashDigestLength=n}}},2185:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sec1KeyFormatter=t.Pkcs1KeyFormatter=t.parsePem=t.formatPem=void 0;const n=r(3380),s=r(4918),i=r(3926);t.formatPem=function(e,t){return`-----BEGIN ${t}-----\n`+e.toString("base64").match(/.{1,64}/g).join("\n")+"\n"+`-----END ${t}-----\n`},t.parsePem=function(e){const t=e.replace(/-+[^-\n]+KEY-+/g,"").replace(/\s/g,"");return Buffer.from(t,"base64")},t.Pkcs1KeyFormatter=class{static formatRsaPublic(e){const t=new s.DerWriter(Buffer.alloc(1024));return t.writeInteger(e.modulus),t.writeInteger(e.exponent),t.toBuffer()}static formatRsaPrivate(e){if(!(e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi))throw new Error("Missing private key parameters.");const t=new s.DerWriter(Buffer.alloc(2048));return t.writeInteger(n.BigInt.fromInt32(0)),t.writeInteger(e.modulus),t.writeInteger(e.exponent),t.writeInteger(e.d),t.writeInteger(e.p),t.writeInteger(e.q),t.writeInteger(e.dp),t.writeInteger(e.dq),t.writeInteger(e.qi),t.toBuffer()}static parseRsaPublic(e){const t=new s.DerReader(e);return{modulus:t.readInteger(),exponent:t.readInteger()}}static parseRsaPrivate(e){const t=new s.DerReader(e);return t.readInteger(),{modulus:t.readInteger(),exponent:t.readInteger(),d:t.readInteger(),p:t.readInteger(),q:t.readInteger(),dp:t.readInteger(),dq:t.readInteger(),qi:t.readInteger()}}};class o{static formatECPublic(e){const t=i.curves.find((t=>t.oid===e.curve.oid)),r=Math.ceil(t.keySize/8),n=new s.DerWriter(Buffer.alloc(512)),a=new s.DerWriter(Buffer.alloc(100));a.writeObjectIdentifier(o.ecPublicKeyOid),a.writeObjectIdentifier(e.curve.oid),n.writeSequence(a);const c=e.x.toBytes({unsigned:!0,length:r}),l=e.y.toBytes({unsigned:!0,length:r}),u=Buffer.alloc(1+c.length+l.length);return u[0]=4,c.copy(u,1),l.copy(u,1+c.length),n.writeBitString(u),n.toBuffer()}static formatECPrivate(e){const t=i.curves.find((t=>t.oid===e.curve.oid)),r=Math.ceil(t.keySize/8),o=new s.DerWriter(Buffer.alloc(512));o.writeInteger(n.BigInt.fromInt32(1)),o.writeOctetString(e.d.toBytes({unsigned:!0,length:r}));const a=new s.DerWriter(Buffer.alloc(100));a.writeObjectIdentifier(e.curve.oid),o.writeTagged(0,a);const c=e.x.toBytes({unsigned:!0,length:r}),l=e.y.toBytes({unsigned:!0,length:r}),u=Buffer.alloc(1+c.length+l.length);u[0]=4,c.copy(u,1),l.copy(u,1+c.length);const h=new s.DerWriter(Buffer.alloc(512));return h.writeBitString(u),o.writeTagged(1,h),o.toBuffer()}static parseECPublic(e){var t;const r=new s.DerReader(e),a=r.readSequence(),c=a.readObjectIdentifier();if(c!==o.ecPublicKeyOid)throw new Error(`Unexpected key type OID: ${c}`);const l=a.readObjectIdentifier(),u=null===(t=i.curves.find((e=>e.oid===l)))||void 0===t?void 0:t.name,h=r.readBitString();if(h.length%2!=1)throw new Error(`Unexpected key data length: ${h.length}`);const d=n.BigInt.fromBytes(h.slice(1,1+(h.length-1)/2),{unsigned:!0}),p=n.BigInt.fromBytes(h.slice(1+(h.length-1)/2),{unsigned:!0});return{curve:{name:u,oid:l},x:d,y:p}}static parseECPrivate(e){var t;const r=new s.DerReader(e),o=r.readInteger().toInt32();if(1!==o)throw new Error(`Unsupported SEC1 format version: ${o}`);const a=n.BigInt.fromBytes(r.readOctetString(),{unsigned:!0}),c=r.tryReadTagged(0);if(!c)throw new Error("SEC1 curve info not found.");const l=c.readObjectIdentifier(),u=null===(t=i.curves.find((e=>e.oid===l)))||void 0===t?void 0:t.name,h=r.tryReadTagged(1);if(!h)throw new Error("SEC1 public key data not found.");const d=h.readBitString();if(d.length%2!=1)throw new Error(`Unexpected key data length: ${d.length}`);const p=n.BigInt.fromBytes(d.slice(1,1+(d.length-1)/2),{unsigned:!0}),f=n.BigInt.fromBytes(d.slice(1+(d.length-1)/2),{unsigned:!0});return{curve:{name:u,oid:l},x:p,y:f,d:a}}}t.Sec1KeyFormatter=o,o.ecPublicKeyOid="1.2.840.10045.2.1"},1579:(e,t,r)=>{"use strict";t.b=void 0;const n=r(6113),s=r(4300),i=r(7103),o=r(3926),a=r(3380),c=r(4918),l=r(7309),u=r(2185),h=process.versions.node.split(".").map((e=>parseInt(e,10))),d=h[0]>10||10===h[0]&&h[1]>=12,p=h[0]>11||11===h[0]&&h[1]>=6;class f{constructor(e){this.comment=null,e&&(this.algorithmName=e)}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return this.algorithmName}get algorithmName(){return this.algorithm}set algorithmName(e){const t=e.split("-")[2];if(this.curve=o.curves.find((e=>e.name===t)),!this.curve)throw new Error("Invalid or unsupported ECDSA algorithm: "+e);this.algorithm=e}generate(){return d&&p?this.generateNodeKeyPairObjects():d?this.generateNodeKeyPairBuffers():this.generateExternalKeyPair()}async generateNodeKeyPairObjects(){[this.publicKey,this.privateKey]=await new Promise(((e,t)=>{const r={namedCurve:this.curve.shortName};try{n.generateKeyPair("ec",r,((r,n,s)=>{r?t(r):e([n,s])}))}catch(e){t(e)}}))}async generateNodeKeyPairBuffers(){[this.publicKey,this.privateKey]=await new Promise(((e,t)=>{const r={namedCurve:this.curve.shortName,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"sec1",format:"pem",cipher:void 0,passphrase:void 0}};try{n.generateKeyPair("ec",r,((r,n,s)=>{r?t(r):e([n,s])}))}catch(e){t(e)}}))}async generateExternalKeyPair(){throw new Error("This version of node does not support generating key pairs. Use node >= 10.12.")}async setPublicKeyBytes(e,t){if(!e)throw new TypeError("Buffer is required.");const r=new l.SshDataReader(e),s=r.readString("ascii");this.algorithmName=t||s;const i=r.readString("ascii");this.algorithmName=`ecdsa-sha2-${i}`;const o=r.readBinary(),c=a.BigInt.fromBytes(o.slice(1,1+(o.length-1)/2),{unsigned:!0}),h=a.BigInt.fromBytes(o.slice(1+(o.length-1)/2),{unsigned:!0}),d=u.Sec1KeyFormatter.formatECPublic({curve:{name:this.curve.name,oid:this.curve.oid},x:c,y:h});this.publicKey=p?n.createPublicKey({key:d,type:"spki",format:"der"}):(0,u.formatPem)(d,"PUBLIC KEY")}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;t="string"==typeof this.publicKey?(0,u.parsePem)(this.publicKey):this.publicKey.export({type:"spki",format:"der"});const r=u.Sec1KeyFormatter.parseECPublic(t);e=e||this.algorithmName||this.keyAlgorithmName;const n=new l.SshDataWriter(s.Buffer.alloc(512));n.writeString(e,"ascii"),n.writeString(this.curve.name,"ascii");const i=Math.ceil(this.curve.keySize/8),o=r.x.toBytes({unsigned:!0,length:i}),a=r.y.toBytes({unsigned:!0,length:i});return n.writeUInt32(1+o.length+a.length),n.writeByte(4),n.write(o),n.write(a),n.toBuffer()}async importParameters(e){if(!e.curve)throw new TypeError("A curve is required.");let t;if(e.curve.oid){if(t=o.curves.find((t=>t.oid===e.curve.oid)),!t)throw new Error(`Unsupported curve OID: ${e.curve.oid}`)}else{if(!e.curve.name)throw new TypeError("A curve OID or name is required.");if(t=o.curves.find((t=>t.name===e.curve.name)),!t)throw new Error(`Unsupported curve: ${e.curve.name}`)}this.algorithmName="ecdsa-sha2-"+t.name;const r=u.Sec1KeyFormatter.formatECPublic(e);if(this.publicKey=p?n.createPublicKey({key:r,type:"spki",format:"der"}):(0,u.formatPem)(r,"EC PUBLIC KEY"),e.d){const t=u.Sec1KeyFormatter.formatECPrivate(e);this.privateKey=p?n.createPrivateKey({key:t,type:"sec1",format:"der"}):(0,u.formatPem)(t,"EC PRIVATE KEY")}else this.privateKey=void 0}async exportParameters(){var e,t;if(!this.publicKey)throw new Error("Key is not present.");let r;return r="string"==typeof this.publicKey?(0,u.parsePem)(null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey):(null!==(t=this.privateKey)&&void 0!==t?t:this.publicKey).export({type:this.privateKey?"sec1":"spki",format:"der"}),this.privateKey?u.Sec1KeyFormatter.parseECPrivate(r):u.Sec1KeyFormatter.parseECPublic(r)}dispose(){}}class g extends i.PublicKeyAlgorithm{constructor(e,t){super(e,e,t)}createKeyPair(){return new f(this.name)}async generateKeyPair(){const e=new f(this.name);return await e.generate(),e}createSigner(e){if(!(e instanceof f))throw new TypeError("ECDSA key pair object expected.");return new m(e,g.convertHashAlgorithmName(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof f))throw new TypeError("ECDSA key pair object expected.");return new m(e,g.convertHashAlgorithmName(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA")}static getSignatureLength(e){return 2*(5+Math.ceil(e/8))}}t.b=g,g.ecdsaSha2Nistp256="ecdsa-sha2-nistp256",g.ecdsaSha2Nistp384="ecdsa-sha2-nistp384",g.ecdsaSha2Nistp521="ecdsa-sha2-nistp521",g.curves=o.curves,g.KeyPair=f;class m{constructor(e,t){this.keyPair=e,this.hashAlgorithmName=t}get digestLength(){const e=this.keyPair.curve;return e?g.getSignatureLength(e.keySize):0}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");const t=n.createSign(this.hashAlgorithmName);t.update(e);let r=t.sign(this.keyPair.privateKey);const i=new c.DerReader(r),o=i.readInteger(),a=i.readInteger(),u=Math.ceil(this.keyPair.curve.keySize/8),h=new l.SshDataWriter(s.Buffer.alloc(this.digestLength));return h.writeBinary(o.toBytes({unsigned:!0,length:u+1})),h.writeBinary(a.toBytes({unsigned:!0,length:u+1})),r=h.toBuffer(),r}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const r=new l.SshDataReader(t),i=r.readBigInt(),o=r.readBigInt(),a=new c.DerWriter(s.Buffer.alloc(t.length));a.writeInteger(i),a.writeInteger(o),t=a.toBuffer();const u=n.createVerify(this.hashAlgorithmName);return u.update(e),u.verify(this.keyPair.publicKey,t)}dispose(){}}},5361:(e,t,r)=>{"use strict";t.r=void 0;const n=r(6113),s=r(4300),i=r(3687);class o extends i.EncryptionAlgorithm{constructor(e,t,r,n){if(super(e),this.algorithmName=t,this.cipherMode=r,this.keySizeInBits=n,"AES"!==t)throw new Error(`Unsupported encryption algorithm: ${t}`);this.blockSizeInBits=o.getBlockSize(t)}get keyLength(){return this.keySizeInBits/8}get blockLength(){return this.blockSizeInBits/8}async createCipher(e,t,r){let n;if("CTR"===this.cipherMode||"CBC"===this.cipherMode)n=new a(e,this.keySizeInBits,this.blockSizeInBits,t,r,this.cipherMode);else{if("GCM"!==this.cipherMode)throw new Error(`Unsupported cipher mode: ${this.cipherMode}`);n=new c(e,this.keySizeInBits,this.blockSizeInBits,t,r)}return n}static getBlockSize(e){if("AES"===e)return 128;throw new Error(`Unsupported encryption algorithm: ${e}`)}}t.r=o;class a{constructor(e,t,r,s,i,o){this.isEncryption=e,this.keySizeInBits=t,this.blockSizeInBits=r;const a=`AES-${this.keySizeInBits}-${o}`;this.cipher=this.isEncryption?n.createCipheriv(a,s,i):n.createDecipheriv(a,s,i),this.cipher.setAutoPadding(!1)}get blockLength(){return this.blockSizeInBits/8}transform(e){const t=this.cipher.update(e);if(t.length!==e.length){const r=`Result from encrypt/decrypt has invalid length ${t.length}, expected ${e.length}.`;throw new Error(r)}return Promise.resolve(t)}dispose(){}}class c{constructor(e,t,r,n,i){this.isEncryption=e,this.keySizeInBits=t,this.blockSizeInBits=r,this.tag=null,this.algorithmName=`aes-${this.keySizeInBits}-gcm`,this.key=s.Buffer.alloc(n.length),n.copy(this.key),this.nonce=s.Buffer.alloc(12),i.copy(this.nonce,0,0,12),this.associatedData=s.Buffer.alloc(4)}get blockLength(){return this.blockSizeInBits/8}get digestLength(){return 16}get authenticatedEncryption(){return!0}transform(e){if(e.length%this.blockLength!=0){const t=`Encrypt/decrypt input has invalid length ${e.length}, not a multiple of block size ${this.blockLength}.`;throw new Error(t)}const t=this.isEncryption?n.createCipheriv(this.algorithmName,this.key,this.nonce):n.createDecipheriv(this.algorithmName,this.key,this.nonce),r=e.length;if(this.associatedData[0]=r>>>24,this.associatedData[1]=r>>>16,this.associatedData[2]=r>>>8,this.associatedData[3]=r,t.setAAD(this.associatedData),!this.isEncryption){if(!this.tag)throw new Error("AES-GCM tag was not set before decrypting.");t.setAuthTag(this.tag)}const s=t.update(e);if(s.length!==e.length){const t=`Result from encrypt/decrypt has invalid length ${s.length}, expected ${e.length}.`;throw new Error(t)}t.final(),this.isEncryption?this.tag=t.getAuthTag():this.tag=null;let i=12;for(;--i>=4&&(this.nonce[i]++,0===this.nonce[i]););return Promise.resolve(s)}async sign(e){if(!this.tag)throw new Error("AES-GCM tag was not obtained by encrypting.");return this.tag}async verify(e,t){if(t.length!==this.digestLength)throw new Error("Incorrect AES-GCM tag length.");return this.tag=t,!0}dispose(){}}},9582:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeHmac=void 0;const n=r(6113),s=r(4300),i=r(4953);class o extends i.HmacAlgorithm{constructor(e,t,r=!1){super(e,t,o.getHashKeyLength(t),o.getHashDigestLength(t)),this.encryptThenMac=r}async createSigner(e){return new a(o.getNodeHashAlgorithmName(this.algorithmName),this.digestLength,this.encryptThenMac,e)}async createVerifier(e){return new a(o.getNodeHashAlgorithmName(this.algorithmName),this.digestLength,this.encryptThenMac,e)}static getHashKeyLength(e){if("SHA2-512"===e)return 64;if("SHA2-384"===e)return 48;if("SHA2-256"===e)return 32;throw new Error(`Unsupported hash algorithm: ${e}`)}static getHashDigestLength(e){return this.getHashKeyLength(e)}static getNodeHashAlgorithmName(e){if("SHA2-512"===e)return"sha512";if("SHA2-384"===e)return"sha384";if("SHA2-256"===e)return"sha256";throw new Error(`Unsupported hash algorithm: ${e}`)}}t.NodeHmac=o;class a{constructor(e,t,r,i){this.algorithmName=e,this.digestLength=t,this.encryptThenMac=r,this.key=n.createSecretKey?n.createSecretKey(i):s.Buffer.from(i)}async sign(e){const t=n.createHmac(this.algorithmName,this.key);return t.update(e),t.digest()}async verify(e,t){const r=n.createHmac(this.algorithmName,this.key);return r.update(e),r.digest().equals(t)}dispose(){}}},1820:(e,t,r)=>{"use strict";t.th=t.yk=void 0;const n=r(6113),s=r(4300),i=r(1263),o=r(9582),a=r(3380);class c extends i.KeyExchangeAlgorithm{constructor(e,t,r){super(e,t,r,o.NodeHmac.getHashDigestLength(r))}createKeyExchange(){return new l(this.keySizeInBits,o.NodeHmac.getNodeHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.yk=c;class l{constructor(e,t,r){switch(this.hashAlgorithmName=t,this.digestLength=r,e){case 1024:this.dh=n.getDiffieHellman("modp2");break;case 2048:this.dh=n.getDiffieHellman("modp14");break;case 4096:this.dh=n.getDiffieHellman("modp16");break;default:throw new Error("Invalid DH bit length.")}}startKeyExchange(){const e=this.dh.generateKeys(),t=a.BigInt.fromBytes(e,{unsigned:!0}).toBytes();return Promise.resolve(t)}decryptKeyExchange(e){const t=this.dh.computeSecret(e),r=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(r)}async sign(e){const t=n.createHash(this.hashAlgorithmName);return t.update(e),s.Buffer.from(t.digest())}dispose(){}}class u extends i.KeyExchangeAlgorithm{constructor(e,t,r){super(e,t,r,o.NodeHmac.getHashDigestLength(r))}createKeyExchange(){return new h(this.keySizeInBits,o.NodeHmac.getNodeHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.th=u;class h{constructor(e,t,r){switch(this.hashAlgorithmName=t,this.digestLength=r,e){case 256:this.ecdh=n.createECDH("prime256v1");break;case 384:this.ecdh=n.createECDH("secp384r1");break;case 521:this.ecdh=n.createECDH("secp521r1");break;default:throw new Error("Invalid ECDH bit length.")}}startKeyExchange(){const e=this.ecdh.generateKeys();return Promise.resolve(e)}decryptKeyExchange(e){const t=this.ecdh.computeSecret(e),r=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(r)}async sign(e){const t=n.createHash(this.hashAlgorithmName);return t.update(e),s.Buffer.from(t.digest())}dispose(){}}},5670:(e,t,r)=>{"use strict";t.e=void 0;const n=r(6113);t.e=class{getBytes(e){n.randomBytes(e.length).copy(e)}}},4245:(e,t,r)=>{"use strict";t.G=void 0;const n=r(6113),s=r(4300),i=r(7103),o=r(7309),a=r(9582),c=r(2185),l=process.versions.node.split(".").map((e=>parseInt(e,10))),u=l[0]>10||10===l[0]&&l[1]>=12,h=l[0]>11||11===l[0]&&l[1]>=6;class d{constructor(){this.comment=null}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return p.keyAlgorithmName}generate(e){return e=null!=e?e:d.defaultKeySize,u&&h?this.generateNodeKeyPairObjects(e):u?this.generateNodeKeyPairBuffers(e):this.generateExternalKeyPair(e)}async generateNodeKeyPairObjects(e){[this.publicKey,this.privateKey]=await new Promise(((t,r)=>{const s={modulusLength:e};try{n.generateKeyPair("rsa",s,((e,n,s)=>{e?r(e):t([n,s])}))}catch(e){r(e)}}))}async generateNodeKeyPairBuffers(e){[this.publicKey,this.privateKey]=await new Promise(((t,r)=>{const s={modulusLength:e,publicKeyEncoding:{type:"pkcs1",format:"pem"},privateKeyEncoding:{type:"pkcs1",format:"pem",cipher:void 0,passphrase:void 0}};try{n.generateKeyPair("rsa",s,((e,n,s)=>{e?r(e):t([n,s])}))}catch(e){r(e)}}))}async generateExternalKeyPair(e){const t=new(await Promise.resolve().then((()=>r(4024))))({b:e});this.publicKey=t.exportKey("pkcs1-public-pem"),this.privateKey=t.exportKey("pkcs1-private-pem"),this.publicKey.endsWith("\n")||(this.publicKey+="\n"),this.privateKey.endsWith("\n")||(this.privateKey+="\n")}async setPublicKeyBytes(e){if(!e)throw new TypeError("Buffer is required.");const t=new o.SshDataReader(e),r=t.readString("ascii");if(r!==this.keyAlgorithmName&&r!==p.rsaWithSha256&&r!==p.rsaWithSha512)throw new Error(`Invalid RSA key algorithm: ${r}`);const s=t.readBigInt(),i=t.readBigInt();e=c.Pkcs1KeyFormatter.formatRsaPublic({modulus:i,exponent:s}),this.publicKey=h?n.createPublicKey({key:e,type:"pkcs1",format:"der"}):(0,c.formatPem)(e,"RSA PUBLIC KEY")}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;e||(e=this.keyAlgorithmName),t="string"==typeof this.publicKey?(0,c.parsePem)(this.publicKey):this.publicKey.export({type:"pkcs1",format:"der"});const r=c.Pkcs1KeyFormatter.parseRsaPublic(t),n=s.Buffer.alloc(512),i=new o.SshDataWriter(n);return i.writeString(e,"ascii"),i.writeBigInt(r.exponent),i.writeBigInt(r.modulus),t=i.toBuffer(),t}async importParameters(e){if(h)this.publicKey=n.createPublicKey({key:c.Pkcs1KeyFormatter.formatRsaPublic(e),format:"der",type:"pkcs1"}),e.d?this.privateKey=n.createPrivateKey({key:c.Pkcs1KeyFormatter.formatRsaPrivate(e),format:"der",type:"pkcs1"}):this.privateKey=void 0;else{const t=c.Pkcs1KeyFormatter.formatRsaPublic(e);if(this.publicKey=(0,c.formatPem)(t,"RSA PUBLIC KEY"),e.d){const t=c.Pkcs1KeyFormatter.formatRsaPrivate(e);this.privateKey=(0,c.formatPem)(t,"RSA PRIVATE KEY")}}}async exportParameters(){var e,t;if(!this.publicKey)throw new Error("Public key not set.");let r;return r=h?(null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey).export({format:"der",type:"pkcs1"}):(0,c.parsePem)(null!==(t=this.privateKey)&&void 0!==t?t:this.publicKey),this.privateKey?c.Pkcs1KeyFormatter.parseRsaPrivate(r):c.Pkcs1KeyFormatter.parseRsaPublic(r)}dispose(){this.publicKey=void 0,this.privateKey=void 0}}d.defaultKeySize=2048;class p extends i.PublicKeyAlgorithm{constructor(e,t){super(e,p.keyAlgorithmName,t)}createKeyPair(){return new d}async generateKeyPair(e){const t=new d;return await t.generate(e),t}createSigner(e){if(!(e instanceof d))throw new TypeError("RSA key pair object expected.");return new f(e,p.convertHashAlgorithmName(this.hashAlgorithmName),a.NodeHmac.getHashDigestLength(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof d))throw new TypeError("RSA key pair object expected.");return new f(e,p.convertHashAlgorithmName(this.hashAlgorithmName),a.NodeHmac.getHashDigestLength(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA")}}t.G=p,p.keyAlgorithmName="ssh-rsa",p.rsaWithSha256="rsa-sha2-256",p.rsaWithSha512="rsa-sha2-512",p.KeyPair=d;class f{constructor(e,t,r){this.keyPair=e,this.hashAlgorithmName=t,this.digestLength=r}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");const t=n.createSign(this.hashAlgorithmName);return t.update(e),t.sign(this.keyPair.privateKey)}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const r=n.createVerify(this.hashAlgorithmName);return r.update(e),r.verify(this.keyPair.publicKey,t)}dispose(){}}},7103:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublicKeyAlgorithm=void 0;const n=r(4300),s=r(7309);t.PublicKeyAlgorithm=class{constructor(e,t,r){this.name=e,this.keyAlgorithmName=t,this.hashAlgorithmName=r}readSignatureData(e){const t=new s.SshDataReader(e),r=t.readString("ascii");if(r!==this.name)throw new Error(`Mismatched public key algorithm: got '${r}', expected '${this.name}'.`);return t.readBinary()}createSignatureData(e){const t=new s.SshDataWriter(n.Buffer.alloc(this.name.length+e.length+20));return t.writeString(this.name,"ascii"),t.writeBinary(e),t.toBuffer()}}},7521:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.algorithmNames=t.SshAlgorithms=t.Encryption=t.ECDsa=t.Rsa=t.HmacAlgorithm=t.EncryptionAlgorithm=t.PublicKeyAlgorithm=t.KeyExchangeAlgorithm=void 0;const n=r(1263);Object.defineProperty(t,"KeyExchangeAlgorithm",{enumerable:!0,get:function(){return n.KeyExchangeAlgorithm}});const s=r(7103);Object.defineProperty(t,"PublicKeyAlgorithm",{enumerable:!0,get:function(){return s.PublicKeyAlgorithm}});const i=r(3687);Object.defineProperty(t,"EncryptionAlgorithm",{enumerable:!0,get:function(){return i.EncryptionAlgorithm}});const o=r(4953);Object.defineProperty(t,"HmacAlgorithm",{enumerable:!0,get:function(){return o.HmacAlgorithm}});const a=!("object"!=typeof crypto||!crypto.subtle),c=r(9297),l=r(787),u=r(6205),h=r(8159),d=r(3175),p=r(8682),f=a?c.WebDiffieHellman:r(1820).yk,g=a?c.WebECDiffieHellman:r(1820).th,m=a?l.WebRsa:r(4245).G;t.Rsa=m;const y=a?u.WebECDsa:r(1579).b;t.ECDsa=y;const v=a?h.WebEncryption:r(5361).r;t.Encryption=v;const w=a?d.WebHmac:r(9582).NodeHmac,S=a?p.WebRandom:r(5670).e;class b{}t.SshAlgorithms=b,b.keyExchange={none:null,dhGroup14Sha256:new f("diffie-hellman-group14-sha256",2048,"SHA2-256"),dhGroup16Sha512:new f("diffie-hellman-group16-sha512",4096,"SHA2-512"),ecdhNistp256Sha256:new g("ecdh-sha2-nistp256",256,"SHA2-256"),ecdhNistp384Sha384:new g("ecdh-sha2-nistp384",384,"SHA2-384"),ecdhNistp521Sha512:new g("ecdh-sha2-nistp521",521,"SHA2-512")},b.publicKey={none:null,rsaWithSha256:new m("rsa-sha2-256","SHA2-256"),rsaWithSha512:new m("rsa-sha2-512","SHA2-512"),ecdsaSha2Nistp256:new y("ecdsa-sha2-nistp256","SHA2-256"),ecdsaSha2Nistp384:new y("ecdsa-sha2-nistp384","SHA2-384"),ecdsaSha2Nistp521:new y("ecdsa-sha2-nistp521","SHA2-512")},b.encryption={none:null,aes256Ctr:new v("aes256-ctr","AES","CTR",256),aes256Gcm:new v("aes256-gcm@openssh.com","AES","GCM",256)},b.hmac={none:null,hmacSha256:new w("hmac-sha2-256","SHA2-256"),hmacSha512:new w("hmac-sha2-512","SHA2-512"),hmacSha256Etm:new w("hmac-sha2-256-etm@openssh.com","SHA2-256",!0),hmacSha512Etm:new w("hmac-sha2-512-etm@openssh.com","SHA2-512",!0)},b.compression={none:null},b.random=new S,t.algorithmNames=function(e){return e.map((e=>e?e.name:"none"))}},5440:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonWebKeyFormatter=void 0;const n=r(3380),s=r(3926);class i{static formatRsa(e,t){const r=i.formatBigInt;let n;if(!1!==t&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi)n={kty:"RSA",n:r(e.modulus),e:r(e.exponent),d:r(e.d),p:r(e.p),q:r(e.q),dp:r(e.dp),dq:r(e.dq),qi:r(e.qi)};else{if(t)throw new Error("Missing private key parameters.");n={kty:"RSA",n:r(e.modulus),e:r(e.exponent)}}return n}static parseRsa(e,t){if("RSA"!==(null==e?void 0:e.kty)||!e.n||!e.e)throw new Error("Invalid RSA JWK.");const r=i.parseBigInt;let n;return n=!1!==t&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi?{modulus:r(e.n),exponent:r(e.e),d:r(e.d),p:r(e.p),q:r(e.q),dp:r(e.dp),dq:r(e.dq),qi:r(e.qi)}:{modulus:r(e.n),exponent:r(e.e)},n}static formatEC(e,t){const r=i.formatBigInt,n=s.curves.find((t=>t.oid===e.curve.oid||t.name===e.curve.name||t.shortName===e.curve.name)),o=Math.ceil(n.keySize/8),a={kty:"EC",crv:e.curve.name,x:r(e.x,o),y:r(e.y,o)};if(!1!==t&&e.d)a.d=r(e.d,o);else if(t)throw new Error("Missing private key parameters.");return a}static parseEC(e,t){if("EC"!==(null==e?void 0:e.kty)||!(e.crv&&e.x&&e.y))throw new Error("Invalid EC JWK.");const r=i.parseBigInt,n={curve:{name:e.crv},x:r(e.x),y:r(e.y)};return!1!==t&&e.d&&(n.d=r(e.d)),n}static formatBigInt(e,t){return i.base64UrlEncode(e.toBytes({unsigned:!0,length:t}))}static parseBigInt(e){return n.BigInt.fromBytes(Buffer.from(e,"base64"),{unsigned:!0})}static base64UrlEncode(e){return e.toString("base64").replace(/=+$/g,"").replace(/\+/g,"-").replace(/\//g,"_")}}t.JsonWebKeyFormatter=i},6205:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebECDsa=void 0;const n=r(4300),s=r(7103),i=r(7309),o=r(3926),a=r(3380),c=r(5440);class l{constructor(e){this.comment=null,e&&(this.algorithmName=e)}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return this.algorithmName}get algorithmName(){return this.algorithm}set algorithmName(e){const t=e.split("-")[2];if(this.curve=o.curves.find((e=>e.name===t)),!this.curve)throw new Error("Invalid or unsupported ECDSA algorithm: "+e);this.algorithm=e}async generate(){try{const e={name:"ECDSA",namedCurve:this.curve.shortName},t=await crypto.subtle.generateKey(e,!0,["sign","verify"]);this.publicKey=t.publicKey,this.privateKey=t.privateKey}catch(e){throw new Error("Failed to generate RSA key pair: "+e)}}async setPublicKeyBytes(e,t){if(!e)throw new TypeError("Buffer is required.");const r=new i.SshDataReader(e),n=r.readString("ascii");if(this.algorithmName=t||n,r.readString("ascii")!==this.curve.name)throw new Error("EC curve name does not match.");const s=r.readBinary(),o=Math.ceil(this.curve.keySize/8),l=a.BigInt.fromBytes(s.slice(1,1+o),{unsigned:!0}),u=a.BigInt.fromBytes(s.slice(1+o,s.length),{unsigned:!0}),h=c.JsonWebKeyFormatter.formatEC({curve:{name:this.curve.shortName,oid:this.curve.oid},x:l,y:u});try{const e={name:"ECDSA",namedCurve:this.curve.shortName};this.publicKey=await crypto.subtle.importKey("jwk",h,e,!0,["verify"])}catch(e){throw new Error("Failed to import EC public key: "+e)}}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;try{t=await crypto.subtle.exportKey("jwk",this.publicKey)}catch(e){throw new Error("Failed to export ECDSA public key: "+e)}const r=n.Buffer.from(t.x,"base64"),s=n.Buffer.from(t.y,"base64"),o=Math.ceil(this.curve.keySize/8);if(r.length!==o||s.length!==o)throw new Error("Unexpected key length.");e=e||this.algorithmName||this.keyAlgorithmName;const a=n.Buffer.alloc(e.length+r.length+s.length+10),c=new i.SshDataWriter(a);return c.writeString(e,"ascii"),c.writeString(this.curve.name,"ascii"),c.writeUInt32(1+r.length+s.length),c.writeByte(4),c.write(r),c.write(s),c.toBuffer()}async importParameters(e){if(!e.curve)throw new TypeError("A curve is required.");let t;if(e.curve.oid){if(t=o.curves.find((t=>t.oid===e.curve.oid)),!t)throw new Error(`Unsupported curve OID: ${e.curve.oid}`)}else{if(!e.curve.name)throw new TypeError("A curve OID or name is required.");if(t=o.curves.find((t=>t.name===e.curve.name)),!t)throw new Error(`Unsupported curve: ${e.curve.name}`)}this.algorithmName="ecdsa-sha2-"+t.name;const r={name:"ECDSA",namedCurve:this.curve.shortName},n=c.JsonWebKeyFormatter.formatEC(e);n.crv=this.curve.shortName;try{n.d?(this.privateKey=await crypto.subtle.importKey("jwk",n,r,!0,["sign"]),n.d=void 0):this.privateKey=void 0,this.publicKey=await crypto.subtle.importKey("jwk",n,r,!0,["verify"])}catch(e){throw new Error("Failed to import ECDSA key pair: "+e)}}async exportParameters(){var e;const t=null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey;if(!t)throw new Error("Key not present.");let r;try{r=await crypto.subtle.exportKey("jwk",t)}catch(e){throw new Error("Failed to export ECDSA key pair: "+e)}const n=c.JsonWebKeyFormatter.parseEC(r);return n.curve={name:this.curve.name,oid:this.curve.oid},n}dispose(){}}class u extends s.PublicKeyAlgorithm{constructor(e,t){super(e,e,t)}createKeyPair(){return new l(this.name)}async generateKeyPair(){const e=new l(this.name);return await e.generate(),e}createSigner(e){if(!(e instanceof l))throw new TypeError("ECDSA key pair object expected.");const t=u.convertHashAlgorithmName(this.hashAlgorithmName);return new h(e,t)}createVerifier(e){if(!(e instanceof l))throw new TypeError("ECDSA key pair object expected.");const t=u.convertHashAlgorithmName(this.hashAlgorithmName);return new h(e,t)}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA-")}static getSignatureLength(e){return 2*(5+Math.ceil(e/8))}}t.WebECDsa=u,u.ecdsaSha2Nistp256="ecdsa-sha2-nistp256",u.ecdsaSha2Nistp384="ecdsa-sha2-nistp384",u.ecdsaSha2Nistp521="ecdsa-sha2-nistp521",u.curves=o.curves,u.KeyPair=l;class h{constructor(e,t){this.keyPair=e,this.hashAlgorithm=t}get digestLength(){const e=this.keyPair.curve;return e?u.getSignatureLength(e.keySize):0}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");let t=n.Buffer.from(await crypto.subtle.sign({name:"ECDSA",hash:{name:this.hashAlgorithm}},this.keyPair.privateKey,e));const r=Math.ceil(this.keyPair.curve.keySize/8);if(t.length!==2*r)throw new Error(`Unexpected signature length: ${t.length}`);const s=a.BigInt.fromBytes(t.slice(0,r),{unsigned:!0}),o=a.BigInt.fromBytes(t.slice(r,t.length),{unsigned:!0}),c=new i.SshDataWriter(n.Buffer.alloc(this.digestLength));return c.writeBinary(s.toBytes({unsigned:!0,length:r+1})),c.writeBinary(o.toBytes({unsigned:!0,length:r+1})),t=c.toBuffer(),t}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const r=new i.SshDataReader(t),s=r.readBigInt(),o=r.readBigInt(),a=Math.ceil(this.keyPair.curve.keySize/8);return t=n.Buffer.alloc(2*a),s.toBytes({unsigned:!0,length:a}).copy(t,0),o.toBytes({unsigned:!0,length:a}).copy(t,a),await crypto.subtle.verify({name:"ECDSA",hash:{name:this.hashAlgorithm}},this.keyPair.publicKey,t,e)}dispose(){}}},8159:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebEncryption=void 0;const n=r(4300),s=r(3687);class i extends s.EncryptionAlgorithm{constructor(e,t,r,n){super(e),this.algorithmName=t,this.cipherMode=r,this.keySizeInBits=n,this.blockSizeInBits=i.getBlockSize(t)}get keyLength(){return this.keySizeInBits/8}get blockLength(){return this.blockSizeInBits/8}async createCipher(e,t,r){const n=new o(e,this.algorithmName,this.cipherMode,this.keySizeInBits,this.blockSizeInBits);return await n.init(t,r),n}static getBlockSize(e){if("AES"===e)return 128;throw new Error(`Unsupported encryption algorithm: ${e}`)}}t.WebEncryption=i;class o{get blockLength(){return this.blockSizeInBits/8}constructor(e,t,r,s,i){if(this.isEncryption=e,this.algorithmName=t,this.cipherMode=r,this.keySizeInBits=s,this.blockSizeInBits=i,this.tag=null,"AES"===this.algorithmName&&"CTR"===this.cipherMode)this.transform=this.aesCtr.bind(this,e);else if("AES"===this.algorithmName&&"CBC"===this.cipherMode)this.transform=this.aesCbc.bind(this,e);else{if("AES"!==this.algorithmName||"GCM"!==this.cipherMode)throw new Error(`Unsupported encryption algorithm: ${this.algorithmName}-${this.cipherMode}`);this.transform=this.aesGcm.bind(this,e),this.associatedData=n.Buffer.alloc(4),this.decryptBuffer=n.Buffer.alloc(4*this.blockLength)}}async init(e,t){try{const t=`${this.algorithmName}-${this.cipherMode}`;this.key=await crypto.subtle.importKey("raw",e,{name:t,length:this.keySizeInBits},!1,this.isEncryption?["encrypt"]:["decrypt"])}catch(e){throw new Error("Failed to initialize AES: "+e)}"GCM"===this.cipherMode?this.iv=n.Buffer.from(t.slice(0,12)):this.iv=n.Buffer.from(t)}async aesCtr(e,t){if(t.length%this.blockLength!=0){const e=`Encrypt/decrypt input has invalid length ${t.length}, not a multiple of block size ${this.blockLength}.`;throw new Error(e)}let r;if(r=e?n.Buffer.from(await crypto.subtle.encrypt({name:"AES-CTR",counter:this.iv,length:this.blockSizeInBits},this.key,t)):n.Buffer.from(await crypto.subtle.decrypt({name:"AES-CTR",counter:this.iv,length:this.blockSizeInBits},this.key,t)),r.length!==t.length){const e=`Result from encrypt/decrypt has invalid length ${r.length}, expected ${t.length}.`;throw new Error(e)}const s=t.length/this.blockLength;for(let e=0;e<s;e++)for(let e=this.iv.length-1;e>=0&&(this.iv[e]=this.iv[e]+1,!this.iv[e]);e--);return r}async aesCbc(e,t){if(e){let e=n.Buffer.from(await crypto.subtle.encrypt({name:"AES-CBC",iv:this.iv},this.key,t));return e=e.slice(0,t.length),e}return n.Buffer.from(await crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv},this.key,t))}async aesGcm(e,t){if(t.length%this.blockLength!=0){const e=`Encrypt/decrypt input has invalid length ${t.length}, not a multiple of block size ${this.blockLength}.`;throw new Error(e)}const r=t.length;let s;if(this.associatedData[0]=r>>>24,this.associatedData[1]=r>>>16,this.associatedData[2]=r>>>8,this.associatedData[3]=r,e)s=n.Buffer.from(await crypto.subtle.encrypt({name:"AES-GCM",iv:this.iv,additionalData:this.associatedData,tagLength:8*this.digestLength},this.key,t)),this.tag=s.slice(s.length-this.digestLength),s=s.slice(0,s.length-this.digestLength);else{if(!this.tag)throw new Error("AES-GCM tag was not set before decrypting.");const e=t.length+this.digestLength;if(this.decryptBuffer.length<e){let t=2*this.decryptBuffer.length;for(;t<e;)t*=2;this.decryptBuffer=n.Buffer.alloc(t)}const r=this.decryptBuffer.slice(0,e);t.copy(r,0),this.tag.copy(r,t.length),s=n.Buffer.from(await crypto.subtle.decrypt({name:"AES-GCM",iv:this.iv,additionalData:this.associatedData,tagLength:8*this.digestLength},this.key,r))}if(s.length!==t.length){const e=`Result from encrypt/decrypt has invalid length ${s.length}, expected ${t.length}.`;throw new Error(e)}let i=12;for(;--i>=4&&(this.iv[i]++,0===this.iv[i]););return s}get digestLength(){return 16}get authenticatedEncryption(){return"GCM"===this.cipherMode}async sign(e){if(!this.tag)throw new Error("AES-GCM tag was not obtained by encrypting.");return this.tag}async verify(e,t){if(t.length!==this.digestLength)throw new Error("Incorrect AES-GCM tag length.");return this.tag=t,!0}dispose(){}}},3175:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebHmac=void 0;const n=r(4300),s=r(4953);class i extends s.HmacAlgorithm{constructor(e,t,r=!1){super(e,t,i.getHashKeyLength(t),i.getHashDigestLength(t)),this.encryptThenMac=r}async createSigner(e){const t=new o(this.algorithmName,!0,this.digestLength,this.encryptThenMac);return await t.init(e),t}async createVerifier(e){const t=new o(this.algorithmName,!1,this.digestLength,this.encryptThenMac);return await t.init(e),t}static getHashKeyLength(e){if("SHA2-512"===e)return 64;if("SHA2-384"===e)return 48;if("SHA2-256"===e)return 32;throw new Error(`Unsupported hash algorithm: ${e}`)}static getHashDigestLength(e){return this.getHashKeyLength(e)}static getWebHashAlgorithmName(e){if("SHA2-512"===e)return"SHA-512";if("SHA2-384"===e)return"SHA-384";if("SHA2-256"===e)return"SHA-256";throw new Error(`Unsupported hash algorithm: ${e}`)}}t.WebHmac=i;class o{constructor(e,t,r,n){this.algorithmName=e,this.isSigning=t,this.digestLength=r,this.encryptThenMac=n}async init(e){try{const t=this.algorithmName.replace("SHA2-","SHA-");this.key=await crypto.subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,this.isSigning?["sign"]:["verify"])}catch(e){throw new Error("Failed to initialize HMAC: "+e)}}async sign(e){return n.Buffer.from(await crypto.subtle.sign({name:"HMAC",hash:{name:this.algorithmName}},this.key,e))}async verify(e,t){return await crypto.subtle.verify({name:"HMAC",hash:{name:this.algorithmName}},this.key,t,e)}dispose(){}}},9297:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebECDiffieHellman=t.WebDiffieHellman=void 0;const n=r(4300),s=r(2257),i=r(1263),o=r(3175),a=r(3380),c=r(5440);class l extends i.KeyExchangeAlgorithm{constructor(e,t,r){super(e,t,r,o.WebHmac.getHashDigestLength(r))}createKeyExchange(){return new u(this.keySizeInBits,o.WebHmac.getWebHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.WebDiffieHellman=l;class u{constructor(e,t,r){switch(this.hashAlgorithmName=t,this.digestLength=r,e){case 1024:this.dh=(0,s.getDiffieHellman)("modp2");break;case 2048:this.dh=(0,s.getDiffieHellman)("modp14");break;case 4096:this.dh=(0,s.getDiffieHellman)("modp16");break;default:throw new Error("Invalid DH bit length.")}}startKeyExchange(){const e=this.dh.generateKeys(),t=a.BigInt.fromBytes(e,{unsigned:!0}).toBytes();return Promise.resolve(t)}decryptKeyExchange(e){const t=this.dh.computeSecret(e),r=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(r)}async sign(e){const t=await crypto.subtle.digest(this.hashAlgorithmName,e);return n.Buffer.from(t)}dispose(){}}class h extends i.KeyExchangeAlgorithm{constructor(e,t,r){super(e,t,r,o.WebHmac.getHashDigestLength(r))}createKeyExchange(){return new d(this.keySizeInBits,o.WebHmac.getWebHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.WebECDiffieHellman=h;class d{constructor(e,t,r){this.bitLength=e,this.hashAlgorithmName=t,this.digestLength=r,this.algorithm={name:"ECDH",namedCurve:"P-"+e}}async startKeyExchange(){this.keyPair||(this.keyPair=await crypto.subtle.generateKey(this.algorithm,!0,["deriveBits"]));const e=await crypto.subtle.exportKey("jwk",this.keyPair.publicKey),t=c.JsonWebKeyFormatter.parseEC(e),r=Math.ceil(this.bitLength/8),s=n.Buffer.alloc(1+2*r);return s[0]=4,t.x.toBytes({unsigned:!0,length:r}).copy(s,1),t.y.toBytes({unsigned:!0,length:r}).copy(s,1+r),n.Buffer.from(s)}async decryptKeyExchange(e){if(!this.keyPair)throw new Error("Key exchange not started.");const t=e,r=c.JsonWebKeyFormatter.formatEC({curve:{name:this.algorithm.namedCurve},x:a.BigInt.fromBytes(t.slice(1,1+(t.length-1)/2),{unsigned:!0}),y:a.BigInt.fromBytes(t.slice(1+(t.length-1)/2),{unsigned:!0})}),s=await crypto.subtle.importKey("jwk",r,this.algorithm,!1,[]),i=n.Buffer.from(await crypto.subtle.deriveBits(Object.assign(Object.assign({},this.algorithm),{public:s}),this.keyPair.privateKey,8*Math.ceil(this.bitLength/8)));return a.BigInt.fromBytes(i,{unsigned:!0}).toBytes()}async sign(e){const t=await crypto.subtle.digest(this.hashAlgorithmName,e);return n.Buffer.from(t)}dispose(){}}},8682:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebRandom=void 0,t.WebRandom=class{getBytes(e){crypto.getRandomValues(e)}}},787:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebRsa=void 0;const n=r(4300),s=r(7103),i=r(3175),o=r(7309),a=r(5440);class c{constructor(e){this.hashAlgorithm=e,this.comment=null}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return l.keyAlgorithmName}async generate(e){e=null!=e?e:c.defaultKeySize;try{const t={name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:this.hashAlgorithm}},r=await crypto.subtle.generateKey(t,!0,["sign","verify"]);this.publicKey=r.publicKey,this.privateKey=r.privateKey}catch(e){throw new Error("Failed to generate RSA key pair: "+e)}}async setPublicKeyBytes(e){if(!e)throw new TypeError("Buffer is required.");const t=new o.SshDataReader(e),r=t.readString("ascii");if(r!==this.keyAlgorithmName&&r!==l.rsaWithSha256&&r!==l.rsaWithSha512)throw new Error(`Invalid RSA key algorithm: ${r}`);const n=t.readBigInt(),s=t.readBigInt(),i=a.JsonWebKeyFormatter.formatRsa({modulus:s,exponent:n},!1);i.alg="RS"+this.hashAlgorithm.replace("SHA-",""),i.key_ops=["verify"];try{const e={name:"RSASSA-PKCS1-v1_5",hash:{name:this.hashAlgorithm}};this.publicKey=await crypto.subtle.importKey("jwk",i,e,!0,["verify"])}catch(e){throw new Error("Failed to import RSA public key: "+e)}}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;e||(e=this.keyAlgorithmName);try{t=await crypto.subtle.exportKey("jwk",this.publicKey)}catch(e){throw new Error("Failed to export RSA public key: "+e)}const{modulus:r,exponent:s}=a.JsonWebKeyFormatter.parseRsa(t,!1),i=n.Buffer.alloc(512),c=new o.SshDataWriter(i);return c.writeString(e,"ascii"),c.writeBigInt(s),c.writeBigInt(r),c.toBuffer()}async importParameters(e){const t=e.d?a.JsonWebKeyFormatter.formatRsa(e,!0):null,r=a.JsonWebKeyFormatter.formatRsa(e,!1),n={name:"RSASSA-PKCS1-v1_5",hash:{name:this.hashAlgorithm}};try{this.publicKey=await crypto.subtle.importKey("jwk",r,n,!0,["verify"]),this.privateKey=t?await crypto.subtle.importKey("jwk",t,n,!0,["sign"]):void 0}catch(e){if(!(e instanceof Error))throw e;throw new Error("Failed to import RSA key pair: "+e.message)}}async exportParameters(){var e;if(!this.publicKey)throw new Error("Public key not set.");let t;try{t=await crypto.subtle.exportKey("jwk",null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey)}catch(e){if(!(e instanceof Error))throw e;throw new Error("Failed to export RSA public key: "+e.message)}return a.JsonWebKeyFormatter.parseRsa(t,!!this.privateKey)}dispose(){}}c.defaultKeySize=2048;class l extends s.PublicKeyAlgorithm{constructor(e,t){super(e,l.keyAlgorithmName,t)}createKeyPair(){const e=l.convertHashAlgorithmName(this.hashAlgorithmName);return new c(e)}async generateKeyPair(e){const t=l.convertHashAlgorithmName(this.hashAlgorithmName),r=new c(t);return await r.generate(e),r}createSigner(e){if(!(e instanceof c))throw new TypeError("RSA key pair object expected.");const t=l.convertHashAlgorithmName(this.hashAlgorithmName);return new u(e,t,i.WebHmac.getHashDigestLength(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof c))throw new TypeError("RSA key pair object expected.");const t=l.convertHashAlgorithmName(this.hashAlgorithmName);return new u(e,t,i.WebHmac.getHashDigestLength(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA-")}}t.WebRsa=l,l.keyAlgorithmName="ssh-rsa",l.rsaWithSha256="rsa-sha2-256",l.rsaWithSha512="rsa-sha2-512",l.KeyPair=c;class u{constructor(e,t,r){this.keyPair=e,this.hashAlgorithm=t,this.digestLength=r}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");return await this.convertKeyHashAlgorithm(),n.Buffer.from(await crypto.subtle.sign("RSASSA-PKCS1-v1_5",this.keyPair.privateKey,e))}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");return await this.convertKeyHashAlgorithm(),await crypto.subtle.verify("RSASSA-PKCS1-v1_5",this.keyPair.publicKey,t,e)}async convertKeyHashAlgorithm(){if(this.keyPair.hashAlgorithm!==this.hashAlgorithm){const e=await this.keyPair.exportParameters();this.keyPair=new c(this.hashAlgorithm),await this.keyPair.importParameters(e)}}dispose(){}}},4608:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDisposedError=t.SshChannelError=t.SshReconnectError=t.SshConnectionError=void 0;class r extends Error{constructor(e,t){super(e),this.reason=t}}t.SshConnectionError=r;class n extends Error{constructor(e,t){super(e),this.reason=t}}t.SshReconnectError=n;class s extends Error{constructor(e,t){super(e),this.reason=t}}t.SshChannelError=s;class i extends Error{constructor(e){var t,r;let n;n="string"==typeof e?e:"function"==typeof e?e.name+" disposed.":(null!==(r=null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)&&void 0!==r?r:"Object ")+" disposed.",super(n)}}t.ObjectDisposedError=i},3314:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshAuthenticatingEventArgs=t.SshAuthenticationType=void 0;const n=r(5844);var s;!function(e){e[e.clientNone=0]="clientNone",e[e.clientHostBased=1]="clientHostBased",e[e.clientPassword=2]="clientPassword",e[e.clientPublicKeyQuery=3]="clientPublicKeyQuery",e[e.clientPublicKey=4]="clientPublicKey",e[e.serverPublicKey=10]="serverPublicKey"}(s=t.SshAuthenticationType||(t.SshAuthenticationType={})),t.SshAuthenticatingEventArgs=class{constructor(e,{username:t,password:r,publicKey:i,clientHostname:o,clientUsername:a},c){this.authenticationType=e;const l=({usernameRequired:e,passwordRequired:n,publicKeyRequired:s,clientHostnameRequired:c,clientUsernameRequired:l})=>"string"==typeof t==!!e&&"string"==typeof r==!!n&&!!i==!!s&&"string"==typeof o==!!c&&"string"==typeof a==!!l;let u;switch(e){case s.clientNone:u=l({usernameRequired:!0});break;case s.clientHostBased:u=l({usernameRequired:!0,publicKeyRequired:!0,clientHostnameRequired:!0,clientUsernameRequired:!0});break;case s.clientPassword:u=l({usernameRequired:!0,passwordRequired:!0});break;case s.clientPublicKeyQuery:case s.clientPublicKey:u=l({usernameRequired:!0,publicKeyRequired:!0});break;case s.serverPublicKey:u=l({publicKeyRequired:!0});break;default:throw new Error(`Invalid authentication type: ${e}`)}if(!u)throw new Error(`Invalid arguments for authentication type: ${e}`);this.username=null!=t?t:null,this.password=null!=r?r:null,this.publicKey=null!=i?i:null,this.clientHostname=null!=o?o:null,this.clientUsername=null!=a?a:null,this.cancellationValue=null!=c?c:n.CancellationToken.None}get cancellation(){return this.cancellationValue}set cancellation(e){this.cancellationValue=e}toString(){return this.password?(this.username?'"'+this.username+'" ':"")+"[password]":this.publicKey?`${this.username?'"'+this.username+'" ':""}[${this.publicKey.keyAlgorithmName}]`:`"${this.username}"`}}},8512:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelClosedEventArgs=void 0,t.SshChannelClosedEventArgs=class{constructor(e,t){"number"==typeof e?this.exitStatus=e:"string"==typeof e?(this.exitSignal=e,this.errorMessage=t):e instanceof Error&&(this.error=e)}}},7776:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelOpeningEventArgs=void 0;const n=r(3379),s=r(5844);t.SshChannelOpeningEventArgs=class{constructor(e,t,r,i){if(this.request=e,this.channel=t,this.isRemoteRequest=r,this.failureReason=n.SshChannelOpenFailureReason.none,this.failureDescription=null,!e)throw new TypeError("A channel open message is required.");if(!t)throw new TypeError("A channel is required.");this.cancellationValue=null!=i?i:s.CancellationToken.None}get cancellation(){return this.cancellationValue}set cancellation(e){this.cancellationValue=e}toString(){return`${this.channel.toString()}${this.failureReason?" "+n.SshChannelOpenFailureReason[this.failureReason]:""}`}}},1656:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshRequestEventArgs=void 0;const n=r(5844);t.SshRequestEventArgs=class{constructor(e,t,r,s){this.requestType=e,this.request=t,this.principal=r,this.cancellationValue=null!=s?s:n.CancellationToken.None}get cancellation(){return this.cancellationValue}set cancellation(e){this.cancellationValue=e}toString(){return`RequestType: ${this.requestType}`+this.request?` Request: ${this.request}`:""}}},8764:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionClosedEventArgs=void 0;const n=r(6306);t.SshSessionClosedEventArgs=class{constructor(e,t,r){if(this.reason=e,this.message=t,this.error=r,!t)throw new TypeError("A disconnect message is required.")}toString(){return`${n.SshDisconnectReason[this.reason]}: ${this.message}`}}},2727:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelError=t.BigInt=t.DerWriter=t.DerReader=t.formatBuffer=t.SshDataWriter=t.SshDataReader=t.ECDsa=t.Rsa=t.Encryption=t.HmacAlgorithm=t.EncryptionAlgorithm=t.PublicKeyAlgorithm=t.KeyExchangeAlgorithm=t.SshAlgorithms=t.CommandRequestMessage=t.ChannelRequestType=t.ChannelRequestMessage=t.ChannelOpenConfirmationMessage=t.ChannelOpenMessage=t.ChannelOpenFailureMessage=t.ChannelMessage=t.SshChannelOpenFailureReason=t.SshReconnectFailureReason=t.SshDisconnectReason=t.SessionRequestFailureMessage=t.SessionRequestSuccessMessage=t.DebugMessage=t.SessionRequestMessage=t.SshMessage=t.SshChannelClosedEventArgs=t.SshSessionClosedEventArgs=t.SshChannelOpeningEventArgs=t.SshRequestEventArgs=t.SshAuthenticatingEventArgs=t.SshAuthenticationType=t.serviceActivation=t.SshService=t.SshRpcMessageStream=t.WebSocketStream=t.NodeStream=t.BaseStream=t.SshStream=t.SshChannel=t.SshServerSession=t.SshClientSession=t.SshSession=t.SshVersionInfo=t.SshProtocolExtensionNames=t.SshSessionConfiguration=void 0,t.SshTraceEventIds=t.TraceLevel=t.SecureStream=t.MultiChannelStream=t.SessionContour=t.ChannelMetrics=t.SessionMetrics=t.Queue=t.Semaphore=t.PromiseCompletionSource=t.CancellationError=t.CancellationTokenSource=t.CancellationToken=t.ObjectDisposedError=t.SshReconnectError=t.SshConnectionError=void 0;var n=r(9872);Object.defineProperty(t,"SshSessionConfiguration",{enumerable:!0,get:function(){return n.SshSessionConfiguration}}),Object.defineProperty(t,"SshProtocolExtensionNames",{enumerable:!0,get:function(){return n.SshProtocolExtensionNames}});var s=r(1163);Object.defineProperty(t,"SshVersionInfo",{enumerable:!0,get:function(){return s.SshVersionInfo}});var i=r(7492);Object.defineProperty(t,"SshSession",{enumerable:!0,get:function(){return i.SshSession}});var o=r(5706);Object.defineProperty(t,"SshClientSession",{enumerable:!0,get:function(){return o.SshClientSession}});var a=r(7331);Object.defineProperty(t,"SshServerSession",{enumerable:!0,get:function(){return a.SshServerSession}});var c=r(9273);Object.defineProperty(t,"SshChannel",{enumerable:!0,get:function(){return c.SshChannel}});var l=r(6373);Object.defineProperty(t,"SshStream",{enumerable:!0,get:function(){return l.SshStream}});var u=r(3538);Object.defineProperty(t,"BaseStream",{enumerable:!0,get:function(){return u.BaseStream}}),Object.defineProperty(t,"NodeStream",{enumerable:!0,get:function(){return u.NodeStream}}),Object.defineProperty(t,"WebSocketStream",{enumerable:!0,get:function(){return u.WebSocketStream}});var h=r(5523);Object.defineProperty(t,"SshRpcMessageStream",{enumerable:!0,get:function(){return h.SshRpcMessageStream}});var d=r(1838);Object.defineProperty(t,"SshService",{enumerable:!0,get:function(){return d.SshService}});var p=r(4865);Object.defineProperty(t,"serviceActivation",{enumerable:!0,get:function(){return p.serviceActivation}});var f=r(3314);Object.defineProperty(t,"SshAuthenticationType",{enumerable:!0,get:function(){return f.SshAuthenticationType}}),Object.defineProperty(t,"SshAuthenticatingEventArgs",{enumerable:!0,get:function(){return f.SshAuthenticatingEventArgs}});var g=r(1656);Object.defineProperty(t,"SshRequestEventArgs",{enumerable:!0,get:function(){return g.SshRequestEventArgs}});var m=r(7776);Object.defineProperty(t,"SshChannelOpeningEventArgs",{enumerable:!0,get:function(){return m.SshChannelOpeningEventArgs}});var y=r(8764);Object.defineProperty(t,"SshSessionClosedEventArgs",{enumerable:!0,get:function(){return y.SshSessionClosedEventArgs}});var v=r(8512);Object.defineProperty(t,"SshChannelClosedEventArgs",{enumerable:!0,get:function(){return v.SshChannelClosedEventArgs}});var w=r(6744);Object.defineProperty(t,"SshMessage",{enumerable:!0,get:function(){return w.SshMessage}});var S=r(6306);Object.defineProperty(t,"SessionRequestMessage",{enumerable:!0,get:function(){return S.SessionRequestMessage}}),Object.defineProperty(t,"DebugMessage",{enumerable:!0,get:function(){return S.DebugMessage}}),Object.defineProperty(t,"SessionRequestSuccessMessage",{enumerable:!0,get:function(){return S.SessionRequestSuccessMessage}}),Object.defineProperty(t,"SessionRequestFailureMessage",{enumerable:!0,get:function(){return S.SessionRequestFailureMessage}}),Object.defineProperty(t,"SshDisconnectReason",{enumerable:!0,get:function(){return S.SshDisconnectReason}}),Object.defineProperty(t,"SshReconnectFailureReason",{enumerable:!0,get:function(){return S.SshReconnectFailureReason}});var b=r(3379);Object.defineProperty(t,"SshChannelOpenFailureReason",{enumerable:!0,get:function(){return b.SshChannelOpenFailureReason}}),Object.defineProperty(t,"ChannelMessage",{enumerable:!0,get:function(){return b.ChannelMessage}}),Object.defineProperty(t,"ChannelOpenFailureMessage",{enumerable:!0,get:function(){return b.ChannelOpenFailureMessage}}),Object.defineProperty(t,"ChannelOpenMessage",{enumerable:!0,get:function(){return b.ChannelOpenMessage}}),Object.defineProperty(t,"ChannelOpenConfirmationMessage",{enumerable:!0,get:function(){return b.ChannelOpenConfirmationMessage}}),Object.defineProperty(t,"ChannelRequestMessage",{enumerable:!0,get:function(){return b.ChannelRequestMessage}}),Object.defineProperty(t,"ChannelRequestType",{enumerable:!0,get:function(){return b.ChannelRequestType}}),Object.defineProperty(t,"CommandRequestMessage",{enumerable:!0,get:function(){return b.CommandRequestMessage}});var _=r(7521);Object.defineProperty(t,"SshAlgorithms",{enumerable:!0,get:function(){return _.SshAlgorithms}}),Object.defineProperty(t,"KeyExchangeAlgorithm",{enumerable:!0,get:function(){return _.KeyExchangeAlgorithm}}),Object.defineProperty(t,"PublicKeyAlgorithm",{enumerable:!0,get:function(){return _.PublicKeyAlgorithm}}),Object.defineProperty(t,"EncryptionAlgorithm",{enumerable:!0,get:function(){return _.EncryptionAlgorithm}}),Object.defineProperty(t,"HmacAlgorithm",{enumerable:!0,get:function(){return _.HmacAlgorithm}}),Object.defineProperty(t,"Encryption",{enumerable:!0,get:function(){return _.Encryption}}),Object.defineProperty(t,"Rsa",{enumerable:!0,get:function(){return _.Rsa}}),Object.defineProperty(t,"ECDsa",{enumerable:!0,get:function(){return _.ECDsa}});var E=r(7309);Object.defineProperty(t,"SshDataReader",{enumerable:!0,get:function(){return E.SshDataReader}}),Object.defineProperty(t,"SshDataWriter",{enumerable:!0,get:function(){return E.SshDataWriter}}),Object.defineProperty(t,"formatBuffer",{enumerable:!0,get:function(){return E.formatBuffer}});var T=r(4918);Object.defineProperty(t,"DerReader",{enumerable:!0,get:function(){return T.DerReader}}),Object.defineProperty(t,"DerWriter",{enumerable:!0,get:function(){return T.DerWriter}});var C=r(3380);Object.defineProperty(t,"BigInt",{enumerable:!0,get:function(){return C.BigInt}});var P=r(4608);Object.defineProperty(t,"SshChannelError",{enumerable:!0,get:function(){return P.SshChannelError}}),Object.defineProperty(t,"SshConnectionError",{enumerable:!0,get:function(){return P.SshConnectionError}}),Object.defineProperty(t,"SshReconnectError",{enumerable:!0,get:function(){return P.SshReconnectError}}),Object.defineProperty(t,"ObjectDisposedError",{enumerable:!0,get:function(){return P.ObjectDisposedError}});var A=r(9638);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return A.CancellationToken}}),Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return A.CancellationTokenSource}}),Object.defineProperty(t,"CancellationError",{enumerable:!0,get:function(){return A.CancellationError}});var R=r(3305);Object.defineProperty(t,"PromiseCompletionSource",{enumerable:!0,get:function(){return R.PromiseCompletionSource}});var I=r(7399);Object.defineProperty(t,"Semaphore",{enumerable:!0,get:function(){return I.Semaphore}});var x=r(6655);Object.defineProperty(t,"Queue",{enumerable:!0,get:function(){return x.Queue}});var O=r(4340);Object.defineProperty(t,"SessionMetrics",{enumerable:!0,get:function(){return O.SessionMetrics}});var k=r(8614);Object.defineProperty(t,"ChannelMetrics",{enumerable:!0,get:function(){return k.ChannelMetrics}});var M=r(2750);Object.defineProperty(t,"SessionContour",{enumerable:!0,get:function(){return M.SessionContour}});var N=r(9141);Object.defineProperty(t,"MultiChannelStream",{enumerable:!0,get:function(){return N.MultiChannelStream}});var D=r(3868);Object.defineProperty(t,"SecureStream",{enumerable:!0,get:function(){return D.SecureStream}});var L=r(6197);Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return L.TraceLevel}}),Object.defineProperty(t,"SshTraceEventIds",{enumerable:!0,get:function(){return L.SshTraceEventIds}})},3380:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BigInt=void 0;const n=r(4300),s=r(7309);class i{constructor(e){if(this.buffer=e,0===e.length)throw new Error("BigInt buffer length must be greater than zero.")}get sign(){const e=this.buffer[0];return 0===e?this.buffer.length>1?1:0:0==(128&e)?1:-1}static fromInt32(e){if(0===e)return i.zero;let t=!1;e<0&&(t=!0,e=-e);const r=[];for(let t=24;t>=0;t-=8)(e>=1<<t||r.length>0)&&(r.push(e>>t),e&=~((1<<t)-1));return t&&(0==(128&r[0])?r[0]|=128:r.splice(0,0,128)),new i(n.Buffer.from(new Uint8Array(r)))}toInt32(){if(this.buffer.length>4)throw new TypeError("BigInt value cannot be converted to a 32-bit signed integer.");let e=this.buffer[0];this.sign<0&&(e&=127);for(let t=1;t<this.buffer.length;t++)e=(e<<8)+this.buffer[t];return this.sign<0&&(e=-e),e}static fromBytes(e,t){if(!n.Buffer.isBuffer(e))throw new TypeError("Buffer expected.");if(0===e.length)throw new Error("BigInt buffer length must be greater than zero.");t=null!=t?t:{};const r=0!=(128&e[0]),s=t.unsigned&&r?1:0;let o=0;for(let t=0;t<e.length-1&&0===e[t];t++)0==(128&e[t+1])&&o++;const a=n.Buffer.alloc(e.length+s-o);return e.copy(a,s,o,e.length),new i(a)}toBytes(e){e=null!=e?e:{};let t=this.buffer;if(e.unsigned){if(this.sign<0)throw new TypeError("Cannot format a negative BigInt as unsigned.");if(0===t[0]&&t.length>1&&(t=t.slice(1,t.length)),void 0!==e.length){if(t.length>e.length)throw new Error(`BigInt (${t.length} bytes) is too large for length ${e.length}.`);if(t.length<e.length){const r=n.Buffer.alloc(e.length);return t.copy(r,e.length-t.length),r}}}const r=n.Buffer.alloc(t.length);return t.copy(r,0,0,t.length),r}copyTo(e,t=0){this.buffer.copy(e,t,0,this.buffer.length)}equals(e){return e instanceof i&&this.buffer.equals(e.buffer)}toString(e){return(0,s.formatBuffer)(this.buffer,null!=e?e:"BigInt")}}t.BigInt=i,i.zero=new i(n.Buffer.alloc(1))},4918:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DerWriter=t.DerReader=void 0;const n=r(4300),s=r(3380);class i{constructor(e,t=48){this.buffer=e,this.position=0,this.readType(t);const r=this.readLength();if(r>this.buffer.length-this.position)throw new Error("Read out of bounds.");this.buffer=this.buffer.slice(0,this.position+r)}get available(){return this.buffer.length-this.position}readNull(){if(this.readType(5),0!==this.readByte())throw new Error("Expected a 0 after Null type.")}readInteger(){this.readType(2);const e=this.readLength(),t=this.readBytes(e);return new s.BigInt(t)}readOctetString(){this.readType(4);const e=this.readLength();return this.readBytes(e)}readBitString(){this.readType(3);const e=this.readLength();if(0!==this.readByte())throw new Error("Padded bit strings are not supported.");return this.readBytes(e-1)}readObjectIdentifier(e){this.readType(6);const t=this.readLength(),r=this.position+t,n=[],s=this.readByte();n.push(Math.trunc(s/40)),n.push(s%40);let i=0;for(;this.position<r;){const e=this.readByte();0!=(128&e)?i=128*i+(127&e):(i=128*i+e,n.push(i),i=0)}if(0!==i)throw new Error("Invalid OID format.");const o=n.join(".");if(e&&o!==e)throw new Error(`Expected OID ${e}, found: ${o}`);return o}readSequence(){const e=this.position;this.readType(48);const t=this.readLength();return this.position+=t,new i(this.buffer.slice(e,this.position))}tryReadTagged(e){if(this.position>=this.buffer.length)return null;const t=this.buffer[this.position];if(0==(160&t)||(-161&t)!==e)return null;const r=this.position;this.position++;const n=this.readLength();return this.position+=n,new i(this.buffer.slice(r,this.position),t)}peek(){if(this.position>=this.buffer.length)throw new Error("Read out of bounds.");return this.buffer[this.position]}readLength(){let e=this.readByte();if(128===e)throw new Error("Indefinite-length encoding is not supported.");if(e>127){const t=127&e;if(t>4)throw new Error(`DER length size is ${t} and cannot be more than 4 bytes.`);e=0;for(let r=0;r<t;r++)e=(e<<8)+this.readByte();if(e<0)throw new Error("Corrupted data - negative length found")}return e}readByte(){if(this.position>=this.buffer.length)throw new Error("Read out of bounds.");return this.buffer[this.position++]}readBytes(e){if(this.position+e>this.buffer.length)throw new Error("Read out of bounds.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readType(e){const t=this.readByte();if(t!==e)throw new Error(`Expected ${e} data type, found : ${t}`)}}t.DerReader=i;class o{constructor(e,t=48){this.buffer=e,this.dataType=t,this.position=0,this.buffer=e}toBuffer(){const e=this.position,t=o.getLength(e);this.ensureCapacity(1+t.length+e);const r=this.buffer.slice(0,1+t.length+e);return this.buffer.copy(r,1+t.length),r[0]=this.dataType,t.copy(r,1,0),this.buffer=this.buffer.slice(1+t.length,r.length),this.position=e,r}writeSequence(e){this.writeBytes(e.toBuffer())}writeTagged(e,t){if(e>15)throw new Error("Invalid DER tag.");this.writeByte(160|e);const r=o.getLength(t.position);this.writeBytes(r),this.writeBytes(t.buffer.slice(0,t.position))}writeNull(){this.writeByte(5),this.writeByte(0)}writeInteger(e){this.writeByte(2);const t=e.toBytes(),r=o.getLength(t.length);this.writeBytes(r),this.writeBytes(t)}writeOctetString(e){this.writeByte(4);const t=o.getLength(e.length);this.writeBytes(t),this.writeBytes(e)}writeBitString(e){this.writeByte(3);const t=o.getLength(1+e.length);this.writeBytes(t),this.writeByte(0),this.writeBytes(e)}writeObjectIdentifier(e){if(!e)throw new TypeError("OID value is null or empty.");const t=e.split(".").map(Number);if(t.length<2||t[0]>3||t[1]>=40)throw new Error(`Invalid OID: ${e}`);this.writeByte(6);let r=t.length-1;for(let e=2;e<t.length;e++){let n=t[e];for(;n>128;)r++,n/=128}const n=o.getLength(r);this.writeBytes(n),this.writeByte(40*t[0]+t[1]);for(let e=2;e<t.length;e++){let r=t[e];if(r>=128){const e=[];for(e.push(127&r);r>=128;)r/=128,e.push(128|127&r);for(;e.length>0;)this.writeByte(e.pop())}else this.writeByte(r)}}static getLength(e){if(e>127){let t=1;for(let r=e>>8;0!==r;r>>=8)t++;const r=o.lengthBuffer.slice(0,t+1);r[0]=128|t;for(let n=8*(t-1),s=1;n>=0;n-=8,s++)r[s]=e>>n;return r}{const t=o.lengthBuffer.slice(0,1);return t[0]=e,t}}writeByte(e){this.ensureCapacity(this.position+1),this.buffer[this.position++]=e}writeBytes(e){this.ensureCapacity(this.position+e.length),e.copy(this.buffer,this.position),this.position+=e.length}ensureCapacity(e){if(this.buffer.length<e){let t=Math.max(512,2*this.buffer.length);for(;t<e;)t*=2;const r=n.Buffer.alloc(t);this.buffer.copy(r,0,0,this.position),this.buffer=r}}}t.DerWriter=o,o.lengthBuffer=n.Buffer.alloc(10)},7309:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatBuffer=t.SshDataWriter=t.SshDataReader=void 0;const n=r(4300),s=r(7521),i=r(3380);class o{constructor(e){this.buffer=e,this.position=0}get available(){return this.buffer.length-this.position}read(e){if(this.available<e)throw new Error("Attempted to read past end of buffer.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readByte(){if(0===this.available)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position];return this.position++,e}readBinary(){const e=this.readUInt32();if(this.available<e)throw new Error("Attempted to read past end of buffer.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readString(e){return this.readBinary().toString()}readList(e){const t=this.readString(e);return 0===t.length?[]:t.split(",")}readBoolean(){return 0!==this.readByte()}readUInt32(){if(this.available<4)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position+0],t=this.buffer[this.position+1],r=this.buffer[this.position+2],n=this.buffer[this.position+3];return this.position+=4,(e<<24|t<<16|r<<8|n)>>>0}readUInt64(){if(this.available<8)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position+0],t=this.buffer[this.position+1],r=this.buffer[this.position+2],n=this.buffer[this.position+3],s=this.buffer[this.position+4],i=this.buffer[this.position+5],o=this.buffer[this.position+6],a=this.buffer[this.position+7];return this.position+=8,4294967296*((e<<24|t<<16|r<<8|n)>>>0)+((s<<24|i<<16|o<<8|a)>>>0)}readBigInt(){const e=this.readBinary();return 0===e.length?i.BigInt.zero:i.BigInt.fromBytes(e)}}let a;t.SshDataReader=o,o.mpintZero=n.Buffer.alloc(1),t.SshDataWriter=class{constructor(e){this.buffer=e,this.position=0}write(e){this.ensureCapacity(this.position+e.length),e.copy(this.buffer,this.position),this.position+=e.length}writeByte(e){this.ensureCapacity(this.position+1),this.buffer[this.position]=e,this.position++}writeBinary(e){this.ensureCapacity(this.position+4+e.length),this.writeUInt32(e.length),e.copy(this.buffer,this.position),this.position+=e.length}writeString(e,t){this.writeBinary(n.Buffer.from(e))}writeList(e,t){this.writeString(e?e.join(","):"",t)}writeBoolean(e){this.writeByte(e?1:0)}writeUInt32(e){this.ensureCapacity(this.position+4),this.buffer[this.position+0]=e>>>24,this.buffer[this.position+1]=e>>>16,this.buffer[this.position+2]=e>>>8,this.buffer[this.position+3]=e>>>0,this.position+=4}static writeUInt32(e,t,r){e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0}writeUInt64(e){this.ensureCapacity(this.position+8);const t=4294967295&e,r=(e-t)/4294967296;this.buffer[this.position+0]=r>>>24,this.buffer[this.position+1]=r>>>16,this.buffer[this.position+2]=r>>>8,this.buffer[this.position+3]=r>>>0,this.buffer[this.position+4]=t>>>24,this.buffer[this.position+5]=t>>>16,this.buffer[this.position+6]=t>>>8,this.buffer[this.position+7]=t>>>0,this.position+=8}writeBigInt(e){const t=e.toBytes();1===t.length&&0===t[0]?this.writeUInt32(0):this.writeBinary(t)}writeRandom(e){this.ensureCapacity(this.position+e);const t=this.buffer.slice(this.position,this.position+e);s.SshAlgorithms.random.getBytes(t),this.position+=e}skip(e){this.ensureCapacity(this.position+e),this.position+=e}ensureCapacity(e){if(this.buffer.length<e){let t=Math.max(512,2*this.buffer.length);for(;t<e;)t*=2;const r=n.Buffer.alloc(t);this.buffer.copy(r,0,0,this.position),this.buffer=r}}toBuffer(){return this.buffer.slice(0,this.position)}},t.formatBuffer=function(e,t,r){let n=`${void 0===t?"Buffer":t}[${e.length}] (${function(e){a||(a=function(){let e;const t=[];for(let r=0;r<256;r++){e=r;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}());let t=-1;for(let r=0;r<e.length;r++)t=t>>>8^a[255&(t^e[r])];return(4294967296+((-1^t)>>>0)).toString(16).substr(-8).toUpperCase()}(e)})\n`;if(!1===r)return n;const s=Math.min(2048,e.length);for(let t=0;t<s;t+=16){t<1e3&&(n+="0"),t<100&&(n+="0"),t<10&&(n+="0"),n+=t+":";for(let r=t;r<t+16;r++)n+=r<s?" "+e.slice(r,r+1).toString("hex"):"   ";n+="  ";for(let r=t;r<t+16;r++)if(r<s){const t=e[r];n+=t>32&&t<=127?e.slice(r,r+1).toString():"."}else n+=" ";n+="\n"}return s<e.length&&(n+="...\n"),n}},1915:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshProtocol=void 0;const n=r(4300),s=r(6655),i=r(7399),o=r(6744),a=r(7309),c=r(6306),l=r(5255),u=r(3379),h=r(4608),d=r(6197);class p{constructor(e,t){this.sequence=e,this.message=t}}class f{constructor(e,t,r,o){this.config=t,this.metrics=r,this.trace=o,this.sessionSemaphore=new i.Semaphore(1),this.inboundPacketSequence=0,this.outboundPacketSequence=0,this.inboundFlow=0,this.outboundFlow=0,this.recentSentMessages=new s.Queue,this.sendWriter=new a.SshDataWriter(n.Buffer.alloc(1024)),this.receiveWriter=new a.SshDataWriter(n.Buffer.alloc(1024)),this.traceChannelData=!1,this.extensions=null,this.kexService=null,this.algorithms=null,this.outgoingMessagesHaveLatencyInfo=!1,this.incomingMessagesHaveLatencyInfo=!1,this.outgoingMessagesHaveReconnectInfo=!1,this.incomingMessagesHaveReconnectInfo=!1,this.stream=e}get lastIncomingSequence(){return this.inboundPacketSequence-1}getSentMessages(e){if(e===this.outboundPacketSequence+1)return[];if(this.recentSentMessages.size>0&&e<this.recentSentMessages.peek().sequence)return null;const t=new Array;for(const r of this.recentSentMessages)if(r.sequence>=e){const e=r.message;e instanceof l.KeyExchangeMessage||e instanceof c.DisconnectMessage||t.push(e)}return t}async writeProtocolVersion(e,t){const r=this.stream;if(!r)throw new Error("SSH session disconnected.");const s=n.Buffer.from(e+"\r\n");return await r.write(s,t),this.metrics.addMessageSent(s.length),Promise.resolve()}async readProtocolVersion(e){const t=this.stream;if(!t)throw new Error("SSH session disconnected.");const r=n.Buffer.alloc(255);let s=0;for(let n=0;n<r.length;n++){const i=await t.read(1,e);if(!i)break;r[n]=i[0];const o=13,a=10;if(n>0&&r[n-1]===o&&r[n]===a){const e=r.toString("utf8",0,n-1);if(e.startsWith("SSH-"))return this.metrics.addMessageReceived(n+1),e;if(s>20)break;s++,n=-1}}throw new h.SshConnectionError("Failed to read the protocol version",c.SshDisconnectReason.protocolError)}async handleNewKeys(e){try{await this.sessionSemaphore.wait(e),this.inboundFlow=0,this.outboundFlow=0,this.algorithms=this.kexService.finishKeyExchange()}finally{this.sessionSemaphore.release()}}async read(e,t){const r=this.stream;if(!r)return!1;let n=0;do{let s;try{s=await r.read(e.length-n,t)}catch(e){if(!(e instanceof Error))throw e;if(r.isDisposed)return!1;throw r.dispose(),this.stream=null,this.trace(d.TraceLevel.Error,d.SshTraceEventIds.streamReadError,`Error reading from stream: ${e.message}`,e),new h.SshConnectionError("Error reading from stream: "+e.message,c.SshDisconnectReason.connectionLost)}if(!s)return!1;s.copy(e,n),n+=s.length}while(n<e.length);return!0}async write(e,t){const r=this.stream;if(!r)return!1;try{await r.write(e,t)}catch(e){if(!(e instanceof Error))throw e;if(r.isDisposed)return!1;throw r.dispose(),this.stream=null,this.trace(d.TraceLevel.Error,d.SshTraceEventIds.streamWriteError,`Error writing to stream: ${e.message}`,e),new h.SshConnectionError("Error writing to stream: "+e.message,c.SshDisconnectReason.connectionLost)}return!0}async considerReExchange(e,t){const r=this.kexService;if(!r)return;let n=null,s=null;!r.exchanging&&(e||this.inboundFlow+this.outboundFlow>this.config.keyRotationThreshold)&&([n,s]=await r.startKeyExchange(e)),n&&(await this.sendMessage(n,t),s&&await this.sendMessage(s,t))}async computeHmac(e,t,r){const s=new a.SshDataWriter(n.Buffer.alloc(4+t.length));return s.writeUInt32(r),s.write(t),await e.sign(s.toBuffer())}async verifyHmac(e,t,r,s){const i=new a.SshDataWriter(n.Buffer.alloc(4+t.length));return i.writeUInt32(r),i.write(t),await e.verify(i.toBuffer(),s)}async readAndVerifyHmac(e,t,r,n){if(!await this.read(r,n))return!1;if(!await this.verifyHmac(e,t,this.inboundPacketSequence,r))throw new h.SshConnectionError("Invalid MAC",c.SshDisconnectReason.macError);return!0}async sendMessage(e,t){var r;const s=this.algorithms,i=null==s?void 0:s.compressor,o=null==s?void 0:s.cipher,a=null==s?void 0:s.messageSigner;let c;await this.sessionSemaphore.wait(t);try{const s=o?Math.max(8,o.blockLength):8,l=f.packetLengthSize+f.paddingLengthSize;if(this.sendWriter.position=l,e.write(this.sendWriter),this.outgoingMessagesHaveReconnectInfo&&(this.sendWriter.writeUInt64(this.lastIncomingSequence),this.outgoingMessagesHaveLatencyInfo)){const e=Math.min(4294967295,Math.round(1e3*(this.metrics.time-this.lastIncomingTimestamp)));this.sendWriter.writeUInt32(e)}let h=this.sendWriter.toBuffer().slice(l);null!=i&&(h=i.compress(h));let g=s-(((null==a?void 0:a.encryptThenMac)||(null==a?void 0:a.authenticatedEncryption)?0:f.packetLengthSize)+f.paddingLengthSize+h.length)%s;g<4&&(g+=s);const m=f.paddingLengthSize+h.length+g;this.sendWriter.position=0,this.sendWriter.writeUInt32(m),this.sendWriter.writeByte(g),null!=i?this.sendWriter.write(h):this.sendWriter.position+=h.length,this.sendWriter.writeRandom(g),h=this.sendWriter.toBuffer();let y=null;if((null==a?void 0:a.encryptThenMac)&&o){const e=h.slice(f.packetLengthSize,h.length);(await o.transform(e)).copy(e),y=await this.computeHmac(a,h,this.outboundPacketSequence)}else if(null==a?void 0:a.authenticatedEncryption){const e=h.slice(f.packetLengthSize,h.length);(await o.transform(e)).copy(e),y=await a.sign(e)}else a&&(y=await this.computeHmac(a,h,this.outboundPacketSequence)),o&&(h=await o.transform(h));if(e instanceof u.ChannelDataMessage?this.traceChannelData&&this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.sendingChannelData,`Sending #${this.outboundPacketSequence} ${e}`):this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.sendingMessage,`Sending #${this.outboundPacketSequence} ${e}`),this.incomingMessagesHaveReconnectInfo){const t=new p(this.outboundPacketSequence,e);t.sentTime=this.metrics.time,this.recentSentMessages.enqueue(t)}if(this.outboundPacketSequence++,this.outboundFlow+=m,y){const e=n.Buffer.concat([h,y],h.length+y.length);c=await this.write(e,t)}else c=await this.write(h,t);this.metrics.addMessageSent(f.packetLengthSize+m+(null!==(r=null==a?void 0:a.digestLength)&&void 0!==r?r:0))}finally{this.sessionSemaphore.release()}return await this.considerReExchange(!1,t),c}async receiveMessage(e){var t;const r=this.algorithms,n=null==r?void 0:r.decipher,s=null==r?void 0:r.messageVerifier,i=null==r?void 0:r.decompressor,l=!((null==s?void 0:s.encryptThenMac)||(null==s?void 0:s.authenticatedEncryption)),p=l?n?Math.max(8,n.blockLength):8:f.packetLengthSize;this.receiveWriter.position=p;let g=this.receiveWriter.toBuffer();if(!await this.read(g,e))return null;this.lastIncomingTimestamp=this.metrics.time,n&&l&&(g=await n.transform(g),this.receiveWriter.position=0,this.receiveWriter.write(g));const m=new a.SshDataReader(g).readUInt32();if(m>f.maxPacketLength)throw new h.SshConnectionError("Invalid packet length.",c.SshDisconnectReason.protocolError);const y=f.packetLengthSize+m;y>p&&this.receiveWriter.skip(y-p),s&&this.receiveWriter.skip(s.digestLength);const v=this.receiveWriter.toBuffer(),w=v.slice(0,y),S=v.slice(y);let b=w.slice(p,y);if(b.length>0){if(!await this.read(b,e))return null;if((null==s?void 0:s.encryptThenMac)&&!await this.readAndVerifyHmac(s,w,S,e))return null;if(n){if(null==s?void 0:s.authenticatedEncryption){if(!await this.read(S,e))return null;await s.verify(b,S)}try{b=await n.transform(b)}catch(e){throw(null==s?void 0:s.authenticatedEncryption)?new h.SshConnectionError("Invalid MAC",c.SshDisconnectReason.macError):e}this.receiveWriter.position=p,this.receiveWriter.write(b)}}if(s&&!s.encryptThenMac&&!s.authenticatedEncryption&&!await this.readAndVerifyHmac(s,w,S,e))return null;const _=w[f.packetLengthSize];let E=w.slice(f.packetLengthSize+f.paddingLengthSize,f.packetLengthSize+(m-_));if(i&&(E=i.decompress(E)),this.incomingMessagesHaveReconnectInfo){let e,t;if(this.incomingMessagesHaveLatencyInfo){const r=new a.SshDataReader(E.slice(E.length-12,E.length));e=r.readUInt64(),t=r.readUInt32()/1e3,E=E.slice(0,E.length-12)}else e=new a.SshDataReader(E.slice(E.length-8,E.length)).readUInt64(),t=0,E=E.slice(0,E.length-8);for(;this.recentSentMessages.size>0;){const r=this.recentSentMessages.peek();if(r.sequence>e)break;if(this.stream&&this.incomingMessagesHaveLatencyInfo&&r.sequence===e){const e=this.lastIncomingTimestamp-r.sentTime-t;this.metrics.updateLatency(e)}this.recentSentMessages.dequeue()}}const T=E[0];let C=o.SshMessage.create(this.config,T,E);if(!C){const e=new c.UnimplementedMessage;e.sequenceNumber=this.inboundPacketSequence,e.unimplementedMessageType=T,C=e}return C instanceof u.ChannelDataMessage?this.traceChannelData&&this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.receivingChannelData,`Receiving #${this.inboundPacketSequence} ${C}`):this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.receivingMessage,`Receiving #${this.inboundPacketSequence} ${C}`),await this.sessionSemaphore.wait(e),this.inboundPacketSequence++,this.inboundFlow+=m,this.sessionSemaphore.release(),this.metrics.addMessageReceived(f.packetLengthSize+m+(null!==(t=null==s?void 0:s.digestLength)&&void 0!==t?t:0)),await this.considerReExchange(!1,e),C}dispose(){try{this.stream&&this.stream.close().catch((e=>{this.trace(d.TraceLevel.Error,d.SshTraceEventIds.streamCloseError,`Error closing stream: ${e.message}`,e)}))}catch(e){if(!(e instanceof Error))throw e;this.trace(d.TraceLevel.Error,d.SshTraceEventIds.streamCloseError,`Error closing stream: ${e.message}`,e)}this.stream=null,this.metrics.updateLatency(0),this.algorithms&&this.algorithms.dispose()}}t.SshProtocol=f,f.maxPacketLength=1048576,f.packetLengthSize=4,f.paddingLengthSize=1},6892:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationSuccessMessage=t.AuthenticationFailureMessage=t.PasswordRequestMessage=t.PublicKeyOKMessage=t.PublicKeyRequestMessage=t.AuthenticationRequestMessage=t.AuthenticationMessage=void 0;const n=r(6744);class s extends n.SshMessage{}t.AuthenticationMessage=s;class i extends s{get messageType(){return 50}onRead(e){this.username=e.readString("utf8"),this.serviceName=e.readString("ascii"),this.methodName=e.readString("ascii")}onWrite(e){e.writeString(this.username||"","utf8"),e.writeString(this.serviceName||"","ascii"),e.writeString(this.validateField(this.methodName,"method name"),"ascii")}}t.AuthenticationRequestMessage=i,t.PublicKeyRequestMessage=class extends i{constructor(){super(),this.methodName="publickey"}get hasSignature(){return!!(this.signature&&this.signature.length>0)}onRead(e){super.onRead(e);const t=e.readBoolean();this.keyAlgorithmName=e.readString("ascii"),this.publicKey=e.readBinary(),t?(this.signature=e.readBinary(),this.payloadWithoutSignature=this.rawBytes.slice(0,this.rawBytes.length-this.signature.length-4)):this.signature=void 0}onWrite(e){var t,r;if(super.onWrite(e),!this.keyAlgorithmName)throw new Error("Key algorithm name not set.");if("hostbased"===this.methodName){if(e.writeString(this.keyAlgorithmName,"ascii"),e.writeBinary(this.publicKey||Buffer.alloc(0)),e.writeString(null!==(t=this.clientHostname)&&void 0!==t?t:"","ascii"),e.writeString(null!==(r=this.clientUsername)&&void 0!==r?r:"","ascii"),!this.hasSignature)throw new Error("A signature is required for a host-based authentcation request.");e.writeBinary(this.signature)}else e.writeBoolean(this.hasSignature),e.writeString(this.keyAlgorithmName,"ascii"),e.writeBinary(this.publicKey||Buffer.alloc(0)),this.hasSignature&&e.writeBinary(this.signature)}},t.PublicKeyOKMessage=class extends s{get messageType(){return 60}onRead(e){this.keyAlgorithmName=e.readString("ascii"),this.publicKey=e.readBinary()}onWrite(e){if(!this.keyAlgorithmName)throw new Error("Key algorithm name not set.");if(!this.publicKey)throw new Error("Public key not set.");e.writeString(this.keyAlgorithmName,"ascii"),e.writeBinary(this.publicKey)}},t.PasswordRequestMessage=class extends i{constructor(){super(),this.methodName="password"}onRead(e){super.onRead(e),e.readBoolean(),this.password=e.readString("utf8")}onWrite(e){super.onWrite(e),e.writeBoolean(!1),e.writeString(this.password||"","utf8")}};class o extends s{constructor(){super(...arguments),this.partialSuccess=!1}get messageType(){return 51}onRead(e){this.methodNames=e.readList("ascii"),this.partialSuccess=e.readBoolean()}onWrite(e){e.writeList(this.methodNames||[],"ascii"),e.writeBoolean(this.partialSuccess)}}t.AuthenticationFailureMessage=o;class a extends s{get messageType(){return 52}onRead(e){}onWrite(e){}}t.AuthenticationSuccessMessage=a,n.SshMessage.index.set(50,i),n.SshMessage.index.set(51,o),n.SshMessage.index.set(52,a)},3379:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelFailureMessage=t.ChannelSuccessMessage=t.ChannelSignalMessage=t.CommandRequestMessage=t.ChannelRequestMessage=t.ChannelRequestType=t.ChannelCloseMessage=t.ChannelEofMessage=t.ChannelDataMessage=t.ChannelWindowAdjustMessage=t.ChannelOpenFailureMessage=t.SshChannelOpenFailureReason=t.ChannelOpenConfirmationMessage=t.ChannelOpenMessage=t.ChannelMessage=t.ConnectionMessage=void 0;const n=r(6744),s=r(7309);class i extends n.SshMessage{}t.ConnectionMessage=i;class o extends i{get recipientChannel(){return this.recipientChannelValue}set recipientChannel(e){e!==this.recipientChannelValue&&(this.recipientChannelValue=e,this.rawBytes&&s.SshDataWriter.writeUInt32(this.rawBytes,1,null!=e?e:0))}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}toString(){return`${super.toString()} (recipientChannel=${this.recipientChannel})`}}t.ChannelMessage=o;class a extends i{get messageType(){return 90}get senderChannel(){return this.senderChannelValue}set senderChannel(e){e!==this.senderChannelValue&&(this.senderChannelValue=e,this.rawBytes&&this.channelType&&s.SshDataWriter.writeUInt32(this.rawBytes,5+this.channelType.length,null!=e?e:0))}onRead(e){this.channelType=e.readString("ascii"),this.senderChannel=e.readUInt32(),this.maxWindowSize=e.readUInt32(),this.maxPacketSize=e.readUInt32()}onWrite(e){e.writeString(this.validateField(this.channelType,"channel type"),"ascii"),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),e.writeUInt32(this.maxWindowSize||a.defaultMaxWindowSize),e.writeUInt32(this.maxPacketSize||a.defaultMaxPacketSize)}toString(){return`${super.toString()}(channelType=${this.channelType}, senderChannel=${this.senderChannel})`}}t.ChannelOpenMessage=a,a.defaultMaxPacketSize=32768,a.defaultMaxWindowSize=1048576;class c extends o{get messageType(){return 91}onRead(e){super.onRead(e),this.senderChannel=e.readUInt32(),this.maxWindowSize=e.readUInt32(),this.maxPacketSize=e.readUInt32()}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),e.writeUInt32(this.validateField(this.maxWindowSize,"max window size")),e.writeUInt32(this.validateField(this.maxPacketSize,"max packet size"))}toString(){return`${super.toString()}(senderChannel=${this.senderChannel})`}}var l,u;t.ChannelOpenConfirmationMessage=c,function(e){e[e.none=0]="none",e[e.administrativelyProhibited=1]="administrativelyProhibited",e[e.connectFailed=2]="connectFailed",e[e.unknownChannelType=3]="unknownChannelType",e[e.resourceShortage=4]="resourceShortage"}(l=t.SshChannelOpenFailureReason||(t.SshChannelOpenFailureReason={}));class h extends o{get messageType(){return 92}onRead(e){super.onRead(e),this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),this.language=e.readString("ascii")}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),e.writeString(this.language||"en","ascii")}toString(){return`${super.toString()} (${l[this.reasonCode||0]}: ${this.description})`}}t.ChannelOpenFailureMessage=h;class d extends o{get messageType(){return 93}onRead(e){super.onRead(e),this.bytesToAdd=e.readUInt32()}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.bytesToAdd,"bytes to add"))}toString(){return`${super.toString()} (bytesToAdd=${this.bytesToAdd})`}}t.ChannelWindowAdjustMessage=d;class p extends o{get messageType(){return 94}onRead(e){super.onRead(e),this.data=e.readBinary()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.data,"data"))}toString(){return this.data?(0,s.formatBuffer)(this.data,""):"[0]"}}t.ChannelDataMessage=p;class f extends o{get messageType(){return 96}}t.ChannelEofMessage=f;class g extends o{get messageType(){return 97}}t.ChannelCloseMessage=g,function(e){e.command="exec",e.shell="shell",e.terminal="pty-req",e.signal="signal",e.exitSignal="exit-signal",e.exitStatus="exit-status"}(u=t.ChannelRequestType||(t.ChannelRequestType={}));class m extends o{constructor(e,t){super(),this.requestType=e,this.wantReply=null!=t&&t}get messageType(){return 98}onRead(e){super.onRead(e),this.requestType=e.readString("ascii"),this.wantReply=e.readBoolean()}onWrite(e){void 0===this.recipientChannel&&(this.recipientChannel=0),super.onWrite(e),e.writeString(this.validateField(this.requestType,"request type"),"ascii"),e.writeBoolean(this.wantReply)}}t.ChannelRequestMessage=m,t.CommandRequestMessage=class extends m{constructor(){super(),this.requestType=u.command}onRead(e){super.onRead(e),this.command=e.readString("utf8")}onWrite(e){super.onWrite(e),e.writeString(this.validateField(this.command,"command"),"utf8")}toString(){return`${super.toString()} (requestType=${this.requestType})`}},t.ChannelSignalMessage=class extends m{constructor(){super()}get signal(){return this.signalValue}set signal(e){this.requestType=u.signal,this.signalValue=e}get exitSignal(){return this.signalValue}set exitSignal(e){this.requestType=u.exitSignal,this.signalValue=e}get errorMessage(){return this.errorMessageValue}set errorMessage(e){if(this.requestType!==u.exitSignal)throw new Error(`Error message property is only valid for ${u.exitSignal} messages.`);this.errorMessageValue=e}get exitStatus(){return this.statusValue}set exitStatus(e){this.requestType=u.exitStatus,this.statusValue=e}onRead(e){switch(super.onRead(e),this.requestType){case u.exitStatus:this.exitStatus=e.readUInt32();break;case u.signal:this.signal=e.readString("ascii");break;case u.exitSignal:this.exitSignal=e.readString("ascii"),e.readBoolean(),this.errorMessage=e.readString("utf8"),e.readString("ascii")}}onWrite(e){if(!this.requestType)throw new Error("Signal message request type not set.");switch(this.wantReply=!1,super.onWrite(e),this.requestType){case u.exitStatus:e.writeUInt32(this.validateField(this.exitStatus,"exit status"));break;case u.signal:e.writeString(this.validateField(this.signal,"signal"),"ascii");break;case u.exitSignal:e.writeString(this.validateField(this.exitSignal,"exit signal"),"ascii"),e.writeBoolean(!1),e.writeString(this.errorMessage||"","utf8"),e.writeString("","ascii");break;default:throw new Error(`Unknown signal message request type: ${this.requestType}`)}}};class y extends o{get messageType(){return 99}}t.ChannelSuccessMessage=y;class v extends o{get messageType(){return 100}}t.ChannelFailureMessage=v,n.SshMessage.index.set(90,a),n.SshMessage.index.set(91,c),n.SshMessage.index.set(92,h),n.SshMessage.index.set(93,d),n.SshMessage.index.set(94,p),n.SshMessage.index.set(96,f),n.SshMessage.index.set(97,g),n.SshMessage.index.set(98,m),n.SshMessage.index.set(99,y),n.SshMessage.index.set(100,v)},5255:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewKeysMessage=t.KeyExchangeDhReplyMessage=t.KeyExchangeDhInitMessage=t.KeyExchangeInitMessage=t.KeyExchangeMessage=void 0;const n=r(4300),s=r(6744),i=r(7521);class o extends s.SshMessage{}t.KeyExchangeMessage=o;class a extends o{get messageType(){return 20}onRead(e){this.cookie=e.read(16),this.keyExchangeAlgorithms=e.readList("ascii"),this.serverHostKeyAlgorithms=e.readList("ascii"),this.encryptionAlgorithmsClientToServer=e.readList("ascii"),this.encryptionAlgorithmsServerToClient=e.readList("ascii"),this.macAlgorithmsClientToServer=e.readList("ascii"),this.macAlgorithmsServerToClient=e.readList("ascii"),this.compressionAlgorithmsClientToServer=e.readList("ascii"),this.compressionAlgorithmsServerToClient=e.readList("ascii"),this.languagesClientToServer=e.readList("ascii"),this.languagesServerToClient=e.readList("ascii"),this.firstKexPacketFollows=e.readBoolean(),this.reserved=e.readUInt32()}onWrite(e){var t;this.cookie||(this.cookie=n.Buffer.alloc(16),i.SshAlgorithms.random.getBytes(this.cookie)),e.write(this.cookie),e.writeList(this.keyExchangeAlgorithms||[],"ascii"),e.writeList(this.serverHostKeyAlgorithms||[],"ascii"),e.writeList(this.encryptionAlgorithmsClientToServer||[],"ascii"),e.writeList(this.encryptionAlgorithmsServerToClient||[],"ascii"),e.writeList(this.macAlgorithmsClientToServer||[],"ascii"),e.writeList(this.macAlgorithmsServerToClient||[],"ascii"),e.writeList(this.compressionAlgorithmsClientToServer||[],"ascii"),e.writeList(this.compressionAlgorithmsServerToClient||[],"ascii"),e.writeList(this.languagesClientToServer||[],"ascii"),e.writeList(this.languagesServerToClient||[],"ascii"),e.writeBoolean(null!==(t=this.firstKexPacketFollows)&&void 0!==t&&t),e.writeUInt32(this.reserved||0)}static CreateNone(){const e=["none"],t=[""],r=new a;return r.cookie=n.Buffer.alloc(16),r.keyExchangeAlgorithms=e,r.serverHostKeyAlgorithms=e,r.encryptionAlgorithmsClientToServer=e,r.encryptionAlgorithmsServerToClient=e,r.macAlgorithmsClientToServer=e,r.macAlgorithmsServerToClient=e,r.compressionAlgorithmsClientToServer=e,r.compressionAlgorithmsServerToClient=e,r.languagesClientToServer=t,r.languagesServerToClient=t,r.rawBytes=r.toBuffer(),r}get allowsNone(){const e=e=>!0===(null==e?void 0:e.includes("none"));return e(this.keyExchangeAlgorithms)&&e(this.serverHostKeyAlgorithms)&&e(this.encryptionAlgorithmsClientToServer)&&e(this.encryptionAlgorithmsServerToClient)&&e(this.macAlgorithmsClientToServer)&&e(this.macAlgorithmsServerToClient)&&e(this.compressionAlgorithmsClientToServer)&&e(this.compressionAlgorithmsServerToClient)&&!0!==this.firstKexPacketFollows}}t.KeyExchangeInitMessage=a,a.none=a.CreateNone();class c extends o{get messageType(){return 30}onRead(e){this.e=e.readBinary()}onWrite(e){e.writeBinary(this.validateField(this.e,"E"))}}t.KeyExchangeDhInitMessage=c;class l extends o{get messageType(){return 31}onRead(e){this.hostKey=e.readBinary(),this.f=e.readBinary(),this.signature=e.readBinary()}onWrite(e){e.writeBinary(this.validateField(this.hostKey,"host key")),e.writeBinary(this.validateField(this.f,"F")),e.writeBinary(this.validateField(this.signature,"signature"))}}t.KeyExchangeDhReplyMessage=l;class u extends o{get messageType(){return 21}onRead(e){}onWrite(e){}}t.NewKeysMessage=u,s.SshMessage.index.set(20,a),s.SshMessage.index.set(30,c),s.SshMessage.index.set(31,l),s.SshMessage.index.set(21,u)},6744:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshMessage=void 0;const n=r(4300),s=r(7309);class i{get messageType(){return 0}toBuffer(){const e=new s.SshDataWriter(n.Buffer.alloc(16));return this.write(e),e.toBuffer()}read(e){this.rawBytes=e.buffer;const t=e.readByte();if(t!==this.messageType)throw new Error(`Message type ${t} is not valid.`);this.onRead(e)}write(e){this.rawBytes?e.write(this.rawBytes):(e.writeByte(this.messageType),this.onWrite(e))}rewrite(){if(this.rawBytes){const e=new s.SshDataWriter(n.Buffer.alloc(16));e.writeByte(this.messageType),this.onWrite(e),this.rawBytes=e.toBuffer()}}onRead(e){throw new Error("Not supported.")}onWrite(e){throw new Error("Not supported.")}validateField(e,t){if(void 0===e)throw new Error(`${this.constructor.name} ${t} is required.`);return e}toString(){return this.constructor.name}static create(e,t,r){const n=e.messages.get(t);if(n){const e=new n;return e.read(new s.SshDataReader(r)),e}return null}convertTo(e,t=!1){const r=new s.SshDataReader(t?n.Buffer.from(this.rawBytes):this.rawBytes);return e.read(r),e}}t.SshMessage=i,i.index=new Map},6306:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionReconnectFailureMessage=t.SshReconnectFailureReason=t.SessionReconnectResponseMessage=t.SessionReconnectRequestMessage=t.SessionChannelRequestMessage=t.ExtensionInfoMessage=t.SessionRequestFailureMessage=t.SessionRequestSuccessMessage=t.SessionRequestMessage=t.ServiceAcceptMessage=t.ServiceRequestMessage=t.DebugMessage=t.UnimplementedMessage=t.IgnoreMessage=t.DisconnectMessage=t.SshDisconnectReason=void 0;const n=r(6744),s=r(3379);var i,o;!function(e){e[e.none=0]="none",e[e.hostNotAllowedToConnect=1]="hostNotAllowedToConnect",e[e.protocolError=2]="protocolError",e[e.keyExchangeFailed=3]="keyExchangeFailed",e[e.reserved=4]="reserved",e[e.macError=5]="macError",e[e.compressionError=6]="compressionError",e[e.serviceNotAvailable=7]="serviceNotAvailable",e[e.protocolVersionNotSupported=8]="protocolVersionNotSupported",e[e.hostKeyNotVerifiable=9]="hostKeyNotVerifiable",e[e.connectionLost=10]="connectionLost",e[e.byApplication=11]="byApplication",e[e.tooManyConnections=12]="tooManyConnections",e[e.authCancelledByUser=13]="authCancelledByUser",e[e.noMoreAuthMethodsAvailable=14]="noMoreAuthMethodsAvailable",e[e.illegalUserName=15]="illegalUserName"}(i=t.SshDisconnectReason||(t.SshDisconnectReason={}));class a extends n.SshMessage{get messageType(){return 1}onRead(e){this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),e.available>=4?this.language=e.readString("ascii"):this.language=null}onWrite(e){e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),this.language&&e.writeString(this.language,"ascii")}toString(){return`${super.toString()} (${i[this.reasonCode||0]}: ${this.description})`}}t.DisconnectMessage=a;class c extends n.SshMessage{get messageType(){return 2}onRead(e){}onWrite(e){}}t.IgnoreMessage=c;class l extends n.SshMessage{get messageType(){return 3}onRead(e){this.sequenceNumber=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.sequenceNumber,"sequence number"))}toString(){return this.unimplementedMessageType?`${super.toString()} (messageType=${this.unimplementedMessageType})`:`${super.toString()} (sequenceNumber=${this.sequenceNumber})`}}t.UnimplementedMessage=l;class u extends n.SshMessage{constructor(e){super(),this.alwaysDisplay=!1,this.message=e}get messageType(){return 4}onRead(e){this.alwaysDisplay=e.readBoolean(),this.message=e.readString("utf8"),this.language=e.readString("ascii")}onWrite(e){var t,r;e.writeBoolean(this.alwaysDisplay),e.writeString(null!==(t=this.message)&&void 0!==t?t:"","utf8"),e.writeString(null!==(r=this.language)&&void 0!==r?r:"","ascii")}toString(){return`${super.toString()}: ${this.message}`}}t.DebugMessage=u;class h extends n.SshMessage{get messageType(){return 5}onRead(e){this.serviceName=e.readString("ascii")}onWrite(e){e.writeString(this.validateField(this.serviceName,"service name"),"ascii")}}t.ServiceRequestMessage=h;class d extends n.SshMessage{get messageType(){return 6}onRead(e){this.serviceName=e.readString("ascii")}onWrite(e){e.writeString(this.validateField(this.serviceName,"service name"),"ascii")}}t.ServiceAcceptMessage=d;class p extends n.SshMessage{constructor(e,t){super(),this.requestType=e,this.wantReply=null!=t&&t}get messageType(){return 80}onRead(e){this.requestType=e.readString("ascii"),this.wantReply=e.readBoolean()}onWrite(e){e.writeString(this.validateField(this.requestType,"request type"),"ascii"),e.writeBoolean(this.wantReply)}toString(){return`${super.toString()} (requestType=${this.requestType})`}}t.SessionRequestMessage=p;class f extends n.SshMessage{get messageType(){return 81}onRead(e){}onWrite(e){}}t.SessionRequestSuccessMessage=f;class g extends n.SshMessage{get messageType(){return 82}onRead(e){}onWrite(e){}}t.SessionRequestFailureMessage=g;class m extends n.SshMessage{constructor(){super(...arguments),this.extensionInfo={}}get messageType(){return 7}onRead(e){const t=e.readUInt32();this.extensionInfo={};for(let r=0;r<t;r++){const t=e.readString("ascii"),r=e.readString("utf8");this.extensionInfo[t]=r}}onWrite(e){const t=Object.keys(this.extensionInfo);e.writeUInt32(t.length);for(const r of t)e.writeString(r,"ascii"),e.writeString(this.extensionInfo[r]||"","utf8")}toString(){let e="";for(const[t,r]of Object.entries(this.extensionInfo))e&&(e+="; "),e+=t,r&&(e+="="+r);return`${super.toString()} (${e})`}}t.ExtensionInfoMessage=m,m.serverIndicator="ext-info-c",m.clientIndicator="ext-info-c",t.SessionChannelRequestMessage=class extends p{onRead(e){super.onRead(e),this.senderChannel=e.readUInt32();const t=new s.ChannelRequestMessage;t.read(e),this.request=t}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),this.validateField(this.request,"request message").write(e)}},t.SessionReconnectRequestMessage=class extends p{onRead(e){super.onRead(e),this.clientReconnectToken=e.readBinary(),this.lastReceivedSequenceNumber=e.readUInt64()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.clientReconnectToken,"clientReconnectToken")),e.writeUInt64(this.validateField(this.lastReceivedSequenceNumber,"lastReceivedSequenceNumber"))}},t.SessionReconnectResponseMessage=class extends f{onRead(e){super.onRead(e),this.serverReconnectToken=e.readBinary(),this.lastReceivedSequenceNumber=e.readUInt64()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.serverReconnectToken,"serverReconnectToken")),e.writeUInt64(this.validateField(this.lastReceivedSequenceNumber,"lastReceivedSequenceNumber"))}},function(e){e[e.none=0]="none",e[e.unknownServerFailure=1]="unknownServerFailure",e[e.sessionNotFound=2]="sessionNotFound",e[e.invalidClientReconnectToken=3]="invalidClientReconnectToken",e[e.serverDroppedMessages=4]="serverDroppedMessages",e[e.unknownClientFailure=101]="unknownClientFailure",e[e.differentServerHostKey=102]="differentServerHostKey",e[e.invalidServerReconnectToken=103]="invalidServerReconnectToken",e[e.clientDroppedMessages=104]="clientDroppedMessages"}(o=t.SshReconnectFailureReason||(t.SshReconnectFailureReason={})),t.SessionReconnectFailureMessage=class extends g{onRead(e){e.available>0&&(this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),this.language=e.readString("ascii"))}onWrite(e){e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),e.writeString(this.language||"en","ascii")}toString(){return`${super.toString()} (${o[this.reasonCode||0]}: ${this.description})`}},n.SshMessage.index.set(1,a),n.SshMessage.index.set(2,c),n.SshMessage.index.set(3,l),n.SshMessage.index.set(5,h),n.SshMessage.index.set(6,d),n.SshMessage.index.set(7,m),n.SshMessage.index.set(80,p),n.SshMessage.index.set(81,f),n.SshMessage.index.set(82,g)},8614:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelMetrics=void 0,t.ChannelMetrics=class{constructor(){this.bytesSentSum=0,this.bytesReceivedSum=0}get bytesSent(){return this.bytesSentSum}get bytesReceived(){return this.bytesReceivedSum}addBytesSent(e){this.bytesSentSum+=e}addBytesReceived(e){this.bytesReceivedSum+=e}toString(){return`Bytes S/R: ${this.bytesSent} / ${this.bytesReceived}; `}}},2750:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionContour=void 0;const n=r(4608),s=r(6655),i=r(7399);class o{constructor(e=256){if(this.intervalMs=o.initialInterval,this.count=0,this.updateQueue=new s.Queue,this.updateSemaphore=new i.Semaphore(0),this.disposed=!1,e<2||0!=(e&e-1))throw new Error("Contour intervals must be a power of two.");this.maxIntervals=e,this.intervalBytesSent=new Array(e),this.intervalBytesReceived=new Array(e),this.intervalLatencyMin=new Array(e),this.intervalLatencyMax=new Array(e),this.intervalLatencySum=new Array(e),this.intervalLatencyCount=new Array(e),this.intervalLatencyAvg=new Array(e),this.intervalBytesSent.fill(0),this.intervalBytesReceived.fill(0),this.intervalLatencyMin.fill(0),this.intervalLatencyMax.fill(0),this.intervalLatencySum.fill(0),this.intervalLatencyCount.fill(0),this.intervalLatencyAvg.fill(0)}get intervalCount(){return this.count}get interval(){return this.intervalMs}get bytesSent(){return this.intervalBytesSent.slice(0,this.count)}get bytesReceived(){return this.intervalBytesReceived.slice(0,this.count)}get latencyMinMs(){return this.intervalLatencyMin.slice(0,this.count)}get latencyMaxMs(){return this.intervalLatencyMax.slice(0,this.count)}get latencyAverageMs(){return this.intervalLatencyAvg.slice(0,this.count)}onMessageSent(e){this.updateQueue.enqueue({time:e.time,bytesSent:e.size}),this.updateSemaphore.tryRelease()}onMessageReceived(e){this.updateQueue.enqueue({time:e.time,bytesReceived:e.size}),this.updateSemaphore.tryRelease()}onLatencyUpdated(e){this.updateQueue.enqueue(e),this.updateSemaphore.tryRelease()}onSessionClosed(){this.updateSemaphore.tryRelease()}async collectMetrics(e,t){if(!e)throw new TypeError("A session metrics object is required.");if(this.disposed)throw new n.ObjectDisposedError(this);const r=[];r.push(e.onMessageSent(this.onMessageSent.bind(this))),r.push(e.onMessageReceived(this.onMessageReceived.bind(this))),r.push(e.onLatencyUpdated(this.onLatencyUpdated.bind(this))),r.push(e.onSessionClosed(this.onSessionClosed.bind(this)));try{for(;!(null==t?void 0:t.isCancellationRequested);){try{await this.updateSemaphore.wait(t)}catch(e){break}const e=this.updateQueue.dequeue();if(!e)break;const r=this.updateInterval(e.time);e.bytesSent&&(this.intervalBytesSent[r]+=e.bytesSent),e.bytesReceived&&(this.intervalBytesReceived[r]+=e.bytesReceived);const n=e.latency;n&&((!this.intervalLatencyMin[r]||n<this.intervalLatencyMin[r])&&(this.intervalLatencyMin[r]=n),(!this.intervalLatencyMax[r]||n>this.intervalLatencyMax[r])&&(this.intervalLatencyMax[r]=n),this.intervalLatencySum[r]+=n,this.intervalLatencyCount[r]++,this.intervalLatencyAvg[r]=this.intervalLatencySum[r]/this.intervalLatencyCount[r])}this.disposed&&this.updateSemaphore.dispose()}finally{for(const e of r)e.dispose()}}updateInterval(e){let t=Math.floor(e/this.intervalMs);if(t>=this.intervalCount){for(;t>=this.maxIntervals;)this.expandIntervals(),t=Math.floor(e/this.intervalMs);this.count=t+1}return t}expandIntervals(){const e=(e,t,r)=>0===e?t:0===t?e:r(e,t),t=this.maxIntervals/2;for(let r=0;r<t;r++){const t=2*r,n=2*r+1;this.intervalBytesSent[r]=this.intervalBytesSent[t]+this.intervalBytesSent[n],this.intervalBytesReceived[r]=this.intervalBytesReceived[t]+this.intervalBytesReceived[n],this.intervalLatencyMin[r]=e(this.intervalLatencyMin[t],this.intervalLatencyMin[n],Math.min),this.intervalLatencyMax[r]=e(this.intervalLatencyMax[t],this.intervalLatencyMax[n],Math.max),this.intervalLatencySum[r]=this.intervalLatencySum[t]+this.intervalLatencySum[n];const s=this.intervalLatencyCount[t]+this.intervalLatencyCount[n];this.intervalLatencyCount[r]=s,this.intervalLatencyAvg[r]=0===s?0:this.intervalLatencySum[r]/this.intervalLatencyCount[r]}this.intervalBytesSent.fill(0,t,this.maxIntervals),this.intervalBytesReceived.fill(0,t,this.maxIntervals),this.intervalLatencyMin.fill(0,t,this.maxIntervals),this.intervalLatencyMax.fill(0,t,this.maxIntervals),this.intervalLatencySum.fill(0,t,this.maxIntervals),this.intervalLatencyCount.fill(0,t,this.maxIntervals),this.intervalLatencyAvg.fill(0,t,this.maxIntervals),this.intervalMs*=2}dispose(){this.disposed=!0,this.updateSemaphore.tryRelease()}export(){const e=e=>Math.max(0,Math.ceil(Math.log2(Math.max(...e)/255))),t=(e,t)=>Math.round(e/Math.pow(2,t)),r=Buffer.alloc(3+5*(2+this.intervalCount)),n=Math.log2(this.interval/o.initialInterval);r[0]=1,r[1]=5,r[2]=n,r[3]=e(this.latencyMinMs),r[4]=e(this.latencyMaxMs),r[5]=e(this.latencyAverageMs),r[6]=e(this.bytesSent),r[7]=e(this.bytesReceived),r[8]=a.latencyMin,r[9]=a.latencyMax,r[10]=a.latencyAverage,r[11]=a.bytesSent,r[12]=a.bytesReceived;for(let e=0;e<this.intervalCount;e++){const n=13+5*e;r[n+0]=t(this.intervalLatencyMin[e],r[3]),r[n+1]=t(this.intervalLatencyMax[e],r[4]),r[n+2]=t(this.intervalLatencyAvg[e],r[5]),r[n+3]=t(this.intervalBytesSent[e],r[6]),r[n+4]=t(this.intervalBytesReceived[e],r[7])}return r.toString("base64")}static import(e){const t=Buffer.from(e,"base64");if(t.length<3)throw new Error("Invalid session contour string.");const r=t[0],n=t[1],s=t[2];if(1!==r)throw new Error(`Unsupported session contour version: ${r}`);const i=(t.length-3)/n-2;if(i<1||t.length!==3+n*(i+2))throw new Error("Incomplete session contour string.");const c=Math.pow(2,Math.ceil(Math.log2(i))),l=new o(c);l.intervalMs=Math.pow(2,s)*o.initialInterval,l.count=i;const u=new Array(n);for(let e=0;e<n;e++)u[e]=Math.pow(2,t[3+e]);const h=new Array(n);for(let e=0;e<n;e++)h[e]=t[3+n+e];for(let e=0;e<i;e++){const r=3+(2+e)*n;for(let s=0;s<n;s++)switch(h[s]){case a.latencyMin:l.intervalLatencyMin[e]=t[r+s]*u[s];break;case a.latencyMax:l.intervalLatencyMax[e]=t[r+s]*u[s];break;case a.latencyAverage:l.intervalLatencyAvg[e]=l.intervalLatencySum[e]=t[r+s]*u[s],l.intervalLatencyCount[e]=0===t[r+s]?0:1;break;case a.bytesSent:l.intervalBytesSent[e]=t[r+s]*u[s];break;case a.bytesReceived:l.intervalBytesReceived[e]=t[r+s]*u[s]}}return l}}var a;t.SessionContour=o,o.initialInterval=1e3,function(e){e[e.none=0]="none",e[e.latencyMin=1]="latencyMin",e[e.latencyMax=2]="latencyMax",e[e.latencyAverage=3]="latencyAverage",e[e.bytesSent=11]="bytesSent",e[e.bytesReceived=12]="bytesReceived"}(a||(a={}))},4340:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMetrics=void 0;const n=r(5844);t.SessionMetrics=class{constructor(){this.startTime=0,this.messagesSentCount=0,this.messagesReceivedCount=0,this.bytesSentSum=0,this.bytesReceivedSum=0,this.reconnectionsCount=0,this.currentLatency=0,this.minLatency=0,this.maxLatency=0,this.latencySum=0,this.latencyCount=0,this.messageSentEmitter=new n.Emitter,this.onMessageSent=this.messageSentEmitter.event,this.messageReceivedEmitter=new n.Emitter,this.onMessageReceived=this.messageReceivedEmitter.event,this.latencyUpdatedEmitter=new n.Emitter,this.onLatencyUpdated=this.latencyUpdatedEmitter.event,this.sessionClosedEmitter=new n.Emitter,this.onSessionClosed=this.sessionClosedEmitter.event,"object"==typeof performance&&"function"==typeof performance.now?Object.defineProperty(this,"time",{get:this.browserTime}):"object"==typeof process&&"function"==typeof process.hrtime&&Object.defineProperty(this,"time",{get:this.nodejsTime}),this.startTime=this.time}get time(){return Date.now()-this.startTime}browserTime(){return performance.now()-this.startTime}nodejsTime(){const[e,t]=process.hrtime();return 1e3*e+t/1e6-this.startTime}get messagesSent(){return this.messagesSentCount}get messagesReceived(){return this.messagesReceivedCount}get bytesSent(){return this.bytesSentSum}get bytesReceived(){return this.bytesReceivedSum}get reconnections(){return this.reconnectionsCount}get latencyAverageMs(){return 0===this.latencyCount?0:this.latencySum/this.latencyCount}get latencyMinMs(){return this.minLatency}get latencyMaxMs(){return this.maxLatency}get latencyCurrentMs(){return this.currentLatency}addMessageSent(e){this.messagesSentCount++,this.bytesSentSum+=e,this.messageSentEmitter.fire({time:this.time,size:e})}addMessageReceived(e){this.messagesReceivedCount++,this.bytesReceivedSum+=e,this.messageReceivedEmitter.fire({time:this.time,size:e})}addReconnection(){this.reconnectionsCount++}updateLatency(e){if(e<0)throw new Error("Measured latency cannot be negative.");this.currentLatency=e,0!==e&&((0===this.minLatency||e<this.minLatency)&&(this.minLatency=e),(0===this.maxLatency||e>this.maxLatency)&&(this.maxLatency=e),this.latencySum+=e,this.latencyCount++,this.latencyUpdatedEmitter.fire({time:this.time,latency:e}))}close(){this.currentLatency=0,this.sessionClosedEmitter.fire()}toString(){let e=`Messages S/R: ${this.messagesSent} / ${this.messagesReceived}; Bytes S/R: ${this.bytesSent} / ${this.bytesReceived}; Reconnections: ${this.reconnections}; `;const t=this.minLatency>=10?1:this.minLatency>=1?10:100;return this.maxLatency>0&&(e+=`Latency Min-Avg-Max: ${Math.round(this.minLatency*t)/t} - ${Math.round(this.latencySum/this.latencyCount*t)/t} - ${Math.round(this.maxLatency*t)/t} ms; `),this.currentLatency>0&&(e+=`Current Latency: ${Math.round(this.currentLatency*t)/t} ms; `),e}}},9141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiChannelStream=void 0;const n=r(5844),s=r(9273),i=r(6373),o=r(7492),a=r(9872),c=r(6306),l=r(6197),u=r(3379);t.MultiChannelStream=class{constructor(e){if(this.transportStream=e,this.disposed=!1,this.disposables=[],this.channelMaxWindowSize=s.SshChannel.defaultMaxWindowSize,this.closedEmitter=new n.Emitter,this.onClosed=this.closedEmitter.event,this.channelOpeningEmitter=new n.Emitter,this.onChannelOpening=this.channelOpeningEmitter.event,!e)throw new TypeError("transportStream is required.");const t=new a.SshSessionConfiguration(!1);this.session=new o.SshSession(t),this.session.onClosed(this.onSessionClosed,this,this.disposables),this.session.onChannelOpening(this.onSessionChannelOpening,this,this.disposables)}get trace(){return this.session.trace}set trace(e){this.session.trace=e}get isClosed(){return this.disposed||this.session.isClosed}async connect(e){await this.session.connect(this.transportStream,e)}async acceptChannel(e,t){return await this.session.connect(this.transportStream,t),await this.session.acceptChannel(e,t)}async acceptStream(e,t){return this.createStream(await this.acceptChannel(e,t))}async openChannel(e,t){await this.session.connect(this.transportStream,t);const r=new u.ChannelOpenMessage;return r.channelType=null!=e?e:s.SshChannel.sessionChannelType,r.maxWindowSize=this.channelMaxWindowSize,await this.session.openChannel(r,null,t)}async openStream(e,t){return this.createStream(await this.openChannel(e,t))}createStream(e){return new i.SshStream(e)}async connectAndRunUntilClosed(e){const t=[],r=new Promise(((r,n)=>{null==e||e.onCancellationRequested(n,null,t),this.session.onClosed(r,null,t)}));try{await this.connect(e),await r}finally{t.forEach((e=>e.dispose())),await this.close()}}dispose(){if(!this.disposed){this.disposed=!0,this.session.dispose(),this.unsubscribe();try{this.transportStream&&this.transportStream.close().catch((e=>{this.trace(l.TraceLevel.Error,l.SshTraceEventIds.streamCloseError,`Error closing transport stream: ${e.message}`,e)}))}catch(e){if(!(e instanceof Error))throw e;this.trace(l.TraceLevel.Error,l.SshTraceEventIds.streamCloseError,`Error closing transport stream: ${e.message}`,e)}}}async close(){this.disposed||(this.disposed=!0,await this.session.close(c.SshDisconnectReason.none,"SshSession disposed"),this.session.dispose(),this.unsubscribe(),await this.transportStream.close())}onSessionClosed(e){this.unsubscribe(),this.closedEmitter.fire(e)}onSessionChannelOpening(e){e.isRemoteRequest&&(e.channel.maxWindowSize=this.channelMaxWindowSize),this.channelOpeningEmitter.fire(e)}unsubscribe(){this.disposables.forEach((e=>e.dispose())),this.disposables=[]}}},3661:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PipeExtensions=void 0;const n=r(4300),s=r(5844),i=r(6306),o=r(3379),a=r(3305),c=r(4608);class l{static async pipeSession(e,t){if(!e)throw new TypeError("Session is required.");if(!t)throw new TypeError("Target session is required");const r=new a.PromiseCompletionSource;e.onRequest((e=>{e.responsePromise=l.forwardSessionRequest(e,t,e.cancellation)})),t.onRequest((t=>{t.responsePromise=l.forwardSessionRequest(t,e,t.cancellation)})),e.onChannelOpening((e=>{e.isRemoteRequest&&(e.openingPromise=l.forwardChannel(e,t,e.cancellation))})),t.onChannelOpening((t=>{t.isRemoteRequest&&(t.openingPromise=l.forwardChannel(t,e,t.cancellation))})),e.onClosed((e=>{r.resolve(l.forwardSessionClose(t,e))})),t.onClosed((t=>{r.resolve(l.forwardSessionClose(e,t))}));const n=await r.promise;await n}static async pipeChannel(e,t){if(!e)throw new TypeError("Channel is required.");if(!t)throw new TypeError("Target channel is required");const r=new a.PromiseCompletionSource;let n=!1;e.onRequest((e=>{e.responsePromise=l.forwardChannelRequest(e,t,e.cancellation)})),t.onRequest((t=>{t.responsePromise=l.forwardChannelRequest(t,e,t.cancellation)})),e.onDataReceived((r=>{l.forwardData(e,t,r).catch()})),t.onDataReceived((r=>{l.forwardData(t,e,r).catch()})),e.onClosed((e=>{n||(n=!0,r.resolve(l.forwardChannelClose(t,e)))})),t.onClosed((t=>{n||(n=!0,r.resolve(l.forwardChannelClose(e,t)))}));const s=await r.promise;await s}static async forwardSessionRequest(e,t,r){return e.request.wantReply?t.requestResponse(e.request,i.SessionRequestSuccessMessage,i.SessionRequestFailureMessage,r):t.request(e.request,r).then((()=>new i.SessionRequestSuccessMessage))}static async forwardChannel(e,t,r){var n;try{const n=await t.openChannel(e.request,null,r);return l.pipeChannel(e.channel,n).catch(),new o.ChannelOpenConfirmationMessage}catch(e){if(!(e instanceof Error))throw e;const t=new o.ChannelOpenFailureMessage;return e instanceof c.SshChannelError?t.reasonCode=null!==(n=e.reason)&&void 0!==n?n:o.SshChannelOpenFailureReason.connectFailed:t.reasonCode=o.SshChannelOpenFailureReason.connectFailed,t.description=e.message,t}}static async forwardChannelRequest(e,t,r){return e.request.recipientChannel=t.remoteChannelId,await t.request(e.request,r)?new o.ChannelSuccessMessage:new o.ChannelFailureMessage}static async forwardSessionClose(e,t){var r;return e.close(t.reason,t.message,null!==(r=t.error)&&void 0!==r?r:void 0)}static async forwardData(e,t,r){const i=n.Buffer.alloc(r.length);r.copy(i);const o=t.send(i,s.CancellationToken.None);return e.adjustWindow(i.length),o}static async forwardChannelClose(e,t){return t.error?(e.close(t.error),Promise.resolve()):t.exitSignal?e.close(t.exitSignal,t.errorMessage):"number"==typeof t.exitStatus?e.close(t.exitStatus):e.close()}}t.PipeExtensions=l},3868:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecureStream=void 0;const n=r(5844),s=r(3538),i=r(6373),o=r(9872),a=r(6306),c=r(6197),l=r(5706),u=r(7331),h=r(4608),d=r(2781),p=r(3305);class f extends d.Duplex{constructor(e,t){if(super({write(e,t,r){this.connectCompletion.promise.then((n=>{n._write(e,t,r)}),r)},writev(e,t){this.connectCompletion.promise.then((r=>{r._writev(e,t)}),t)},final(e){this.connectCompletion.promise.then((t=>{t._final(e)}),e)},read(e){this.connectCompletion.promise.then((t=>{t._read(e)}),(e=>{}))}}),this.transportStream=e,this.clientCredentials=null,this.serverCredentials=null,this.connectCompletion=new p.PromiseCompletionSource,this.disposed=!1,this.disposables=[],this.closedEmitter=new n.Emitter,this.onClosed=this.closedEmitter.event,!e)throw new TypeError("A transport stream is required.");if(!t)throw new TypeError("Client or server credentials are required.");const r=new o.SshSessionConfiguration(!0);if("username"in t)this.clientCredentials=t,this.session=new l.SshClientSession(r);else{if(!t.publicKeys)throw new TypeError("Client or server credentials are required.");this.serverCredentials=t,this.session=new u.SshServerSession(r)}this.session.onClosed(this.onSessionClosed,this,this.disposables)}get trace(){return this.session.trace}set trace(e){this.session.trace=e}get isClosed(){return this.disposed||this.session.isClosed}onAuthenticating(e,t,r){return this.session.onAuthenticating(e,t,r)}async connect(e){try{this.serverCredentials&&(this.session.credentials=this.serverCredentials);let t=this.transportStream;t instanceof d.Duplex&&(t=new s.NodeStream(t)),await this.session.connect(t,e);let r=null;if(this.clientCredentials){const t=this.session;if(!await t.authenticateServer(e))throw new h.SshConnectionError("Server authentication failed.",a.SshDisconnectReason.hostKeyNotVerifiable);if(!await t.authenticateClient(this.clientCredentials,e))throw new h.SshConnectionError("Client authentication failed.",a.SshDisconnectReason.noMoreAuthMethodsAvailable);r=await this.session.openChannel(e)}else r=await this.session.acceptChannel(e);this.stream=this.createStream(r),this.stream.on("data",(e=>this.emit("data",e))),this.stream.on("end",(()=>this.emit("end"))),this.stream.on("close",(()=>this.emit("close"))),this.stream.on("error",(()=>this.emit("error"))),r.onClosed((()=>this.dispose())),this.connectCompletion.resolve(this.stream)}catch(e){if(!(e instanceof Error))throw e;let t=e instanceof h.SshConnectionError?e.reason:void 0;throw null!=t||(t=a.SshDisconnectReason.protocolError),await this.session.close(t,e.message,e),this.connectCompletion.reject(e),e}}createStream(e){return new i.SshStream(e)}dispose(){if(!this.disposed){this.disposed=!0,this.session.dispose(),this.unsubscribe();try{this.transportStream&&(this.transportStream instanceof d.Duplex?(this.transportStream.end(),this.transportStream.destroy()):this.transportStream.close().catch((e=>{this.trace(c.TraceLevel.Error,c.SshTraceEventIds.streamCloseError,`Error closing transport stream: ${e.message}`,e)})))}catch(e){if(!(e instanceof Error))throw e;this.trace(c.TraceLevel.Error,c.SshTraceEventIds.streamCloseError,`Error closing transport stream: ${e.message}`,e)}}}async close(){this.disposed||(this.disposed=!0,await this.session.close(a.SshDisconnectReason.none,"SshSession disposed"),this.session.dispose(),this.unsubscribe(),this.transportStream instanceof d.Duplex?await new Promise((e=>{this.transportStream.end(e)})):await this.transportStream.close())}onSessionClosed(e){this.unsubscribe(),this.closedEmitter.fire(e)}unsubscribe(){this.disposables.forEach((e=>e.dispose())),this.disposables=[]}}t.SecureStream=f},5263:function(e,t,r){"use strict";var n,s=this&&this.__decorate||function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationService=void 0;const i=r(1838),o=r(6892),a=r(5844),c=r(7309),l=r(6306),u=r(3314),h=r(3193),d=r(4865),p=r(6655),f=r(6197);let g=n=class extends i.SshService{constructor(e){var t;super(e),this.authenticationFailureCount=0,this.disposeCancellationSource=new a.CancellationTokenSource;const r=null===(t=e.algorithms)||void 0===t?void 0:t.publicKeyAlgorithmName;if(!r)throw new Error("Algorithms not initialized.");this.publicKeyAlgorithmName=r}handleMessage(e,t){if(e instanceof o.AuthenticationSuccessMessage)return this.handleSuccessMessage(e);if(e instanceof o.AuthenticationFailureMessage)return this.handleFailureMessage(e);if(e instanceof o.AuthenticationRequestMessage)return this.handleAuthenticationRequestMessage(e,t);throw new Error(`Message not implemented: ${e}`)}async handleAuthenticationRequestMessage(e,t){if(this.trace(f.TraceLevel.Info,f.SshTraceEventIds.sessionAuthenticating,`Authentication request: ${e.methodName}`),"publickey"===e.methodName||"hostbased"===e.methodName)return this.handlePublicKeyRequestMessage(e.convertTo(new o.PublicKeyRequestMessage),t);if("password"===e.methodName)return this.handlePasswordRequestMessage(e.convertTo(new o.PasswordRequestMessage),t);if("none"===e.methodName)return this.handleAuthenticating(e,new u.SshAuthenticatingEventArgs(u.SshAuthenticationType.clientNone,{username:e.username},t));{const e=new o.AuthenticationFailureMessage;e.methodNames=["publickey","password","hostbased"],await this.session.sendMessage(e,t)}}async handlePublicKeyRequestMessage(e,t){var r,n,s;const i=this.session.config.getPublicKeyAlgorithm(e.keyAlgorithmName);if(!i){const e=new o.AuthenticationFailureMessage;return e.methodNames=["publickey","password"],void await this.session.sendMessage(e,t)}const a=i.createKeyPair();let l;if(await a.setPublicKeyBytes(e.publicKey),"hostbased"===e.methodName)l=new u.SshAuthenticatingEventArgs(u.SshAuthenticationType.clientHostBased,{username:null!==(r=e.username)&&void 0!==r?r:"",publicKey:a,clientHostname:e.clientHostname,clientUsername:e.clientUsername});else if(e.hasSignature){const r=i.readSignatureData(e.signature),n=this.session.sessionId;if(null==n)throw new Error("Session ID not initialized.");const o=new c.SshDataWriter(Buffer.alloc(n.length+e.payloadWithoutSignature.length+20));o.writeBinary(n),o.write(e.payloadWithoutSignature);const h=o.toBuffer(),d=i.createVerifier(a);await d.verify(h,r)||await this.handleAuthenticationFailure("Public key authentication failed: invalid signature.",t),l=new u.SshAuthenticatingEventArgs(u.SshAuthenticationType.clientPublicKey,{username:null!==(s=e.username)&&void 0!==s?s:"",publicKey:a})}else l=new u.SshAuthenticatingEventArgs(u.SshAuthenticationType.clientPublicKeyQuery,{username:null!==(n=e.username)&&void 0!==n?n:"",publicKey:a});await this.handleAuthenticating(e,l,t)}async handlePasswordRequestMessage(e,t){var r,n;const s=new u.SshAuthenticatingEventArgs(u.SshAuthenticationType.clientPassword,{username:null!==(r=e.username)&&void 0!==r?r:"",password:null!==(n=e.password)&&void 0!==n?n:""});await this.handleAuthenticating(e,s,t)}async handleAuthenticating(e,t,r){var n;t.cancellation=this.disposeCancellationSource.token;let s=null;try{s=await this.session.raiseAuthenticatingEvent(t)}catch(e){if(!(e instanceof Error))throw e;this.trace(f.TraceLevel.Error,f.SshTraceEventIds.authenticationError,`Error while authenticating client: ${e.message}`,e),s=null}if(s)if(t.authenticationType===u.SshAuthenticationType.clientPublicKeyQuery){const t=e,n=new o.PublicKeyOKMessage;n.keyAlgorithmName=t.keyAlgorithmName,n.publicKey=t.publicKey,await this.session.sendMessage(n,r)}else this.session.principal=s,e.serviceName&&this.session.activateService(e.serviceName),this.trace(f.TraceLevel.Info,f.SshTraceEventIds.sessionAuthenticated,`${u.SshAuthenticationType[t.authenticationType]} authentication succeeded.`),await this.session.sendMessage(new o.AuthenticationSuccessMessage,r),null===(n=this.session)||void 0===n||n.handleClientAuthenticated();else await this.handleAuthenticationFailure(`${u.SshAuthenticationType[t.authenticationType]} authentication failed.`)}async handleAuthenticationFailure(e,t){this.authenticationFailureCount++,this.trace(f.TraceLevel.Warning,f.SshTraceEventIds.clientAuthenticationFailed,e);const r=new o.AuthenticationFailureMessage;r.methodNames=["publickey","password","hostbased"],await this.session.sendMessage(r,t),this.authenticationFailureCount>=this.session.config.maxClientAuthenticationAttempts&&await this.session.close(l.SshDisconnectReason.noMoreAuthMethodsAvailable,"Authentication failed.")}async authenticateClient(e,t){var r,n,s,i;this.clientAuthenticationMethods=new p.Queue;for(const t of null!==(r=e.publicKeys)&&void 0!==r?r:[]){if(!t)continue;const r=null!==(n=e.username)&&void 0!==n?n:"";let s=t;const i=e.privateKeyProvider;this.clientAuthenticationMethods.enqueue((async e=>{if(!s.hasPrivateKey){if(null==i)throw new Error("A private key provider is required.");s=await i(t,null!=e?e:a.CancellationToken.None)}s?await this.requestPublicKeyAuthentication(r,s,e):await this.session.close(l.SshDisconnectReason.authCancelledByUser)}))}const o=e.passwordProvider;if(o)this.clientAuthenticationMethods.enqueue((async e=>{var t;const r=o(null!=e?e:a.CancellationToken.None),n=r?await r:null;n?await this.requestPasswordAuthentication(null!==(t=n[0])&&void 0!==t?t:"",n[1],e):await this.session.close(l.SshDisconnectReason.authCancelledByUser)}));else if(e.password){const t=null!==(s=e.username)&&void 0!==s?s:"",r=e.password;this.clientAuthenticationMethods.enqueue((async e=>{await this.requestPasswordAuthentication(t,r,e)}))}if(0===this.clientAuthenticationMethods.size){const t=null!==(i=e.username)&&void 0!==i?i:"";this.clientAuthenticationMethods.enqueue((async e=>{await this.requestUsernameAuthentication(t,e)}))}const c=this.clientAuthenticationMethods.dequeue();await c(t)}async requestUsernameAuthentication(e,t){const r=new o.AuthenticationRequestMessage;r.serviceName=h.ConnectionService.serviceName,r.methodName="none",r.username=e,await this.session.sendMessage(r,t),this.session.activateService(h.ConnectionService)}async requestPublicKeyAuthentication(e,t,r){const n=this.session.config.publicKeyAlgorithms.find((e=>(null==e?void 0:e.keyAlgorithmName)===t.keyAlgorithmName));if(!n)throw new Error(`Public key algorithm '${t.keyAlgorithmName}' is not in session config.`);const s=new o.PublicKeyRequestMessage;s.serviceName=h.ConnectionService.serviceName,s.username=e,s.keyAlgorithmName=n.name,s.publicKey=await t.getPublicKeyBytes(n.name),s.signature=await this.createAuthenticationSignature(s,n,t),await this.session.sendMessage(s,r),0===this.clientAuthenticationMethods.size&&this.session.activateService(h.ConnectionService)}async requestPasswordAuthentication(e,t,r){const n=new o.PasswordRequestMessage;n.serviceName=h.ConnectionService.serviceName,n.username=e,n.password=t,await this.session.sendMessage(n,r),this.session.activateService(h.ConnectionService)}handleFailureMessage(e){this.session.onAuthenticationComplete(!1)}handleSuccessMessage(e){this.session.activateService(h.ConnectionService),this.session.onAuthenticationComplete(!0)}async createAuthenticationSignature(e,t,r){const n=this.session.sessionId;if(null==n)throw new Error("Session ID not initialized.");const s=new c.SshDataWriter(Buffer.alloc(e.publicKey.length+(e.username||"").length+400));s.writeBinary(n),s.writeByte(e.messageType),s.writeString(e.username||"","utf8"),s.writeString(e.serviceName||"","ascii"),s.writeString("publickey","ascii"),s.writeBoolean(!0),s.writeString(e.keyAlgorithmName,"ascii"),s.writeBinary(e.publicKey);const i=t.createSigner(r),o=await i.sign(s.toBuffer());return t.createSignatureData(o)}dispose(){try{this.disposeCancellationSource.cancel(),this.disposeCancellationSource.dispose()}catch(e){}super.dispose()}};g.serviceName="ssh-userauth",g=n=s([(0,d.serviceActivation)({serviceRequest:n.serviceName})],g),t.AuthenticationService=g},3193:function(e,t,r){"use strict";var n,s=this&&this.__decorate||function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionService=void 0;const i=r(1838),o=r(3379),a=r(3305),c=r(9273),l=r(9638),u=r(4608),h=r(7776),d=r(4865),p=r(6197);let f=n=class extends i.SshService{constructor(e){super(e),this.channelCounter=0,this.channelMap=new Map,this.nonAcceptedChannels=new Map,this.pendingChannels=new Map,this.pendingAcceptChannels=new Map}get channels(){return Array.from(this.channelMap.values())}close(e){let t=[...this.pendingChannels.values()].map((e=>e.completionSource));this.pendingAcceptChannels.size>0&&(t=t.concat([...this.pendingAcceptChannels.values()].reduce(((e,t)=>e.concat(t)))));for(const t of this.channelMap.values())t.close(e);for(const r of t)r.reject(e)}dispose(){const e=[...this.channelMap.values()];let t=[...this.pendingChannels.values()].map((e=>e.completionSource));this.pendingAcceptChannels.size>0&&(t=t.concat([...this.pendingAcceptChannels.values()].reduce(((e,t)=>e.concat(t)))));for(const t of e)t.dispose();for(const e of t)e.reject(new u.SshConnectionError("Session closed."));super.dispose()}async acceptChannel(e,t){const r=new a.PromiseCompletionSource;let n;if(t){if(t.isCancellationRequested)throw new l.CancellationError;n=t.onCancellationRequested((()=>{const t=this.pendingAcceptChannels.get(e);if(t){const e=t.findIndex((e=>Object.is(e,r)));e>=0&&t.splice(e,1)}r.reject(new l.CancellationError)}))}let s=null;if(s=Array.from(this.nonAcceptedChannels.values()).find((t=>t.channelType===e))||null,s)this.nonAcceptedChannels.delete(s.channelId);else{let t=this.pendingAcceptChannels.get(e);t||(t=[],this.pendingAcceptChannels.set(e,t)),t.push(r)}try{return s||await r.promise}finally{n&&n.dispose()}}async openChannel(e,t,r){const n=++this.channelCounter;e.senderChannel=n;let s=null;if(r){if(r.isCancellationRequested)throw new l.CancellationError;s=r.onCancellationRequested((()=>{this.pendingChannels.delete(n)&&t.reject(new l.CancellationError)}))}return this.pendingChannels.set(n,{openMessage:e,completionSource:t,cancellationRegistration:s}),await this.session.sendMessage(e),n}handleMessage(e,t){if(e instanceof o.ChannelDataMessage)return this.handleDataMessage(e);if(e instanceof o.ChannelWindowAdjustMessage)return this.handleAdjustWindowMessage(e);if(e instanceof o.ChannelEofMessage)return this.handleEofMessage(e);if(e instanceof o.ChannelOpenMessage)return this.handleOpenMessage(e,t);if(e instanceof o.ChannelCloseMessage)return this.handleCloseMessage(e);if(e instanceof o.ChannelOpenConfirmationMessage)return this.handleOpenConfirmationMessage(e,t);if(e instanceof o.ChannelOpenFailureMessage)return this.handleOpenFailureMessage(e);if(e instanceof o.ChannelRequestMessage)return this.handleRequestMessage(e,t);if(e instanceof o.ChannelSuccessMessage)return this.handleSuccessMessage(e);if(e instanceof o.ChannelFailureMessage)return this.handleFailureMessage(e);throw new Error(`Message not implemented: ${e}`)}async handleOpenMessage(e,t){var r;const n=e.senderChannel;if(!this.session.canAcceptRequests){this.trace(p.TraceLevel.Warning,p.SshTraceEventIds.channelOpenFailed,"Channel open request blocked because the session is not yet authenticated.");const e=new o.ChannelOpenFailureMessage;return e.recipientChannel=n,e.reasonCode=o.SshChannelOpenFailureReason.administrativelyProhibited,e.description="Authenticate before opening channels.",void await this.session.sendMessage(e,t)}if(!e.channelType){const e=new o.ChannelOpenFailureMessage;return e.recipientChannel=n,e.reasonCode=o.SshChannelOpenFailureReason.unknownChannelType,e.description="Channel type not specified.",void await this.session.sendMessage(e,t)}e=e.convertTo(new o.ChannelOpenMessage,!0);let s=new o.ChannelOpenConfirmationMessage;const i=++this.channelCounter,a=new c.SshChannel(this,e.channelType,i,n,e.maxWindowSize,e.maxPacketSize,e,s);let l;const u=new h.SshChannelOpeningEventArgs(e,a,!0);try{if(await this.session.handleChannelOpening(u,t),u.openingPromise)l=await u.openingPromise;else if(u.failureReason!==o.SshChannelOpenFailureReason.none){const e=new o.ChannelOpenFailureMessage;e.reasonCode=u.failureReason,e.description=null!==(r=u.failureDescription)&&void 0!==r?r:void 0,l=e}else l=s}catch(e){throw a.dispose(),e}if(l instanceof o.ChannelOpenFailureMessage){l.recipientChannel=n;try{await this.session.sendMessage(l,t)}finally{a.dispose()}return}if(this.session.isClosed)return void a.dispose();a.isMaxWindowSizeLocked=!0,this.channelMap.set(a.channelId,a),s=l,s.recipientChannel=a.remoteChannelId,s.senderChannel=a.channelId,s.maxWindowSize=a.maxWindowSize,s.maxPacketSize=a.maxPacketSize,s.rewrite(),a.openConfirmationMessage=s,await this.session.sendMessage(s,t);let d=!1;const f=this.pendingAcceptChannels.get(a.channelType);for(;f&&f.length>0;){f.shift().resolve(a),d=!0;break}d||this.nonAcceptedChannels.set(a.channelId,a),this.onChannelOpenCompleted(a.channelId,a),a.enableSending()}handleCloseMessage(e){const t=this.tryGetChannelForMessage(e);t&&t.handleClose()}async handleOpenConfirmationMessage(e,t){var r;let n,s=null;const i=this.pendingChannels.get(e.recipientChannel);if(!i)throw this.channelMap.has(e.recipientChannel)?new Error("Duplicate channel ID."):new Error("Channel confirmation was not requested.");n=i.openMessage,s=i.completionSource,i.cancellationRegistration&&i.cancellationRegistration.dispose(),this.pendingChannels.delete(e.recipientChannel),e=e.convertTo(new o.ChannelOpenConfirmationMessage,!0);const a=new c.SshChannel(this,n.channelType||c.SshChannel.sessionChannelType,e.recipientChannel,e.senderChannel,e.maxWindowSize,e.maxPacketSize,n,e);"number"==typeof n.maxWindowSize&&(a.maxWindowSize=n.maxWindowSize),a.isMaxWindowSizeLocked=!0,this.channelMap.set(a.channelId,a);const l=new h.SshChannelOpeningEventArgs(n,a,!1);if(await this.session.handleChannelOpening(l,t),s){if(l.failureReason!==o.SshChannelOpenFailureReason.none)return void s.reject(new u.SshChannelError(null!==(r=l.failureDescription)&&void 0!==r?r:"Channel open failure.",l.failureReason));s.resolve(a)}else this.onChannelOpenCompleted(a.channelId,a);a.enableSending()}handleOpenFailureMessage(e){let t=null;const r=this.pendingChannels.get(e.recipientChannel);r&&(t=r.completionSource,r.cancellationRegistration&&r.cancellationRegistration.dispose(),this.pendingChannels.delete(e.recipientChannel)),null!=t?t.reject(new u.SshChannelError(e.description||"Channel open rejected.",e.reasonCode)):this.onChannelOpenCompleted(e.recipientChannel,null)}async handleRequestMessage(e,t){const r=this.tryGetChannelForMessage(e);r&&await r.handleRequest(e,t)}handleSuccessMessage(e){const t=this.tryGetChannelForMessage(e);null==t||t.handleResponse(!0)}handleFailureMessage(e){const t=this.tryGetChannelForMessage(e);null==t||t.handleResponse(!1)}handleDataMessage(e){const t=this.tryGetChannelForMessage(e);null==t||t.handleDataReceived(e.data)}handleAdjustWindowMessage(e){const t=this.tryGetChannelForMessage(e);null==t||t.adjustRemoteWindow(e.bytesToAdd)}handleEofMessage(e){const t=this.tryGetChannelForMessage(e);null==t||t.handleEof()}onChannelOpenCompleted(e,t){t?this.trace(p.TraceLevel.Info,p.SshTraceEventIds.channelOpened,`${this.session} ChannelOpenCompleted(${t})`):this.trace(p.TraceLevel.Warning,p.SshTraceEventIds.channelOpenFailed,`${this.session} ChannelOpenCompleted(${e} failed)`)}tryGetChannelForMessage(e){const t=this.findChannelById(e.recipientChannel);return t||(e instanceof o.ChannelDataMessage||e.toString(),this.trace(p.TraceLevel.Warning,p.SshTraceEventIds.channelRequestFailed,`Invalid channel ID ${e.recipientChannel} in {messageString}.`)),t}findChannelById(e){var t;return null!==(t=this.channelMap.get(e))&&void 0!==t?t:null}removeChannel(e){this.channelMap.delete(e.channelId),this.pendingChannels.delete(e.channelId)}};f.serviceName="ssh-connection",f=n=s([(0,d.serviceActivation)({serviceRequest:n.serviceName})],f),t.ConnectionService=f},4237:function(e,t,r){"use strict";var n,s=this&&this.__decorate||function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyExchangeService=void 0;const i=r(4300),o=r(7492),a=r(1838),c=r(3380),l=r(5255),u=r(7521),h=r(7309),d=r(4608),p=r(6306),f=r(890),g=r(5844),m=r(3193),y=r(4865),v=r(6197);class w{}const S="ext-info-s",b="ext-info-c";let _=n=class extends a.SshService{constructor(e,t){super(e),this.isClientSession=t,this.isInitialExchange=!1,this.exchangeContext=null}get exchanging(){return!!this.exchangeContext}async startKeyExchange(e){this.isInitialExchange=e,this.exchangeContext=new w;const t=this.createKeyExchangeInitMessage();let r=null;return this.isClientSession?(e&&this.session.config.enableKeyExchangeGuess&&(r=await this.createKeyExchangeGuessMessage(),t.firstKexPacketFollows=!!r),this.exchangeContext.clientKexInitPayload=t.toBuffer()):this.exchangeContext.serverKexInitPayload=t.toBuffer(),[t,r]}finishKeyExchange(){const e=this.exchangeContext.newAlgorithms;return this.exchangeContext=null,e}abortKeyExchange(){this.exchangeContext=null}createKeyExchangeInitMessage(){const e=this.isClientSession?b:S,t=this.session.config,r=new l.KeyExchangeInitMessage;return r.keyExchangeAlgorithms=(0,u.algorithmNames)(t.keyExchangeAlgorithms).concat(e),r.serverHostKeyAlgorithms=this.getPublicKeyAlgorithms(),r.encryptionAlgorithmsClientToServer=r.encryptionAlgorithmsServerToClient=(0,u.algorithmNames)(t.encryptionAlgorithms),r.macAlgorithmsClientToServer=r.macAlgorithmsServerToClient=(0,u.algorithmNames)(t.hmacAlgorithms),r.compressionAlgorithmsClientToServer=r.compressionAlgorithmsServerToClient=(0,u.algorithmNames)(t.compressionAlgorithms),r.languagesClientToServer=[""],r.languagesServerToClient=[""],r.firstKexPacketFollows=!1,r.reserved=0,r}getPublicKeyAlgorithms(){var e,t;let r=[...this.session.config.publicKeyAlgorithms];if(r.length>1&&!this.isClientSession){const n=null===(t=null===(e=this.session.credentials)||void 0===e?void 0:e.publicKeys)||void 0===t?void 0:t.map((e=>e.keyAlgorithmName));n&&(r=r.filter((e=>e&&n.includes(e.keyAlgorithmName))))}return(0,u.algorithmNames)(r)}async createKeyExchangeGuessMessage(){if(!this.exchangeContext)throw new Error("Key exchange was not started.");const e=this.session.config.keyExchangeAlgorithms[0];if(!e)return null;this.exchangeContext.keyExchange=e.name,this.exchangeContext.exchange=e.createKeyExchange(),this.exchangeContext.exchangeValue=await this.exchangeContext.exchange.startKeyExchange();const t=new l.KeyExchangeDhInitMessage;return t.e=this.exchangeContext.exchangeValue,t}handleMessage(e,t){if(e instanceof l.KeyExchangeInitMessage)return this.handleInitMessage(e,t);if(e instanceof l.KeyExchangeDhInitMessage)return this.handleDhInitMessage(e,t);if(e instanceof l.KeyExchangeDhReplyMessage)return this.handleDhReplyMessage(e,t);throw new Error(`Message not implemented: ${e}`)}async handleInitMessage(e,t){var r,n;if(!this.exchangeContext)throw new Error("Key exchange was not started.");const s=this.session.config;if(this.exchangeContext.keyExchange=this.chooseAlgorithm("KeyExchange",(0,u.algorithmNames)(s.keyExchangeAlgorithms),e.keyExchangeAlgorithms),"none"===this.exchangeContext.keyExchange)return this.trace(v.TraceLevel.Info,v.SshTraceEventIds.algorithmNegotiation,"Client and server negotiated no security. Cancelling key-exchange."),this.session.activateService(m.ConnectionService),this.exchangeContext.newAlgorithms=new f.SshSessionAlgorithms,void await this.session.handleNewKeysMessage(new l.NewKeysMessage,t);let i;if(this.exchangeContext.publicKey=this.chooseAlgorithm("PublicKey",this.getPublicKeyAlgorithms(),e.serverHostKeyAlgorithms),this.exchangeContext.clientEncryption=this.chooseAlgorithm("ClientEncryption",(0,u.algorithmNames)(s.encryptionAlgorithms),e.encryptionAlgorithmsClientToServer),this.exchangeContext.serverEncryption=this.chooseAlgorithm("ServerEncryption",(0,u.algorithmNames)(s.encryptionAlgorithms),e.encryptionAlgorithmsServerToClient),this.exchangeContext.clientHmac=this.chooseAlgorithm("ClientHmac",(0,u.algorithmNames)(s.hmacAlgorithms),e.macAlgorithmsClientToServer),this.exchangeContext.serverHmac=this.chooseAlgorithm("ServerHmac",(0,u.algorithmNames)(s.hmacAlgorithms),e.macAlgorithmsServerToClient),this.exchangeContext.clientCompression=this.chooseAlgorithm("ClientCompression",(0,u.algorithmNames)(s.compressionAlgorithms),e.compressionAlgorithmsClientToServer),this.exchangeContext.serverCompression=this.chooseAlgorithm("ServerCompression",(0,u.algorithmNames)(s.compressionAlgorithms),e.compressionAlgorithmsServerToClient),this.isClientSession){this.exchangeContext.serverKexInitPayload=e.toBuffer();const n=!!this.exchangeContext.exchangeValue,o=this.exchangeContext.keyExchange===(null===(r=s.keyExchangeAlgorithms[0])||void 0===r?void 0:r.name);if(!n||!o){const e=s.getKeyExchangeAlgorithm(this.exchangeContext.keyExchange);this.exchangeContext.exchange=e.createKeyExchange(),this.exchangeContext.exchangeValue=await this.exchangeContext.exchange.startKeyExchange();const r=new l.KeyExchangeDhInitMessage;r.e=this.exchangeContext.exchangeValue,await this.session.sendMessage(r,t)}i=S}else{if(e.firstKexPacketFollows){const t=this.exchangeContext.keyExchange===(null===(n=e.keyExchangeAlgorithms)||void 0===n?void 0:n[0]),r=t?"correct":"incorrect";this.trace(v.TraceLevel.Verbose,v.SshTraceEventIds.algorithmNegotiation,`Client's KeyExchange guess was ${r}.`),this.exchangeContext.discardGuessedInit=!t}this.exchangeContext.clientKexInitPayload=e.toBuffer(),i=b}this.isInitialExchange&&e.keyExchangeAlgorithms.includes(i)&&await this.session.sendExtensionInfo(t)}async handleDhInitMessage(e,t){var r,n,s,o,a;if(this.isClientSession)return;const c=this.session;if(!this.exchangeContext||!this.exchangeContext.keyExchange||!this.exchangeContext.publicKey)throw new d.SshConnectionError("Key exchange not started.",p.SshDisconnectReason.protocolError);if(this.exchangeContext.discardGuessedInit)return void(this.exchangeContext.discardGuessedInit=!1);const u=this.session.config.getKeyExchangeAlgorithm(this.exchangeContext.keyExchange);if(!u)throw new d.SshConnectionError("Key exchange not supported for algorithm: "+this.exchangeContext.keyExchange,p.SshDisconnectReason.keyExchangeFailed);const h=this.session.config.getPublicKeyAlgorithm(this.exchangeContext.publicKey);if(!h)throw new d.SshConnectionError("Public key algorithm not supported: "+this.exchangeContext.publicKey,p.SshDisconnectReason.keyExchangeFailed);let m=null;if(null===(r=c.credentials)||void 0===r?void 0:r.publicKeys){const e=c.credentials.publicKeys.find((e=>e.keyAlgorithmName===h.keyAlgorithmName));if(m=null!=e?e:null,!1===(null==m?void 0:m.hasPrivateKey)){if(!c.credentials.privateKeyProvider)throw new Error("A private key provider is required.");m=await c.credentials.privateKeyProvider(e,null!=t?t:g.CancellationToken.None)}}if(null==m)throw new d.SshConnectionError("Private key not found for algorithm: "+this.exchangeContext.publicKey,p.SshDisconnectReason.keyExchangeFailed);const y=this.session.config.getEncryptionAlgorithm(this.exchangeContext.clientEncryption),v=this.session.config.getEncryptionAlgorithm(this.exchangeContext.serverEncryption),w=this.session.config.getHmacAlgorithm(this.exchangeContext.serverHmac),S=this.session.config.getHmacAlgorithm(this.exchangeContext.clientHmac),b=u.createKeyExchange(),_=e.e||i.Buffer.alloc(0),E=await b.startKeyExchange(),T=await b.decryptKeyExchange(_),C=await m.getPublicKeyBytes(h.name);if(!C)throw new d.SshConnectionError("Public key not set.",p.SshDisconnectReason.keyExchangeFailed);const P=await this.computeExchangeHash(b,C,_,E,T);this.session.sessionId||(this.session.sessionId=P);const[A,R,I,x,O,k]=await this.computeKeys(b,T,P,y,v,S,w),M=null!==(n=await(null==v?void 0:v.createCipher(!0,x,R)))&&void 0!==n?n:null,N=null!==(s=await(null==y?void 0:y.createCipher(!1,I,A)))&&void 0!==s?s:null,D=null!==(o=await(null==w?void 0:w.createSigner(k)))&&void 0!==o?o:null,L=null!==(a=await(null==S?void 0:S.createVerifier(O)))&&void 0!==a?a:null,B=new f.SshSessionAlgorithms;B.publicKeyAlgorithmName=this.exchangeContext.publicKey,B.cipher=M,B.decipher=N,B.signer=D,B.verifier=L,B.messageSigner=(null==M?void 0:M.authenticatedEncryption)?M:D,B.messageVerifier=(null==N?void 0:N.authenticatedEncryption)?N:L,B.compressor=this.session.config.getCompressionAlgorithm(this.exchangeContext.serverCompression),B.decompressor=this.session.config.getCompressionAlgorithm(this.exchangeContext.clientCompression),this.exchangeContext.newAlgorithms=B,A&&A.fill(0),I&&I.fill(0),O&&O.fill(0),R&&R.fill(0),x&&x.fill(0),k&&k.fill(0);const q=h.createSigner(m);let j=await q.sign(P);j=h.createSignatureData(j);const F=new l.KeyExchangeDhReplyMessage;F.hostKey=C,F.f=E,F.signature=j,await this.session.sendMessage(F,t),await this.session.sendMessage(new l.NewKeysMessage,t)}async handleDhReplyMessage(e,t){var r,n,s,i;if(!this.isClientSession)return;if(!this.exchangeContext)throw new d.SshConnectionError("Key exchange was not started.",p.SshDisconnectReason.protocolError);const o=this.session.config,a=this.exchangeContext.exchange,c=this.exchangeContext.publicKey,u=o.getPublicKeyAlgorithm(c),h=o.getEncryptionAlgorithm(this.exchangeContext.clientEncryption),g=o.getEncryptionAlgorithm(this.exchangeContext.serverEncryption),m=o.getHmacAlgorithm(this.exchangeContext.serverHmac),y=o.getHmacAlgorithm(this.exchangeContext.clientHmac),w=this.exchangeContext.exchangeValue,S=e.f;if(!a||!w)throw new d.SshConnectionError("Failed to initialize crypto after key exchange.",p.SshDisconnectReason.keyExchangeFailed);this.hostKey=u.createKeyPair(),await this.hostKey.setPublicKeyBytes(e.hostKey);const b=await a.decryptKeyExchange(S),_=e.hostKey,E=await this.computeExchangeHash(a,_,w,S,b),T=u.readSignatureData(e.signature),C=u.createVerifier(this.hostKey);let P;try{P=await C.verify(E,T)}catch(e){if(!(e instanceof Error))throw e;throw this.trace(v.TraceLevel.Error,v.SshTraceEventIds.serverAuthenticationFailed,`Server public key verification error: ${e.message}`,e),new d.SshConnectionError(`Server public key verification failed: ${e.message}`,p.SshDisconnectReason.hostKeyNotVerifiable)}if(!P)throw this.trace(v.TraceLevel.Warning,v.SshTraceEventIds.serverAuthenticationFailed,"Server public key verification failed."),new d.SshConnectionError("Server public key verification failed.",p.SshDisconnectReason.hostKeyNotVerifiable);this.trace(v.TraceLevel.Verbose,v.SshTraceEventIds.sessionAuthenticated,"Server public key verification succeeded."),null==this.session.sessionId&&(this.session.sessionId=E);const[A,R,I,x,O,k]=await this.computeKeys(a,b,E,h,g,y,m),M=null!==(r=await(null==h?void 0:h.createCipher(!0,I,A)))&&void 0!==r?r:null,N=null!==(n=await(null==g?void 0:g.createCipher(!1,x,R)))&&void 0!==n?n:null,D=null!==(s=await(null==y?void 0:y.createSigner(O)))&&void 0!==s?s:null,L=null!==(i=await(null==m?void 0:m.createVerifier(k)))&&void 0!==i?i:null,B=new f.SshSessionAlgorithms;B.publicKeyAlgorithmName=c,B.cipher=M,B.decipher=N,B.signer=D,B.verifier=L,B.messageSigner=(null==M?void 0:M.authenticatedEncryption)?M:D,B.messageVerifier=(null==N?void 0:N.authenticatedEncryption)?N:L,B.compressor=o.getCompressionAlgorithm(this.exchangeContext.clientCompression),B.decompressor=o.getCompressionAlgorithm(this.exchangeContext.serverCompression),this.exchangeContext.newAlgorithms=B,A&&A.fill(0),I&&I.fill(0),O&&O.fill(0),R&&R.fill(0),x&&x.fill(0),k&&k.fill(0),await this.session.sendMessage(new l.NewKeysMessage,t)}chooseAlgorithm(e,t,r){let n,s;this.isClientSession?(n=r||[],s=t):(n=t,s=r||[]);const i=`${e} negotiation: Server (${n.join(", ")}) Client (${s.join(", ")})`;for(const e of s)for(const t of n)if(t===e){const e=t;return this.trace(v.TraceLevel.Info,v.SshTraceEventIds.algorithmNegotiation,`${i} => ${e}`),e}throw new Error(`Failed ${i}`)}async computeExchangeHash(e,t,r,n,s){if(!this.session.remoteVersion)throw new Error("Key exchange not completed.");const a=new h.SshDataWriter(i.Buffer.alloc(2048));return this.isClientSession?(a.writeString(o.SshSession.localVersion.toString(),"ascii"),a.writeString(this.session.remoteVersion.toString(),"ascii")):(a.writeString(this.session.remoteVersion.toString(),"ascii"),a.writeString(o.SshSession.localVersion.toString(),"ascii")),a.writeBinary(this.exchangeContext.clientKexInitPayload),a.writeBinary(this.exchangeContext.serverKexInitPayload),a.writeBinary(t),a.writeBigInt(c.BigInt.fromBytes(r,{unsigned:!0})),a.writeBigInt(c.BigInt.fromBytes(n,{unsigned:!0})),a.writeBigInt(c.BigInt.fromBytes(s,{unsigned:!0})),await e.sign(a.toBuffer())}async computeKeys(e,t,r,n,s,o,a){var c,l;const u=new h.SshDataWriter(i.Buffer.alloc(4+t.length+r.length+Math.max(1+(null!==(l=null===(c=this.session.sessionId)||void 0===c?void 0:c.length)&&void 0!==l?l:0),e.digestLength)));u.writeBinary(t),u.write(r);const d=u.position;return[n&&await this.computeKey(e,u,d,n.blockLength,"A"),s&&await this.computeKey(e,u,d,s.blockLength,"B"),n&&await this.computeKey(e,u,d,n.keyLength,"C"),s&&await this.computeKey(e,u,d,s.keyLength,"D"),o&&await this.computeKey(e,u,d,o.keyLength,"E"),a&&await this.computeKey(e,u,d,a.keyLength,"F")]}async computeKey(e,t,r,n,s){const o=i.Buffer.alloc(n);let a=0,c=0,l=null;if(!this.session.sessionId)throw new Error("Session ID not set.");for(;a<n;)t.position=r,l?t.write(l):(t.writeByte(s.charCodeAt(0)),t.write(this.session.sessionId)),l=await e.sign(t.toBuffer()),c=Math.min(l.length,n-a),l.copy(o,a),a+=c;return l&&l.fill(0),o}};_.serviceName="ssh-keyexchange",_=n=s([(0,y.serviceActivation)({serviceRequest:n.serviceName})],_),t.KeyExchangeService=_},4865:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findService=t.serviceActivation=void 0,t.serviceActivation=function(e){return t=>{t.activations||(t.activations=[]),t.activations.push(e)}},t.findService=function(e,t){for(const r of e.keys()){const e=r.activations;let n=!1;for(const s of e)if(n=!0,t(s))return r;if(!n)throw new Error(`SSH service type '${r.name}' must have one or more 'serviceActivation' decorators.`)}return null}},1838:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshService=void 0;const n=r(5844),s=r(7492);t.SshService=class{constructor(e){if(this.session=e,this.disposed=!1,this.disposedEmitter=new n.Emitter,this.onDisposed=this.disposedEmitter.event,!(e instanceof s.SshSession))throw new TypeError("Session is not an instance of SshSession. (This may be due to a version mismatch between SSH packages.)")}get trace(){return this.session.trace}dispose(){this.disposed||(this.disposed=!0,this.disposedEmitter.fire())}async onSessionRequest(e,t){this.session.raiseSessionRequest(e)}async onChannelOpening(e,t){if(!e)throw new TypeError("Request is required.");return this.session.handleChannelOpening(e,t,!1)}async onChannelRequest(e,t,r){}async sendMessage(e,t){await this.session.sendMessage(e,t)}}},9273:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannel=void 0;const n=r(5844),s=r(4865),i=r(3379),o=r(6306),a=r(8614),c=r(3305),l=r(4608),u=r(1656),h=r(8512),d=r(9638),p=r(7399),f=r(6197),g=r(3661);class m{constructor(e,t,r,s,i,o,c,l){this.connectionService=e,this.channelType=t,this.channelId=r,this.remoteChannelId=s,this.openMessage=c,this.openConfirmationMessage=l,this.remoteClosed=!1,this.localClosed=!1,this.sentEof=!1,this.disposed=!1,this.openSendingWindowCompletionSource=null,this.requestCompletionSource=null,this.sendSemaphore=new p.Semaphore(0),this.metrics=new a.ChannelMetrics,this.dataReceivedEmitter=new n.Emitter,this.onDataReceived=this.dataReceivedEmitter.event,this.eofEmitter=new n.Emitter,this.onEof=this.eofEmitter.event,this.closedEmitter=new n.Emitter,this.onClosed=this.closedEmitter.event,this.requestEmitter=new n.Emitter,this.onRequest=this.requestEmitter.event,this.isMaxWindowSizeLocked=!1,this.remoteWindowSize=i,this.maxWindowSizeValue=m.defaultMaxWindowSize,this.windowSize=this.maxWindowSizeValue,this.maxPacketSize=Math.min(o,m.defaultMaxPacketSize)}get session(){return this.connectionService.session}get isClosed(){return this.localClosed||this.remoteClosed}get maxWindowSize(){return this.maxWindowSizeValue}set maxWindowSize(e){if(this.isMaxWindowSizeLocked)throw new Error("Cannot change the max window size after opening the channel.");if(e<this.maxPacketSize)throw new Error("Maximum window size cannot be less than maximum packet size.");this.maxWindowSizeValue=e}async request(e,t){if(!e)throw new TypeError("Request is required.");if(this.disposed)throw new l.ObjectDisposedError(this);if(e.recipientChannel=this.remoteChannelId,!e.wantReply)return await this.session.sendMessage(e,t),!0;if(null!=this.requestCompletionSource)throw new Error("Another request is already pending.");const r=new c.PromiseCompletionSource;if(this.requestCompletionSource=r,t){if(t.isCancellationRequested)throw new d.CancellationError;t.onCancellationRequested((()=>{r.reject(new d.CancellationError)}))}return await this.session.sendMessage(e,t),await r.promise}async send(e,t){if(this.disposed)throw new l.ObjectDisposedError(this);if(0!==e.length){if(this.sentEof)throw new Error("Cannot send more data after EOF.");await this.sendSemaphore.wait(t);try{let r=0,n=e.length;for(;n>0;){let s=Math.min(Math.min(this.remoteWindowSize,this.maxPacketSize),n);for(;0===s;)this.openSendingWindowCompletionSource||(this.openSendingWindowCompletionSource=new c.PromiseCompletionSource),this.session.trace(f.TraceLevel.Warning,f.SshTraceEventIds.channelWaitForWindowAdjust,`${this} send window is full. Waiting for window adjustment before sending.`),await(0,d.withCancellation)(this.openSendingWindowCompletionSource.promise,t),this.openSendingWindowCompletionSource=null,s=Math.min(Math.min(this.remoteWindowSize,this.maxPacketSize),n);const o=new i.ChannelDataMessage;o.recipientChannel=this.remoteChannelId,o.data=Buffer.from(e.slice(r,r+s)),await this.session.sendMessage(o,t),this.remoteWindowSize-=s,n-=s,r+=s,this.metrics.addBytesSent(s)}}finally{this.sendSemaphore.tryRelease()}}else await this.sendEof()}enableSending(){this.sendSemaphore.tryRelease()}async sendEof(e){if(!this.sentEof){await this.sendSemaphore.wait(e);try{this.sentEof=!0;const t=new i.ChannelEofMessage;t.recipientChannel=this.remoteChannelId,await this.session.sendMessage(t,e)}finally{this.sendSemaphore.tryRelease()}}}async handleRequest(e,t){if(!e.requestType)throw new l.SshConnectionError("Channel request type not specified.",o.SshDisconnectReason.protocolError);if(e.requestType===i.ChannelRequestType.exitStatus){const t=new i.ChannelSignalMessage;return e.convertTo(t),this.exitStatus=t.exitStatus,!0}if(e.requestType===i.ChannelRequestType.exitSignal){const t=new i.ChannelSignalMessage;return e.convertTo(t),this.exitSignal=t.exitSignal,this.exitErrorMessage=t.errorMessage,!0}if(e.requestType===i.ChannelRequestType.signal){const t=new i.ChannelSignalMessage;e.convertTo(t)}const r=new u.SshRequestEventArgs(e.requestType,e,this.session.principal,t),n=(0,s.findService)(this.session.config.services,(t=>(!t.channelType||t.channelType===this.channelType)&&t.channelRequest===e.requestType));await this.sendSemaphore.wait(t);try{let s=null;if(n){const e=this.session.activateService(n);await e.onChannelRequest(this,r,t)}else this.requestEmitter.fire(r);r.responsePromise&&(s=await r.responsePromise,r.isAuthorized=s instanceof i.ChannelSuccessMessage),e.wantReply&&(r.isAuthorized?(s=null!=s?s:new i.ChannelSuccessMessage,s.recipientChannel=this.remoteChannelId):(s=null!=s?s:new i.ChannelFailureMessage,s.recipientChannel=this.remoteChannelId),await this.session.sendMessage(s,t))}finally{this.sendSemaphore.tryRelease()}return r.isAuthorized||!1}handleResponse(e){this.requestCompletionSource&&(this.requestCompletionSource.resolve(e),this.requestCompletionSource=null)}handleDataReceived(e){this.metrics.addBytesReceived(e.length),this.dataReceivedEmitter.fire(e)}adjustWindow(e){if(!this.disposed&&(this.windowSize-=e,this.windowSize<=this.maxWindowSizeValue/2)){const e=new i.ChannelWindowAdjustMessage;e.recipientChannel=this.remoteChannelId,e.bytesToAdd=this.maxWindowSizeValue-this.windowSize,this.windowSize=this.maxWindowSizeValue,this.session.sendMessage(e).catch((e=>{this.session.trace(f.TraceLevel.Error,f.SshTraceEventIds.channelWindowAdjustFailed,`Error sending window adjust message: ${e.message}`,e)}))}}adjustRemoteWindow(e){this.remoteWindowSize+=e,this.openSendingWindowCompletionSource&&this.openSendingWindowCompletionSource.resolve(void 0)}handleEof(){this.session.trace(f.TraceLevel.Info,f.SshTraceEventIds.channelEofReceived,`${this} EOF received.`),this.eofEmitter.fire()}close(e,t,r){if(e instanceof Error){const t=e;return this.localClosed||(this.localClosed=!0,this.session.trace(f.TraceLevel.Info,f.SshTraceEventIds.channelClosed,`${this} Closed: ${t.message}`),this.closedEmitter.fire(new h.SshChannelClosedEventArgs(t))),void this.disposeInternal()}return"number"==typeof e?this.closeWithStatus(e,t):"string"==typeof e?this.closeWithSignal(e,t,r):this.closeDefault(e)}async closeDefault(e){var t;if(!this.remoteClosed&&!this.localClosed){this.remoteClosed=!0,await this.sendSemaphore.wait(e);try{const e=new i.ChannelCloseMessage;e.recipientChannel=this.remoteChannelId,await this.session.sendMessage(e)}catch(e){}finally{this.sendSemaphore.tryRelease()}}if(!this.localClosed){this.localClosed=!0;const e=this.raiseClosedEvent();null===(t=this.requestCompletionSource)||void 0===t||t.reject(new l.SshChannelError(e))}this.disposeInternal()}async closeWithStatus(e,t){if(!this.remoteClosed&&!this.localClosed){this.exitStatus=e;const t=new i.ChannelSignalMessage;t.recipientChannel=this.remoteChannelId,t.exitStatus=e,await this.session.sendMessage(t)}await this.closeDefault(t)}async closeWithSignal(e,t,r){if(!this.remoteClosed&&!this.localClosed){this.exitSignal=e,this.exitErrorMessage=t;const r=new i.ChannelSignalMessage;r.recipientChannel=this.remoteChannelId,r.exitSignal=e,r.errorMessage=t,await this.session.sendMessage(r)}await this.closeDefault(r)}handleClose(){var e;if(!this.localClosed){this.localClosed=!0;const t=this.raiseClosedEvent(!0);null===(e=this.requestCompletionSource)||void 0===e||e.reject(new l.SshChannelError(t))}this.disposeInternal()}raiseClosedEvent(e=!1){const t=` (S: ${this.metrics.bytesSent}, R: ${this.metrics.bytesReceived})`,r=e?"remotely":"locally";let n,s;return void 0!==this.exitStatus?(s=new h.SshChannelClosedEventArgs(this.exitStatus),n=`${this} closed ${r}: status=${this.exitStatus}`):void 0!==this.exitSignal?(s=new h.SshChannelClosedEventArgs(this.exitSignal,this.exitErrorMessage),n=`${this} closed ${r}: signal=${this.exitSignal} ${this.exitErrorMessage}`):(s=new h.SshChannelClosedEventArgs,n=`${this} closed ${r}.`),this.session.trace(f.TraceLevel.Info,f.SshTraceEventIds.channelClosed,n+t),this.closedEmitter.fire(s),n}dispose(){var e;if(!this.disposed&&!this.localClosed){if(!this.remoteClosed){this.remoteClosed=!0;const e=new i.ChannelCloseMessage;e.recipientChannel=this.remoteChannelId,this.session.sendMessage(e).catch((e=>{}))}const t=this.session.isClosed?`${this.session} closed.`:`${this} disposed.`;this.session.trace(f.TraceLevel.Info,f.SshTraceEventIds.channelClosed,t);const r=new h.SshChannelClosedEventArgs("SIGABRT",t);this.localClosed=!0,this.closedEmitter.fire(r),null===(e=this.requestCompletionSource)||void 0===e||e.reject(new l.SshChannelError(t))}this.disposeInternal()}disposeInternal(){var e;this.disposed||(this.disposed=!0,null===(e=this.requestCompletionSource)||void 0===e||e.reject(new l.ObjectDisposedError(this)),this.connectionService.removeChannel(this),this.sendSemaphore.dispose())}pipe(e){return g.PipeExtensions.pipeChannel(this,e)}toString(){return`SshChannel(Type: ${this.channelType}, Id: ${this.channelId}, RemoteId: ${this.remoteChannelId})`}}t.SshChannel=m,m.sessionChannelType="session",m.defaultMaxPacketSize=i.ChannelOpenMessage.defaultMaxPacketSize,m.defaultMaxWindowSize=i.ChannelOpenMessage.defaultMaxWindowSize},5706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshClientSession=void 0;const n=r(7492),s=r(6306),i=r(3314),o=r(3305),a=r(9638),c=r(9872),l=r(5263),u=r(3193),h=r(4608),d=r(6197);class p extends n.SshSession{constructor(e){super(e,!0),this.serviceRequests=new Map,this.clientAuthCompletion=null}async authenticate(e,t){return!!await this.authenticateServer(t)&&!!await this.authenticateClient(e,t)}async authenticateServer(e){if(!this.kexService||!this.kexService.hostKey)throw new Error("Encrypt the session before authenticating.");try{this.principal=await this.raiseAuthenticatingEvent(new i.SshAuthenticatingEventArgs(i.SshAuthenticationType.serverPublicKey,{publicKey:this.kexService.hostKey},e))}catch(e){if(!(e instanceof Error))throw e;throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.authenticationError,`Error while authenticating server: ${e.message}`,e),e}return this.principal?(this.trace(d.TraceLevel.Info,d.SshTraceEventIds.sessionAuthenticated,`${this} server authenticated.`),!0):(await this.close(s.SshDisconnectReason.hostKeyNotVerifiable,"Server authentication failed."),this.trace(d.TraceLevel.Warning,d.SshTraceEventIds.serverAuthenticationFailed,`${this} server authentication failed.`),!1)}authenticateClient(e,t,r){if(!e)throw new TypeError("A credentials object is required.");return"function"==typeof t?this.authenticateClientWithCompletion(e,t,r):new Promise(((r,n)=>this.authenticateClientWithCompletion(e,((e,t)=>{e?n(e):r(t)}),t)))}async authenticateClientWithCompletion(e,t,r){if(this.clientAuthCompletion=new o.PromiseCompletionSource,this.clientAuthCompletion.promise.then((e=>t(void 0,e)),(e=>t(e))),r){if(r.isCancellationRequested)throw new a.CancellationError;r.onCancellationRequested((e=>{this.clientAuthCompletion&&this.clientAuthCompletion.reject(new a.CancellationError)}))}let n=this.getService(l.AuthenticationService);if(!n){const e=new s.ServiceRequestMessage;e.serviceName=l.AuthenticationService.serviceName,await this.sendMessage(e,r),n=this.activateService(l.AuthenticationService)}await n.authenticateClient(e,r)}onAuthenticationComplete(e){e?this.trace(d.TraceLevel.Info,d.SshTraceEventIds.sessionAuthenticated,`${this} client authenticated.`):this.trace(d.TraceLevel.Warning,d.SshTraceEventIds.clientAuthenticationFailed,`${this} client authentication failed.`),this.clientAuthCompletion&&(this.clientAuthCompletion.resolve(e),this.clientAuthCompletion=null)}async requestService(e,t){let r=!1,n=this.serviceRequests.get(e);if(n||(n=new o.PromiseCompletionSource,this.serviceRequests.set(e,n),r=!0),r){const r=new s.ServiceRequestMessage;r.serviceName=e,await this.sendMessage(r,t)}await n.promise}async handleServiceAcceptMessage(e,t){const r=this.serviceRequests.get(e.serviceName);null==r||r.resolve(!0)}async openChannel(e,t,r){if(!this.connectionService){const e=new s.ServiceRequestMessage;e.serviceName=u.ConnectionService.serviceName,await this.sendMessage(e,r)}return await super.openChannel(e,t,r)}handleDisconnected(){return this.reconnecting?(this.reconnecting=!1,!1):super.handleDisconnected()}async reconnect(e,t){if(this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.clientSessionReconnecting,"Attempting to reconnect..."),this.isClosed)throw new h.ObjectDisposedError(this);if(this.isConnected)throw new Error("Already connected.");if(!this.protocol)throw new Error("The session was never previously connected.");if(this.reconnecting)throw new Error("Already reconnecting.");this.reconnecting=!0;try{await this.reconnectInternal(e,t)}finally{this.reconnecting=!1}}async reconnectInternal(e,t){var r,n,i,o,a,l;const u=this.sessionId,p=this.protocol,f=null===(r=this.kexService)||void 0===r?void 0:r.hostKey;if(!(u&&p&&this.kexService&&f&&(null===(n=p.extensions)||void 0===n?void 0:n.has(c.SshProtocolExtensionNames.sessionReconnect))))throw new Error("Reconnect was not enabled for this session.");let g;try{if(this.sessionId=null,await this.connect(e,t),!this.sessionId||!this.algorithms||!this.algorithms.signer)throw new Error("Session is not encrypted.");const r=this.kexService.hostKey,n=r?await r.getPublicKeyBytes():null,i=await f.getPublicKeyBytes();if(!n||!i||!n.equals(i)){const e="The server host key is different.";throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.clientSessionReconnectFailed,`Reconnection failed: ${e}`),new h.SshReconnectError(e,s.SshReconnectFailureReason.differentServerHostKey)}g=this.sessionId}catch(e){throw this.protocol=p,super.handleDisconnected(),e}finally{this.sessionId=u,this.kexService.hostKey=f}const m=await this.createReconnectToken(u,g),y=new s.SessionReconnectRequestMessage;y.requestType="session-reconnect@microsoft.com",y.clientReconnectToken=m,y.lastReceivedSequenceNumber=p.lastIncomingSequence,y.wantReply=!0;const v=await this.requestResponse(y,s.SessionReconnectResponseMessage,s.SessionReconnectFailureMessage,t);if(v instanceof s.SessionReconnectFailureMessage){const e=null!==(i=v.reasonCode)&&void 0!==i?i:s.SshReconnectFailureReason.unknownServerFailure,t=null!==(o=v.description)&&void 0!==o?o:"The server rejected the reconnect request.";throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.clientSessionReconnectFailed,`Reconnection failed: ${t}`),this.protocol=p,new h.SshReconnectError(t,e)}if(!this.verifyReconnectToken(u,g,null!==(a=v.serverReconnectToken)&&void 0!==a?a:Buffer.alloc(0))){const e="The reconnect token provided by the server was invalid.";throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.clientSessionReconnectFailed,`Reconnection failed: ${e}`),new h.SshReconnectError(e,s.SshReconnectFailureReason.invalidServerReconnectToken)}this.trace(d.TraceLevel.Info,d.SshTraceEventIds.clientSessionReconnecting,"Reconnect request was accepted by the server.");const w=p.getSentMessages((null!==(l=v.lastReceivedSequenceNumber)&&void 0!==l?l:0)+1);if(!w){const e="Client is unable to re-send messages requested by the server.";throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.clientSessionReconnectFailed,`Reconnection failed: ${e}`),new h.SshReconnectError(e,s.SshReconnectFailureReason.clientDroppedMessages)}let S=0;for(const e of w)await this.sendMessage(e,t),S++;p.dispose(),this.metrics.addReconnection(),this.trace(d.TraceLevel.Info,d.SshTraceEventIds.clientSessionReconnecting,`{this} reconnected. Re-sent ${S} dropped messages.`)}dispose(){this.clientAuthCompletion&&this.clientAuthCompletion.reject(new h.ObjectDisposedError(this)),super.dispose()}}t.SshClientSession=p},5523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshRpcMessageStream=void 0;const n=r(5844),s=r(4300),i=r(7309),o="Content-Length: ",a="\r\n\r\n";class c{constructor(e){this.channel=e,this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.partialMessageEmitter=new n.Emitter,this.callback=null,this.messageBuffer=new i.SshDataWriter(s.Buffer.alloc(1024)),this.headersLength=null,this.messageLength=null,this.onError=this.errorEmitter.event,this.onClose=this.closeEmitter.event,this.onPartialMessage=this.partialMessageEmitter.event,this.eventRegistration=this.channel.onDataReceived(this.onDataReceived.bind(this)),this.channel.onClosed((e=>{e.error&&this.errorEmitter.fire(e.error),this.closeEmitter.fire()}))}listen(e){return this.callback=e,n.Disposable.create((()=>{this.callback=null}))}dispose(){this.eventRegistration&&this.eventRegistration.dispose()}onDataReceived(e){if(this.messageBuffer.write(e),this.channel.adjustWindow(e.length),e=this.messageBuffer.toBuffer(),null===this.messageLength){const t=e.indexOf(a);if(t<0)return;const r=e.slice(0,t).toString();if(!r.startsWith(o))throw new Error(`Message does not start with JSON-RPC headers.\n${r}`);this.headersLength=t+a.length,this.messageLength=parseInt(r.substr(o.length,t-o.length),10)}const t=this.messageBuffer.position,r=this.headersLength+this.messageLength;if(t>=r){if(this.callback){const t=e.slice(this.headersLength,r).toString();let n;try{n=JSON.parse(t)}catch(e){if(!(e instanceof Error))throw e;throw new Error(`Failed to parse JSON-RPC message: ${e.message}\n${t}`)}this.callback(n)}this.messageLength=null,this.messageBuffer.position=0,t>r&&this.onDataReceived(e.slice(r))}}}class l{constructor(e){this.channel=e,this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.onError=this.errorEmitter.event,this.onClose=this.closeEmitter.event,this.channel.onClosed((e=>{e.error&&this.errorEmitter.fire([e.error,e.errorMessage&&{jsonrpc:e.errorMessage}||void 0,e.exitStatus]),this.closeEmitter.fire()}))}write(e){const t=JSON.stringify(e),r=s.Buffer.from(t),n=s.Buffer.from(o+r.length+a),i=s.Buffer.alloc(n.length+r.length);return n.copy(i,0),r.copy(i,n.length),this.channel.send(i).catch((e=>{this.errorEmitter.fire([e,void 0,void 0])}))}end(){}dispose(){}}t.SshRpcMessageStream=class{constructor(e){this.reader=new c(e),this.writer=new l(e)}}},7331:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshServerSession=void 0;const n=r(7492),s=r(5844),i=r(6306),o=r(4608),a=r(9872),c=r(6197);class l extends n.SshSession{constructor(e,t){super(e,!1),this.clientAuthenticatedEmitter=new s.Emitter,this.onClientAuthenticated=this.clientAuthenticatedEmitter.event,this.reconnectedEmitter=new s.Emitter,this.onReconnected=this.reconnectedEmitter.event,this.credentials={publicKeys:[]};const r=e.protocolExtensions.includes(a.SshProtocolExtensionNames.sessionReconnect);if(r&&!t)throw new Error("When reconnect is enabled, server sessions require a reference to a shared collection to track reconnectable sessions.");if(!r&&t)throw new Error("When reconnect is not enabled, the reconnectable sessions collection is not applicable.");this.reconnectableSessions=t}async handleServiceRequestMessage(e,t){if(!this.activateService(e.serviceName))throw new o.SshConnectionError(`Service "${e.serviceName}" not available.`,i.SshDisconnectReason.serviceNotAvailable);{const r=new i.ServiceAcceptMessage;r.serviceName=e.serviceName,await this.sendMessage(r,t)}}async handleRequestMessage(e,t){var r;if("session-reconnect@microsoft.com"===e.requestType&&(null===(r=this.config.protocolExtensions)||void 0===r?void 0:r.includes(a.SshProtocolExtensionNames.sessionReconnect))){const r=e.convertTo(new i.SessionReconnectRequestMessage);await this.reconnect(r,t)}else await super.handleRequestMessage(e,t)}handleClientAuthenticated(){this.clientAuthenticatedEmitter.fire()}async enableReconnect(e){await super.enableReconnect(e),this.reconnectableSessions.includes(this)||this.reconnectableSessions.push(this)}handleDisconnected(){return!!this.reconnecting||super.handleDisconnected()}async reconnect(e,t){var r,n,s;if(!this.reconnectableSessions)throw new Error("Disconnected sessions collection should have been initialied when reconnect is enabled.");let o;for(const t of this.reconnectableSessions)if(t!==this&&await this.verifyReconnectToken(t.sessionId,this.sessionId,null!==(r=e.clientReconnectToken)&&void 0!==r?r:Buffer.alloc(0))){o=t,this.reconnectableSessions.splice(this.reconnectableSessions.indexOf(o),1);break}if(!o||o.isClosed){const e="Requested reconnect session was not found or the reconnect token provided by the client was invalid.";this.trace(c.TraceLevel.Error,c.SshTraceEventIds.serverSessionReconnectFailed,`Reconnect failed: ${e}`);const r=new i.SessionReconnectFailureMessage;return r.reasonCode=i.SshReconnectFailureReason.sessionNotFound,r.description=e,void await this.sendMessage(r,t)}const a=o.protocol.getSentMessages((null!==(n=e.lastReceivedSequenceNumber)&&void 0!==n?n:0)+1);if(!a){this.reconnectableSessions.push(o);const e="Server is unable to re-send messages requested by the client.";this.trace(c.TraceLevel.Error,c.SshTraceEventIds.serverSessionReconnectFailed,`Reconnect failed: ${e}`);const r=new i.SessionReconnectFailureMessage;return r.reasonCode=i.SshReconnectFailureReason.serverDroppedMessages,r.description=e,void await this.sendMessage(r,t)}const l=new i.SessionReconnectResponseMessage;l.serverReconnectToken=await this.createReconnectToken(o.sessionId,this.sessionId),l.lastReceivedSequenceNumber=o.protocol.lastIncomingSequence,await this.sendMessage(l,t);try{for(o.reconnecting=!0,null===(s=o.protocol)||void 0===s||s.dispose();o.isConnected;)await new Promise((e=>setTimeout((()=>e()),5)));o.protocol=this.protocol,o.protocol.kexService=o.kexService,this.protocol=void 0;for(const e of a)await o.sendMessage(e,t);this.dispose()}finally{o.reconnecting=!1}this.reconnectableSessions.push(o),o.metrics.addReconnection(),o.processMessages().catch((e=>{this.trace(c.TraceLevel.Error,c.SshTraceEventIds.unknownError,`Unhandled error processing messages: ${e.message}`,e)})),this.trace(c.TraceLevel.Info,c.SshTraceEventIds.serverSessionReconnecting,`${o} reconnected. Re-sent ${a.length} dropped messages.`),o.reconnectedEmitter.fire()}dispose(){if(this.reconnectableSessions){const e=this.reconnectableSessions.indexOf(this);e>=0&&this.reconnectableSessions.splice(e,1)}super.dispose()}}t.SshServerSession=l},7492:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSession=void 0;const n=r(6197),s=r(4300),i=r(5844),o=r(9872),a=r(9273),c=r(1163),l=r(1915),u=r(4237),h=r(4865),d=r(3193),p=r(5263),f=r(6744),g=r(5255),m=r(3379),y=r(6892),v=r(6306),w=r(4340),S=r(3305),b=r(8764),_=r(1656),E=r(7521),T=r(9638),C=r(4608),P=r(7399),A=r(3661);class R{get algorithms(){return this.protocol?this.protocol.algorithms:null}get principal(){return this.principalValue}set principal(e){this.principalValue=e}constructor(e,t){if(this.config=e,this.remoteVersion=null,this.activatedServices=new Map,this.connectionService=null,this.requestHandler=null,this.blockedMessages=[],this.blockedMessagesSemaphore=new P.Semaphore(1),this.connected=!1,this.disposed=!1,this.metrics=new w.SessionMetrics,this.reconnecting=!1,this.sessionId=null,this.principalValue=null,this.authenticatingEmitter=new i.Emitter,this.onAuthenticating=this.authenticatingEmitter.event,this.closedEmitter=new i.Emitter,this.onClosed=this.closedEmitter.event,this.disconnectedEmitter=new i.Emitter,this.onDisconnected=this.disconnectedEmitter.event,this.serviceActivatedEmitter=new i.Emitter,this.onServiceActivated=this.serviceActivatedEmitter.event,this.channelOpeningEmitter=new i.Emitter,this.onChannelOpening=this.channelOpeningEmitter.event,this.requestEmitter=new i.Emitter,this.onRequest=this.requestEmitter.event,this.trace=(e,t,r,n)=>{},!e)throw new TypeError("Session configuration is required.");if(e.keyExchangeAlgorithms.find((e=>!!e)))this.kexService=new u.KeyExchangeService(this,null!=t&&t);else{if(e.encryptionAlgorithms.length>0&&e.encryptionAlgorithms.indexOf(null)<0)throw new Error("Encryption requires a key-exchange algorithm to be configured.");if(e.hmacAlgorithms.length>0&&e.hmacAlgorithms.indexOf(null)<0)throw new Error("HMAC requires a key-exchange algorithm to be configured.");if(e.publicKeyAlgorithms.length>0&&e.publicKeyAlgorithms.indexOf(null)<0)throw new Error("Host authentication requires a key-exchange algorithm to be configured.");this.kexService=null,this.activateService(d.ConnectionService)}e.onConfigurationChanged((()=>{const t=this.protocol;t&&(t.traceChannelData=e.traceChannelData)}))}get isConnected(){return this.connected}get isClosed(){return this.disposed}get services(){return[...this.activatedServices.values()]}get channels(){var e,t;return null!==(t=null===(e=this.connectionService)||void 0===e?void 0:e.channels)&&void 0!==t?t:[]}get protocolExtensions(){var e;return(null===(e=this.protocol)||void 0===e?void 0:e.extensions)||null}getService(e){return this.activatedServices.get(e)||null}activateService(e){let t;if("function"==typeof e)t=e;else{const r=e;if(t=(0,h.findService)(this.config.services,(e=>e.serviceRequest===r)),!t)return null}let r=this.activatedServices.get(t);if(!r){if(!this.config.services.has(t))throw new Error(`Service type not configured: ${t.name}`);r=new t(this,this.config.services.get(t)),t===d.ConnectionService&&(this.connectionService=r),this.activatedServices.set(t,r),this.serviceActivatedEmitter.fire(r)}return r}async connect(e,t){if(!e)throw new TypeError("A session stream is required.");if(this.disposed)throw new C.ObjectDisposedError(this);this.connectPromise||(this.connectPromise=this.doConnect(e,t)),await this.connectPromise}async doConnect(e,t){this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionConnecting,`${this} ${this.reconnecting?"re":""}connecting...`),this.protocol=new l.SshProtocol(e,this.config,this.metrics,this.trace),this.protocol.kexService=this.kexService,await this.exchangeVersions(t),this.kexService?await this.encrypt(t):(await this.sendMessage(g.KeyExchangeInitMessage.none,t),await(0,T.withCancellation)(this.versionExchangePromise,t),this.connected=!0),this.processMessages().catch((e=>{this.trace(n.TraceLevel.Error,n.SshTraceEventIds.unknownError,`Unhandled error processing messages: ${e.message}`,e)}))}async exchangeVersions(e){const t=this.protocol.writeProtocolVersion(R.localVersion.toString(),e),r=this.protocol.readProtocolVersion(e);this.versionExchangePromise=r.then((async e=>{let t;this.trace(n.TraceLevel.Info,n.SshTraceEventIds.protocolVersion,`Local version: ${R.localVersion}, remote version: ${e}`);const r=c.SshVersionInfo.tryParse(e);if(r){if(this.remoteVersion=r,"2.0"===r.protocolVersion)return;t=`Remote SSH version ${this.remoteVersion} is not supported. This library only supports SSH v2.0.`}else t=`Could not parse remote SSH version ${e}`;await this.close(v.SshDisconnectReason.protocolVersionNotSupported,t,new Error(t))})),await t}async encrypt(e){var t,r;const s=this.protocol;if(!s)throw new C.ObjectDisposedError(this);await s.considerReExchange(!0,e),await(0,T.withCancellation)(this.versionExchangePromise,e),this.connected=!0;let i=null;for(;!(this.isClosed||(null===(t=this.protocol)||void 0===t?void 0:t.algorithms)||i instanceof v.DisconnectMessage)&&(i=await s.receiveMessage(e),i);)await this.handleMessage(i,e);if(!(null===(r=this.protocol)||void 0===r?void 0:r.algorithms))throw new C.SshConnectionError("Session closed while encrypting.",v.SshDisconnectReason.connectionLost);this.protocol.algorithms.cipher&&this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionEncrypted,`${this} encrypted.`)}async processMessages(){var e;for(this.connected=!0;!this.disposed;){const t=this.protocol;if(!t)break;let r=null;try{r=await t.receiveMessage()}catch(t){if(!(t instanceof Error))throw t;let r=v.SshDisconnectReason.protocolError;t instanceof C.SshConnectionError?r=null!==(e=t.reason)&&void 0!==e?e:r:this.trace(n.TraceLevel.Error,n.SshTraceEventIds.receiveMessageFailed,`Error receiving message: ${t.message}`,t),await this.close(r,t.message,t)}if(!r){await this.close(v.SshDisconnectReason.connectionLost,"Connection lost.");break}try{await this.handleMessage(r)}catch(e){if(!(e instanceof Error))throw e;this.trace(n.TraceLevel.Error,n.SshTraceEventIds.handleMessageFailed,`Error handling ${r}: ${e.message}`,e),await this.close(v.SshDisconnectReason.protocolError,e.message,e)}}this.connected=!1}get canAcceptRequests(){var e;return!(this.kexService&&(!(null===(e=this.protocol)||void 0===e?void 0:e.algorithms)||this.protocol.algorithms.cipher&&!this.principal))}async sendMessage(e,t){var r,s;if(!e)throw new TypeError("Message expected.");if(t&&t.isCancellationRequested)throw new T.CancellationError;const i=this.protocol;if(!i||this.disposed)throw new C.ObjectDisposedError(this);if(this.kexService&&this.kexService.exchanging&&e.messageType>4&&(e.messageType<20||e.messageType>49))return void this.blockedMessages.push(e);let a;await this.blockedMessagesSemaphore.wait(t);try{a=await i.sendMessage(e,t),this.blockedMessagesSemaphore.release()}catch(t){if(this.blockedMessagesSemaphore.release(),t instanceof C.SshConnectionError&&t.reason===v.SshDisconnectReason.connectionLost&&(null===(r=this.protocolExtensions)||void 0===r?void 0:r.has(o.SshProtocolExtensionNames.sessionReconnect)))return;if(!(t instanceof Error))throw t;throw this.trace(n.TraceLevel.Error,n.SshTraceEventIds.sendMessageFailed,`Error sending ${e}: ${t.message}`,t),t}if(!a&&!(null===(s=this.protocolExtensions)||void 0===s?void 0:s.has(o.SshProtocolExtensionNames.sessionReconnect)))throw new C.SshConnectionError("Session disconnected.",v.SshDisconnectReason.connectionLost)}handleMessage(e,t){var r;if(e instanceof m.ConnectionMessage&&this.connectionService)return this.connectionService.handleMessage(e,t);if(e instanceof g.NewKeysMessage)return this.handleNewKeysMessage(e,t);if(e instanceof g.KeyExchangeMessage)return this.handleKeyExchangeMessage(e,t);if(e instanceof y.AuthenticationMessage)return null===(r=this.getService(p.AuthenticationService))||void 0===r?void 0:r.handleMessage(e,t);if(e instanceof v.ServiceRequestMessage)return this.handleServiceRequestMessage(e,t);if(e instanceof v.ServiceAcceptMessage)return this.handleServiceAcceptMessage(e,t);if(e instanceof v.SessionRequestMessage)return this.handleRequestMessage(e,t);if(e instanceof v.SessionRequestSuccessMessage)return this.handleRequestSuccessMessage(e);if(e instanceof v.SessionRequestFailureMessage)return this.handleRequestFailureMessage(e);if(e instanceof v.ExtensionInfoMessage)return this.handleExtensionInfoMessage(e,t);if(e instanceof v.DisconnectMessage)return this.handleDisconnectMessage(e);if(e instanceof v.UnimplementedMessage)return this.handleUnimplementedMessage(e,t);if(e instanceof v.DebugMessage)return this.handleDebugMessage(e);if(!(e instanceof v.IgnoreMessage))throw e instanceof f.SshMessage?new Error(`Unhandled message type: ${e.constructor.name}`):new TypeError("Message argument was "+(e?"invalid type.":"null."))}async handleRequestMessage(e,t){var r;let s=!1,i=null;if("initial-channel-request@microsoft.com"===e.requestType&&this.config.protocolExtensions.includes(o.SshProtocolExtensionNames.openChannelRequest)){const r=e.convertTo(new v.SessionChannelRequestMessage),n=r.senderChannel,i=this.channels.find((e=>e.remoteChannelId===n));i&&r.request&&(r.request.wantReply=!1,s=await i.handleRequest(r.request,t))}else if("enable-session-reconnect@microsoft.com"===e.requestType&&(null===(r=this.config.protocolExtensions)||void 0===r?void 0:r.includes(o.SshProtocolExtensionNames.sessionReconnect)))this.protocol.incomingMessagesHaveReconnectInfo||(this.protocol.incomingMessagesHaveReconnectInfo=!0,this.protocol.incomingMessagesHaveLatencyInfo=this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionLatency),s=!0);else if(this.canAcceptRequests){const r=new _.SshRequestEventArgs(e.requestType||"",e,this.principal,t),n=(0,h.findService)(this.config.services,(t=>t.sessionRequest===e.requestType));if(n){const e=this.activateService(n);await e.onSessionRequest(r,t)}else this.raiseSessionRequest(r);r.responsePromise?(i=await r.responsePromise,s=i instanceof v.SessionRequestSuccessMessage):s=r.isAuthorized||!1}else this.trace(n.TraceLevel.Warning,n.SshTraceEventIds.sessionRequestFailed,"Session request blocked because the session is not yet authenticated."),s=!1;e.wantReply&&(s?i instanceof v.SessionRequestSuccessMessage||(i=new v.SessionRequestSuccessMessage):i instanceof v.SessionRequestFailureMessage||(i=new v.SessionRequestFailureMessage),await this.sendMessage(i,t))}raiseSessionRequest(e){this.requestEmitter.fire(e)}async handleServiceRequestMessage(e,t){}async handleServiceAcceptMessage(e,t){}async handleKeyExchangeMessage(e,t){this.kexService?await this.kexService.handleMessage(e,t):e instanceof g.KeyExchangeInitMessage&&e.allowsNone||await this.close(v.SshDisconnectReason.keyExchangeFailed,"Encryption is disabled.")}async handleNewKeysMessage(e,t){try{await this.blockedMessagesSemaphore.wait(t),await this.protocol.handleNewKeys(t);try{for(;this.blockedMessages.length>0;){const e=this.blockedMessages.shift();if(!this.protocol)throw new C.ObjectDisposedError(this);await this.protocol.sendMessage(e,t)}}catch(e){if(!(e instanceof Error))throw e;await this.close(v.SshDisconnectReason.protocolError,void 0,e)}}finally{this.blockedMessagesSemaphore.release()}}async handleUnimplementedMessage(e,t){void 0!==e.unimplementedMessageType&&await this.sendMessage(e,t)}handleDebugMessage(e){e.message&&this.trace(e.alwaysDisplay?n.TraceLevel.Info:n.TraceLevel.Verbose,n.SshTraceEventIds.debugMessage,e.message)}async raiseAuthenticatingEvent(e){this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionAuthenticating,`${this} Authenticating(${e})`),this.authenticatingEmitter.fire(e);let t=e.authenticationPromise;return t||(t=Promise.resolve(null)),await t}async request(e,t){if(!e)throw new TypeError("Request is required.");return e.wantReply?await this.requestResponse(e,v.SessionRequestSuccessMessage,v.SessionRequestFailureMessage,t)instanceof v.SessionRequestSuccessMessage:(await this.sendMessage(e,t),!0)}async requestResponse(e,t,r,n){if(!e)throw new TypeError("Request is required.");if(!t)throw new TypeError("Success response type is required.");if(!r)throw new TypeError("Failure response type is required.");if(this.requestHandler)throw new Error("Another request is already pending.");e.wantReply=!0;const s=new S.PromiseCompletionSource;if(n){if(n.isCancellationRequested)throw new T.CancellationError;n.onCancellationRequested((()=>{this.requestHandler=null,s.reject(new T.CancellationError)}))}return this.requestHandler=(e,n)=>{var i,o;if(this.requestHandler=null,e)s.reject(e);else if(n instanceof v.SessionRequestFailureMessage){const e=null!==(i=null==n?void 0:n.convertTo(new r,!0))&&void 0!==i?i:null;s.resolve(e)}else if(n instanceof v.SessionRequestSuccessMessage){const e=null!==(o=null==n?void 0:n.convertTo(new t,!0))&&void 0!==o?o:null;s.resolve(e)}else s.reject(new Error("Unknown response message type."))},await this.sendMessage(e,n),await s.promise}handleRequestSuccessMessage(e){this.requestHandler&&this.requestHandler(void 0,e)}handleRequestFailureMessage(e){this.requestHandler&&this.requestHandler(void 0,e)}async acceptChannel(e,t){const r="string"==typeof e?e:void 0;t||"object"!=typeof e||(t=e),this.activateService(d.ConnectionService);const n=this.connectionService.acceptChannel(r||a.SshChannel.sessionChannelType,t);return await n}async openChannel(e,t,r){let n;if("string"==typeof e||null===e?(n=new m.ChannelOpenMessage,n.channelType=null!=e?e:a.SshChannel.sessionChannelType):e instanceof m.ChannelOpenMessage?n=e:(n=new m.ChannelOpenMessage,n.channelType=a.SshChannel.sessionChannelType,r=e),t instanceof m.ChannelRequestMessage)return await this.openChannelWithInitialRequest(n,t,r);r||null===t||(r=t),this.activateService(d.ConnectionService);const s=new S.PromiseCompletionSource;return await this.connectionService.openChannel(n,s,r),await s.promise}async openChannelWithInitialRequest(e,t,r){var n;this.activateService(d.ConnectionService);const s=new S.PromiseCompletionSource,i=await this.connectionService.openChannel(e,s,r);if(r){if(r.isCancellationRequested)throw new T.CancellationError;r.onCancellationRequested((()=>s.reject(new T.CancellationError)))}let a,c;const l=this.config.protocolExtensions.includes(o.SshProtocolExtensionNames.openChannelRequest)&&(null===(n=this.protocolExtensions)||void 0===n?void 0:n.has(o.SshProtocolExtensionNames.openChannelRequest));if(!1===l)a=await s.promise,c=await a.request(t,r);else{const e=t.wantReply||void 0===l,n=new v.SessionChannelRequestMessage;n.requestType="initial-channel-request@microsoft.com",n.senderChannel=i,n.request=t,n.wantReply=e;const o=this.request(n,r);a=await s.promise,e?(c=await o,c||void 0!==l||(c=await a.request(t))):c=!0}if(!c)throw await a.close(),new Error("The initial channel request was denied.");return a}async handleChannelOpening(e,t,r=!0){if(r){const r=(0,h.findService)(this.config.services,(t=>t.channelType===e.channel.channelType&&!t.channelRequest));if(r){const n=this.activateService(r);return void await n.onChannelOpening(e,t)}}e.cancellation=null!=t?t:i.CancellationToken.None,this.channelOpeningEmitter.fire(e)}async sendExtensionInfo(e){const t=new v.ExtensionInfoMessage;t.extensionInfo={};for(const e of this.config.protocolExtensions)if(e===o.SshProtocolExtensionNames.serverSignatureAlgorithms){const r=Array.from(new Set((0,E.algorithmNames)(this.config.publicKeyAlgorithms))).join(",");t.extensionInfo[e]=r}else t.extensionInfo[e]="";await this.sendMessage(t,e)}async handleExtensionInfoMessage(e,t){if(this.protocol&&(this.protocol.extensions=new Map,e.extensionInfo)){for(const t of this.config.protocolExtensions){const r=e.extensionInfo[t];"string"==typeof r&&this.protocol.extensions.set(t,r)}this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionReconnect)&&await this.enableReconnect(t)}}async close(e,t,r){var s,i,o;if(!this.disposed&&this.connected){if(this.connected=!1,this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionClosing,`${this} Close(${v.SshDisconnectReason[e]}, "${t||""}")`),e!==v.SshDisconnectReason.connectionLost)try{const r=new v.DisconnectMessage;r.reasonCode=e,r.description=t||"",await(null===(s=this.protocol)||void 0===s?void 0:s.sendMessage(r))}catch(e){}else if(this.handleDisconnected())return null===(i=this.protocol)||void 0===i||i.dispose(),this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionDisconnected,`${this} disconnected.`),void this.disconnectedEmitter.fire();this.disposed=!0,this.closedError=r,(r=null!=r?r:new C.SshConnectionError(t,e))&&(null===(o=this.connectionService)||void 0===o||o.close(r)),this.closedEmitter.fire(new b.SshSessionClosedEventArgs(e,t||"Disconnected.",r)),this.dispose()}}handleDisconnected(){var e,t;return this.connectPromise=void 0,null===(e=this.kexService)||void 0===e||e.abortKeyExchange(),!!(null===(t=this.protocolExtensions)||void 0===t?void 0:t.has(o.SshProtocolExtensionNames.sessionReconnect))}async handleDisconnectMessage(e){var t;const r=e.description||"Received disconnect message.";await this.close(null!==(t=e.reasonCode)&&void 0!==t?t:v.SshDisconnectReason.none,r)}dispose(){var e,t;const r=this.closedError instanceof C.SshConnectionError?this.closedError:new C.SshConnectionError("Session disposed.");this.disposed||(this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionClosing,`${this} disposed.`),this.disposed=!0,this.closedEmitter.fire(new b.SshSessionClosedEventArgs(v.SshDisconnectReason.none,"SshSession disposed",r))),this.requestHandler&&this.requestHandler(r),this.metrics.close(),null===(e=this.connectionService)||void 0===e||e.dispose();for(const e of this.activatedServices.values())e!==this.connectionService&&e.dispose();this.activatedServices.clear(),null===(t=this.protocol)||void 0===t||t.dispose(),this.protocol=void 0}async enableReconnect(e){var t;try{if(await this.blockedMessagesSemaphore.wait(),null===(t=this.kexService)||void 0===t?void 0:t.exchanging)this.trace(n.TraceLevel.Error,n.SshTraceEventIds.sessionReconnectInitFailed,"Failed to initialize session reconnect because a key-exchange was in-progress.");else{const t=new v.SessionRequestMessage("enable-session-reconnect@microsoft.com",!1);await this.protocol.sendMessage(t,e),this.protocol&&(this.protocol.outgoingMessagesHaveReconnectInfo=!0,this.protocol.outgoingMessagesHaveLatencyInfo=this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionLatency))}this.blockedMessagesSemaphore.release()}catch(e){throw this.blockedMessagesSemaphore.release(),e instanceof Error&&await this.close(v.SshDisconnectReason.protocolError,void 0,e),e}}async createReconnectToken(e,t){return await this.algorithms.signer.sign(s.Buffer.concat([e,t]))}async verifyReconnectToken(e,t,r){return await this.algorithms.verifier.verify(s.Buffer.concat([e,t]),r)}pipe(e){return A.PipeExtensions.pipeSession(this,e)}toString(){return this.constructor.name}}t.SshSession=R,R.localVersion=c.SshVersionInfo.getLocalVersion()},890:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionAlgorithms=void 0,t.SshSessionAlgorithms=class{dispose(){this.cipher&&this.cipher.dispose(),this.decipher&&this.decipher.dispose(),this.signer&&this.signer.dispose(),this.verifier&&this.verifier.dispose()}}},9872:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionConfiguration=t.SshProtocolExtensionNames=void 0;const n=r(5844),s=r(7521),i=r(4237),o=r(3193),a=r(5263),c=r(6744);var l;!function(e){e.serverSignatureAlgorithms="server-sig-algs",e.openChannelRequest="open-channel-request@microsoft.com",e.sessionReconnect="session-reconnect@microsoft.com",e.sessionLatency="session-latency@microsoft.com"}(l=t.SshProtocolExtensionNames||(t.SshProtocolExtensionNames={})),t.SshSessionConfiguration=class{constructor(e=!0){this.protocolExtensions=[],this.services=new Map,this.messages=new Map,this.keyExchangeAlgorithms=[],this.publicKeyAlgorithms=[],this.encryptionAlgorithms=[],this.hmacAlgorithms=[],this.compressionAlgorithms=[],this.traceChannelDataValue=!1,this.configurationChangedEmitter=new n.Emitter,this.onConfigurationChanged=this.configurationChangedEmitter.event,this.maxClientAuthenticationAttempts=5,this.enableKeyExchangeGuess=!1,this.keyRotationThreshold=536870912,this.protocolExtensions.push(l.serverSignatureAlgorithms),this.protocolExtensions.push(l.openChannelRequest),this.services.set(i.KeyExchangeService,null),this.services.set(o.ConnectionService,null),this.services.set(a.AuthenticationService,null);for(const[e,t]of c.SshMessage.index)this.messages.set(e,t);e?(this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.ecdhNistp384Sha384),this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.ecdhNistp256Sha256),this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.dhGroup16Sha512),this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.dhGroup14Sha256),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.rsaWithSha512),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.rsaWithSha256),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.ecdsaSha2Nistp384),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.ecdsaSha2Nistp256),this.encryptionAlgorithms.push(s.SshAlgorithms.encryption.aes256Gcm),this.encryptionAlgorithms.push(s.SshAlgorithms.encryption.aes256Ctr),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.hmacSha512Etm),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.hmacSha256Etm),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.hmacSha512),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.hmacSha256)):(this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.none),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.none),this.encryptionAlgorithms.push(s.SshAlgorithms.encryption.none),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.none)),this.compressionAlgorithms.push(s.SshAlgorithms.compression.none)}addService(e,t){if(this.services.has(e))throw new Error("Duplicate service entry.");this.services.set(e,t)}getKeyExchangeAlgorithm(e){return this.getAlgorithm(e,this.keyExchangeAlgorithms)}getPublicKeyAlgorithm(e){return this.getAlgorithm(e,this.publicKeyAlgorithms)}getEncryptionAlgorithm(e){return this.getAlgorithm(e,this.encryptionAlgorithms)}getHmacAlgorithm(e){return this.getAlgorithm(e,this.hmacAlgorithms)}getCompressionAlgorithm(e){return this.getAlgorithm(e,this.compressionAlgorithms)}getAlgorithm(e,t){const r=t.find((t=>!!t&&t.name===e));if(!r){if("none"===e)return null;throw new Error("Algorithm not found: "+e)}return r}get traceChannelData(){return this.traceChannelDataValue}set traceChannelData(e){e!==this.traceChannelDataValue&&(this.traceChannelDataValue=e,this.configurationChangedEmitter.fire())}}},6373:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshStream=void 0;const n=r(3305),s=r(2781);class i extends s.Duplex{constructor(e){let t=null;super({async write(t,r,n){let s;try{let n;if("string"==typeof t)n=Buffer.from(t,r);else{if(!(t instanceof Buffer||t instanceof Uint8Array))throw new Error("Unsupported chunk type: "+typeof t);n=t}await e.send(n)}catch(e){if(!(e instanceof Error))throw e;s=e}n&&n(s)},async writev(t,r){let n;try{if(1===t.length)return this.write(t[0].chunk,t[0].encoding,r);{function s(e,t){if(t.chunk instanceof Buffer||t.chunk instanceof Uint8Array)return e+t.chunk.length;throw new Error("Unsupported chunk type: "+typeof t.chunk)}const i=t.reduce(s,0),o=Buffer.alloc(i);let a=0;for(let c=0;c<t.length;c++)t[c].chunk.copy(o,a),a+=t[c].chunk.length;await e.send(o)}}catch(l){if(!(l instanceof Error))throw l;n=l}r&&r(n)},async final(t){let r;try{await e.close()}catch(e){if(!(e instanceof Error))throw e;r=e}t&&t(r)},read(){t&&(t.resolve(),t=null)}}),e.onDataReceived((async r=>{const s=Buffer.alloc(r.length);r.copy(s),this.push(s)||(t||(t=new n.PromiseCompletionSource),await t.promise),e.adjustWindow(s.length)})),e.onClosed((()=>{this.push(null)})),this.channel=e}destroy(e){return this.channel.close().catch(),super.destroy(e),this}toString(){return`SshStream(Channel Type: ${this.channel.channelType}, Id: ${this.channel.channelId}, RemoteId: ${this.channel.remoteChannelId})`}}t.SshStream=i},1163:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshVersionInfo=void 0;const n=r(4369),s=n.name.replace(/^@\w+\//,""),i=n.version;class o{static tryParse(e){if(!e)throw new TypeError("Version string expected.");if(!e.startsWith("SSH-"))return null;const t=e.indexOf("-",4);if(t<=0)return null;const r=e.substring(4,t);if(!/^\d+\.\d+$/.test(r))return null;let n,s;const i=e.substring(t+1),a=i.indexOf(" "),c=i.lastIndexOf("_",a>=0?a:i.length-1);if(c>=0){n=i.substring(0,c).replace(/_/g," "),s=i.substring(c+1);for(let e=0;e<s.length;e++){const t=s[e];if(!(t>="0"&&t<="9")&&"."!==t){s=s.substring(0,e);break}}/^\d+(\.\d+)*$/.test(s)||(s=null)}else n=i,s=null;return new o(e,r,n,s)}static getLocalVersion(){return new o(`SSH-2.0-${s}_${i}`,"2.0",s,i)}constructor(e,t,r,n){this.versionString=e,this.protocolVersion=t,this.name=r,this.version=n}toString(){return this.versionString}get isVsSsh(){return this.isVsSshCS||this.isVsSshTS}get isVsSshCS(){return"Microsoft.VisualStudio.Ssh"===this.name||"Microsoft.DevTunnels.Ssh"===this.name}get isVsSshTS(){return"vs-ssh"===this.name||"dev-tunnels-ssh"===this.name}}t.SshVersionInfo=o},3538:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketStream=t.NodeStream=t.BaseStream=void 0;const n=r(4300),s=r(5844),i=r(9638),o=r(4608);function a(e,t){t&&(t.isCancellationRequested?e(new i.CancellationError):t.onCancellationRequested((()=>{e(new i.CancellationError)})))}class c{constructor(){this.incomingData=[],this.pendingReads=[],this.error=null,this.disposed=!1,this.closedEmitter=new s.Emitter,this.closed=this.closedEmitter.event}onData(e){for(;this.pendingReads.length>0;){const t=this.pendingReads.shift();if(t.count>=e.length)return void t.resolve(e);{const r=e.slice(0,t.count);e=e.slice(t.count),t.resolve(r)}}this.incomingData.push(e)}onEnd(){for(;this.pendingReads.length>0;)this.pendingReads.shift().resolve(null);this.incomingData.push(n.Buffer.alloc(0))}onError(e){for(this.error||(this.error=e);this.pendingReads.length>0;)this.pendingReads.shift().reject(e)}async read(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);if(this.incomingData.length>0){let t=this.incomingData[0];return 0===t.length?null:(e>=t.length?this.incomingData.shift():(this.incomingData[0]=t.slice(e),t=t.slice(0,e)),t)}if(this.error)throw this.error;return await new Promise(((r,n)=>{if(t){if(t.isCancellationRequested)return void n(new i.CancellationError);t.onCancellationRequested((()=>{for(let e=0;e<this.pendingReads.length;e++)Object.is(t,this.pendingReads[e].cancellation)&&this.pendingReads.splice(e--,1)[0].reject(new i.CancellationError)}))}this.pendingReads.push({count:e,resolve:r,reject:n,cancellation:t})}))}dispose(){if(!this.disposed){this.disposed=!0;const e=new o.ObjectDisposedError(this);this.onError(e),this.fireOnClose(e)}}fireOnClose(e){this.closedEmitter.fire({error:e})}get isDisposed(){return this.disposed}}t.BaseStream=c,t.NodeStream=class extends c{constructor(e,t){if(super(),!e)throw new TypeError("Duplex or Readable/Writable stream are required.");this.readStream=e,this.writeStream=t||e,this.readStream.on("data",this.onData.bind(this)),this.readStream.on("end",this.onEnd.bind(this)),this.readStream.on("error",this.onError.bind(this)),this.readStream.on("close",(()=>{this.onEnd(),this.fireOnClose()}))}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new o.ObjectDisposedError(this);return new Promise(((r,n)=>{a(n,t),this.writeStream.write(e,(e=>{e?n(e):r()}))}))}async close(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);await new Promise(((e,r)=>{a(r,t),this.writeStream.end(e)})),this.disposed=!0,this.onError(e||new o.ObjectDisposedError(this)),this.closedEmitter.fire({error:e})}dispose(){if(!this.disposed){const e=new o.ObjectDisposedError(this);this.readStream.destroy(e),this.writeStream.destroy(e)}super.dispose()}},t.WebSocketStream=class extends c{constructor(e){if(super(),this.websocket=e,!e)throw new TypeError("WebSocket is required.");if("string"==typeof e.binaryType&&"arraybuffer"!==e.binaryType)throw new Error("WebSocket must use arraybuffer binary type.");e.onmessage=e=>{this.onData(n.Buffer.from(e.data))},e.onclose=e=>{if(e.wasClean)this.onEnd();else{const t=new Error(e.reason);t.code=e.code,this.onError(t)}}}get protocol(){return this.websocket.protocol}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new o.ObjectDisposedError(this);if("readyState"in this.websocket&&(2===this.websocket.readyState||3===this.websocket.readyState))throw new DOMException("WebSocket is already in CLOSING or CLOSED state.","InvalidStateError");this.websocket.send(e)}async close(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);if(e){const t="number"==typeof e.code?e.code:void 0;this.websocket.close(t,e.message)}else this.websocket.close();this.disposed=!0,this.closedEmitter.fire({error:e}),this.onError(e||new Error("Stream closed."))}dispose(){this.disposed||this.websocket.close(),super.dispose()}}},6197:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SshTraceEventIds=t.TraceLevel=void 0,(r=t.TraceLevel||(t.TraceLevel={})).Error="error",r.Warning="warning",r.Info="info",r.Verbose="verbose";class n{}t.SshTraceEventIds=n,n.unknownError=9e3,n.streamReadError=9001,n.streamWriteError=9002,n.streamCloseError=9003,n.sendMessageFailed=9004,n.receiveMessageFailed=9005,n.handleMessageFailed=9006,n.serverAuthenticationFailed=9007,n.clientAuthenticationFailed=9008,n.authenticationError=9009,n.channelWindowAdjustFailed=9010,n.channelWaitForWindowAdjust=9011,n.sessionReconnectInitFailed=9020,n.serverSessionReconnectFailed=9021,n.clientSessionReconnectFailed=9022,n.sessionRequestFailed=9023,n.channelRequestFailed=9024,n.serverListenFailed=9050,n.portForwardServerListenFailed=9051,n.portForwardRequestInvalid=9052,n.portForwardChannelInvalid=9053,n.portForwardChannelOpenFailed=9054,n.portForwardConnectionFailed=9055,n.protocolVersion=9100,n.sendingMessage=9101,n.receivingMessage=9102,n.sendingChannelData=9103,n.receivingChannelData=9104,n.sessionEncrypted=9110,n.sessionAuthenticating=9111,n.sessionAuthenticated=9112,n.sessionClosing=9113,n.sessionConnecting=9114,n.channelOpened=9120,n.channelOpenFailed=9121,n.channelEofReceived=9122,n.channelClosed=9123,n.serverListening=9150,n.serverClientConnected=9151,n.portForwardServerListening=9152,n.portForwardConnectionAccepted=9153,n.portForwardChannelOpened=9154,n.portForwardChannelClosed=9155,n.portForwardConnectionOpened=9156,n.portForwardConnectionClosed=9157,n.sessionDisconnected=9160,n.clientSessionReconnecting=9161,n.serverSessionReconnecting=9162,n.clientSessionStartReconnecting=9163,n.algorithmNegotiation=9170,n.debugMessage=9200},9638:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withCancellation=t.CancellationError=t.CancellationTokenSource=t.CancellationToken=void 0;const n=r(5844);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return n.CancellationToken}}),Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return n.CancellationTokenSource}});class s extends Error{constructor(e){super(e||"Operation cancelled.")}}t.CancellationError=s,t.withCancellation=function(e,t){return t?Promise.race([e,new Promise(((e,r)=>{t.isCancellationRequested?r(new s):t.onCancellationRequested((()=>{r(new s)}))}))]):e}},3305:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseCompletionSource=void 0,t.PromiseCompletionSource=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}resolve(e){}reject(e){}}},6655:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;class r{constructor(){this.array=new Array,this.first=0,this.count=0,this.version=0}get size(){return this.count}enqueue(e){if(this.count===this.array.length){const e=new Array(Math.max(16,2*this.count));for(let t=0;t<this.count;t++)e[t]=this.array[(this.first+t)%this.count];this.array=e,this.first=0}this.array[(this.first+this.count)%this.array.length]=e,this.count++,this.version++}dequeue(){if(0===this.count)return;const e=this.array[this.first];return this.array[this.first]=void 0,this.first=(this.first+1)%this.array.length,this.count--,this.version++,e}peek(){if(0!==this.count)return this.array[this.first]}clear(){this.first=0,this.count=0,this.array.fill(void 0),this.version++}*[Symbol.iterator](){const e=this.version;for(let t=0;t<this.count;t++){const r=this.array[(this.first+t)%this.array.length];if(yield r,this.version!==e)throw new Error("Iterator is invalid due to changes in the collection.")}}}t.Queue=r},7399:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const n=r(3305),s=r(9638),i=r(4608);t.Semaphore=class{constructor(e=0){this.completions=[],this.disposed=!1,this.count=e}get currentCount(){return this.count}release(e=1){if(this.disposed)throw new i.ObjectDisposedError(this);const t=this.count;for(;e>0;e--)this.completions.length>0?this.completions.shift().resolve(!0):this.count++;return t}tryRelease(){try{this.release()}catch(e){if(!(e instanceof i.ObjectDisposedError))throw e}}async wait(e,t){const r="number"==typeof e?e:void 0;if(void 0===t&&"object"==typeof e&&(t=e),this.disposed)throw new i.ObjectDisposedError(this);if(null==t?void 0:t.isCancellationRequested)throw new s.CancellationError;if(this.count>0)return this.count--,!0;if(0===r)return!1;{const e=new n.PromiseCompletionSource;this.completions.push(e);const i=[e.promise];if(r&&i.push(new Promise((e=>setTimeout((()=>e(!1)),r)))),t){const e=new n.PromiseCompletionSource;t.onCancellationRequested((()=>{e.reject(new s.CancellationError)})),i.push(e.promise)}if(await Promise.race(i))return!0;{const t=this.completions.indexOf(e);return t>=0&&this.completions.splice(t,1),!1}}}dispose(){if(!this.disposed){this.disposed=!0;for(const e of this.completions)e.reject(new i.ObjectDisposedError(this));this.completions.splice(0,this.completions.length),this.count=0}}}},1034:(e,t,r)=>{var n,s=Object.create,i=Object.defineProperty,o=Object.defineProperties,a=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,f=(e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))d.call(t,r)&&f(e,r,t[r]);if(u)for(var r of u(t))p.call(t,r)&&f(e,r,t[r]);return e},m=(e,t)=>o(e,c(t)),y=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),v=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of l(t))!d.call(e,s)&&s!==r&&i(e,s,{get:()=>t[s],enumerable:!(n=a(t,s))||n.enumerable});return e},w=(e,t,r)=>(r=null!=e?s(h(e)):{},v(!t&&e&&e.__esModule?r:i(r,"default",{value:e,enumerable:!0}),e)),S=y(((e,t)=>{"use strict";var r=function(){function e(){}return e.info=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.enableDebug&&console.info(e.TAG+t,r)},e.warn=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.disableWarnings||console.warn(e.TAG+t,r)},e.enableDebug=!1,e.disableWarnings=!1,e.disableErrors=!1,e.TAG="ApplicationInsights:",e}();t.exports=r})),b=y((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.AsyncScopeManager=e.OpenTelemetryScopeManagerWrapper=void 0;var n=yn(),s=r(2361),i=function(){function e(){}return e.prototype.active=function(){var e=this,r=n.CorrelationContextManager.getCurrentContext();return t(t({},r),{getValue:function(t){return e._activeSymbol?t===e._activeSymbol&&r:(e._activeSymbol=t,r)},setValue:function(){}})},e.prototype.with=function(t,r){var s=t.parentSpanId,i=t.name,o=e._spanToContext(t,s,i);return n.CorrelationContextManager.runWithContext(o,r)()},e.prototype.bind=function(e){return"function"==typeof e?n.CorrelationContextManager.wrapCallback(e):(e instanceof s.EventEmitter&&n.CorrelationContextManager.wrapEmitter(e),e)},e.prototype.enable=function(){return n.CorrelationContextManager.enable(),this},e.prototype.disable=function(){return n.CorrelationContextManager.disable(),this},e._spanToContext=function(e,r,s){var i=r?"|"+e.spanContext().traceId+"."+r+".":e.spanContext().traceId,o=t(t({},e.spanContext()),{traceFlags:e.spanContext().traceFlags});return n.CorrelationContextManager.spanToContextObject(o,i,s)},e}();e.OpenTelemetryScopeManagerWrapper=i,e.AsyncScopeManager=new i})),_=y(((e,t)=>{var r;e=t.exports=z,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,s=e.re=[],i=e.src=[],o=0,a=o++;i[a]="0|[1-9]\\d*";var c=o++;i[c]="[0-9]+";var l=o++;i[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var u=o++;i[u]="("+i[a]+")\\.("+i[a]+")\\.("+i[a]+")";var h=o++;i[h]="("+i[c]+")\\.("+i[c]+")\\.("+i[c]+")";var d=o++;i[d]="(?:"+i[a]+"|"+i[l]+")";var p=o++;i[p]="(?:"+i[c]+"|"+i[l]+")";var f=o++;i[f]="(?:-("+i[d]+"(?:\\."+i[d]+")*))";var g=o++;i[g]="(?:-?("+i[p]+"(?:\\."+i[p]+")*))";var m=o++;i[m]="[0-9A-Za-z-]+";var y=o++;i[y]="(?:\\+("+i[m]+"(?:\\."+i[m]+")*))";var v=o++,w="v?"+i[u]+i[f]+"?"+i[y]+"?";i[v]="^"+w+"$";var S="[v=\\s]*"+i[h]+i[g]+"?"+i[y]+"?",b=o++;i[b]="^"+S+"$";var _=o++;i[_]="((?:<|>)?=?)";var E=o++;i[E]=i[c]+"|x|X|\\*";var T=o++;i[T]=i[a]+"|x|X|\\*";var C=o++;i[C]="[v=\\s]*("+i[T]+")(?:\\.("+i[T]+")(?:\\.("+i[T]+")(?:"+i[f]+")?"+i[y]+"?)?)?";var P=o++;i[P]="[v=\\s]*("+i[E]+")(?:\\.("+i[E]+")(?:\\.("+i[E]+")(?:"+i[g]+")?"+i[y]+"?)?)?";var A=o++;i[A]="^"+i[_]+"\\s*"+i[C]+"$";var R=o++;i[R]="^"+i[_]+"\\s*"+i[P]+"$";var I=o++;i[I]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var x=o++;i[x]="(?:~>?)";var O=o++;i[O]="(\\s*)"+i[x]+"\\s+",s[O]=new RegExp(i[O],"g");var k=o++;i[k]="^"+i[x]+i[C]+"$";var M=o++;i[M]="^"+i[x]+i[P]+"$";var N=o++;i[N]="(?:\\^)";var D=o++;i[D]="(\\s*)"+i[N]+"\\s+",s[D]=new RegExp(i[D],"g");var L=o++;i[L]="^"+i[N]+i[C]+"$";var B=o++;i[B]="^"+i[N]+i[P]+"$";var q=o++;i[q]="^"+i[_]+"\\s*("+S+")$|^$";var j=o++;i[j]="^"+i[_]+"\\s*("+w+")$|^$";var F=o++;i[F]="(\\s*)"+i[_]+"\\s*("+S+"|"+i[C]+")",s[F]=new RegExp(i[F],"g");var U=o++;i[U]="^\\s*("+i[C]+")\\s+-\\s+("+i[C]+")\\s*$";var $=o++;i[$]="^\\s*("+i[P]+")\\s+-\\s+("+i[P]+")\\s*$";var H,K=o++;for(i[K]="(<|>)?=?\\s*\\*",H=0;H<35;H++)r(H,i[H]),s[H]||(s[H]=new RegExp(i[H]));function V(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof z)return e;if("string"!=typeof e||e.length>256)return null;if(!(t.loose?s[b]:s[v]).test(e))return null;try{return new z(e,t)}catch{return null}}function z(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof z){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof z))return new z(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var i=e.trim().match(t.loose?s[b]:s[v]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}e.parse=V,e.valid=function(e,t){var r=V(e,t);return r?r.version:null},e.clean=function(e,t){var r=V(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},e.SemVer=z,z.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},z.prototype.toString=function(){return this.version},z.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof z||(e=new z(e,this.options)),this.compareMain(e)||this.comparePre(e)},z.prototype.compareMain=function(e){return e instanceof z||(e=new z(e,this.options)),G(this.major,e.major)||G(this.minor,e.minor)||G(this.patch,e.patch)},z.prototype.comparePre=function(e){if(e instanceof z||(e=new z(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],s=e.prerelease[t];if(r("prerelease compare",t,n,s),void 0===n&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===n)return-1;if(n!==s)return G(n,s)}while(++t)},z.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},e.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new z(e,r).inc(t,n).version}catch{return null}},e.diff=function(e,t){if(J(e,t))return null;var r=V(e),n=V(t),s="";if(r.prerelease.length||n.prerelease.length){s="pre";var i="prerelease"}for(var o in r)if(("major"===o||"minor"===o||"patch"===o)&&r[o]!==n[o])return s+o;return i},e.compareIdentifiers=G;var W=/^[0-9]+$/;function G(e,t){var r=W.test(e),n=W.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function Y(e,t,r){return new z(e,r).compare(new z(t,r))}function Q(e,t,r){return Y(e,t,r)>0}function X(e,t,r){return Y(e,t,r)<0}function J(e,t,r){return 0===Y(e,t,r)}function Z(e,t,r){return 0!==Y(e,t,r)}function ee(e,t,r){return Y(e,t,r)>=0}function te(e,t,r){return Y(e,t,r)<=0}function re(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return J(e,r,n);case"!=":return Z(e,r,n);case">":return Q(e,r,n);case">=":return ee(e,r,n);case"<":return X(e,r,n);case"<=":return te(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ne(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof ne){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ne))return new ne(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===se?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}e.rcompareIdentifiers=function(e,t){return G(t,e)},e.major=function(e,t){return new z(e,t).major},e.minor=function(e,t){return new z(e,t).minor},e.patch=function(e,t){return new z(e,t).patch},e.compare=Y,e.compareLoose=function(e,t){return Y(e,t,!0)},e.rcompare=function(e,t,r){return Y(t,e,r)},e.sort=function(t,r){return t.sort((function(t,n){return e.compare(t,n,r)}))},e.rsort=function(t,r){return t.sort((function(t,n){return e.rcompare(t,n,r)}))},e.gt=Q,e.lt=X,e.eq=J,e.neq=Z,e.gte=ee,e.lte=te,e.cmp=re,e.Comparator=ne;var se={};function ie(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof ie)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new ie(e.raw,t);if(e instanceof ne)return new ie(e.value,t);if(!(this instanceof ie))return new ie(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function oe(e){return!e||"x"===e.toLowerCase()||"*"===e}function ae(e,t,r,n,s,i,o,a,c,l,u,h,d){return((t=oe(r)?"":oe(n)?">="+r+".0.0":oe(s)?">="+r+"."+n+".0":">="+t)+" "+(a=oe(c)?"":oe(l)?"<"+(+c+1)+".0.0":oe(u)?"<"+c+"."+(+l+1)+".0":h?"<="+c+"."+l+"."+u+"-"+h:"<="+a)).trim()}function ce(e,t,n){for(var s=0;s<e.length;s++)if(!e[s].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(s=0;s<e.length;s++)if(r(e[s].semver),e[s].semver!==se&&e[s].semver.prerelease.length>0){var i=e[s].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new ie(t,r)}catch{return!1}return t.test(e)}function ue(e,t,r,n){var s,i,o,a,c;switch(e=new z(e,n),t=new ie(t,n),r){case">":s=Q,i=te,o=X,a=">",c=">=";break;case"<":s=X,i=ee,o=Q,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],h=null,d=null;if(u.forEach((function(e){e.semver===se&&(e=new ne(">=0.0.0")),h=h||e,d=d||e,s(e.semver,h.semver,n)?h=e:o(e.semver,d.semver,n)&&(d=e)})),h.operator===a||h.operator===c||(!d.operator||d.operator===a)&&i(e,d.semver))return!1;if(d.operator===c&&o(e,d.semver))return!1}return!0}ne.prototype.parse=function(e){var t=this.options.loose?s[q]:s[j],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new z(r[2],this.options.loose):this.semver=se},ne.prototype.toString=function(){return this.value},ne.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===se||("string"==typeof e&&(e=new z(e,this.options)),re(e,this.operator,this.semver,this.options))},ne.prototype.intersects=function(e,t){if(!(e instanceof ne))throw new TypeError("a Comparator is required");var r;if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new ie(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new ie(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),s=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||s||i&&o||a||c},e.Range=ie,ie.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},ie.prototype.toString=function(){return this.range},ie.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?s[$]:s[U];e=e.replace(n,ae),r("hyphen replace",e),e=e.replace(s[F],"$1$2$3"),r("comparator trim",e,s[F]),e=(e=(e=e.replace(s[O],"$1~")).replace(s[D],"$1^")).split(/\s+/).join(" ");var i=t?s[q]:s[j],o=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?s[B]:s[L];return e.replace(n,(function(t,n,s,i,o){var a;return r("caret",e,t,n,s,i,o),oe(n)?a="":oe(s)?a=">="+n+".0.0 <"+(+n+1)+".0.0":oe(i)?a="0"===n?">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0":">="+n+"."+s+".0 <"+(+n+1)+".0.0":o?(r("replaceCaret pr",o),a="0"===n?"0"===s?">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+s+"."+(+i+1):">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+(+s+1)+".0":">="+n+"."+s+"."+i+"-"+o+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===s?">="+n+"."+s+"."+i+" <"+n+"."+s+"."+(+i+1):">="+n+"."+s+"."+i+" <"+n+"."+(+s+1)+".0":">="+n+"."+s+"."+i+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?s[M]:s[k];return e.replace(n,(function(t,n,s,i,o){var a;return r("tilde",e,t,n,s,i,o),oe(n)?a="":oe(s)?a=">="+n+".0.0 <"+(+n+1)+".0.0":oe(i)?a=">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0":o?(r("replaceTilde pr",o),a=">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+(+s+1)+".0"):a=">="+n+"."+s+"."+i+" <"+n+"."+(+s+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?s[R]:s[A];return e.replace(n,(function(t,n,s,i,o,a){r("xRange",e,t,n,s,i,o,a);var c=oe(s),l=c||oe(i),u=l||oe(o);return"="===n&&u&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&u?(l&&(i=0),o=0,">"===n?(n=">=",l?(s=+s+1,i=0,o=0):(i=+i+1,o=0)):"<="===n&&(n="<",l?s=+s+1:i=+i+1),t=n+s+"."+i+"."+o):l?t=">="+s+".0.0 <"+(+s+1)+".0.0":u&&(t=">="+s+"."+i+".0 <"+s+"."+(+i+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(s[K],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter((function(e){return!!e.match(i)}))),o.map((function(e){return new ne(e,this.options)}),this)},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},e.toComparators=function(e,t){return new ie(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},ie.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new z(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},e.satisfies=le,e.maxSatisfying=function(e,t,r){var n=null,s=null;try{var i=new ie(t,r)}catch{return null}return e.forEach((function(e){i.test(e)&&(!n||-1===s.compare(e))&&(s=new z(n=e,r))})),n},e.minSatisfying=function(e,t,r){var n=null,s=null;try{var i=new ie(t,r)}catch{return null}return e.forEach((function(e){i.test(e)&&(!n||1===s.compare(e))&&(s=new z(n=e,r))})),n},e.minVersion=function(e,t){e=new ie(e,t);var r=new z("0.0.0");if(e.test(r)||(r=new z("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n)e.set[n].forEach((function(e){var t=new z(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":(!r||Q(r,t))&&(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return r&&e.test(r)?r:null},e.validRange=function(e,t){try{return new ie(e,t).range||"*"}catch{return null}},e.ltr=function(e,t,r){return ue(e,t,"<",r)},e.gtr=function(e,t,r){return ue(e,t,">",r)},e.outside=ue,e.prerelease=function(e,t){var r=V(e,t);return r&&r.prerelease.length?r.prerelease:null},e.intersects=function(e,t,r){return e=new ie(e,r),t=new ie(t,r),e.intersects(t)},e.coerce=function(e){if(e instanceof z)return e;if("string"!=typeof e)return null;var t=e.match(s[I]);return null==t?null:V(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}})),E=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makePatchingRequire=void 0;var t=r(1017),n=_(),s=r(8188),i=Object.keys(process.binding("natives")),o=s.prototype.require;e.makePatchingRequire=function(e){var r={};return function(a){var c=o.apply(this,arguments);if(e[a]){var l=s._resolveFilename(a,this);if(r.hasOwnProperty(l))return r[l];var u=void 0;if(i.indexOf(a)<0)try{u=o.call(this,t.join(a,"package.json")).version}catch{return c}else u=process.version.substring(1);var h=u.indexOf("-");h>=0&&(u=u.substring(0,h));for(var d=c,p=0,f=e[a];p<f.length;p++){var g=f[p];n.satisfies(u,g.versionSpecifier)&&(d=g.patch(d,l))}return r[l]=d}return c}}})),T=y(((e,t)=>{t.exports={name:"diagnostic-channel",version:"1.0.0",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}})),C=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.channel=e.makePatchingRequire=void 0;var t=E(),n=E();Object.defineProperty(e,"makePatchingRequire",{enumerable:!0,get:function(){return n.makePatchingRequire}});var s=function(e){return!0},i=function(){function e(){this.version=T().version,this.subscribers={},this.contextPreservationFunction=function(e){return e},this.knownPatches={},this.currentlyPublishing=!1}return e.prototype.shouldPublish=function(e){var t=this.subscribers[e];return!!t&&t.some((function(e){var t=e.filter;return!t||t(!1)}))},e.prototype.publish=function(e,t){if(!this.currentlyPublishing){var r=this.subscribers[e];if(r){var n={timestamp:Date.now(),data:t};this.currentlyPublishing=!0,r.forEach((function(e){var t=e.listener,r=e.filter;try{r&&r(!0)&&t(n)}catch{}})),this.currentlyPublishing=!1}}},e.prototype.subscribe=function(e,t,r){void 0===r&&(r=s),this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push({listener:t,filter:r})},e.prototype.unsubscribe=function(e,t,r){void 0===r&&(r=s);var n=this.subscribers[e];if(n)for(var i=0;i<n.length;++i)if(n[i].listener===t&&n[i].filter===r)return n.splice(i,1),!0;return!1},e.prototype.reset=function(){var e=this;this.subscribers={},this.contextPreservationFunction=function(e){return e},Object.getOwnPropertyNames(this.knownPatches).forEach((function(t){return delete e.knownPatches[t]}))},e.prototype.bindToContext=function(e){return this.contextPreservationFunction(e)},e.prototype.addContextPreservation=function(e){var t=this.contextPreservationFunction;this.contextPreservationFunction=function(r){return e(t(r))}},e.prototype.registerMonkeyPatch=function(e,t){this.knownPatches[e]||(this.knownPatches[e]=[]),this.knownPatches[e].push(t)},e.prototype.getPatchesObject=function(){return this.knownPatches},e}();global.diagnosticsSource||(global.diagnosticsSource=new i,r(8188).prototype.require=t.makePatchingRequire(global.diagnosticsSource.getPatchesObject())),e.channel=global.diagnosticsSource})),P=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),A=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._globalThis=void 0,e._globalThis="object"==typeof globalThis?globalThis:global})),R=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(A(),e)})),I=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(R(),e)})),x=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VERSION=void 0,e.VERSION="1.0.3"})),O=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isCompatible=e._makeCompatibilityCheck=void 0;var t=x(),r=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function n(e){var t=new Set([e]),n=new Set,s=e.match(r);if(!s)return function(){return!1};var i=+s[1],o=+s[2],a=+s[3];if(null!=s[4])return function(t){return t===e};function c(e){return n.add(e),!1}function l(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var s=e.match(r);if(!s)return c(e);var u=+s[1],h=+s[2],d=+s[3];return null!=s[4]||i!==u?c(e):0===i?o===h&&a<=d?l(e):c(e):o<=h?l(e):c(e)}}e._makeCompatibilityCheck=n,e.isCompatible=n(t.VERSION)})),k=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unregisterGlobal=e.getGlobal=e.registerGlobal=void 0;var t=I(),r=x(),n=O(),s=r.VERSION.split(".")[0],i=Symbol.for("opentelemetry.js.api."+s),o=t._globalThis;e.registerGlobal=function(e,t,n,s){var a;void 0===s&&(s=!1);var c=o[i]=null!==(a=o[i])&&void 0!==a?a:{version:r.VERSION};if(!s&&c[e]){var l=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(l.stack||l.message),!1}return c.version!==r.VERSION?(l=new Error("@opentelemetry/api: All API registration versions must match"),n.error(l.stack||l.message),!1):(c[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+r.VERSION+"."),!0)},e.getGlobal=function(e){var t,r,s=null===(t=o[i])||void 0===t?void 0:t.version;if(s&&n.isCompatible(s))return null===(r=o[i])||void 0===r?void 0:r[e]},e.unregisterGlobal=function(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+r.VERSION+".");var n=o[i];n&&delete n[e]}})),M=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagComponentLogger=void 0;var t=k(),r=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n("verbose",this._namespace,e)},e}();function n(e,r,n){var s=t.getGlobal("diag");if(s)return n.unshift(r),s[e].apply(s,n)}e.DiagComponentLogger=r})),N=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.DiagLogLevel=void 0,(t=e.DiagLogLevel||(e.DiagLogLevel={}))[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"})),D=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createLogLevelDiagLogger=void 0;var t=N();e.createLogLevelDiagLogger=function(e,r){function n(t,n){var s=r[t];return"function"==typeof s&&e>=n?s.bind(r):function(){}}return e<t.DiagLogLevel.NONE?e=t.DiagLogLevel.NONE:e>t.DiagLogLevel.ALL&&(e=t.DiagLogLevel.ALL),r=r||{},{error:n("error",t.DiagLogLevel.ERROR),warn:n("warn",t.DiagLogLevel.WARN),info:n("info",t.DiagLogLevel.INFO),debug:n("debug",t.DiagLogLevel.DEBUG),verbose:n("verbose",t.DiagLogLevel.VERBOSE)}}})),L=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagAPI=void 0;var t=M(),r=D(),n=N(),s=k(),i=function(){function e(){function e(e){return function(){var t=s.getGlobal("diag");if(t)return t[e].apply(t,arguments)}}var i=this;i.setLogger=function(e,t){var o,a;if(void 0===t&&(t=n.DiagLogLevel.INFO),e===i){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return i.error(null!==(o=c.stack)&&void 0!==o?o:c.message),!1}var l=s.getGlobal("diag"),u=r.createLogLevelDiagLogger(t,e);if(l){var h=null!==(a=(new Error).stack)&&void 0!==a?a:"<failed to generate stacktrace>";l.warn("Current logger will be overwritten from "+h),u.warn("Current logger will overwrite one already registered from "+h)}return s.registerGlobal("diag",u,i,!0)},i.disable=function(){s.unregisterGlobal("diag",i)},i.createComponentLogger=function(e){return new t.DiagComponentLogger(e)},i.verbose=e("verbose"),i.debug=e("debug"),i.info=e("info"),i.warn=e("warn"),i.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();e.DiagAPI=i})),B=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BaggageImpl=void 0;var t=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){return[e[0],e[1]]}))},e.prototype.setEntry=function(t,r){var n=new e(this._entries);return n._entries.set(t,r),n},e.prototype.removeEntry=function(t){var r=new e(this._entries);return r._entries.delete(t),r},e.prototype.removeEntries=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=new e(this._entries),s=0,i=t;s<i.length;s++){var o=i[s];n._entries.delete(o)}return n},e.prototype.clear=function(){return new e},e}();e.BaggageImpl=t})),q=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.baggageEntryMetadataSymbol=void 0,e.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")})),j=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.baggageEntryMetadataFromString=e.createBaggage=void 0;var t=L(),r=B(),n=q(),s=t.DiagAPI.instance();e.createBaggage=function(e){return void 0===e&&(e={}),new r.BaggageImpl(new Map(Object.entries(e)))},e.baggageEntryMetadataFromString=function(e){return"string"!=typeof e&&(s.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:n.baggageEntryMetadataSymbol,toString:function(){return e}}}})),F=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),U=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),$=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagConsoleLogger=void 0;var t=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];e.DiagConsoleLogger=function(){function e(e){return function(){var t=arguments;if(console){var r=console[e];if("function"!=typeof r&&(r=console.log),"function"==typeof r)return r.apply(console,t)}}}for(var r=0;r<t.length;r++)this[t[r].n]=e(t[r].c)}})),H=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r($(),e),r(N(),e)})),K=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultTextMapSetter=e.defaultTextMapGetter=void 0,e.defaultTextMapGetter={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},e.defaultTextMapSetter={set:function(e,t,r){null!=e&&(e[t]=r)}}})),V=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),z=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),W=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ROOT_CONTEXT=e.createContextKey=void 0,e.createContextKey=function(e){return Symbol.for(e)};e.ROOT_CONTEXT=new function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(e){return r._currentContext.get(e)},r.setValue=function(t,n){var s=new e(r._currentContext);return s._currentContext.set(t,n),s},r.deleteValue=function(t){var n=new e(r._currentContext);return n._currentContext.delete(t),n}}})),G=y((e=>{"use strict";var t=e&&e.__spreadArray||function(e,t){for(var r=0,n=t.length,s=e.length;r<n;r++,s++)e[s]=t[r];return e};Object.defineProperty(e,"__esModule",{value:!0}),e.NoopContextManager=void 0;var r=W(),n=function(){function e(){}return e.prototype.active=function(){return r.ROOT_CONTEXT},e.prototype.with=function(e,r,n){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return r.call.apply(r,t([n],s))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}();e.NoopContextManager=n})),Y=y((e=>{"use strict";var t=e&&e.__spreadArray||function(e,t){for(var r=0,n=t.length,s=e.length;r<n;r++,s++)e[s]=t[r];return e};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextAPI=void 0;var r=G(),n=k(),s=L(),i="context",o=new r.NoopContextManager,a=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return n.registerGlobal(i,e,s.DiagAPI.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,r,n){for(var s,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return(s=this._getContextManager()).with.apply(s,t([e,r,n],i))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return n.getGlobal(i)||o},e.prototype.disable=function(){this._getContextManager().disable(),n.unregisterGlobal(i,s.DiagAPI.instance())},e}();e.ContextAPI=a})),Q=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.TraceFlags=void 0,(t=e.TraceFlags||(e.TraceFlags={}))[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"})),X=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.INVALID_SPAN_CONTEXT=e.INVALID_TRACEID=e.INVALID_SPANID=void 0;var t=Q();e.INVALID_SPANID="0000000000000000",e.INVALID_TRACEID="00000000000000000000000000000000",e.INVALID_SPAN_CONTEXT={traceId:e.INVALID_TRACEID,spanId:e.INVALID_SPANID,traceFlags:t.TraceFlags.NONE}})),J=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NonRecordingSpan=void 0;var t=X(),r=function(){function e(e){void 0===e&&(e=t.INVALID_SPAN_CONTEXT),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}();e.NonRecordingSpan=r})),Z=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSpanContext=e.setSpanContext=e.deleteSpan=e.setSpan=e.getSpan=void 0;var t=W(),r=J(),n=t.createContextKey("OpenTelemetry Context Key SPAN");function s(e){return e.getValue(n)||void 0}function i(e,t){return e.setValue(n,t)}e.getSpan=s,e.setSpan=i,e.deleteSpan=function(e){return e.deleteValue(n)},e.setSpanContext=function(e,t){return i(e,new r.NonRecordingSpan(t))},e.getSpanContext=function(e){var t;return null===(t=s(e))||void 0===t?void 0:t.spanContext()}})),ee=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wrapSpanContext=e.isSpanContextValid=e.isValidSpanId=e.isValidTraceId=void 0;var t=X(),r=J(),n=/^([0-9a-f]{32})$/i,s=/^[0-9a-f]{16}$/i;function i(e){return n.test(e)&&e!==t.INVALID_TRACEID}function o(e){return s.test(e)&&e!==t.INVALID_SPANID}e.isValidTraceId=i,e.isValidSpanId=o,e.isSpanContextValid=function(e){return i(e.traceId)&&o(e.spanId)},e.wrapSpanContext=function(e){return new r.NonRecordingSpan(e)}})),te=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopTracer=void 0;var t=Y(),r=Z(),n=J(),s=ee(),i=t.ContextAPI.getInstance(),o=function(){function e(){}return e.prototype.startSpan=function(e,t,i){if(Boolean(null==t?void 0:t.root))return new n.NonRecordingSpan;var o=i&&r.getSpanContext(i);return function(e){return"object"==typeof e&&"string"==typeof e.spanId&&"string"==typeof e.traceId&&"number"==typeof e.traceFlags}(o)&&s.isSpanContextValid(o)?new n.NonRecordingSpan(o):new n.NonRecordingSpan},e.prototype.startActiveSpan=function(e,t,n,s){var o,a,c;if(!(arguments.length<2)){2===arguments.length?c=t:3===arguments.length?(o=t,c=n):(o=t,a=n,c=s);var l=a??i.active(),u=this.startSpan(e,o,l),h=r.setSpan(l,u);return i.with(h,c,void 0,u)}},e}();e.NoopTracer=o})),re=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyTracer=void 0;var t=new(te().NoopTracer),r=function(){function e(e,t,r){this._provider=e,this.name=t,this.version=r}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype.startActiveSpan=function(e,t,r,n){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version);return e?(this._delegate=e,this._delegate):t},e}();e.ProxyTracer=r})),ne=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopTracerProvider=void 0;var t=te(),r=function(){function e(){}return e.prototype.getTracer=function(e,r){return new t.NoopTracer},e}();e.NoopTracerProvider=r})),se=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyTracerProvider=void 0;var t=re(),r=new(ne().NoopTracerProvider),n=function(){function e(){}return e.prototype.getTracer=function(e,r){var n;return null!==(n=this.getDelegateTracer(e,r))&&void 0!==n?n:new t.ProxyTracer(this,e,r)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:r},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t)},e}();e.ProxyTracerProvider=n})),ie=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),oe=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.SamplingDecision=void 0,(t=e.SamplingDecision||(e.SamplingDecision={}))[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})),ae=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ce=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.SpanKind=void 0,(t=e.SpanKind||(e.SpanKind={}))[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})),le=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ue=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),he=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.SpanStatusCode=void 0,(t=e.SpanStatusCode||(e.SpanStatusCode={}))[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})),de=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),pe=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),fe=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ge=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),me=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TraceAPI=void 0;var t=k(),r=se(),n=ee(),s=Z(),i=L(),o="trace",a=function(){function e(){this._proxyTracerProvider=new r.ProxyTracerProvider,this.wrapSpanContext=n.wrapSpanContext,this.isSpanContextValid=n.isSpanContextValid,this.deleteSpan=s.deleteSpan,this.getSpan=s.getSpan,this.getSpanContext=s.getSpanContext,this.setSpan=s.setSpan,this.setSpanContext=s.setSpanContext}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var r=t.registerGlobal(o,this._proxyTracerProvider,i.DiagAPI.instance());return r&&this._proxyTracerProvider.setDelegate(e),r},e.prototype.getTracerProvider=function(){return t.getGlobal(o)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){t.unregisterGlobal(o,i.DiagAPI.instance()),this._proxyTracerProvider=new r.ProxyTracerProvider},e}();e.TraceAPI=a})),ye=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopTextMapPropagator=void 0;var t=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}();e.NoopTextMapPropagator=t})),ve=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deleteBaggage=e.setBaggage=e.getBaggage=void 0;var t=W().createContextKey("OpenTelemetry Baggage Key");e.getBaggage=function(e){return e.getValue(t)||void 0},e.setBaggage=function(e,r){return e.setValue(t,r)},e.deleteBaggage=function(e){return e.deleteValue(t)}})),we=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PropagationAPI=void 0;var t=k(),r=ye(),n=K(),s=ve(),i=j(),o=L(),a="propagation",c=new r.NoopTextMapPropagator,l=function(){function e(){this.createBaggage=i.createBaggage,this.getBaggage=s.getBaggage,this.setBaggage=s.setBaggage,this.deleteBaggage=s.deleteBaggage}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return t.registerGlobal(a,e,o.DiagAPI.instance())},e.prototype.inject=function(e,t,r){return void 0===r&&(r=n.defaultTextMapSetter),this._getGlobalPropagator().inject(e,t,r)},e.prototype.extract=function(e,t,r){return void 0===r&&(r=n.defaultTextMapGetter),this._getGlobalPropagator().extract(e,t,r)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){t.unregisterGlobal(a,o.DiagAPI.instance())},e.prototype._getGlobalPropagator=function(){return t.getGlobal(a)||c},e}();e.PropagationAPI=l})),Se=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.diag=e.propagation=e.trace=e.context=e.INVALID_SPAN_CONTEXT=e.INVALID_TRACEID=e.INVALID_SPANID=e.isValidSpanId=e.isValidTraceId=e.isSpanContextValid=e.baggageEntryMetadataFromString=void 0,r(P(),e);var n=j();Object.defineProperty(e,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return n.baggageEntryMetadataFromString}}),r(F(),e),r(U(),e),r(H(),e),r(K(),e),r(V(),e),r(z(),e),r(re(),e),r(se(),e),r(ie(),e),r(oe(),e),r(ae(),e),r(ce(),e),r(le(),e),r(ue(),e),r(he(),e),r(Q(),e),r(de(),e),r(pe(),e),r(fe(),e);var s=ee();Object.defineProperty(e,"isSpanContextValid",{enumerable:!0,get:function(){return s.isSpanContextValid}}),Object.defineProperty(e,"isValidTraceId",{enumerable:!0,get:function(){return s.isValidTraceId}}),Object.defineProperty(e,"isValidSpanId",{enumerable:!0,get:function(){return s.isValidSpanId}});var i=X();Object.defineProperty(e,"INVALID_SPANID",{enumerable:!0,get:function(){return i.INVALID_SPANID}}),Object.defineProperty(e,"INVALID_TRACEID",{enumerable:!0,get:function(){return i.INVALID_TRACEID}}),Object.defineProperty(e,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return i.INVALID_SPAN_CONTEXT}}),r(W(),e),r(ge(),e);var o=Y();e.context=o.ContextAPI.getInstance();var a=me();e.trace=a.TraceAPI.getInstance();var c=we();e.propagation=c.PropagationAPI.getInstance();var l=L();e.diag=l.DiagAPI.instance(),e.default={trace:e.trace,context:e.context,propagation:e.propagation,diag:e.diag}})),be=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isTracingSuppressed=e.unsuppressTracing=e.suppressTracing=void 0;var t=Se().createContextKey("OpenTelemetry SDK Context Key SUPPRESS_TRACING");e.suppressTracing=function(e){return e.setValue(t,!0)},e.unsuppressTracing=function(e){return e.deleteValue(t)},e.isTracingSuppressed=function(e){return!0===e.getValue(t)}})),_e=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BAGGAGE_MAX_TOTAL_LENGTH=e.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=e.BAGGAGE_MAX_NAME_VALUE_PAIRS=e.BAGGAGE_HEADER=e.BAGGAGE_ITEMS_SEPARATOR=e.BAGGAGE_PROPERTIES_SEPARATOR=e.BAGGAGE_KEY_PAIR_SEPARATOR=void 0,e.BAGGAGE_KEY_PAIR_SEPARATOR="=",e.BAGGAGE_PROPERTIES_SEPARATOR=";",e.BAGGAGE_ITEMS_SEPARATOR=",",e.BAGGAGE_HEADER="baggage",e.BAGGAGE_MAX_NAME_VALUE_PAIRS=180,e.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=4096,e.BAGGAGE_MAX_TOTAL_LENGTH=8192})),Ee=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseKeyPairsIntoRecord=e.parsePairKeyValue=e.getKeyPairs=e.serializeKeyPairs=void 0;var t=Se(),r=_e();e.serializeKeyPairs=e=>e.reduce(((e,t)=>{let n=`${e}${""!==e?r.BAGGAGE_ITEMS_SEPARATOR:""}${t}`;return n.length>r.BAGGAGE_MAX_TOTAL_LENGTH?e:n}),""),e.getKeyPairs=e=>e.getAllEntries().map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t.value)}`)),e.parsePairKeyValue=e=>{let n=e.split(r.BAGGAGE_PROPERTIES_SEPARATOR);if(n.length<=0)return;let s=n.shift();if(!s)return;let i=s.split(r.BAGGAGE_KEY_PAIR_SEPARATOR);if(2!==i.length)return;let o,a=decodeURIComponent(i[0].trim()),c=decodeURIComponent(i[1].trim());return n.length>0&&(o=t.baggageEntryMetadataFromString(n.join(r.BAGGAGE_PROPERTIES_SEPARATOR))),{key:a,value:c,metadata:o}},e.parseKeyPairsIntoRecord=t=>"string"!=typeof t||0===t.length?{}:t.split(r.BAGGAGE_ITEMS_SEPARATOR).map((t=>e.parsePairKeyValue(t))).filter((e=>void 0!==e&&e.value.length>0)).reduce(((e,t)=>(e[t.key]=t.value,e)),{})})),Te=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HttpBaggagePropagator=void 0;var t=Se(),r=be(),n=_e(),s=Ee();e.HttpBaggagePropagator=class{inject(e,i,o){let a=t.propagation.getBaggage(e);if(!a||r.isTracingSuppressed(e))return;let c=s.getKeyPairs(a).filter((e=>e.length<=n.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS)).slice(0,n.BAGGAGE_MAX_NAME_VALUE_PAIRS),l=s.serializeKeyPairs(c);l.length>0&&o.set(i,n.BAGGAGE_HEADER,l)}extract(e,r,i){let o=i.get(r,n.BAGGAGE_HEADER);if(!o)return e;let a={};return 0===o.length||(o.split(n.BAGGAGE_ITEMS_SEPARATOR).forEach((e=>{let t=s.parsePairKeyValue(e);if(t){let e={value:t.value};t.metadata&&(e.metadata=t.metadata),a[t.key]=e}})),0===Object.entries(a).length)?e:t.propagation.setBaggage(e,t.propagation.createBaggage(a))}fields(){return[n.BAGGAGE_HEADER]}}})),Ce=y((e=>{"use strict";function t(e){return null==e||(Array.isArray(e)?function(e){let t;for(let n of e)if(null!=n){if(!t){if(r(n)){t=typeof n;continue}return!1}if(typeof n!==t)return!1}return!0}(e):r(e))}function r(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.isAttributeValue=e.sanitizeAttributes=void 0,e.sanitizeAttributes=function(e){let r={};if(null==e||"object"!=typeof e)return r;for(let[n,s]of Object.entries(e))t(s)&&(Array.isArray(s)?r[n]=s.slice():r[n]=s);return r},e.isAttributeValue=t})),Pe=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loggingErrorHandler=void 0;var t=Se();e.loggingErrorHandler=function(){return e=>{t.diag.error(function(e){return"string"==typeof e?e:JSON.stringify(function(e){let t={},r=e;for(;null!==r;)Object.getOwnPropertyNames(r).forEach((e=>{if(t[e])return;let n=r[e];n&&(t[e]=String(n))})),r=Object.getPrototypeOf(r);return t}(e))}(e))}}})),Ae=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.globalErrorHandler=e.setGlobalErrorHandler=void 0;var t=Pe().loggingErrorHandler();e.setGlobalErrorHandler=function(e){t=e},e.globalErrorHandler=e=>{try{t(e)}catch{}}})),Re=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.TracesSamplerValues=void 0,(t=e.TracesSamplerValues||(e.TracesSamplerValues={})).AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})),Ie=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseEnvironment=e.DEFAULT_ENVIRONMENT=void 0;var t=Se(),r=Re(),n=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT"];function s(e){return n.indexOf(e)>-1}var i=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function o(e){return i.indexOf(e)>-1}function a(e,t,r,n=-1/0,s=1/0){if(typeof r[e]<"u"){let i=Number(r[e]);isNaN(i)||(t[e]=i<n?n:i>s?s:i)}}function c(e,t,r,n=","){let s=r[e];"string"==typeof s&&(t[e]=s.split(n).map((e=>e.trim())))}e.DEFAULT_ENVIRONMENT={CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:t.DiagLogLevel.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"none",OTEL_TRACES_SAMPLER:r.TracesSamplerValues.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:""};var l={ALL:t.DiagLogLevel.ALL,VERBOSE:t.DiagLogLevel.VERBOSE,DEBUG:t.DiagLogLevel.DEBUG,INFO:t.DiagLogLevel.INFO,WARN:t.DiagLogLevel.WARN,ERROR:t.DiagLogLevel.ERROR,NONE:t.DiagLogLevel.NONE};function u(e,t,r){let n=r[e];if("string"==typeof n){let r=l[n.toUpperCase()];null!=r&&(t[e]=r)}}e.parseEnvironment=function(t){let r={};for(let n in e.DEFAULT_ENVIRONMENT){let e=n;if("OTEL_LOG_LEVEL"===e)u(e,r,t);else if(s(e))a(e,r,t);else if(o(e))c(e,r,t);else{let n=t[e];typeof n<"u"&&null!==n&&(r[e]=String(n))}}return r}})),xe=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEnv=void 0;var t=r(2037),n=Ie();e.getEnv=function(){let e=n.parseEnvironment(process.env);return Object.assign({HOSTNAME:t.hostname()},n.DEFAULT_ENVIRONMENT,e)}})),Oe=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hexToBase64=void 0,e.hexToBase64=function(e){let t=e.length,r="";for(let n=0;n<t;n+=2){let t=e.substring(n,n+2),s=parseInt(t,16);r+=String.fromCharCode(s)}return Buffer.from(r,"ascii").toString("base64")}})),ke=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RandomIdGenerator=void 0,e.RandomIdGenerator=class{constructor(){this.generateTraceId=r(16),this.generateSpanId=r(8)}};var t=Buffer.allocUnsafe(16);function r(e){return function(){for(let r=0;r<e/4;r++)t.writeUInt32BE(Math.random()*2**32>>>0,4*r);for(let r=0;r<e&&!(t[r]>0);r++)r===e-1&&(t[e-1]=1);return t.toString("hex",0,e)}}})),Me=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.otperformance=void 0;var t=r(4074);e.otperformance=t.performance})),Ne=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VERSION=void 0,e.VERSION="0.23.0"})),De=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.RpcGrpcStatusCodeValues=e.MessagingOperationValues=e.MessagingDestinationKindValues=e.HttpFlavorValues=e.NetTransportValues=e.FaasInvokedProviderValues=e.FaasDocumentOperationValues=e.FaasTriggerValues=e.DbCassandraConsistencyLevelValues=e.DbSystemValues=e.SemanticAttributes=void 0,e.SemanticAttributes={DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_METHOD:"rpc.jsonrpc.method",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message"},(t=e.DbSystemValues||(e.DbSystemValues={})).OTHER_SQL="other_sql",t.MSSQL="mssql",t.MYSQL="mysql",t.ORACLE="oracle",t.DB2="db2",t.POSTGRESQL="postgresql",t.REDSHIFT="redshift",t.HIVE="hive",t.CLOUDSCAPE="cloudscape",t.HSQLDB="hsqldb",t.PROGRESS="progress",t.MAXDB="maxdb",t.HANADB="hanadb",t.INGRES="ingres",t.FIRSTSQL="firstsql",t.EDB="edb",t.CACHE="cache",t.ADABAS="adabas",t.FIREBIRD="firebird",t.DERBY="derby",t.FILEMAKER="filemaker",t.INFORMIX="informix",t.INSTANTDB="instantdb",t.INTERBASE="interbase",t.MARIADB="mariadb",t.NETEZZA="netezza",t.PERVASIVE="pervasive",t.POINTBASE="pointbase",t.SQLITE="sqlite",t.SYBASE="sybase",t.TERADATA="teradata",t.VERTICA="vertica",t.H2="h2",t.COLDFUSION="coldfusion",t.CASSANDRA="cassandra",t.HBASE="hbase",t.MONGODB="mongodb",t.REDIS="redis",t.COUCHBASE="couchbase",t.COUCHDB="couchdb",t.COSMOSDB="cosmosdb",t.DYNAMODB="dynamodb",t.NEO4J="neo4j",t.GEODE="geode",t.ELASTICSEARCH="elasticsearch",t.MEMCACHED="memcached",t.COCKROACHDB="cockroachdb",function(e){e.ALL="all",e.EACH_QUORUM="each_quorum",e.QUORUM="quorum",e.LOCAL_QUORUM="local_quorum",e.ONE="one",e.TWO="two",e.THREE="three",e.LOCAL_ONE="local_one",e.ANY="any",e.SERIAL="serial",e.LOCAL_SERIAL="local_serial"}(e.DbCassandraConsistencyLevelValues||(e.DbCassandraConsistencyLevelValues={})),function(e){e.DATASOURCE="datasource",e.HTTP="http",e.PUBSUB="pubsub",e.TIMER="timer",e.OTHER="other"}(e.FaasTriggerValues||(e.FaasTriggerValues={})),function(e){e.INSERT="insert",e.EDIT="edit",e.DELETE="delete"}(e.FaasDocumentOperationValues||(e.FaasDocumentOperationValues={})),function(e){e.AWS="aws",e.AZURE="azure",e.GCP="gcp"}(e.FaasInvokedProviderValues||(e.FaasInvokedProviderValues={})),function(e){e.IP_TCP="ip_tcp",e.IP_UDP="ip_udp",e.IP="ip",e.UNIX="unix",e.PIPE="pipe",e.INPROC="inproc",e.OTHER="other"}(e.NetTransportValues||(e.NetTransportValues={})),function(e){e.HTTP_1_0="1.0",e.HTTP_1_1="1.1",e.HTTP_2_0="2.0",e.SPDY="SPDY",e.QUIC="QUIC"}(e.HttpFlavorValues||(e.HttpFlavorValues={})),function(e){e.QUEUE="queue",e.TOPIC="topic"}(e.MessagingDestinationKindValues||(e.MessagingDestinationKindValues={})),function(e){e.RECEIVE="receive",e.PROCESS="process"}(e.MessagingOperationValues||(e.MessagingOperationValues={})),function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(e.RpcGrpcStatusCodeValues||(e.RpcGrpcStatusCodeValues={}))})),Le=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(De(),e)})),Be=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.TelemetrySdkLanguageValues=e.OsTypeValues=e.HostArchValues=e.AwsEcsLaunchtypeValues=e.CloudPlatformValues=e.CloudProviderValues=e.ResourceAttributes=void 0,e.ResourceAttributes={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"},(t=e.CloudProviderValues||(e.CloudProviderValues={})).AWS="aws",t.AZURE="azure",t.GCP="gcp",function(e){e.AWS_EC2="aws_ec2",e.AWS_ECS="aws_ecs",e.AWS_EKS="aws_eks",e.AWS_LAMBDA="aws_lambda",e.AWS_ELASTIC_BEANSTALK="aws_elastic_beanstalk",e.AZURE_VM="azure_vm",e.AZURE_CONTAINER_INSTANCES="azure_container_instances",e.AZURE_AKS="azure_aks",e.AZURE_FUNCTIONS="azure_functions",e.AZURE_APP_SERVICE="azure_app_service",e.GCP_COMPUTE_ENGINE="gcp_compute_engine",e.GCP_CLOUD_RUN="gcp_cloud_run",e.GCP_KUBERNETES_ENGINE="gcp_kubernetes_engine",e.GCP_CLOUD_FUNCTIONS="gcp_cloud_functions",e.GCP_APP_ENGINE="gcp_app_engine"}(e.CloudPlatformValues||(e.CloudPlatformValues={})),function(e){e.EC2="ec2",e.FARGATE="fargate"}(e.AwsEcsLaunchtypeValues||(e.AwsEcsLaunchtypeValues={})),function(e){e.AMD64="amd64",e.ARM32="arm32",e.ARM64="arm64",e.IA64="ia64",e.PPC32="ppc32",e.PPC64="ppc64",e.X86="x86"}(e.HostArchValues||(e.HostArchValues={})),function(e){e.WINDOWS="windows",e.LINUX="linux",e.DARWIN="darwin",e.FREEBSD="freebsd",e.NETBSD="netbsd",e.OPENBSD="openbsd",e.DRAGONFLYBSD="dragonflybsd",e.HPUX="hpux",e.AIX="aix",e.SOLARIS="solaris",e.Z_OS="z_os"}(e.OsTypeValues||(e.OsTypeValues={})),function(e){e.CPP="cpp",e.DOTNET="dotnet",e.ERLANG="erlang",e.GO="go",e.JAVA="java",e.NODEJS="nodejs",e.PHP="php",e.PYTHON="python",e.RUBY="ruby",e.WEBJS="webjs"}(e.TelemetrySdkLanguageValues||(e.TelemetrySdkLanguageValues={}))})),qe=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Be(),e)})),je=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Le(),e),r(qe(),e)})),Fe=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SDK_INFO=void 0;var t=Ne(),r=je();e.SDK_INFO={[r.ResourceAttributes.TELEMETRY_SDK_NAME]:"opentelemetry",[r.ResourceAttributes.PROCESS_RUNTIME_NAME]:"node",[r.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:r.TelemetrySdkLanguageValues.NODEJS,[r.ResourceAttributes.TELEMETRY_SDK_VERSION]:t.VERSION}})),Ue=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unrefTimer=void 0,e.unrefTimer=function(e){e.unref()}})),$e=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(xe(),e),r(Oe(),e),r(ke(),e),r(Me(),e),r(Fe(),e),r(Ue(),e)})),He=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r($e(),e)})),Ke=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isTimeInput=e.isTimeInputHrTime=e.hrTimeToMicroseconds=e.hrTimeToMilliseconds=e.hrTimeToNanoseconds=e.hrTimeToTimeStamp=e.hrTimeDuration=e.timeInputToHrTime=e.hrTime=void 0;var t=He(),r=Math.pow(10,9);function n(e){let t=e/1e3,n=Math.trunc(t);return[n,Number((t-n).toFixed(9))*r]}function s(){let e=t.otperformance.timeOrigin;if("number"!=typeof e){let r=t.otperformance;e=r.timing&&r.timing.fetchStart}return e}function i(e){let i=n(s()),o=n("number"==typeof e?e:t.otperformance.now()),a=i[0]+o[0],c=i[1]+o[1];return c>r&&(c-=r,a+=1),[a,c]}function o(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}e.hrTime=i,e.timeInputToHrTime=function(e){if(o(e))return e;if("number"==typeof e)return e<s()?i(e):n(e);if(e instanceof Date)return n(e.getTime());throw TypeError("Invalid input type")},e.hrTimeDuration=function(e,t){let n=t[0]-e[0],s=t[1]-e[1];return s<0&&(n-=1,s+=r),[n,s]},e.hrTimeToTimeStamp=function(e){let t=`${"0".repeat(9)}${e[1]}Z`,r=t.substr(t.length-9-1);return new Date(1e3*e[0]).toISOString().replace("000Z",r)},e.hrTimeToNanoseconds=function(e){return e[0]*r+e[1]},e.hrTimeToMilliseconds=function(e){return Math.round(1e3*e[0]+e[1]/1e6)},e.hrTimeToMicroseconds=function(e){return Math.round(1e6*e[0]+e[1]/1e3)},e.isTimeInputHrTime=o,e.isTimeInput=function(e){return o(e)||"number"==typeof e||e instanceof Date}})),Ve=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ze=y((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.ExportResultCode=void 0,(t=e.ExportResultCode||(e.ExportResultCode={}))[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})),We=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CompositePropagator=void 0;var t=Se();e.CompositePropagator=class{constructor(e={}){var t;this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._fields=Array.from(new Set(this._propagators.map((e=>"function"==typeof e.fields?e.fields():[])).reduce(((e,t)=>e.concat(t)),[])))}inject(e,r,n){for(let s of this._propagators)try{s.inject(e,r,n)}catch(e){t.diag.warn(`Failed to inject with ${s.constructor.name}. Err: ${e.message}`)}}extract(e,r,n){return this._propagators.reduce(((e,s)=>{try{return s.extract(e,r,n)}catch(e){t.diag.warn(`Failed to inject with ${s.constructor.name}. Err: ${e.message}`)}return e}),e)}fields(){return this._fields.slice()}}})),Ge=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateValue=e.validateKey=void 0;var t="[_0-9a-z-*/]",r=new RegExp(`^(?:[a-z]${t}{0,255}|[a-z0-9]${t}{0,240}@[a-z]${t}{0,13})$`),n=/^[ -~]{0,255}[!-~]$/,s=/,|=/;e.validateKey=function(e){return r.test(e)},e.validateValue=function(e){return n.test(e)&&!s.test(e)}})),Ye=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TraceState=void 0;var t=Ge(),r=class{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){let r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r}unset(e){let t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce(((e,t)=>(e.push(t+"="+this.get(t)),e)),[]).join(",")}_parse(e){e.length>512||(this._internalState=e.split(",").reverse().reduce(((e,r)=>{let n=r.trim(),s=n.indexOf("=");if(-1!==s){let i=n.slice(0,s),o=n.slice(s+1,r.length);t.validateKey(i)&&t.validateValue(o)&&e.set(i,o)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new r;return e._internalState=new Map(this._internalState),e}};e.TraceState=r})),Qe=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HttpTraceContextPropagator=e.parseTraceParent=e.TRACE_STATE_HEADER=e.TRACE_PARENT_HEADER=void 0;var t=Se(),r=be(),n=Ye();e.TRACE_PARENT_HEADER="traceparent",e.TRACE_STATE_HEADER="tracestate";var s=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");function i(e){let t=s.exec(e);return!t||"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}}e.parseTraceParent=i,e.HttpTraceContextPropagator=class{inject(n,s,i){let o=t.trace.getSpanContext(n);if(!o||r.isTracingSuppressed(n)||!t.isSpanContextValid(o))return;let a=`00-${o.traceId}-${o.spanId}-0${Number(o.traceFlags||t.TraceFlags.NONE).toString(16)}`;i.set(s,e.TRACE_PARENT_HEADER,a),o.traceState&&i.set(s,e.TRACE_STATE_HEADER,o.traceState.serialize())}extract(r,s,o){let a=o.get(s,e.TRACE_PARENT_HEADER);if(!a)return r;let c=Array.isArray(a)?a[0]:a;if("string"!=typeof c)return r;let l=i(c);if(!l)return r;l.isRemote=!0;let u=o.get(s,e.TRACE_STATE_HEADER);if(u){let e=Array.isArray(u)?u.join(","):u;l.traceState=new n.TraceState("string"==typeof e?e:void 0)}return t.trace.setSpanContext(r,l)}fields(){return[e.TRACE_PARENT_HEADER,e.TRACE_STATE_HEADER]}}})),Xe=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Je=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRPCMetadata=e.deleteRPCMetadata=e.setRPCMetadata=e.RPCType=void 0;var t=Se().createContextKey("OpenTelemetry SDK Context Key RPC_METADATA");(e.RPCType||(e.RPCType={})).HTTP="http",e.setRPCMetadata=function(e,r){return e.setValue(t,r)},e.deleteRPCMetadata=function(e){return e.deleteValue(t)},e.getRPCMetadata=function(e){return e.getValue(t)}})),Ze=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlwaysOffSampler=void 0;var t=Se();e.AlwaysOffSampler=class{shouldSample(){return{decision:t.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}})),et=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlwaysOnSampler=void 0;var t=Se();e.AlwaysOnSampler=class{shouldSample(){return{decision:t.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}})),tt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParentBasedSampler=void 0;var t=Se(),r=Ae(),n=Ze(),s=et();e.ParentBasedSampler=class{constructor(e){var t,i,o,a;this._root=e.root,this._root||(r.globalErrorHandler(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new s.AlwaysOnSampler),this._remoteParentSampled=null!==(t=e.remoteParentSampled)&&void 0!==t?t:new s.AlwaysOnSampler,this._remoteParentNotSampled=null!==(i=e.remoteParentNotSampled)&&void 0!==i?i:new n.AlwaysOffSampler,this._localParentSampled=null!==(o=e.localParentSampled)&&void 0!==o?o:new s.AlwaysOnSampler,this._localParentNotSampled=null!==(a=e.localParentNotSampled)&&void 0!==a?a:new n.AlwaysOffSampler}shouldSample(e,r,n,s,i,o){let a=t.trace.getSpanContext(e);return a&&t.isSpanContextValid(a)?a.isRemote?a.traceFlags&t.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,s,i,o):this._remoteParentNotSampled.shouldSample(e,r,n,s,i,o):a.traceFlags&t.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(e,r,n,s,i,o):this._localParentNotSampled.shouldSample(e,r,n,s,i,o):this._root.shouldSample(e,r,n,s,i,o)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}})),rt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TraceIdRatioBasedSampler=void 0;var t=Se();e.TraceIdRatioBasedSampler=class{constructor(e=0){this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}shouldSample(e,r){return{decision:t.isValidTraceId(r)&&this._accumulate(r)<this._upperBound?t.SamplingDecision.RECORD_AND_SAMPLED:t.SamplingDecision.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let t=0;for(let r=0;r<e.length/8;r++){let n=8*r;t=(t^parseInt(e.slice(n,n+8),16))>>>0}return t}}})),nt=y((e=>{"use strict";function t(e,t){return"string"==typeof t?e===t:t.test(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.isUrlIgnored=e.urlMatches=void 0,e.urlMatches=t,e.isUrlIgnored=function(e,r){if(!r)return!1;for(let n of r)if(t(e,n))return!0;return!1}})),st=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isWrapped=void 0,e.isWrapped=function(e){return"function"==typeof e&&"function"==typeof e.__original&&"function"==typeof e.__unwrap&&!0===e.__wrapped}})),it=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.baggageUtils=void 0,r(Te(),e),r(Ce(),e),r(Ae(),e),r(Pe(),e),r(Ke(),e),r(Ve(),e),r(ze(),e),r(Ne(),e),e.baggageUtils=Ee(),r(He(),e),r(We(),e),r(Qe(),e),r(Xe(),e),r(Je(),e),r(Ze(),e),r(et(),e),r(tt(),e),r(rt(),e),r(be(),e),r(Ye(),e),r(Ie(),e),r(Re(),e),r(nt(),e),r(st(),e),r(Ne(),e)})),ot=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExceptionEventName=void 0,e.ExceptionEventName="exception"})),at=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Span=void 0;var t=Se(),r=it(),n=je(),s=ot();e.Span=class{constructor(e,n,s,i,o,a,c=[],l=r.hrTime()){this.attributes={},this.links=[],this.events=[],this.status={code:t.SpanStatusCode.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=s,this._spanContext=i,this.parentSpanId=a,this.kind=o,this.links=c,this.startTime=r.timeInputToHrTime(l),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,n)}spanContext(){return this._spanContext}setAttribute(e,n){return null==n||this._isSpanEnded()?this:0===e.length?(t.diag.warn(`Invalid attribute key: ${e}`),this):r.isAttributeValue(n)?(Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)||(this.attributes[e]=n),this):(t.diag.warn(`Invalid attribute value set for key: ${e}`),this)}setAttributes(e){for(let[t,r]of Object.entries(e))this.setAttribute(t,r);return this}addEvent(e,n,s){return this._isSpanEnded()||(this.events.length>=this._spanLimits.eventCountLimit&&(t.diag.warn("Dropping extra events."),this.events.shift()),r.isTimeInput(n)&&(typeof s>"u"&&(s=n),n=void 0),typeof s>"u"&&(s=r.hrTime()),this.events.push({name:e,attributes:n,time:r.timeInputToHrTime(s)})),this}setStatus(e){return this._isSpanEnded()||(this.status=e),this}updateName(e){return this._isSpanEnded()||(this.name=e),this}end(e=r.hrTime()){this._isSpanEnded()?t.diag.error("You can only call end() on a span once."):(this._ended=!0,this.endTime=r.timeInputToHrTime(e),this._duration=r.hrTimeDuration(this.startTime,this.endTime),this._duration[0]<0&&t.diag.warn("Inconsistent start and end time, startTime > endTime",this.startTime,this.endTime),this._spanProcessor.onEnd(this))}isRecording(){return!1===this._ended}recordException(e,i=r.hrTime()){let o={};"string"==typeof e?o[n.SemanticAttributes.EXCEPTION_MESSAGE]=e:e&&(e.code?o[n.SemanticAttributes.EXCEPTION_TYPE]=e.code.toString():e.name&&(o[n.SemanticAttributes.EXCEPTION_TYPE]=e.name),e.message&&(o[n.SemanticAttributes.EXCEPTION_MESSAGE]=e.message),e.stack&&(o[n.SemanticAttributes.EXCEPTION_STACKTRACE]=e.stack)),o[n.SemanticAttributes.EXCEPTION_TYPE]||o[n.SemanticAttributes.EXCEPTION_MESSAGE]?this.addEvent(s.ExceptionEventName,o,i):t.diag.warn(`Failed to record an exception ${e}`)}get duration(){return this._duration}get ended(){return this._ended}_isSpanEnded(){return this._ended&&t.diag.warn("Can not execute the operation on ended Span {traceId: %s, spanId: %s}",this._spanContext.traceId,this._spanContext.spanId),this._ended}}})),ct=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buildSamplerFromEnv=e.DEFAULT_CONFIG=void 0;var t=Se(),r=it(),n=r.getEnv(),s=r.TracesSamplerValues.AlwaysOn;function i(e=r.getEnv()){switch(e.OTEL_TRACES_SAMPLER){case r.TracesSamplerValues.AlwaysOn:return new r.AlwaysOnSampler;case r.TracesSamplerValues.AlwaysOff:return new r.AlwaysOffSampler;case r.TracesSamplerValues.ParentBasedAlwaysOn:return new r.ParentBasedSampler({root:new r.AlwaysOnSampler});case r.TracesSamplerValues.ParentBasedAlwaysOff:return new r.ParentBasedSampler({root:new r.AlwaysOffSampler});case r.TracesSamplerValues.TraceIdRatio:return new r.TraceIdRatioBasedSampler(o(e));case r.TracesSamplerValues.ParentBasedTraceIdRatio:return new r.ParentBasedSampler({root:new r.TraceIdRatioBasedSampler(o(e))});default:return t.diag.error(`OTEL_TRACES_SAMPLER value "${e.OTEL_TRACES_SAMPLER} invalid, defaulting to ${s}".`),new r.AlwaysOnSampler}}function o(e){if(void 0===e.OTEL_TRACES_SAMPLER_ARG||""===e.OTEL_TRACES_SAMPLER_ARG)return t.diag.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1;let r=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(r)?(t.diag.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to 1.`),1):r<0||r>1?(t.diag.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to 1.`),1):r}e.DEFAULT_CONFIG={sampler:i(n),forceFlushTimeoutMillis:3e4,spanLimits:{attributeCountLimit:r.getEnv().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:r.getEnv().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:r.getEnv().OTEL_SPAN_EVENT_COUNT_LIMIT}},e.buildSamplerFromEnv=i})),lt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mergeConfig=void 0;var t=ct();e.mergeConfig=function(e){let r={sampler:t.buildSamplerFromEnv()},n=Object.assign({},t.DEFAULT_CONFIG,r,e);return n.spanLimits=Object.assign({},t.DEFAULT_CONFIG.spanLimits,e.spanLimits||{}),n}})),ut=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tracer=void 0;var t=Se(),r=it(),n=at(),s=lt();e.Tracer=class{constructor(e,t,n){this._tracerProvider=n;let i=s.mergeConfig(t);this._sampler=i.sampler,this._spanLimits=i.spanLimits,this._idGenerator=t.idGenerator||new r.RandomIdGenerator,this.resource=n.resource,this.instrumentationLibrary=e}startSpan(e,s={},i=t.context.active()){var o,a;if(r.isTracingSuppressed(i))return t.diag.debug("Instrumentation suppressed, returning Noop Span"),t.trace.wrapSpanContext(t.INVALID_SPAN_CONTEXT);let c,l,u,h=function(e,r){if(!e.root)return t.trace.getSpanContext(r)}(s,i),d=this._idGenerator.generateSpanId();h&&t.trace.isSpanContextValid(h)?(c=h.traceId,l=h.traceState,u=h.spanId):c=this._idGenerator.generateTraceId();let p=null!==(o=s.kind)&&void 0!==o?o:t.SpanKind.INTERNAL,f=null!==(a=s.links)&&void 0!==a?a:[],g=r.sanitizeAttributes(s.attributes),m=this._sampler.shouldSample(s.root?t.trace.setSpanContext(i,t.INVALID_SPAN_CONTEXT):i,c,e,p,g,f),y={traceId:c,spanId:d,traceFlags:m.decision===t.SamplingDecision.RECORD_AND_SAMPLED?t.TraceFlags.SAMPLED:t.TraceFlags.NONE,traceState:l};if(m.decision===t.SamplingDecision.NOT_RECORD)return t.diag.debug("Recording is off, propagating context in a non-recording span"),t.trace.wrapSpanContext(y);let v=new n.Span(this,i,e,y,p,u,f,s.startTime);return v.setAttributes(Object.assign(g,m.attributes)),v}startActiveSpan(e,r,n,s){let i,o,a;if(arguments.length<2)return;2===arguments.length?a=r:3===arguments.length?(i=r,a=n):(i=r,o=n,a=s);let c=o??t.context.active(),l=this.startSpan(e,i,c),u=t.trace.setSpan(c,l);return t.context.with(u,a,void 0,l)}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}}})),ht=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultServiceName=void 0,e.defaultServiceName=function(){return`unknown_service:${process.argv0}`}})),dt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.detectResources=void 0;var t=vt(),n=Se(),s=r(3837);e.detectResources=async(e={})=>{let r=Object.assign(e),s=await Promise.all((r.detectors||[]).map((async e=>{try{let t=await e.detect(r);return n.diag.debug(`${e.constructor.name} found resource.`,t),t}catch(r){return n.diag.debug(`${e.constructor.name} failed: ${r.message}`),t.Resource.empty()}})));return i(s),s.reduce(((e,t)=>e.merge(t)),t.Resource.empty())};var i=e=>{e.forEach((e=>{if(Object.keys(e.attributes).length>0){let t=s.inspect(e.attributes,{depth:2,breakLength:1/0,sorted:!0,compact:!1});n.diag.verbose(t)}}))}})),pt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.envDetector=void 0;var t=Se(),r=it(),n=je(),s=bt();e.envDetector=new class{constructor(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}async detect(e){let i={},o=r.getEnv(),a=o.OTEL_RESOURCE_ATTRIBUTES,c=o.OTEL_SERVICE_NAME;if(a)try{let e=this._parseResourceAttributes(a);Object.assign(i,e)}catch(e){t.diag.debug(`EnvDetector failed: ${e.message}`)}return c&&(i[n.ResourceAttributes.SERVICE_NAME]=c),new s.Resource(i)}_parseResourceAttributes(e){if(!e)return{};let t={},r=e.split(this._COMMA_SEPARATOR,-1);for(let e of r){let r=e.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(2!==r.length)continue;let[n,s]=r;if(n=n.trim(),s=s.trim().split('^"|"$').join(""),!this._isValidAndNotEmpty(n))throw new Error(`Attribute key ${this._ERROR_MESSAGE_INVALID_CHARS}`);if(!this._isValid(s))throw new Error(`Attribute value ${this._ERROR_MESSAGE_INVALID_VALUE}`);t[n]=s}return t}_isValid(e){return e.length<=this._MAX_LENGTH&&this._isPrintableString(e)}_isPrintableString(e){for(let t=0;t<e.length;t++){let r=e.charAt(t);if(r<=" "||r>="~")return!1}return!0}_isValidAndNotEmpty(e){return e.length>0&&this._isValid(e)}}})),ft=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processDetector=void 0;var t=Se(),r=je(),n=bt();e.processDetector=new class{async detect(e){let t={[r.ResourceAttributes.PROCESS_PID]:process.pid,[r.ResourceAttributes.PROCESS_EXECUTABLE_NAME]:process.title||"",[r.ResourceAttributes.PROCESS_COMMAND]:process.argv[1]||"",[r.ResourceAttributes.PROCESS_COMMAND_LINE]:process.argv.join(" ")||""};return this._getResourceAttributes(t,e)}_getResourceAttributes(e,s){return""===e[r.ResourceAttributes.PROCESS_EXECUTABLE_NAME]||""===e[r.ResourceAttributes.PROCESS_EXECUTABLE_PATH]||""===e[r.ResourceAttributes.PROCESS_COMMAND]||""===e[r.ResourceAttributes.PROCESS_COMMAND_LINE]?(t.diag.debug("ProcessDetector failed: Unable to find required process resources. "),n.Resource.empty()):new n.Resource(Object.assign({},e))}}})),gt=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(pt(),e),r(ft(),e)})),mt=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(ht(),e),r(dt(),e),r(gt(),e)})),yt=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(mt(),e)})),vt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Resource=void 0;var t=je(),r=it(),n=yt(),s=class{constructor(e){this.attributes=e}static empty(){return s.EMPTY}static default(){return new s({[t.ResourceAttributes.SERVICE_NAME]:n.defaultServiceName(),[t.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:r.SDK_INFO[t.ResourceAttributes.TELEMETRY_SDK_LANGUAGE],[t.ResourceAttributes.TELEMETRY_SDK_NAME]:r.SDK_INFO[t.ResourceAttributes.TELEMETRY_SDK_NAME],[t.ResourceAttributes.TELEMETRY_SDK_VERSION]:r.SDK_INFO[t.ResourceAttributes.TELEMETRY_SDK_VERSION]})}merge(e){if(!e||!Object.keys(e.attributes).length)return this;let t=Object.assign({},this.attributes,e.attributes);return new s(t)}};e.Resource=s,s.EMPTY=new s({})})),wt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),St=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),bt=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(vt(),e),r(yt(),e),r(wt(),e),r(St(),e)})),_t=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MultiSpanProcessor=void 0;var t=it();e.MultiSpanProcessor=class{constructor(e){this._spanProcessors=e}forceFlush(){let e=[];for(let t of this._spanProcessors)e.push(t.forceFlush());return new Promise((r=>{Promise.all(e).then((()=>{r()})).catch((e=>{t.globalErrorHandler(e||new Error("MultiSpanProcessor: forceFlush failed")),r()}))}))}onStart(e,t){for(let r of this._spanProcessors)r.onStart(e,t)}onEnd(e){for(let t of this._spanProcessors)t.onEnd(e)}shutdown(){let e=[];for(let t of this._spanProcessors)e.push(t.shutdown());return new Promise(((t,r)=>{Promise.all(e).then((()=>{t()}),r)}))}}})),Et=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopSpanProcessor=void 0,e.NoopSpanProcessor=class{onStart(e,t){}onEnd(e){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}}})),Tt=y(((e,t)=>{var r="__lodash_hash_undefined__",n=9007199254740991,s="[object Arguments]",i="[object Function]",o="[object Object]",a=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[s]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l[i]=l["[object Map]"]=l["[object Number]"]=l[o]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var u="object"==typeof global&&global&&global.Object===Object&&global,h="object"==typeof self&&self&&self.Object===Object&&self,d=u||h||Function("return this")(),p="object"==typeof e&&e&&!e.nodeType&&e,f=p&&"object"==typeof t&&t&&!t.nodeType&&t,g=f&&f.exports===p,m=g&&u.process,y=function(){try{return f&&f.require&&f.require("util").types||m&&m.binding&&m.binding("util")}catch{}}(),v=y&&y.isTypedArray;function w(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var S,b=Array.prototype,_=Function.prototype,E=Object.prototype,T=d["__core-js_shared__"],C=_.toString,P=E.hasOwnProperty,A=(S=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",R=E.toString,I=C.call(Object),x=RegExp("^"+C.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),O=g?d.Buffer:void 0,k=d.Symbol,M=d.Uint8Array,N=(O&&O.allocUnsafe,function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object)),D=Object.create,L=E.propertyIsEnumerable,B=b.splice,q=k?k.toStringTag:void 0,j=function(){try{var e=oe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),F=O?O.isBuffer:void 0,U=Math.max,$=Date.now,H=oe(d,"Map"),K=oe(Object,"create"),V=function(){function e(){}return function(t){if(!ve(t))return{};if(D)return D(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function z(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function W(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function G(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Y(e){var t=this.__data__=new W(e);this.size=t.size}function Q(e,t,r){(void 0!==r&&!he(e[t],r)||void 0===r&&!(t in e))&&Z(e,t,r)}function X(e,t,r){var n=e[t];(!P.call(e,t)||!he(n,r)||void 0===r&&!(t in e))&&Z(e,t,r)}function J(e,t){for(var r=e.length;r--;)if(he(e[r][0],t))return r;return-1}function Z(e,t,r){"__proto__"==t&&j?j(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}z.prototype.clear=function(){this.__data__=K?K(null):{},this.size=0},z.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},z.prototype.get=function(e){var t=this.__data__;if(K){var n=t[e];return n===r?void 0:n}return P.call(t,e)?t[e]:void 0},z.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:P.call(t,e)},z.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=K&&void 0===t?r:t,this},W.prototype.clear=function(){this.__data__=[],this.size=0},W.prototype.delete=function(e){var t=this.__data__,r=J(t,e);return!(r<0||(r==t.length-1?t.pop():B.call(t,r,1),--this.size,0))},W.prototype.get=function(e){var t=this.__data__,r=J(t,e);return r<0?void 0:t[r][1]},W.prototype.has=function(e){return J(this.__data__,e)>-1},W.prototype.set=function(e,t){var r=this.__data__,n=J(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},G.prototype.clear=function(){this.size=0,this.__data__={hash:new z,map:new(H||W),string:new z}},G.prototype.delete=function(e){var t=ie(this,e).delete(e);return this.size-=t?1:0,t},G.prototype.get=function(e){return ie(this,e).get(e)},G.prototype.has=function(e){return ie(this,e).has(e)},G.prototype.set=function(e,t){var r=ie(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Y.prototype.clear=function(){this.__data__=new W,this.size=0},Y.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Y.prototype.get=function(e){return this.__data__.get(e)},Y.prototype.has=function(e){return this.__data__.has(e)},Y.prototype.set=function(e,t){var r=this.__data__;if(r instanceof W){var n=r.__data__;if(!H||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new G(n)}return r.set(e,t),this.size=r.size,this};var ee=function(e,t,r){for(var n=-1,s=Object(e),i=r(e),o=i.length;o--;){var a=i[++n];if(!1===t(s[a],a,s))break}return e};function te(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":q&&q in Object(e)?function(e){var t=P.call(e,q),r=e[q];try{e[q]=void 0;var n=!0}catch{}var s=R.call(e);return n&&(t?e[q]=r:delete e[q]),s}(e):function(e){return R.call(e)}(e)}function re(e){return we(e)&&te(e)==s}function ne(e,t,r,n,s){e!==t&&ee(t,(function(i,a){if(s||(s=new Y),ve(i))!function(e,t,r,n,s,i,a){var c=le(e,r),l=le(t,r),u=a.get(l);if(u)Q(e,r,u);else{var h=i?i(c,l,r+"",e,t,a):void 0,d=void 0===h;if(d){var p=pe(l),f=!p&&ge(l),g=!p&&!f&&Se(l);h=l,p||f||g?pe(c)?h=c:function(e){return we(e)&&fe(e)}(c)?h=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(c):f?(d=!1,h=function(e,t){return e.slice()}(l)):g?(d=!1,h=function(e,t){var r=function(e){var t=new e.constructor(e.byteLength);return new M(t).set(new M(e)),t}(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}(l)):h=[]:function(e){if(!we(e)||te(e)!=o)return!1;var t=N(e);if(null===t)return!0;var r=P.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&C.call(r)==I}(l)||de(l)?(h=c,de(c)?h=function(e){return function(e,t,r,n){var s=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var a=t[i],c=void 0;void 0===c&&(c=e[a]),s?Z(r,a,c):X(r,a,c)}return r}(e,be(e))}(c):(!ve(c)||me(c))&&(h=function(e){return"function"!=typeof e.constructor||ce(e)?{}:V(N(e))}(l))):d=!1}d&&(a.set(l,h),s(h,l,n,i,a),a.delete(l)),Q(e,r,h)}}(e,t,a,r,ne,n,s);else{var c=n?n(le(e,a),i,a+"",e,t,s):void 0;void 0===c&&(c=i),Q(e,a,c)}}),be)}var se=j?function(e,t){return j(e,"toString",{configurable:!0,enumerable:!1,value:Ee(t),writable:!0})}:Te;function ie(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function oe(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!ve(e)||function(e){return!!A&&A in e}(e))&&(me(e)?x:a).test(function(e){if(null!=e){try{return C.call(e)}catch{}try{return e+""}catch{}}return""}(e))}(r)?r:void 0}function ae(e,t){var r=typeof e;return!!(t=t??n)&&("number"==r||"symbol"!=r&&c.test(e))&&e>-1&&e%1==0&&e<t}function ce(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||E)}function le(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ue=function(e){var t=0,r=0;return function(){var n=$(),s=16-(n-r);if(r=n,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(se);function he(e,t){return e===t||e!=e&&t!=t}var de=re(function(){return arguments}())?re:function(e){return we(e)&&P.call(e,"callee")&&!L.call(e,"callee")},pe=Array.isArray;function fe(e){return null!=e&&ye(e.length)&&!me(e)}var ge=F||function(){return!1};function me(e){if(!ve(e))return!1;var t=te(e);return t==i||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function ye(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function ve(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function we(e){return null!=e&&"object"==typeof e}var Se=v?function(e){return function(t){return e(t)}}(v):function(e){return we(e)&&ye(e.length)&&!!l[te(e)]};function be(e){return fe(e)?function(e,t){var r=pe(e),n=!r&&de(e),s=!r&&!n&&ge(e),i=!r&&!n&&!s&&Se(e),o=r||n||s||i,a=o?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=a.length;for(var l in e)(t||P.call(e,l))&&(!o||!("length"==l||s&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ae(l,c)))&&a.push(l);return a}(e,!0):function(e){if(!ve(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=ce(e),r=[];for(var n in e)"constructor"==n&&(t||!P.call(e,n))||r.push(n);return r}(e)}var _e=function(e){return function(e,t){return ue(function(e,t,r){return t=U(void 0===t?e.length-1:t,0),function(){for(var n=arguments,s=-1,i=U(n.length-t,0),o=Array(i);++s<i;)o[s]=n[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=n[s];return a[t]=r(o),w(e,this,a)}}(e,t,Te),e+"")}((function(t,r){var n=-1,s=r.length,i=s>1?r[s-1]:void 0,o=s>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(s--,i):void 0,o&&function(e,t,r){if(!ve(r))return!1;var n=typeof t;return!!("number"==n?fe(r)&&ae(t,r.length):"string"==n&&t in r)&&he(r[t],e)}(r[0],r[1],o)&&(i=s<3?void 0:i,s=1),t=Object(t);++n<s;){var a=r[n];a&&e(t,a,n)}return t}))}((function(e,t,r){ne(e,t,r)}));function Ee(e){return function(){return e}}function Te(e){return e}t.exports=_e})),Ct=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BatchSpanProcessorBase=void 0;var t=Se(),r=it();e.BatchSpanProcessorBase=class{constructor(e,t){this._exporter=e,this._finishedSpans=[],this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve();let n=r.getEnv();this._maxExportBatchSize="number"==typeof(null==t?void 0:t.maxExportBatchSize)?t.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==t?void 0:t.maxQueueSize)?t.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==t?void 0:t.scheduledDelayMillis)?t.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==t?void 0:t.exportTimeoutMillis)?t.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT}forceFlush(){return this._isShutdown?this._shuttingDownPromise:this._flushAll()}onStart(e){}onEnd(e){this._isShutdown||this._addToBuffer(e)}shutdown(){return this._isShutdown||(this._isShutdown=!0,this._shuttingDownPromise=new Promise(((e,t)=>{Promise.resolve().then((()=>this.onShutdown())).then((()=>this._flushAll())).then((()=>this._exporter.shutdown())).then(e).catch((e=>{t(e)}))}))),this._shuttingDownPromise}_addToBuffer(e){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(e),this._maybeStartTimer())}_flushAll(){return new Promise(((e,t)=>{let r=[];for(let e=0,t=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);e<t;e++)r.push(this._flushOneBatch());Promise.all(r).then((()=>{e()})).catch(t)}))}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise(((e,n)=>{let s=setTimeout((()=>{n(new Error("Timeout"))}),this._exportTimeoutMillis);t.context.with(r.suppressTracing(t.context.active()),(()=>{this._exporter.export(this._finishedSpans.splice(0,this._maxExportBatchSize),(t=>{var i;clearTimeout(s),t.code===r.ExportResultCode.SUCCESS?e():n(null!==(i=t.error)&&void 0!==i?i:new Error("BatchSpanProcessor: span export failed"))}))}))}))}_maybeStartTimer(){void 0===this._timer&&(this._timer=setTimeout((()=>{this._flushOneBatch().then((()=>{this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())})).catch((e=>{r.globalErrorHandler(e)}))}),this._scheduledDelayMillis),r.unrefTimer(this._timer))}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}}})),Pt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BatchSpanProcessor=void 0;var t=Ct(),r=class extends t.BatchSpanProcessorBase{onShutdown(){}};e.BatchSpanProcessor=r})),At=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Pt(),e)})),Rt=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(At(),e)})),It=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BasicTracerProvider=e.ForceFlushState=void 0;var t,r,n=Se(),s=it(),i=bt(),o=qt(),a=ct(),c=_t(),l=Et(),u=Tt(),h=Rt();(r=t=e.ForceFlushState||(e.ForceFlushState={}))[r.resolved=0]="resolved",r[r.timeout=1]="timeout",r[r.error=2]="error",r[r.unresolved=3]="unresolved";var d=class{constructor(e={}){var t;this._registeredSpanProcessors=[],this._tracers=new Map;let r=u({},a.DEFAULT_CONFIG,e);this.resource=null!==(t=r.resource)&&void 0!==t?t:i.Resource.empty(),this.resource=i.Resource.default().merge(this.resource),this._config=Object.assign({},r,{resource:this.resource});let n=this._buildExporterFromEnv();if(void 0!==n){let e=new h.BatchSpanProcessor(n);this.activeSpanProcessor=e}else this.activeSpanProcessor=new l.NoopSpanProcessor}getTracer(e,t){let r=`${e}@${t||""}`;return this._tracers.has(r)||this._tracers.set(r,new o.Tracer({name:e,version:t},this._config,this)),this._tracers.get(r)}addSpanProcessor(e){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch((e=>n.diag.error("Error while trying to shutdown current span processor",e))),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new c.MultiSpanProcessor(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(e={}){n.trace.setGlobalTracerProvider(this),void 0===e.propagator&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&n.context.setGlobalContextManager(e.contextManager),e.propagator&&n.propagation.setGlobalPropagator(e.propagator)}forceFlush(){let e=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map((r=>new Promise((n=>{let s,i=setTimeout((()=>{n(new Error(`Span processor did not completed within timeout period of ${e} ms`)),s=t.timeout}),e);r.forceFlush().then((()=>{clearTimeout(i),s!==t.timeout&&(s=t.resolved,n(s))})).catch((e=>{clearTimeout(i),s=t.error,n(e)}))}))));return new Promise(((e,n)=>{Promise.all(r).then((r=>{let s=r.filter((e=>e!==t.resolved));s.length>0?n(s):e()})).catch((e=>n([e])))}))}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(e){var t;return null===(t=d._registeredPropagators.get(e))||void 0===t?void 0:t()}_getSpanExporter(e){var t;return null===(t=d._registeredExporters.get(e))||void 0===t?void 0:t()}_buildPropagatorFromEnv(){let e=Array.from(new Set(s.getEnv().OTEL_PROPAGATORS)),t=e.map((e=>{let t=this._getPropagator(e);return t||n.diag.warn(`Propagator "${e}" requested through environment variable is unavailable.`),t})).reduce(((e,t)=>(t&&e.push(t),e)),[]);if(0!==t.length)return 1===e.length?t[0]:new s.CompositePropagator({propagators:t})}_buildExporterFromEnv(){let e=s.getEnv().OTEL_TRACES_EXPORTER;if("none"===e)return;let t=this._getSpanExporter(e);return t||n.diag.error(`Exporter "${e}" requested through environment variable is unavailable.`),t}};e.BasicTracerProvider=d,d._registeredPropagators=new Map([["tracecontext",()=>new s.HttpTraceContextPropagator],["baggage",()=>new s.HttpBaggagePropagator]]),d._registeredExporters=new Map})),xt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConsoleSpanExporter=void 0;var t=it();e.ConsoleSpanExporter=class{export(e,t){return this._sendSpans(e,t)}shutdown(){return this._sendSpans([]),Promise.resolve()}_exportInfo(e){return{traceId:e.spanContext().traceId,parentId:e.parentSpanId,name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:t.hrTimeToMicroseconds(e.startTime),duration:t.hrTimeToMicroseconds(e.duration),attributes:e.attributes,status:e.status,events:e.events}}_sendSpans(e,r){for(let t of e)console.log(this._exportInfo(t));if(r)return r({code:t.ExportResultCode.SUCCESS})}}})),Ot=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InMemorySpanExporter=void 0;var t=it();e.InMemorySpanExporter=class{constructor(){this._finishedSpans=[],this._stopped=!1}export(e,r){if(this._stopped)return r({code:t.ExportResultCode.FAILED,error:new Error("Exporter has been stopped")});this._finishedSpans.push(...e),setTimeout((()=>r({code:t.ExportResultCode.SUCCESS})),0)}shutdown(){return this._stopped=!0,this._finishedSpans=[],Promise.resolve()}reset(){this._finishedSpans=[]}getFinishedSpans(){return this._finishedSpans}}})),kt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Mt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleSpanProcessor=void 0;var t=Se(),r=it();e.SimpleSpanProcessor=class{constructor(e){this._exporter=e,this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve()}forceFlush(){return Promise.resolve()}onStart(e){}onEnd(e){this._isShutdown||t.context.with(r.suppressTracing(t.context.active()),(()=>{this._exporter.export([e],(e=>{var t;e.code!==r.ExportResultCode.SUCCESS&&r.globalErrorHandler(null!==(t=e.error)&&void 0!==t?t:new Error(`SimpleSpanProcessor: span export failed (status ${e})`))}))}))}shutdown(){return this._isShutdown||(this._isShutdown=!0,this._shuttingDownPromise=new Promise(((e,t)=>{Promise.resolve().then((()=>this._exporter.shutdown())).then(e).catch((e=>{t(e)}))}))),this._shuttingDownPromise}}})),Nt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Dt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Lt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Bt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),qt=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(ut(),e),r(It(),e),r(Rt(),e),r(xt(),e),r(Ot(),e),r(kt(),e),r(Mt(),e),r(Nt(),e),r(Et(),e),r(at(),e),r(Dt(),e),r(Lt(),e),r(Bt(),e)})),jt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.azureCoreTracing=e.AzureMonitorSymbol=void 0;var t=C();e.AzureMonitorSymbol="Azure_Monitor_Tracer";var r=!1;e.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:function(n){if(r)return n;try{var s=qt(),i=Se(),o=(new s.BasicTracerProvider).getTracer("applicationinsights tracer"),a=n.setTracer;n.setTracer=function(r){var n=r.startSpan;r.startSpan=function(e,r,s){var i=n.call(this,e,r,s),o=i.end;return i.end=function(){var e=o.apply(this,arguments);return t.channel.publish("azure-coretracing",i),e},i},r[e.AzureMonitorSymbol]=!0,a.call(this,r)},i.trace.getSpan(i.context.active()),n.setTracer(o),r=!0}catch{}return n}},e.enable=function(){t.channel.registerMonkeyPatch("@azure/core-tracing",e.azureCoreTracing)}})),Ft=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.bunyan=void 0;var t=C();e.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:function(e){var r=e.prototype._emit;return e.prototype._emit=function(e,n){var s=r.apply(this,arguments);if(!n){var i=s;i||(i=r.call(this,e,!0)),t.channel.publish("bunyan",{level:e.level,result:i})}return s},e}},e.enable=function(){t.channel.registerMonkeyPatch("bunyan",e.bunyan)}})),Ut=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.console=void 0;var t=C(),n=r(2781);e.console={versionSpecifier:">= 4.0.0",patch:function(e){var r=new n.Writable,s=new n.Writable;r.write=function(e){if(!e)return!0;var r=e.toString();return t.channel.publish("console",{message:r}),!0},s.write=function(e){if(!e)return!0;var r=e.toString();return t.channel.publish("console",{message:r,stderr:!0}),!0};for(var i=new e.Console(r,s),o=function(t){var r=e[t];r&&(e[t]=function(){if(i[t])try{i[t].apply(i,arguments)}catch{}return r.apply(e,arguments)})},a=0,c=["log","info","warn","error","dir","time","timeEnd","trace","assert"];a<c.length;a++)o(c[a]);return e}},e.enable=function(){t.channel.registerMonkeyPatch("console",e.console),r(6206)}})),$t=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.mongoCore=void 0;var t=C();e.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:function(e){var r=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var e=r.apply(this,arguments),n=this.s.pool.write;this.s.pool.write=function(){var e="function"==typeof arguments[1]?1:2;return"function"==typeof arguments[e]&&(arguments[e]=t.channel.bindToContext(arguments[e])),n.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return"function"==typeof arguments[1]&&(arguments[1]=t.channel.bindToContext(arguments[1])),s.apply(this,arguments)},e},e}},e.enable=function(){t.channel.registerMonkeyPatch("mongodb-core",e.mongoCore)}})),Ht=y((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.mongo330=e.mongo3=e.mongo2=void 0;var r=C();e.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:function(e){var n=e.instrument({operationIdGenerator:{next:function(){return r.channel.bindToContext((function(e){return e()}))}}}),s={};return n.on("started",(function(e){s[e.requestId]||(s[e.requestId]=t(t({},e),{time:new Date}))})),n.on("succeeded",(function(e){var t=s[e.requestId];t&&delete s[e.requestId],"function"==typeof e.operationId?e.operationId((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})):r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),n.on("failed",(function(e){var t=s[e.requestId];t&&delete s[e.requestId],"function"==typeof e.operationId?e.operationId((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})):r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),e}},e.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:function(e){var n=e.instrument(),s={},i={};return n.on("started",(function(e){s[e.requestId]||(i[e.requestId]=r.channel.bindToContext((function(e){return e()})),s[e.requestId]=t(t({},e),{time:new Date}))})),n.on("succeeded",(function(e){var t=s[e.requestId];t&&delete s[e.requestId],"object"==typeof e&&"function"==typeof i[e.requestId]&&(i[e.requestId]((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),delete i[e.requestId])})),n.on("failed",(function(e){var t=s[e.requestId];t&&delete s[e.requestId],"object"==typeof e&&"function"==typeof i[e.requestId]&&(i[e.requestId]((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),delete i[e.requestId])})),e}},e.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:function(e){!function(e){var t=e.Server.prototype.connect;e.Server.prototype.connect=function(){var e=t.apply(this,arguments),n=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var e="function"==typeof arguments[1]?1:2;return"function"==typeof arguments[e]&&(arguments[e]=r.channel.bindToContext(arguments[e])),n.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return"function"==typeof arguments[1]&&(arguments[1]=r.channel.bindToContext(arguments[1])),s.apply(this,arguments)},e}}(e);var t=e.instrument(),n={},s={};return t.on("started",(function(e){n[e.requestId]||(s[e.requestId]=r.channel.bindToContext((function(e){return e()})),n[e.requestId]=e)})),t.on("succeeded",(function(e){var t=n[e.requestId];t&&delete n[e.requestId],"object"==typeof e&&"function"==typeof s[e.requestId]&&(s[e.requestId]((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),delete s[e.requestId])})),t.on("failed",(function(e){var t=n[e.requestId];t&&delete n[e.requestId],"object"==typeof e&&"function"==typeof s[e.requestId]&&(s[e.requestId]((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),delete s[e.requestId])})),e}},e.enable=function(){r.channel.registerMonkeyPatch("mongodb",e.mongo2),r.channel.registerMonkeyPatch("mongodb",e.mongo3),r.channel.registerMonkeyPatch("mongodb",e.mongo330)}})),Kt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.mysql=void 0;var t=C(),n=r(1017);e.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:function(e,s){var i=function(e,r){return function(r,n){var s=e[r];s&&(e[r]=function(){for(var e=arguments.length-1,r=arguments.length-1;r>=0;--r){if("function"==typeof arguments[r]){e=r;break}if(typeof arguments[r]<"u")break}var i=arguments[e],o={result:null,startTime:null,startDate:null};"function"==typeof i&&(n?(o.startTime=process.hrtime(),o.startDate=new Date,arguments[e]=t.channel.bindToContext(n(o,i))):arguments[e]=t.channel.bindToContext(i));var a=s.apply(this,arguments);return o.result=a,a})}},o=function(e,t){return i(e.prototype)},a=r(2729)(n.dirname(s)+"/lib/Connection");["connect","changeUser","ping","statistics","end"].forEach((function(e){return o(a)(e)})),i(a)("createQuery",(function(e,r){return function(n){var s=process.hrtime(e.startTime),i=1e3*s[0]+s[1]/1e6|0;t.channel.publish("mysql",{query:e.result,callbackArgs:arguments,err:n,duration:i,time:e.startDate}),r.apply(this,arguments)}}));var c=r(9668)(n.dirname(s)+"/lib/Pool");return["_enqueueCallback"].forEach((function(e){return o(c)(e)})),e}},e.enable=function(){t.channel.registerMonkeyPatch("mysql",e.mysql)}})),Vt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.postgresPool1=void 0;var t=C();e.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:function(e){var r=e.prototype.connect;return e.prototype.connect=function(e){return e&&(arguments[0]=t.channel.bindToContext(e)),r.apply(this,arguments)},e}},e.enable=function(){t.channel.registerMonkeyPatch("pg-pool",e.postgresPool1)}})),zt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.postgres7=e.postgres6=void 0;var t=C(),n=r(2361);e.postgres6={versionSpecifier:"6.*",patch:function(e,r){var s=e.Client.prototype.query,i="__diagnosticOriginalFunc";return e.Client.prototype.query=function(e,r,o){var a,c={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},l=process.hrtime();function u(e){e&&e[i]&&(e=e[i]);var r=t.channel.bindToContext((function(r,s){var i=process.hrtime(l);if(c.result=s&&{rowCount:s.rowCount,command:s.command},c.error=r,c.duration=Math.ceil(1e3*i[0]+i[1]/1e6),t.channel.publish("postgres",c),r){if(e)return e.apply(this,arguments);a&&a instanceof n.EventEmitter&&a.emit("error",r)}else e&&e.apply(this,arguments)}));try{return Object.defineProperty(r,i,{value:e}),r}catch{return e}}try{"string"==typeof e?r instanceof Array?(c.query.preparable={text:e,args:r},o=u(o)):(c.query.text=e,o?o=u(o):r=u(r)):("string"==typeof e.name?c.query.plan=e.name:e.values instanceof Array?c.query.preparable={text:e.text,args:e.values}:c.query.text=e.text,o?o=u(o):r?r=u(r):e.callback=u(e.callback))}catch{return s.apply(this,arguments)}return arguments[0]=e,arguments[1]=r,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,a=s.apply(this,arguments)},e}},e.postgres7={versionSpecifier:">=7.* <=8.*",patch:function(e,r){var s=e.Client.prototype.query,i="__diagnosticOriginalFunc";return e.Client.prototype.query=function(e,r,o){var a,c=this,l=!!o,u={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},h=process.hrtime();function d(e){e&&e[i]&&(e=e[i]);var r=t.channel.bindToContext((function(r,s){var i=process.hrtime(h);if(u.result=s&&{rowCount:s.rowCount,command:s.command},u.error=r,u.duration=Math.ceil(1e3*i[0]+i[1]/1e6),t.channel.publish("postgres",u),r){if(e)return e.apply(this,arguments);a&&a instanceof n.EventEmitter&&a.emit("error",r)}else e&&e.apply(this,arguments)}));try{return Object.defineProperty(r,i,{value:e}),r}catch{return e}}try{"string"==typeof e?r instanceof Array?(u.query.preparable={text:e,args:r},o=(l="function"==typeof o)?d(o):o):(u.query.text=e,o?o=(l="function"==typeof o)?d(o):o:r=(l="function"==typeof r)?d(r):r):("string"==typeof e.name?u.query.plan=e.name:e.values instanceof Array?u.query.preparable={text:e.text,args:e.values}:u.query.text=e.text,o?(l="function"==typeof o,o=d(o)):r?r=(l="function"==typeof r)?d(r):r:(l="function"==typeof e.callback,e.callback=l?d(e.callback):e.callback))}catch{return s.apply(this,arguments)}return arguments[0]=e,arguments[1]=r,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,a=s.apply(this,arguments),l?a:a.then((function(e){return d()(void 0,e),new c._Promise((function(t,r){t(e)}))})).catch((function(e){return d()(e,void 0),new c._Promise((function(t,r){r(e)}))}))},e}},e.enable=function(){t.channel.registerMonkeyPatch("pg",e.postgres6),t.channel.registerMonkeyPatch("pg",e.postgres7)}})),Wt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.redis=void 0;var t=C();e.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:function(e){var r=e.RedisClient.prototype.internal_send_command;return e.RedisClient.prototype.internal_send_command=function(e){if(e){var n=e.callback;if(!n||!n.pubsubBound){var s=this.address,i=process.hrtime(),o=new Date;e.callback=t.channel.bindToContext((function(r,a){var c=process.hrtime(i),l=1e3*c[0]+c[1]/1e6|0;t.channel.publish("redis",{duration:l,address:s,commandObj:e,err:r,result:a,time:o}),"function"==typeof n&&n.apply(this,arguments)})),e.callback.pubsubBound=!0}}return r.call(this,e)},e}},e.enable=function(){t.channel.registerMonkeyPatch("redis",e.redis)}})),Gt=y((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.tedious=void 0;var r=C();e.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:function(e){var n=e.Connection.prototype.makeRequest;return e.Connection.prototype.makeRequest=function(){function e(e){var n=process.hrtime(),s={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return r.channel.bindToContext((function(i,o,a){var c=process.hrtime(n);s=t(t({},s),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!i&&{rowCount:o,rows:a},query:{text:this.parametersByName.statement.value},error:i,duration:Math.ceil(1e3*c[0]+c[1]/1e6)}),r.channel.publish("tedious",s),e.call(this,i,o,a)}))}var s=arguments[0];arguments[0].callback=e(s.callback),n.apply(this,arguments)},e}},e.enable=function(){r.channel.registerMonkeyPatch("tedious",e.tedious)}})),Yt=y((e=>{"use strict";var t,r=e&&e.__extends||(t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},t(e,r)},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),n=e&&e.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.winston2=e.winston3=void 0;var s=C();e.winston3={versionSpecifier:"3.x",patch:function(e){var t=function(e){function t(t,r){var n=e.call(this,r)||this;return n.winston=t,n}return r(t,e),t.prototype.log=function(e,t){var r=e.message,i=e.level,o=e.meta,a=n(e,["message","level","meta"]);i="function"==typeof Symbol.for?e[Symbol.for("level")]:i,r=e instanceof Error?e:r;var c=function(e,t){return null!=e.config.npm.levels[t]?"npm":null!=e.config.syslog.levels[t]?"syslog":"unknown"}(this.winston,i);for(var l in o=o||{},a)a.hasOwnProperty(l)&&(o[l]=a[l]);s.channel.publish("winston",{message:r,level:i,levelKind:c,meta:o}),t()},t}(e.Transport);function i(){var r,n=arguments[0].levels||e.config.npm.levels;for(var s in n)n.hasOwnProperty(s)&&(r=void 0===r||n[s]>n[r]?s:r);this.add(new t(e,{level:r}))}var o=e.createLogger;e.createLogger=function(){var r,n=arguments[0].levels||e.config.npm.levels;for(var s in n)n.hasOwnProperty(s)&&(r=void 0===r||n[s]>n[r]?s:r);var a=o.apply(this,arguments);a.add(new t(e,{level:r}));var c=a.configure;return a.configure=function(){c.apply(this,arguments),i.apply(this,arguments)},a};var a=e.configure;return e.configure=function(){a.apply(this,arguments),i.apply(this,arguments)},e.add(new t(e)),e}},e.winston2={versionSpecifier:"2.x",patch:function(e){var t,r=e.Logger.prototype.log,n=function(r,n,i){var o;return o=t===e.config.npm.levels?"npm":t===e.config.syslog.levels?"syslog":"unknown",s.channel.publish("winston",{level:r,message:n,meta:i,levelKind:o}),n};return e.Logger.prototype.log=function(){return t=this.levels,this.filters&&0!==this.filters.length?this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter((function(e){return e!==n})),this.filters.push(n)):this.filters=[n],r.apply(this,arguments)},e}},e.enable=function(){s.channel.registerMonkeyPatch("winston",e.winston2),s.channel.registerMonkeyPatch("winston",e.winston3)}})),Qt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.tedious=e.pgPool=e.pg=e.winston=e.redis=e.mysql=e.mongodb=e.mongodbCore=e.console=e.bunyan=e.azuresdk=void 0;var t=jt();e.azuresdk=t;var r=Ft();e.bunyan=r;var n=Ut();e.console=n;var s=$t();e.mongodbCore=s;var i=Ht();e.mongodb=i;var o=Kt();e.mysql=o;var a=Vt();e.pgPool=a;var c=zt();e.pg=c;var l=Wt();e.redis=l;var u=Gt();e.tedious=u;var h=Yt();e.winston=h,e.enable=function(){r.enable(),n.enable(),s.enable(),i.enable(),o.enable(),c.enable(),a.enable(),l.enable(),h.enable(),t.enable(),u.enable()}})),Xt=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.registerContextPreservation=e.IsInitialized=void 0;var t=b(),r=S();e.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var n,s,i,o,a="DiagnosticChannel";if(e.IsInitialized){for(o in n=Qt(),s=(process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"").split(","),i={bunyan:n.bunyan,console:n.console,mongodb:n.mongodb,mongodbCore:n.mongodbCore,mysql:n.mysql,redis:n.redis,pg:n.pg,pgPool:n.pgPool,winston:n.winston,azuresdk:n.azuresdk})-1===s.indexOf(o)&&(i[o].enable(),r.info(a,"Subscribed to "+o+" events"));s.length>0&&r.info(a,"Some modules will not be patched",s)}else r.info(a,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");e.registerContextPreservation=function(r){if(e.IsInitialized){var n=C();n.channel.addContextPreservation(r),n.channel.spanContextPropagator=t.AsyncScopeManager}}})),Jt=y(((e,t)=>{"use strict";t.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}})),Zt=y(((e,t)=>{"use strict";var n=e&&e.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},n.apply(this,arguments)},s=r(3685),i=r(5687),o=r(7310),a=r(2057),c=S(),l=Jt(),u=function(){function e(){}return e.getCookie=function(t,r){var n="";if(t&&t.length&&"string"==typeof r)for(var s=t+"=",i=r.split(";"),o=0;o<i.length;o++)if(r=i[o],(r=e.trim(r))&&0===r.indexOf(s)){n=r.substring(s.length,i[o].length);break}return n},e.trim=function(e){return"string"==typeof e?e.replace(/^\s+|\s+$/g,""):""},e.int32ArrayToBase64=function(e){var t=function(e,t){return String.fromCharCode(e>>t&255)},r=e.map((function(e){return t(e,24)+t(e,16)+t(e,8)+t(e,0)})).join(""),n=(Buffer.from?Buffer.from(r,"binary"):new Buffer(r,"binary")).toString("base64");return n.substr(0,n.indexOf("="))},e.random32=function(){return 4294967296*Math.random()|0},e.randomu32=function(){return e.random32()+2147483648},e.w3cTraceId=function(){for(var t,r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",s=0;s<4;s++)n+=r[15&(t=e.random32())]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+4*Math.random()|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)},e.w3cSpanId=function(){return e.w3cTraceId().substring(16)},e.isValidW3CId=function(e){return 32===e.length&&"00000000000000000000000000000000"!==e},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.isError=function(e){return e instanceof Error},e.isPrimitive=function(e){var t=typeof e;return"string"===t||"number"===t||"boolean"===t},e.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},e.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=(e/1e3%60).toFixed(7).replace(/0{0,4}$/,""),r=""+Math.floor(e/6e4)%60,n=""+Math.floor(e/36e5)%24,s=Math.floor(e/864e5);return t=t.indexOf(".")<2?"0"+t:t,r=r.length<2?"0"+r:r,(s>0?s+".":"")+(n=n.length<2?"0"+n:n)+":"+r+":"+t},e.extractError=function(e){var t=e;return{message:e.message,code:t.code||t.id||""}},e.extractObject=function(t){return t instanceof Error?e.extractError(t):"function"==typeof t.toJSON?t.toJSON():t},e.validateStringMap=function(t){if("object"==typeof t){var r={};for(var n in t){var s="",i=t[n],o=typeof i;if(e.isPrimitive(i))s=i.toString();else if(null===i||"undefined"===o)s="";else{if("function"===o){c.info("key: "+n+" was function; will not serialize");continue}var a=e.isArray(i)?i:e.extractObject(i);try{s=e.isPrimitive(a)?a:JSON.stringify(a)}catch(e){s=i.constructor.name.toString()+" (Error: "+e.message+")",c.info("key: "+n+", could not be serialized")}}r[n]=s.substring(0,e.MAX_PROPERTY_LENGTH)}return r}c.info("Invalid properties dropped from payload")},e.canIncludeCorrelationHeader=function(e,t){var r=e&&e.config&&e.config.correlationHeaderExcludedDomains;if(!r||0==r.length||!t)return!0;for(var n=0;n<r.length;n++)if(new RegExp(r[n].replace(/\./g,".").replace(/\*/g,".*")).test(o.parse(t).hostname))return!1;return!0},e.getCorrelationContextTarget=function(e,t){var r=e.headers&&e.headers[l.requestContextHeader];if(r)for(var n=r.split(","),s=0;s<n.length;++s){var i=n[s].split("=");if(2==i.length&&i[0]==t)return i[1]}},e.makeRequest=function(t,r,a,l){r&&0===r.indexOf("//")&&(r="https:"+r);var u=o.parse(r),h=n(n({},a),{host:u.hostname,port:u.port,path:u.pathname}),d=void 0;if("https:"===u.protocol&&(d=t.proxyHttpsUrl||void 0),"http:"===u.protocol&&(d=t.proxyHttpUrl||void 0),d){0===d.indexOf("//")&&(d="http:"+d);var p=o.parse(d);"https:"===p.protocol?(c.info("Proxies that use HTTPS are not supported"),d=void 0):h=n(n({},h),{host:p.hostname,port:p.port||"80",path:r,headers:n(n({},h.headers),{Host:u.hostname})})}var f="https:"===u.protocol&&!d;return f&&void 0!==t.httpsAgent?h.agent=t.httpsAgent:f||void 0===t.httpAgent?f&&(h.agent=e.tlsRestrictedAgent):h.agent=t.httpAgent,f?i.request(h,l):s.request(h,l)},e.safeIncludeCorrelationHeader=function(t,r,n){var s;if("string"==typeof n)s=n;else if(n instanceof Array)s=n.join(",");else if(n&&"function"==typeof n.toString)try{s=n.toString()}catch(e){c.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",e,n)}s?e.addCorrelationIdHeaderFromString(t,r,s):r.setHeader(l.requestContextHeader,l.requestContextSourceKey+"="+t.config.correlationId)},e.dumpObj=function(e){var t=Object.prototype.toString.call(e);return t+("[object Error]"===t?"{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":JSON.stringify(e))},e.addCorrelationIdHeaderFromString=function(e,t,r){var n=r.split(","),s=l.requestContextSourceKey+"=";n.some((function(e){return e.substring(0,s.length)===s}))||t.setHeader(l.requestContextHeader,r+","+l.requestContextSourceKey+"="+e.config.correlationId)},e.MAX_PROPERTY_LENGTH=8192,e.tlsRestrictedAgent=new i.Agent({keepAlive:!0,maxSockets:25,secureOptions:a.SSL_OP_NO_SSLv2|a.SSL_OP_NO_SSLv3|a.SSL_OP_NO_TLSv1|a.SSL_OP_NO_TLSv1_1}),e}();t.exports=u})),er=y(((e,t)=>{"use strict";var r=Zt(),n=S(),s=function(){function e(){}return e.queryCorrelationId=function(t,s){var i=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId";if(e.completedLookups.hasOwnProperty(i))s(e.completedLookups[i]);else if(e.pendingLookups[i])e.pendingLookups[i].push(s);else{e.pendingLookups[i]=[s];var o=function(){if(e.pendingLookups[i]){var s={method:"GET",disableAppInsightsAutoCollection:!0};n.info(e.TAG,s);var a=r.makeRequest(t,i,s,(function(r){if(200===r.statusCode){var s="";r.setEncoding("utf-8"),r.on("data",(function(e){s+=e})),r.on("end",(function(){n.info(e.TAG,s);var t=e.correlationIdPrefix+s;e.completedLookups[i]=t,e.pendingLookups[i]&&e.pendingLookups[i].forEach((function(e){return e(t)})),delete e.pendingLookups[i]}))}else r.statusCode>=400&&r.statusCode<500?(e.completedLookups[i]=void 0,delete e.pendingLookups[i]):setTimeout(o,t.correlationIdRetryIntervalMs)}));a&&(a.on("error",(function(t){n.warn(e.TAG,t)})),a.end())}};setTimeout(o,0)}},e.cancelCorrelationIdQuery=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId",s=e.pendingLookups[n];s&&(e.pendingLookups[n]=s.filter((function(e){return e!=r})),0==e.pendingLookups[n].length&&delete e.pendingLookups[n])},e.generateRequestId=function(t){if(t){"."!==(t="|"==t[0]?t:"|"+t)[t.length-1]&&(t+=".");var r=(e.currentRootId++).toString(16);return e.appendSuffix(t,r,"_")}return e.generateRootId()},e.getRootId=function(e){var t=e.indexOf(".");t<0&&(t=e.length);var r="|"===e[0]?1:0;return e.substring(r,t)},e.generateRootId=function(){return"|"+r.w3cTraceId()+"."},e.appendSuffix=function(t,n,s){if(t.length+n.length<e.requestIdMaxLength)return t+n+s;var i=e.requestIdMaxLength-9;if(t.length>i)for(;i>1;--i){var o=t[i-1];if("."===o||"_"===o)break}if(i<=1)return e.generateRootId();for(n=r.randomu32().toString(16);n.length<8;)n="0"+n;return t.substring(0,i)+n+"#"},e.TAG="CorrelationIdManager",e.correlationIdPrefix="cid-v1:",e.w3cEnabled=!0,e.pendingLookups={},e.completedLookups={},e.requestIdMaxLength=1024,e.currentRootId=r.randomu32(),e}();t.exports=s})),tr=y(((e,t)=>{"use strict";var r=Zt(),n=er(),s=function(){function e(t,s){if(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&"string"==typeof t)if(t.split(",").length>1)this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16);else{var i=t.trim().split("-"),o=i.length;o>=4?(this.version=i[0],this.traceId=i[1],this.spanId=i[2],this.traceFlag=i[3]):(this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=e.DEFAULT_VERSION,this.traceId=r.w3cTraceId()),"00"===this.version&&4!==o&&(this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16)),"ff"===this.version&&(this.version=e.DEFAULT_VERSION,this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=e.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.traceId=r.w3cTraceId()),e.isValidTraceId(this.traceId)||(this.traceId=r.w3cTraceId()),e.isValidSpanId(this.spanId)||(this.spanId=r.w3cTraceId().substr(0,16),this.traceId=r.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(s){this.parentId=s.slice();var a=n.getRootId(s);e.isValidTraceId(a)||(this.legacyRootId=a,a=r.w3cTraceId()),-1!==s.indexOf("|")&&(s=s.substring(1+s.substring(0,s.length-1).lastIndexOf("."),s.length-1)),this.traceId=a,this.spanId=s}else this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16)}return e.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},e.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},e.formatOpenTelemetryTraceFlags=function(e){var t="0"+e.toString(16);return t.substring(t.length-2)},e.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.prototype.updateSpanId=function(){this.spanId=r.w3cTraceId().substr(0,16)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}();t.exports=s})),rr=y(((e,t)=>{"use strict";var r=function(){function e(e){this.fieldmap=[],e&&(this.fieldmap=this.parseHeader(e))}return e.prototype.toString=function(){var e=this.fieldmap;return e&&0!=e.length?e.join(", "):null},e.validateKeyChars=function(e){var t=e.split("@");if(2==t.length){var r=t[0].trim(),n=t[1].trim(),s=Boolean(r.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),i=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return s&&i}return 1==t.length&&Boolean(e.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/))},e.prototype.parseHeader=function(t){var r=[],n={},s=t.split(",");if(s.length>32)return null;for(var i=0,o=s;i<o.length;i++){var a=o[i].trim();if(0!==a.length){var c=a.split("=");if(2!==c.length||!e.validateKeyChars(c[0])||n[c[0]])return null;n[c[0]]=!0,r.push(a)}}return r},e.strict=!0,e}();t.exports=r})),nr=y(((e,t)=>{"use strict";t.exports=function(){}})),sr=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=s})),ir=y(((e,t)=>{"use strict";t.exports=function(){}})),or=y(((e,t)=>{"use strict";t.exports=function(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}})),ar=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){return e.call(this)||this}return n(t,e),t}(ir());t.exports=s})),cr=y(((e,t)=>{"use strict";var r,n;(n=r||(r={}))[n.Measurement=0]="Measurement",n[n.Aggregation=1]="Aggregation",t.exports=r})),lr=y(((e,t)=>{"use strict";var r=cr();t.exports=function(){this.kind=r.Measurement}})),ur=y(((e,t)=>{"use strict";t.exports=function(){this.ver=1,this.sampleRate=100,this.tags={}}})),hr=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=s})),dr=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=s})),pr=y(((e,t)=>{"use strict";t.exports=function(){this.hasFullStack=!0,this.parsedStack=[]}})),fr=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t}return n(t,e),t}(nr());t.exports=s})),gr=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t}return n(t,e),t}(nr());t.exports=s})),mr=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return n(t,e),t}(hr());t.exports=s})),yr=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=s})),vr=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=s})),wr=y(((e,t)=>{"use strict";var r,n;(n=r||(r={}))[n.Verbose=0]="Verbose",n[n.Information=1]="Information",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n[n.Critical=4]="Critical",t.exports=r})),Sr=y(((e,t)=>{"use strict";t.exports=function(){}})),br=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvailabilityData=sr(),e.Base=ir(),e.ContextTagKeys=or(),e.Data=ar(),e.DataPoint=lr(),e.DataPointType=cr(),e.Domain=nr(),e.Envelope=ur(),e.EventData=hr(),e.ExceptionData=dr(),e.ExceptionDetails=pr(),e.MessageData=fr(),e.MetricData=gr(),e.PageViewData=mr(),e.RemoteDependencyData=yr(),e.RequestData=vr(),e.SeverityLevel=wr(),e.StackFrame=Sr()})),_r=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.domainSupportsProperties=e.RemoteDependencyDataConstants=void 0;var t=br(),r=function(){function e(){}return e.TYPE_HTTP="Http",e.TYPE_AI="Http (tracked component)",e}();e.RemoteDependencyDataConstants=r,e.domainSupportsProperties=function(e){return"properties"in e||e instanceof t.EventData||e instanceof t.ExceptionData||e instanceof t.MessageData||e instanceof t.MetricData||e instanceof t.PageViewData||e instanceof t.RemoteDependencyData||e instanceof t.RequestData}})),Er=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Tr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Cr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Pr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Ar=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Rr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Ir=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),xr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Or=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),kr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Mr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Nr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Dr=y((e=>{"use strict";var t,r;Object.defineProperty(e,"__esModule",{value:!0}),e.TelemetryType=e.TelemetryTypeString=e.baseTypeToTelemetryType=e.telemetryTypeToBaseType=void 0,e.telemetryTypeToBaseType=function(e){switch(e){case t.Event:return"EventData";case t.Exception:return"ExceptionData";case t.Trace:return"MessageData";case t.Metric:return"MetricData";case t.Request:return"RequestData";case t.Dependency:return"RemoteDependencyData";case t.Availability:return"AvailabilityData";case t.PageView:return"PageViewData"}},e.baseTypeToTelemetryType=function(e){switch(e){case"EventData":return t.Event;case"ExceptionData":return t.Exception;case"MessageData":return t.Trace;case"MetricData":return t.Metric;case"RequestData":return t.Request;case"RemoteDependencyData":return t.Dependency;case"AvailabilityData":return t.Availability;case"PageViewData":return t.PageView}},e.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"},(r=t=e.TelemetryType||(e.TelemetryType={}))[r.Event=0]="Event",r[r.Exception=1]="Exception",r[r.Trace=2]="Trace",r[r.Metric=3]="Metric",r[r.Request=4]="Request",r[r.Dependency=5]="Dependency",r[r.Availability=6]="Availability",r[r.PageView=7]="PageView"})),Lr=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Er(),e),r(Tr(),e),r(Cr(),e),r(Pr(),e),r(Ar(),e),r(Rr(),e),r(Ir(),e),r(xr(),e),r(Or(),e),r(kr(),e),r(Mr(),e),r(Nr(),e),r(Dr(),e)})),Br=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),qr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),jr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Fr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Ur=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),$r=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Hr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Kr=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Vr=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Br(),e),r(qr(),e),r(jr(),e),r(Fr(),e),r(Ur(),e),r($r(),e),r(Hr(),e),r(Kr(),e)})),zr=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(_r(),e),r(br(),e),r(Lr(),e),r(Vr(),e)})),Wr=y(((e,t)=>{"use strict";var r=function(){function e(){}return e.prototype.getUrl=function(){return this.url},e.prototype.RequestParser=function(){this.startTime=+new Date},e.prototype._setStatus=function(e,t){var r=+new Date;this.duration=r-this.startTime,this.statusCode=e;var n=this.properties||{};if(t)if("string"==typeof t)n.error=t;else if(t instanceof Error)n.error=t.message;else if("object"==typeof t)for(var s in t)n[s]=t[s]&&t[s].toString&&t[s].toString();this.properties=n},e.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},e}();t.exports=r})),Gr=y(((e,t)=>{"use strict";var n,s=e&&e.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=r(7310),o=zr(),a=Zt(),c=Jt(),l=Wr(),u=er(),h=rr(),d=tr(),p=function(e){function t(t,r){var n=e.call(this)||this;return t&&(n.method=t.method,n.url=n._getAbsoluteUrl(t),n.startTime=+new Date,n.socketRemoteAddress=t.socket&&t.socket.remoteAddress,n.parseHeaders(t,r),t.connection&&(n.connectionRemoteAddress=t.connection.remoteAddress,n.legacySocketRemoteAddress=t.connection.socket&&t.connection.socket.remoteAddress)),n}return s(t,e),t.prototype.onError=function(e,t){this._setStatus(void 0,e),t&&(this.duration=t)},t.prototype.onResponse=function(e,t){this._setStatus(e.statusCode,void 0),t&&(this.duration=t)},t.prototype.getRequestTelemetry=function(e){var t={id:this.requestId,name:this.method+" "+i.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(e&&e.time?t.time=e.time:this.startTime&&(t.time=new Date(this.startTime)),e){for(var r in e)t[r]||(t[r]=e[r]);if(e.properties)for(var r in e.properties)t.properties[r]=e.properties[r]}return t},t.prototype.getRequestTags=function(e){var r={};for(var n in e)r[n]=e[n];return r[t.keys.locationIp]=e[t.keys.locationIp]||this._getIp(),r[t.keys.sessionId]=e[t.keys.sessionId]||this._getId("ai_session"),r[t.keys.userId]=e[t.keys.userId]||this._getId("ai_user"),r[t.keys.userAuthUserId]=e[t.keys.userAuthUserId]||this._getId("ai_authUser"),r[t.keys.operationName]=this.getOperationName(e),r[t.keys.operationParentId]=this.getOperationParentId(e),r[t.keys.operationId]=this.getOperationId(e),r},t.prototype.getOperationId=function(e){return e[t.keys.operationId]||this.operationId},t.prototype.getOperationParentId=function(e){return e[t.keys.operationParentId]||this.parentId||this.getOperationId(e)},t.prototype.getOperationName=function(e){return e[t.keys.operationName]||this.method+" "+i.parse(this.url).pathname},t.prototype.getRequestId=function(){return this.requestId},t.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},t.prototype.getTraceparent=function(){return this.traceparent},t.prototype.getTracestate=function(){return this.tracestate},t.prototype.getLegacyRootId=function(){return this.legacyRootId},t.prototype._getAbsoluteUrl=function(e){if(!e.headers)return e.url;var t=e.connection?e.connection.encrypted:null,r=i.parse(e.url),n=r.pathname,s=r.search,o=t||"https"==e.headers["x-forwarded-proto"]?"https":"http";return i.format({protocol:o,host:e.headers.host,pathname:n,search:s})},t.prototype._getIp=function(){var e=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,t=function(t){var r=e.exec(t);if(r)return r[0]},r=t(this.rawHeaders["x-forwarded-for"])||t(this.rawHeaders["x-client-ip"])||t(this.rawHeaders["x-real-ip"])||t(this.connectionRemoteAddress)||t(this.socketRemoteAddress)||t(this.legacySocketRemoteAddress);return!r&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&"::"===this.connectionRemoteAddress.substr(0,2)&&(r="127.0.0.1"),r},t.prototype._getId=function(e){var r=this.rawHeaders&&this.rawHeaders.cookie&&"string"==typeof this.rawHeaders.cookie&&this.rawHeaders.cookie||"";return t.parseId(a.getCookie(e,r))},t.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},t.prototype.parseHeaders=function(e,t){if(this.rawHeaders=e.headers||e.rawHeaders,this.userAgent=e.headers&&e.headers["user-agent"],this.sourceCorrelationId=a.getCorrelationContextTarget(e,c.requestContextSourceKey),e.headers){var r=e.headers[c.traceStateHeader]?e.headers[c.traceStateHeader].toString():null,n=e.headers[c.traceparentHeader]?e.headers[c.traceparentHeader].toString():null,s=e.headers[c.requestIdHeader]?e.headers[c.requestIdHeader].toString():null,i=e.headers[c.parentIdHeader]?e.headers[c.parentIdHeader].toString():null,o=e.headers[c.rootIdHeader]?e.headers[c.rootIdHeader].toString():null;this.correlationContextHeader=e.headers[c.correlationContextHeader]?e.headers[c.correlationContextHeader].toString():null,u.w3cEnabled&&(n||r)?(this.traceparent=new d(n?n.toString():null),this.tracestate=n&&r&&new h(r?r.toString():null),this.setBackCompatFromThisTraceContext()):s?u.w3cEnabled?(this.traceparent=new d(null,s),this.setBackCompatFromThisTraceContext()):(this.parentId=s,this.requestId=u.generateRequestId(this.parentId),this.operationId=u.getRootId(this.requestId)):u.w3cEnabled?(this.traceparent=new d,this.traceparent.parentId=i,this.traceparent.legacyRootId=o||i,this.setBackCompatFromThisTraceContext()):(this.parentId=i,this.requestId=u.generateRequestId(o||this.parentId),this.correlationContextHeader=null,this.operationId=u.getRootId(this.requestId)),t&&(this.requestId=t,this.operationId=u.getRootId(this.requestId))}},t.parseId=function(e){var t=e.split("|");return t.length>0?t[0]:""},t.keys=new o.ContextTagKeys,t}(l);t.exports=p})),Yr=y(((e,t)=>{var r;e=t.exports=z,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,s=e.re=[],i=e.src=[],o=0,a=o++;i[a]="0|[1-9]\\d*";var c=o++;i[c]="[0-9]+";var l=o++;i[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var u=o++;i[u]="("+i[a]+")\\.("+i[a]+")\\.("+i[a]+")";var h=o++;i[h]="("+i[c]+")\\.("+i[c]+")\\.("+i[c]+")";var d=o++;i[d]="(?:"+i[a]+"|"+i[l]+")";var p=o++;i[p]="(?:"+i[c]+"|"+i[l]+")";var f=o++;i[f]="(?:-("+i[d]+"(?:\\."+i[d]+")*))";var g=o++;i[g]="(?:-?("+i[p]+"(?:\\."+i[p]+")*))";var m=o++;i[m]="[0-9A-Za-z-]+";var y=o++;i[y]="(?:\\+("+i[m]+"(?:\\."+i[m]+")*))";var v=o++,w="v?"+i[u]+i[f]+"?"+i[y]+"?";i[v]="^"+w+"$";var S="[v=\\s]*"+i[h]+i[g]+"?"+i[y]+"?",b=o++;i[b]="^"+S+"$";var _=o++;i[_]="((?:<|>)?=?)";var E=o++;i[E]=i[c]+"|x|X|\\*";var T=o++;i[T]=i[a]+"|x|X|\\*";var C=o++;i[C]="[v=\\s]*("+i[T]+")(?:\\.("+i[T]+")(?:\\.("+i[T]+")(?:"+i[f]+")?"+i[y]+"?)?)?";var P=o++;i[P]="[v=\\s]*("+i[E]+")(?:\\.("+i[E]+")(?:\\.("+i[E]+")(?:"+i[g]+")?"+i[y]+"?)?)?";var A=o++;i[A]="^"+i[_]+"\\s*"+i[C]+"$";var R=o++;i[R]="^"+i[_]+"\\s*"+i[P]+"$";var I=o++;i[I]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var x=o++;i[x]="(?:~>?)";var O=o++;i[O]="(\\s*)"+i[x]+"\\s+",s[O]=new RegExp(i[O],"g");var k=o++;i[k]="^"+i[x]+i[C]+"$";var M=o++;i[M]="^"+i[x]+i[P]+"$";var N=o++;i[N]="(?:\\^)";var D=o++;i[D]="(\\s*)"+i[N]+"\\s+",s[D]=new RegExp(i[D],"g");var L=o++;i[L]="^"+i[N]+i[C]+"$";var B=o++;i[B]="^"+i[N]+i[P]+"$";var q=o++;i[q]="^"+i[_]+"\\s*("+S+")$|^$";var j=o++;i[j]="^"+i[_]+"\\s*("+w+")$|^$";var F=o++;i[F]="(\\s*)"+i[_]+"\\s*("+S+"|"+i[C]+")",s[F]=new RegExp(i[F],"g");var U=o++;i[U]="^\\s*("+i[C]+")\\s+-\\s+("+i[C]+")\\s*$";var $=o++;i[$]="^\\s*("+i[P]+")\\s+-\\s+("+i[P]+")\\s*$";var H,K=o++;for(i[K]="(<|>)?=?\\s*\\*",H=0;H<35;H++)r(H,i[H]),s[H]||(s[H]=new RegExp(i[H]));function V(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof z)return e;if("string"!=typeof e||e.length>256)return null;if(!(t.loose?s[b]:s[v]).test(e))return null;try{return new z(e,t)}catch{return null}}function z(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof z){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof z))return new z(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var i=e.trim().match(t.loose?s[b]:s[v]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}e.parse=V,e.valid=function(e,t){var r=V(e,t);return r?r.version:null},e.clean=function(e,t){var r=V(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},e.SemVer=z,z.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},z.prototype.toString=function(){return this.version},z.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof z||(e=new z(e,this.options)),this.compareMain(e)||this.comparePre(e)},z.prototype.compareMain=function(e){return e instanceof z||(e=new z(e,this.options)),G(this.major,e.major)||G(this.minor,e.minor)||G(this.patch,e.patch)},z.prototype.comparePre=function(e){if(e instanceof z||(e=new z(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],s=e.prerelease[t];if(r("prerelease compare",t,n,s),void 0===n&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===n)return-1;if(n!==s)return G(n,s)}while(++t)},z.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},e.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new z(e,r).inc(t,n).version}catch{return null}},e.diff=function(e,t){if(J(e,t))return null;var r=V(e),n=V(t),s="";if(r.prerelease.length||n.prerelease.length){s="pre";var i="prerelease"}for(var o in r)if(("major"===o||"minor"===o||"patch"===o)&&r[o]!==n[o])return s+o;return i},e.compareIdentifiers=G;var W=/^[0-9]+$/;function G(e,t){var r=W.test(e),n=W.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function Y(e,t,r){return new z(e,r).compare(new z(t,r))}function Q(e,t,r){return Y(e,t,r)>0}function X(e,t,r){return Y(e,t,r)<0}function J(e,t,r){return 0===Y(e,t,r)}function Z(e,t,r){return 0!==Y(e,t,r)}function ee(e,t,r){return Y(e,t,r)>=0}function te(e,t,r){return Y(e,t,r)<=0}function re(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return J(e,r,n);case"!=":return Z(e,r,n);case">":return Q(e,r,n);case">=":return ee(e,r,n);case"<":return X(e,r,n);case"<=":return te(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ne(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof ne){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ne))return new ne(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===se?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}e.rcompareIdentifiers=function(e,t){return G(t,e)},e.major=function(e,t){return new z(e,t).major},e.minor=function(e,t){return new z(e,t).minor},e.patch=function(e,t){return new z(e,t).patch},e.compare=Y,e.compareLoose=function(e,t){return Y(e,t,!0)},e.rcompare=function(e,t,r){return Y(t,e,r)},e.sort=function(t,r){return t.sort((function(t,n){return e.compare(t,n,r)}))},e.rsort=function(t,r){return t.sort((function(t,n){return e.rcompare(t,n,r)}))},e.gt=Q,e.lt=X,e.eq=J,e.neq=Z,e.gte=ee,e.lte=te,e.cmp=re,e.Comparator=ne;var se={};function ie(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof ie)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new ie(e.raw,t);if(e instanceof ne)return new ie(e.value,t);if(!(this instanceof ie))return new ie(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function oe(e){return!e||"x"===e.toLowerCase()||"*"===e}function ae(e,t,r,n,s,i,o,a,c,l,u,h,d){return((t=oe(r)?"":oe(n)?">="+r+".0.0":oe(s)?">="+r+"."+n+".0":">="+t)+" "+(a=oe(c)?"":oe(l)?"<"+(+c+1)+".0.0":oe(u)?"<"+c+"."+(+l+1)+".0":h?"<="+c+"."+l+"."+u+"-"+h:"<="+a)).trim()}function ce(e,t,n){for(var s=0;s<e.length;s++)if(!e[s].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(s=0;s<e.length;s++)if(r(e[s].semver),e[s].semver!==se&&e[s].semver.prerelease.length>0){var i=e[s].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new ie(t,r)}catch{return!1}return t.test(e)}function ue(e,t,r,n){var s,i,o,a,c;switch(e=new z(e,n),t=new ie(t,n),r){case">":s=Q,i=te,o=X,a=">",c=">=";break;case"<":s=X,i=ee,o=Q,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],h=null,d=null;if(u.forEach((function(e){e.semver===se&&(e=new ne(">=0.0.0")),h=h||e,d=d||e,s(e.semver,h.semver,n)?h=e:o(e.semver,d.semver,n)&&(d=e)})),h.operator===a||h.operator===c||(!d.operator||d.operator===a)&&i(e,d.semver))return!1;if(d.operator===c&&o(e,d.semver))return!1}return!0}ne.prototype.parse=function(e){var t=this.options.loose?s[q]:s[j],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new z(r[2],this.options.loose):this.semver=se},ne.prototype.toString=function(){return this.value},ne.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===se||("string"==typeof e&&(e=new z(e,this.options)),re(e,this.operator,this.semver,this.options))},ne.prototype.intersects=function(e,t){if(!(e instanceof ne))throw new TypeError("a Comparator is required");var r;if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new ie(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new ie(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),s=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||s||i&&o||a||c},e.Range=ie,ie.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},ie.prototype.toString=function(){return this.range},ie.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?s[$]:s[U];e=e.replace(n,ae),r("hyphen replace",e),e=e.replace(s[F],"$1$2$3"),r("comparator trim",e,s[F]),e=(e=(e=e.replace(s[O],"$1~")).replace(s[D],"$1^")).split(/\s+/).join(" ");var i=t?s[q]:s[j],o=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?s[B]:s[L];return e.replace(n,(function(t,n,s,i,o){var a;return r("caret",e,t,n,s,i,o),oe(n)?a="":oe(s)?a=">="+n+".0.0 <"+(+n+1)+".0.0":oe(i)?a="0"===n?">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0":">="+n+"."+s+".0 <"+(+n+1)+".0.0":o?(r("replaceCaret pr",o),a="0"===n?"0"===s?">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+s+"."+(+i+1):">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+(+s+1)+".0":">="+n+"."+s+"."+i+"-"+o+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===s?">="+n+"."+s+"."+i+" <"+n+"."+s+"."+(+i+1):">="+n+"."+s+"."+i+" <"+n+"."+(+s+1)+".0":">="+n+"."+s+"."+i+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?s[M]:s[k];return e.replace(n,(function(t,n,s,i,o){var a;return r("tilde",e,t,n,s,i,o),oe(n)?a="":oe(s)?a=">="+n+".0.0 <"+(+n+1)+".0.0":oe(i)?a=">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0":o?(r("replaceTilde pr",o),a=">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+(+s+1)+".0"):a=">="+n+"."+s+"."+i+" <"+n+"."+(+s+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?s[R]:s[A];return e.replace(n,(function(t,n,s,i,o,a){r("xRange",e,t,n,s,i,o,a);var c=oe(s),l=c||oe(i),u=l||oe(o);return"="===n&&u&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&u?(l&&(i=0),o=0,">"===n?(n=">=",l?(s=+s+1,i=0,o=0):(i=+i+1,o=0)):"<="===n&&(n="<",l?s=+s+1:i=+i+1),t=n+s+"."+i+"."+o):l?t=">="+s+".0.0 <"+(+s+1)+".0.0":u&&(t=">="+s+"."+i+".0 <"+s+"."+(+i+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(s[K],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter((function(e){return!!e.match(i)}))),o.map((function(e){return new ne(e,this.options)}),this)},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},e.toComparators=function(e,t){return new ie(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},ie.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new z(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},e.satisfies=le,e.maxSatisfying=function(e,t,r){var n=null,s=null;try{var i=new ie(t,r)}catch{return null}return e.forEach((function(e){i.test(e)&&(!n||-1===s.compare(e))&&(s=new z(n=e,r))})),n},e.minSatisfying=function(e,t,r){var n=null,s=null;try{var i=new ie(t,r)}catch{return null}return e.forEach((function(e){i.test(e)&&(!n||1===s.compare(e))&&(s=new z(n=e,r))})),n},e.minVersion=function(e,t){e=new ie(e,t);var r=new z("0.0.0");if(e.test(r)||(r=new z("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n)e.set[n].forEach((function(e){var t=new z(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":(!r||Q(r,t))&&(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return r&&e.test(r)?r:null},e.validRange=function(e,t){try{return new ie(e,t).range||"*"}catch{return null}},e.ltr=function(e,t,r){return ue(e,t,"<",r)},e.gtr=function(e,t,r){return ue(e,t,">",r)},e.outside=ue,e.prerelease=function(e,t){var r=V(e,t);return r&&r.prerelease.length?r.prerelease:null},e.intersects=function(e,t,r){return e=new ie(e,r),t=new ie(t,r),e.intersects(t)},e.coerce=function(e){if(e instanceof z)return e;if("string"!=typeof e)return null;var t=e.match(s[I]);return null==t?null:V(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}})),Qr=y(((e,t)=>{"use strict";function r(e){return"function"==typeof e}var n=console.error.bind(console);function s(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function i(e){e&&e.logger&&(r(e.logger)?n=e.logger:n("new logger isn't a function, not replacing"))}function o(e,t,i){if(e&&e[t]){if(!i)return n("no wrapper function"),void n((new Error).stack);if(r(e[t])&&r(i)){var o=e[t],a=i(o,t);return s(a,"__original",o),s(a,"__unwrap",(function(){e[t]===a&&s(e,t,o)})),s(a,"__wrapped",!0),s(e,t,a),a}n("original object and wrapper must be functions")}else n("no original function "+t+" to wrap")}function a(e,t){return e&&e[t]?e[t].__unwrap?e[t].__unwrap():void n("no original to unwrap to -- has "+t+" already been unwrapped?"):(n("no function to unwrap."),void n((new Error).stack))}i.wrap=o,i.massWrap=function(e,t,r){if(!e)return n("must provide one or more modules to patch"),void n((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach((function(e){t.forEach((function(t){o(e,t,r)}))})):n("must provide one or more functions to wrap on modules")},i.unwrap=a,i.massUnwrap=function(e,t){if(!e)return n("must provide one or more modules to patch"),void n((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach((function(e){t.forEach((function(t){a(e,t)}))})):n("must provide one or more functions to unwrap on modules")},t.exports=i})),Xr=y(((e,t)=>{"use strict";var r=Qr(),n=r.wrap,s=r.unwrap,i="wrap@before";function o(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function a(e,t){var r;return r=e._events&&e._events[t],Array.isArray(r)||(r=r?[r]:[]),r}function c(e,t){if(e){var r=e;if("function"==typeof e)r=t(e);else if(Array.isArray(e)){r=[];for(var n=0;n<e.length;n++)r[n]=t(e[n])}return r}}t.exports=function(e,t,r){if(!(e&&e.on&&e.addListener&&e.removeListener&&e.emit))throw new Error("can only wrap real EEs");if(!t)throw new Error("must have function to run on listener addition");if(!r)throw new Error("must have function to wrap listeners when emitting");function l(e){return function(t,r){var s=a(this,t).slice();try{var o=e.call(this,t,r);return function(e,t,r){var n=a(e,t).filter((function(e){return-1===r.indexOf(e)}));n.length>0&&function(e,t){for(var r=t.length,n=0;n<r;n++){var s=t[n],o=e[i];if("function"==typeof o)o(s);else if(Array.isArray(o))for(var a=o.length,c=0;c<a;c++)o[c](s)}}(e,n)}(this,t,s),o}finally{this.on.__wrapped||n(this,"on",l),this.addListener.__wrapped||n(this,"addListener",l)}}}e[i]?"function"==typeof e[i]?o(e,i,[e[i],t]):Array.isArray(e[i])&&e[i].push(t):o(e,i,t),e.__wrapped||(n(e,"addListener",l),n(e,"on",l),n(e,"emit",(function(e){return function(t){if(!this._events||!this._events[t])return e.apply(this,arguments);var i=this._events[t];function o(e){return function(){this._events[t]=i;try{return e.apply(this,arguments)}finally{i=this._events[t],this._events[t]=c(i,r)}}}n(this,"removeListener",o);try{return this._events[t]=c(i,r),e.apply(this,arguments)}finally{s(this,"removeListener"),this._events[t]=i}}})),o(e,"__unwrap",(function(){s(e,"addListener"),s(e,"on"),s(e,"emit"),delete e[i],delete e.__wrapped})),o(e,"__wrapped",!0))}})),Jr=y(((e,t)=>{"use strict";var n=r(3837),s=r(9491),i=Xr(),o=r(852),a="cls@contexts",c="error@context",l=process.env.DEBUG_CLS_HOOKED,u=-1;function h(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}function d(e){return process.namespaces[e]}function p(e){let t=d(e);s.ok(t,"can't delete nonexistent namespace! \""+e+'"'),s.ok(t.id,"don't assign to process.namespaces directly! "+n.inspect(t)),process.namespaces[e]=null}function f(...e){l&&process._rawDebug(`${n.format(...e)}`)}t.exports={getNamespace:d,createNamespace:function(e){s.ok(e,"namespace must be given a name."),l&&f(`NS-CREATING NAMESPACE (${e})`);let t=new h(e);return t.id=u,o.createHook({init(r,s,i,a){if(u=o.executionAsyncId(),t.active)t._contexts.set(r,t.active),l&&f(`${" ".repeat(t._indent<0?0:t._indent)}INIT [${s}] (${e}) asyncId:${r} currentUid:${u} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`);else if(0===u){let i=o.triggerAsyncId(),c=t._contexts.get(i);c?(t._contexts.set(r,c),l&&f(`${" ".repeat(t._indent<0?0:t._indent)}INIT USING CONTEXT FROM TRIGGERID [${s}] (${e}) asyncId:${r} currentUid:${u} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)):l&&f(`${" ".repeat(t._indent<0?0:t._indent)}INIT MISSING CONTEXT [${s}] (${e}) asyncId:${r} currentUid:${u} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}if(l&&"PROMISE"===s){f(n.inspect(a,{showHidden:!0}));let o=a.parentId;f(`${" ".repeat(t._indent<0?0:t._indent)}INIT RESOURCE-PROMISE [${s}] (${e}) parentId:${o} asyncId:${r} currentUid:${u} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(r){let s;if(u=o.executionAsyncId(),s=t._contexts.get(r)||t._contexts.get(u),s){if(l){let i=o.triggerAsyncId();f(`${" ".repeat(t._indent<0?0:t._indent)}BEFORE (${e}) asyncId:${r} currentUid:${u} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${n.inspect(s)}`),t._indent+=2}t.enter(s)}else if(l){let s=o.triggerAsyncId();f(`${" ".repeat(t._indent<0?0:t._indent)}BEFORE MISSING CONTEXT (${e}) asyncId:${r} currentUid:${u} triggerId:${s} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${n.inspect(t._contexts,{showHidden:!0,depth:2,colors:!0})}`),t._indent+=2}},after(r){let s;if(u=o.executionAsyncId(),s=t._contexts.get(r)||t._contexts.get(u),s){if(l){let i=o.triggerAsyncId();t._indent-=2,f(`${" ".repeat(t._indent<0?0:t._indent)}AFTER (${e}) asyncId:${r} currentUid:${u} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${n.inspect(s)}`)}t.exit(s)}else if(l){let i=o.triggerAsyncId();t._indent-=2,f(`${" ".repeat(t._indent<0?0:t._indent)}AFTER MISSING CONTEXT (${e}) asyncId:${r} currentUid:${u} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${n.inspect(s)}`)}},destroy(r){if(u=o.executionAsyncId(),l){let s=o.triggerAsyncId();f(`${" ".repeat(t._indent<0?0:t._indent)}DESTROY (${e}) currentUid:${u} asyncId:${r} triggerId:${s} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${n.inspect(t._contexts.get(u))}`)}t._contexts.delete(r)}}).enable(),process.namespaces[e]=t,t},destroyNamespace:p,reset:function(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){p(e)})),process.namespaces=Object.create(null)},ERROR_SYMBOL:c},h.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,l&&f(" ".repeat(this._indent<0?0:this._indent)+"CONTEXT-SET KEY:"+e+"="+t+" in ns:"+this.name+" currentUid:"+u+" active:"+n.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),t},h.prototype.get=function(e){if(this.active){if(l){let t=o.executionAsyncId(),r=o.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);f(s+"CONTEXT-GETTING KEY:"+e+"="+this.active[e]+" ("+this.name+") currentUid:"+u+" active:"+n.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),f(`${s}CONTEXT-GETTING KEY: (${this.name}) ${e}=${this.active[e]} currentUid:${u} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length} active:${n.inspect(this.active)}`)}return this.active[e]}if(l){let t=o.currentId(),r=o.triggerAsyncId();f(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${e}=undefined currentUid:${u} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length}`)}},h.prototype.createContext=function(){let e=Object.create(this.active?this.active:Object.prototype);if(e._ns_name=this.name,e.id=u,l){let t=o.executionAsyncId(),r=o.triggerAsyncId();f(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-CREATED Context: (${this.name}) currentUid:${u} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length} context:${n.inspect(e,{showHidden:!0,depth:2,colors:!0})}`)}return e},h.prototype.run=function(e){let t=this.createContext();this.enter(t);try{if(l){let e=o.triggerAsyncId(),r=o.executionAsyncId();f(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${u} triggerId:${e} asyncHooksCurrentId:${r} len:${this._set.length} context:${n.inspect(t)}`)}return e(t),t}catch(e){throw e&&(e[c]=t),e}finally{if(l){let e=o.triggerAsyncId(),r=o.executionAsyncId();f(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-RUN END: (${this.name}) currentUid:${u} triggerId:${e} asyncHooksCurrentId:${r} len:${this._set.length} ${n.inspect(t)}`)}this.exit(t)}},h.prototype.runAndReturn=function(e){let t;return this.run((function(r){t=e(r)})),t},h.prototype.runPromise=function(e){let t=this.createContext();this.enter(t);let r=e(t);if(!r||!r.then||!r.catch)throw new Error("fn must return a promise.");return l&&f("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+u+" len:"+this._set.length+" "+n.inspect(t)),r.then((e=>(l&&f("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+u+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e))).catch((e=>{throw e[c]=t,l&&f("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+u+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e}))},h.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());let r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e[c]=t),e}finally{r.exit(t)}}},h.prototype.enter=function(e){if(s.ok(e,"context must be provided for entering"),l){let t=o.executionAsyncId(),r=o.triggerAsyncId();f(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-ENTER: (${this.name}) currentUid:${u} triggerId:${r} asyncHooksCurrentId:${t} len:${this._set.length} ${n.inspect(e)}`)}this._set.push(this.active),this.active=e},h.prototype.exit=function(e){if(s.ok(e,"context must be provided for exiting"),l){let t=o.executionAsyncId(),r=o.triggerAsyncId();f(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-EXIT: (${this.name}) currentUid:${u} triggerId:${r} asyncHooksCurrentId:${t} len:${this._set.length} ${n.inspect(e)}`)}if(this.active===e)return s.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());let t=this._set.lastIndexOf(e);t<0?(l&&f("??ERROR?? context exiting but not entered - ignoring: "+n.inspect(e)),s.ok(t>=0,"context not currently entered; can't exit. \n"+n.inspect(this)+"\n"+n.inspect(e))):(s.ok(t,"can't remove top context"),this._set.splice(t,1))},h.prototype.bindEmitter=function(e){s.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let t=this,r="context@"+this.name;i(e,(function(e){!e||(e[a]||(e[a]=Object.create(null)),e[a][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e[a])return e;let t=e,r=e[a];return Object.keys(r).forEach((function(e){let n=r[e];t=n.namespace.bind(t,n.context)})),t}))},h.prototype.fromException=function(e){return e[c]},process.namespaces={}})),Zr=y(((e,t)=>{"use strict";function r(){}t.exports=function(){let e=this._hooks,t=this._state,n=process.nextTick;process.nextTick=function(){if(!t.enabled)return n.apply(process,arguments);let s=new Array(arguments.length);for(let e=0;e<arguments.length;e++)s[e]=arguments[e];let i=s[0];if("function"!=typeof i)throw new TypeError("callback is not a function");let o=new r,a=--t.counter;return e.init.call(o,a,0,null,null),s[0]=function(){e.pre.call(o,a);let t=!0;try{i.apply(this,arguments),t=!1}finally{t&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",(function(){e.post.call(o,a,!0),e.destroy.call(null,a)}))}e.post.call(o,a,!1),e.destroy.call(null,a)},n.apply(process,s)}}})),en=y(((e,t)=>{"use strict";function r(){}t.exports=function(){let e=this._hooks,t=this._state,n=global.Promise,s=n.prototype.then;function i(t,r,n,s){return"function"!=typeof t?s?function(t){return function(r){return e.destroy.call(null,t),r}}(n):function(t){return function(r){throw e.destroy.call(null,t),r}}(n):function(){e.pre.call(r,n);try{return t.apply(this,arguments)}finally{e.post.call(r,n,!1),e.destroy.call(null,n)}}}n.prototype.then=function(n,o){if(!t.enabled)return s.call(this,n,o);let a=new r,c=--t.counter;return e.init.call(a,c,0,null,null),s.call(this,i(n,a,c,!0),i(o,a,c,!1))}}})),tn=y(((e,t)=>{"use strict";var n=r(9512);function s(){}function i(){}function o(){}var a=new Map,c=new Map,l=new Map,u=null,h=!1;function d(e,t,r,s,i,o,a){let c=n[r],l=n[s];n[r]=function(){if(!t.enabled)return c.apply(n,arguments);let r=new Array(arguments.length);for(let e=0;e<arguments.length;e++)r[e]=arguments[e];let s=r[0];if("function"!=typeof s)throw new TypeError('"callback" argument must be a function');let l,d=new i,p=--t.counter;return e.init.call(d,p,0,null,null),r[0]=function(){u=l,e.pre.call(d,p);let t=!0;try{s.apply(this,arguments),t=!1}finally{t&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",(function(){e.post.call(d,p,!0),o.delete(l),e.destroy.call(null,p)}))}e.post.call(d,p,!1),u=null,(a||h)&&(h=!1,o.delete(l),e.destroy.call(null,p))},l=c.apply(n,r),o.set(l,p),l},n[s]=function(t){if(u===t&&null!==t)h=!0;else if(o.has(t)){let r=o.get(t);o.delete(t),e.destroy.call(null,r)}l.apply(n,arguments)}}t.exports=function(){d(this._hooks,this._state,"setTimeout","clearTimeout",s,a,!0),d(this._hooks,this._state,"setInterval","clearInterval",i,c,!1),d(this._hooks,this._state,"setImmediate","clearImmediate",o,l,!0),global.setTimeout=n.setTimeout,global.setInterval=n.setInterval,global.setImmediate=n.setImmediate,global.clearTimeout=n.clearTimeout,global.clearInterval=n.clearInterval,global.clearImmediate=n.clearImmediate}})),rn=y(((e,t)=>{t.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}})),nn=y(((e,t)=>{"use strict";var r=process.binding("async_wrap"),n=r.Providers.TIMERWRAP,s={nextTick:Zr(),promise:en(),timers:tn()},i=new Set;function o(){this.enabled=!1,this.counter=0}function a(){let e=this.initFns=[],t=this.preFns=[],r=this.postFns=[],s=this.destroyFns=[];this.init=function(t,r,s,o){if(r!==n)for(let n of e)n(t,this,r,s,o);else i.add(t)},this.pre=function(e){if(!i.has(e))for(let r of t)r(e,this)},this.post=function(e,t){if(!i.has(e))for(let n of r)n(e,this,t)},this.destroy=function(e){if(i.has(e))i.delete(e);else for(let t of s)t(e)}}function c(e,t){let r=e.indexOf(t);-1!==r&&e.splice(r,1)}function l(){this._state=new o,this._hooks=new a,this.version=rn().version,this.providers=r.Providers;for(let e of Object.keys(s))s[e].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),r.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}a.prototype.add=function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)},a.prototype.remove=function(e){e.init&&c(this.initFns,e.init),e.pre&&c(this.preFns,e.pre),e.post&&c(this.postFns,e.post),e.destroy&&c(this.destroyFns,e.destroy)},t.exports=l,l.prototype.addHooks=function(e){this._hooks.add(e)},l.prototype.removeHooks=function(e){this._hooks.remove(e)},l.prototype.enable=function(){this._state.enabled=!0,r.enable()},l.prototype.disable=function(){this._state.enabled=!1,r.disable()}})),sn=y(((e,t)=>{t.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}})),on=y(((e,t)=>{t.exports=function(e,t){var r=[];r.push(function(e){try{return Error.prototype.toString.call(e)}catch(e){try{return"<error: "+e+">"}catch{return"<error>"}}}(e));for(var n=0;n<t.length;n++){var s,i=t[n];try{s=i.toString()}catch(e){try{s="<error: "+e+">"}catch{s="<error>"}}r.push("    at "+s)}return r.join("\n")}})),an=y(((e,t)=>{var r=on();function n(){this.extend=new o,this.filter=new o,this.format=new a,this.version=sn().version}var s=!1;n.prototype.callSite=function e(t){t||(t={}),s=!0;var r={};Error.captureStackTrace(r,e);var n=r.stack;return s=!1,n=n.slice(t.slice||0),t.extend&&(n=this.extend._modify(r,n)),t.filter&&(n=this.filter._modify(r,n)),n};var i=new n;function o(){this._modifiers=[]}function a(){this._formater=r,this._previous=void 0}o.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;r<n;r++)t=this._modifiers[r](e,t);return t},o.prototype.attach=function(e){this._modifiers.push(e)},o.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return-1!==t&&(this._modifiers.splice(t,1),!0)},a.prototype.replace=function(e){e?this._formater=e:this.restore()},a.prototype.restore=function(){this._formater=r,this._previous=void 0},a.prototype._backup=function(){this._previous=this._formater},a.prototype._roolback=function(){this._previous===r?this.replace(void 0):this.replace(this._previous),this._previous=void 0},Error.prepareStackTrace&&i.format.replace(Error.prepareStackTrace);var c=!1;function l(e,t){if(s)return t;if(c)return r(e,t);var n=t.concat();n=i.extend._modify(e,n),n=(n=i.filter._modify(e,n)).slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&void 0===Object.getOwnPropertyDescriptor(e,"callSite")&&(e.callSite={original:t,mutated:n}),c=!0;var o=i.format._formater(e,n);return c=!1,o}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return l},set:function(e){e===l?i.format._roolback():(i.format._backup(),i.format.replace(e))}}),Object.defineProperty(Error.prototype,"callSite",{get:function(){return this.stack,this.callSite},set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0}),t.exports=i})),cn=y(((e,t)=>{if(global._stackChain){if(global._stackChain.version!==sn().version)throw new Error("Conflicting version of stack-chain found");t.exports=global._stackChain}else t.exports=global._stackChain=an()})),ln=y(((e,t)=>{"use strict";var r=nn();if(global._asyncHook){if(global._asyncHook.version!==rn().version)throw new Error("Conflicting version of async-hook-jl found");t.exports=global._asyncHook}else cn().filter.attach((function(e,t){return t.filter((function(e){let t=e.getFileName();return!(t&&t.slice(0,__dirname.length)===__dirname)}))})),t.exports=global._asyncHook=new r})),un=y(((e,t)=>{"use strict";var n=r(3837),s=r(9491),i=Xr(),o=ln(),a="cls@contexts",c="error@context",l=[];for(let e in o.providers)l[o.providers[e]]=e;var u,h,d=process.env.DEBUG_CLS_HOOKED,p=-1;function f(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map}function g(e){return process.namespaces[e]}function m(e){let t=g(e);s.ok(t,"can't delete nonexistent namespace! \""+e+'"'),s.ok(t.id,"don't assign to process.namespaces directly! "+n.inspect(t)),process.namespaces[e]=null}function y(e){process.env.DEBUG&&process._rawDebug(e)}function v(e){return e?"function"==typeof e?e.name?e.name:(e.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1]:e.constructor&&e.constructor.name?e.constructor.name:void 0:e}if(t.exports={getNamespace:g,createNamespace:function(e){s.ok(e,"namespace must be given a name."),d&&y("CREATING NAMESPACE "+e);let t=new f(e);return t.id=p,o.addHooks({init(r,s,i,o,a){p=r,o?(t._contexts.set(r,t._contexts.get(o)),d&&y("PARENTID: "+e+" uid:"+r+" parent:"+o+" provider:"+i)):t._contexts.set(p,t.active),d&&y("INIT "+e+" uid:"+r+" parent:"+o+" provider:"+l[i]+" active:"+n.inspect(t.active,!0))},pre(r,s){p=r;let i=t._contexts.get(r);i?(d&&y(" PRE "+e+" uid:"+r+" handle:"+v(s)+" context:"+n.inspect(i)),t.enter(i)):d&&y(" PRE MISSING CONTEXT "+e+" uid:"+r+" handle:"+v(s))},post(r,s){p=r;let i=t._contexts.get(r);i?(d&&y(" POST "+e+" uid:"+r+" handle:"+v(s)+" context:"+n.inspect(i)),t.exit(i)):d&&y(" POST MISSING CONTEXT "+e+" uid:"+r+" handle:"+v(s))},destroy(r){p=r,d&&y("DESTROY "+e+" uid:"+r+" context:"+n.inspect(t._contexts.get(p))+" active:"+n.inspect(t.active,!0)),t._contexts.delete(r)}}),process.namespaces[e]=t,t},destroyNamespace:m,reset:function(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){m(e)})),process.namespaces=Object.create(null)},ERROR_SYMBOL:c},f.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return d&&y("    SETTING KEY:"+e+"="+t+" in ns:"+this.name+" uid:"+p+" active:"+n.inspect(this.active,!0)),this.active[e]=t,t},f.prototype.get=function(e){if(this.active)return d&&y("    GETTING KEY:"+e+"="+this.active[e]+" "+this.name+" uid:"+p+" active:"+n.inspect(this.active,!0)),this.active[e];d&&y("    GETTING KEY:"+e+"=undefined "+this.name+" uid:"+p+" active:"+n.inspect(this.active,!0))},f.prototype.createContext=function(){d&&y("   CREATING Context: "+this.name+" uid:"+p+" len:"+this._set.length+"  active:"+n.inspect(this.active,!0,2,!0));let e=Object.create(this.active?this.active:Object.prototype);return e._ns_name=this.name,e.id=p,d&&y("   CREATED Context: "+this.name+" uid:"+p+" len:"+this._set.length+"  context:"+n.inspect(e,!0,2,!0)),e},f.prototype.run=function(e){let t=this.createContext();this.enter(t);try{return d&&y(" BEFORE RUN: "+this.name+" uid:"+p+" len:"+this._set.length+" "+n.inspect(t)),e(t),t}catch(e){throw e&&(e[c]=t),e}finally{d&&y(" AFTER RUN: "+this.name+" uid:"+p+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t)}},f.prototype.runAndReturn=function(e){var t;return this.run((function(r){t=e(r)})),t},f.prototype.runPromise=function(e){let t=this.createContext();this.enter(t);let r=e(t);if(!r||!r.then||!r.catch)throw new Error("fn must return a promise.");return d&&y(" BEFORE runPromise: "+this.name+" uid:"+p+" len:"+this._set.length+" "+n.inspect(t)),r.then((e=>(d&&y(" AFTER runPromise: "+this.name+" uid:"+p+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e))).catch((e=>{throw e[c]=t,d&&y(" AFTER runPromise: "+this.name+" uid:"+p+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e}))},f.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());let r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e[c]=t),e}finally{r.exit(t)}}},f.prototype.enter=function(e){s.ok(e,"context must be provided for entering"),d&&y("  ENTER "+this.name+" uid:"+p+" len:"+this._set.length+" context: "+n.inspect(e)),this._set.push(this.active),this.active=e},f.prototype.exit=function(e){if(s.ok(e,"context must be provided for exiting"),d&&y("  EXIT "+this.name+" uid:"+p+" len:"+this._set.length+" context: "+n.inspect(e)),this.active===e)return s.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());let t=this._set.lastIndexOf(e);t<0?(d&&y("??ERROR?? context exiting but not entered - ignoring: "+n.inspect(e)),s.ok(t>=0,"context not currently entered; can't exit. \n"+n.inspect(this)+"\n"+n.inspect(e))):(s.ok(t,"can't remove top context"),this._set.splice(t,1))},f.prototype.bindEmitter=function(e){s.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let t=this,r="context@"+this.name;i(e,(function(e){!e||(e[a]||(e[a]=Object.create(null)),e[a][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e[a])return e;let t=e,r=e[a];return Object.keys(r).forEach((function(e){let n=r[e];t=n.namespace.bind(t,n.context)})),t}))},f.prototype.fromException=function(e){return e[c]},process.namespaces={},o._state&&!o._state.enabled&&o.enable(),d)for(h in(u=cn()).filter._modifiers)u.filter.deattach(h)})),hn=y(((e,t)=>{"use strict";var r=Yr();process&&r.gte(process.versions.node,"8.0.0")?t.exports=Jr():t.exports=un()})),dn=y(((e,t)=>{var r;e=t.exports=z,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,s=e.re=[],i=e.src=[],o=0,a=o++;i[a]="0|[1-9]\\d*";var c=o++;i[c]="[0-9]+";var l=o++;i[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var u=o++;i[u]="("+i[a]+")\\.("+i[a]+")\\.("+i[a]+")";var h=o++;i[h]="("+i[c]+")\\.("+i[c]+")\\.("+i[c]+")";var d=o++;i[d]="(?:"+i[a]+"|"+i[l]+")";var p=o++;i[p]="(?:"+i[c]+"|"+i[l]+")";var f=o++;i[f]="(?:-("+i[d]+"(?:\\."+i[d]+")*))";var g=o++;i[g]="(?:-?("+i[p]+"(?:\\."+i[p]+")*))";var m=o++;i[m]="[0-9A-Za-z-]+";var y=o++;i[y]="(?:\\+("+i[m]+"(?:\\."+i[m]+")*))";var v=o++,w="v?"+i[u]+i[f]+"?"+i[y]+"?";i[v]="^"+w+"$";var S="[v=\\s]*"+i[h]+i[g]+"?"+i[y]+"?",b=o++;i[b]="^"+S+"$";var _=o++;i[_]="((?:<|>)?=?)";var E=o++;i[E]=i[c]+"|x|X|\\*";var T=o++;i[T]=i[a]+"|x|X|\\*";var C=o++;i[C]="[v=\\s]*("+i[T]+")(?:\\.("+i[T]+")(?:\\.("+i[T]+")(?:"+i[f]+")?"+i[y]+"?)?)?";var P=o++;i[P]="[v=\\s]*("+i[E]+")(?:\\.("+i[E]+")(?:\\.("+i[E]+")(?:"+i[g]+")?"+i[y]+"?)?)?";var A=o++;i[A]="^"+i[_]+"\\s*"+i[C]+"$";var R=o++;i[R]="^"+i[_]+"\\s*"+i[P]+"$";var I=o++;i[I]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var x=o++;i[x]="(?:~>?)";var O=o++;i[O]="(\\s*)"+i[x]+"\\s+",s[O]=new RegExp(i[O],"g");var k=o++;i[k]="^"+i[x]+i[C]+"$";var M=o++;i[M]="^"+i[x]+i[P]+"$";var N=o++;i[N]="(?:\\^)";var D=o++;i[D]="(\\s*)"+i[N]+"\\s+",s[D]=new RegExp(i[D],"g");var L=o++;i[L]="^"+i[N]+i[C]+"$";var B=o++;i[B]="^"+i[N]+i[P]+"$";var q=o++;i[q]="^"+i[_]+"\\s*("+S+")$|^$";var j=o++;i[j]="^"+i[_]+"\\s*("+w+")$|^$";var F=o++;i[F]="(\\s*)"+i[_]+"\\s*("+S+"|"+i[C]+")",s[F]=new RegExp(i[F],"g");var U=o++;i[U]="^\\s*("+i[C]+")\\s+-\\s+("+i[C]+")\\s*$";var $=o++;i[$]="^\\s*("+i[P]+")\\s+-\\s+("+i[P]+")\\s*$";var H,K=o++;for(i[K]="(<|>)?=?\\s*\\*",H=0;H<35;H++)r(H,i[H]),s[H]||(s[H]=new RegExp(i[H]));function V(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof z)return e;if("string"!=typeof e||e.length>256)return null;if(!(t.loose?s[b]:s[v]).test(e))return null;try{return new z(e,t)}catch{return null}}function z(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof z){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof z))return new z(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var i=e.trim().match(t.loose?s[b]:s[v]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}e.parse=V,e.valid=function(e,t){var r=V(e,t);return r?r.version:null},e.clean=function(e,t){var r=V(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},e.SemVer=z,z.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},z.prototype.toString=function(){return this.version},z.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof z||(e=new z(e,this.options)),this.compareMain(e)||this.comparePre(e)},z.prototype.compareMain=function(e){return e instanceof z||(e=new z(e,this.options)),G(this.major,e.major)||G(this.minor,e.minor)||G(this.patch,e.patch)},z.prototype.comparePre=function(e){if(e instanceof z||(e=new z(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],s=e.prerelease[t];if(r("prerelease compare",t,n,s),void 0===n&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===n)return-1;if(n!==s)return G(n,s)}while(++t)},z.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},e.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new z(e,r).inc(t,n).version}catch{return null}},e.diff=function(e,t){if(J(e,t))return null;var r=V(e),n=V(t),s="";if(r.prerelease.length||n.prerelease.length){s="pre";var i="prerelease"}for(var o in r)if(("major"===o||"minor"===o||"patch"===o)&&r[o]!==n[o])return s+o;return i},e.compareIdentifiers=G;var W=/^[0-9]+$/;function G(e,t){var r=W.test(e),n=W.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function Y(e,t,r){return new z(e,r).compare(new z(t,r))}function Q(e,t,r){return Y(e,t,r)>0}function X(e,t,r){return Y(e,t,r)<0}function J(e,t,r){return 0===Y(e,t,r)}function Z(e,t,r){return 0!==Y(e,t,r)}function ee(e,t,r){return Y(e,t,r)>=0}function te(e,t,r){return Y(e,t,r)<=0}function re(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return J(e,r,n);case"!=":return Z(e,r,n);case">":return Q(e,r,n);case">=":return ee(e,r,n);case"<":return X(e,r,n);case"<=":return te(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ne(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof ne){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ne))return new ne(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===se?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}e.rcompareIdentifiers=function(e,t){return G(t,e)},e.major=function(e,t){return new z(e,t).major},e.minor=function(e,t){return new z(e,t).minor},e.patch=function(e,t){return new z(e,t).patch},e.compare=Y,e.compareLoose=function(e,t){return Y(e,t,!0)},e.rcompare=function(e,t,r){return Y(t,e,r)},e.sort=function(t,r){return t.sort((function(t,n){return e.compare(t,n,r)}))},e.rsort=function(t,r){return t.sort((function(t,n){return e.rcompare(t,n,r)}))},e.gt=Q,e.lt=X,e.eq=J,e.neq=Z,e.gte=ee,e.lte=te,e.cmp=re,e.Comparator=ne;var se={};function ie(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof ie)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new ie(e.raw,t);if(e instanceof ne)return new ie(e.value,t);if(!(this instanceof ie))return new ie(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function oe(e){return!e||"x"===e.toLowerCase()||"*"===e}function ae(e,t,r,n,s,i,o,a,c,l,u,h,d){return((t=oe(r)?"":oe(n)?">="+r+".0.0":oe(s)?">="+r+"."+n+".0":">="+t)+" "+(a=oe(c)?"":oe(l)?"<"+(+c+1)+".0.0":oe(u)?"<"+c+"."+(+l+1)+".0":h?"<="+c+"."+l+"."+u+"-"+h:"<="+a)).trim()}function ce(e,t,n){for(var s=0;s<e.length;s++)if(!e[s].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(s=0;s<e.length;s++)if(r(e[s].semver),e[s].semver!==se&&e[s].semver.prerelease.length>0){var i=e[s].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new ie(t,r)}catch{return!1}return t.test(e)}function ue(e,t,r,n){var s,i,o,a,c;switch(e=new z(e,n),t=new ie(t,n),r){case">":s=Q,i=te,o=X,a=">",c=">=";break;case"<":s=X,i=ee,o=Q,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],h=null,d=null;if(u.forEach((function(e){e.semver===se&&(e=new ne(">=0.0.0")),h=h||e,d=d||e,s(e.semver,h.semver,n)?h=e:o(e.semver,d.semver,n)&&(d=e)})),h.operator===a||h.operator===c||(!d.operator||d.operator===a)&&i(e,d.semver))return!1;if(d.operator===c&&o(e,d.semver))return!1}return!0}ne.prototype.parse=function(e){var t=this.options.loose?s[q]:s[j],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new z(r[2],this.options.loose):this.semver=se},ne.prototype.toString=function(){return this.value},ne.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===se||("string"==typeof e&&(e=new z(e,this.options)),re(e,this.operator,this.semver,this.options))},ne.prototype.intersects=function(e,t){if(!(e instanceof ne))throw new TypeError("a Comparator is required");var r;if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new ie(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new ie(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),s=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||s||i&&o||a||c},e.Range=ie,ie.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},ie.prototype.toString=function(){return this.range},ie.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?s[$]:s[U];e=e.replace(n,ae),r("hyphen replace",e),e=e.replace(s[F],"$1$2$3"),r("comparator trim",e,s[F]),e=(e=(e=e.replace(s[O],"$1~")).replace(s[D],"$1^")).split(/\s+/).join(" ");var i=t?s[q]:s[j],o=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?s[B]:s[L];return e.replace(n,(function(t,n,s,i,o){var a;return r("caret",e,t,n,s,i,o),oe(n)?a="":oe(s)?a=">="+n+".0.0 <"+(+n+1)+".0.0":oe(i)?a="0"===n?">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0":">="+n+"."+s+".0 <"+(+n+1)+".0.0":o?(r("replaceCaret pr",o),a="0"===n?"0"===s?">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+s+"."+(+i+1):">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+(+s+1)+".0":">="+n+"."+s+"."+i+"-"+o+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===s?">="+n+"."+s+"."+i+" <"+n+"."+s+"."+(+i+1):">="+n+"."+s+"."+i+" <"+n+"."+(+s+1)+".0":">="+n+"."+s+"."+i+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?s[M]:s[k];return e.replace(n,(function(t,n,s,i,o){var a;return r("tilde",e,t,n,s,i,o),oe(n)?a="":oe(s)?a=">="+n+".0.0 <"+(+n+1)+".0.0":oe(i)?a=">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0":o?(r("replaceTilde pr",o),a=">="+n+"."+s+"."+i+"-"+o+" <"+n+"."+(+s+1)+".0"):a=">="+n+"."+s+"."+i+" <"+n+"."+(+s+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?s[R]:s[A];return e.replace(n,(function(t,n,s,i,o,a){r("xRange",e,t,n,s,i,o,a);var c=oe(s),l=c||oe(i),u=l||oe(o);return"="===n&&u&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&u?(l&&(i=0),o=0,">"===n?(n=">=",l?(s=+s+1,i=0,o=0):(i=+i+1,o=0)):"<="===n&&(n="<",l?s=+s+1:i=+i+1),t=n+s+"."+i+"."+o):l?t=">="+s+".0.0 <"+(+s+1)+".0.0":u&&(t=">="+s+"."+i+".0 <"+s+"."+(+i+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(s[K],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter((function(e){return!!e.match(i)}))),o.map((function(e){return new ne(e,this.options)}),this)},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},e.toComparators=function(e,t){return new ie(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},ie.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new z(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},e.satisfies=le,e.maxSatisfying=function(e,t,r){var n=null,s=null;try{var i=new ie(t,r)}catch{return null}return e.forEach((function(e){i.test(e)&&(!n||-1===s.compare(e))&&(s=new z(n=e,r))})),n},e.minSatisfying=function(e,t,r){var n=null,s=null;try{var i=new ie(t,r)}catch{return null}return e.forEach((function(e){i.test(e)&&(!n||1===s.compare(e))&&(s=new z(n=e,r))})),n},e.minVersion=function(e,t){e=new ie(e,t);var r=new z("0.0.0");if(e.test(r)||(r=new z("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n)e.set[n].forEach((function(e){var t=new z(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":(!r||Q(r,t))&&(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return r&&e.test(r)?r:null},e.validRange=function(e,t){try{return new ie(e,t).range||"*"}catch{return null}},e.ltr=function(e,t,r){return ue(e,t,"<",r)},e.gtr=function(e,t,r){return ue(e,t,">",r)},e.outside=ue,e.prerelease=function(e,t){var r=V(e,t);return r&&r.prerelease.length?r.prerelease:null},e.intersects=function(e,t,r){return e=new ie(e,r),t=new ie(t,r),e.intersects(t)},e.coerce=function(e){if(e instanceof z)return e;if("string"!=typeof e)return null;var t=e.match(s[I]);return null==t?null:V(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}})),pn=y(((e,t)=>{var r,n,s,i,o,a=Qr().wrap,c=[],l=0,u=!1,h=[];function d(e,t){var r=e.length,n=t.length,s=[];if(0===r&&0===n)return s;for(var i=0;i<r;i++)s[i]=e[i];if(0===n)return s;for(var o=0;o<n;o++){var a=!0;for(i=0;i<r;i++)if(e[i].uid===t[o].uid){a=!1;break}a&&s.push(t[o])}return s}function p(e,t){"function"==typeof e.create&&(this.create=e.create,this.flags|=1),"function"==typeof e.before&&(this.before=e.before,this.flags|=2),"function"==typeof e.after&&(this.after=e.after,this.flags|=4),"function"==typeof e.error&&(this.error=e.error,this.flags|=8),this.uid=++l,this.data=void 0===t?null:t}function f(e,t){if("object"!=typeof e||!e)throw new TypeError("callbacks argument must be an object");return e instanceof p?e:new p(e,t)}process._fatalException?(s=!1,r=function(e){var t=c.length;if(s||0===t)return!1;var r=!1;s=!0;for(var n=0;n<t;++n){var o=c[n];if(0!=(8&o.flags)){var a=i&&i[o.uid];r=o.error(a,e)||r}}return s=!1,h.length>0&&(c=h.pop()),i=void 0,r&&!u},n=function(e,t,r){var n=[];u=!0;for(var s=0;s<r;++s){var o=t[s];if(n[o.uid]=o.data,0!=(1&o.flags)){var a=o.create(o.data);void 0!==a&&(n[o.uid]=a)}}return u=!1,function(){i=n,h.push(c),c=d(t,c),u=!0;for(var s=0;s<r;++s)(2&t[s].flags)>0&&t[s].before(this,n[t[s].uid]);u=!1;var o=e.apply(this,arguments);for(u=!0,s=0;s<r;++s)(4&t[s].flags)>0&&t[s].after(this,n[t[s].uid]);return u=!1,c=h.pop(),i=void 0,o}},a(process,"_fatalException",(function(e){return function(t){return r(t)||e(t)}}))):(o=!1,r=function(e){if(o)throw e;for(var t=!1,r=c.length,n=0;n<r;++n){var s=c[n];0!=(8&s.flags)&&(t=s.error(null,e)||t)}if(!t&&u)throw e},n=function(e,t,n){var s=[];u=!0;for(var i=0;i<n;++i){var a=t[i];if(s[a.uid]=a.data,0!=(1&a.flags)){var l=a.create(a.data);void 0!==l&&(s[a.uid]=l)}}return u=!1,function(){var i,a=!1,l=!1;h.push(c),c=d(t,c),u=!0;for(var p=0;p<n;++p)(2&t[p].flags)>0&&t[p].before(this,s[t[p].uid]);u=!1;try{i=e.apply(this,arguments)}catch(e){for(a=!0,p=0;p<n;++p)if(0!=(8&c[p].flags))try{l=c[p].error(s[t[p].uid],e)||l}catch(e){throw o=!0,e}if(!l)throw process.removeListener("uncaughtException",r),process._originalNextTick((function(){process.addListener("uncaughtException",r)})),e}finally{if(!a||l){for(u=!0,p=0;p<n;++p)(4&t[p].flags)>0&&t[p].after(this,s[t[p].uid]);u=!1}c=h.pop()}return i}},process.addListener("uncaughtException",r)),p.prototype.create=void 0,p.prototype.before=void 0,p.prototype.after=void 0,p.prototype.error=void 0,p.prototype.data=void 0,p.prototype.uid=0,p.prototype.flags=0,process.createAsyncListener=f,process.addAsyncListener=function(e,t){var r;r=e instanceof p?e:f(e,t);for(var n=!1,s=0;s<c.length;s++)if(r===c[s]){n=!0;break}return n||c.push(r),r},process.removeAsyncListener=function(e){for(var t=0;t<c.length;t++)if(e===c[t]){c.splice(t,1);break}},t.exports=function(e){var t=c.length;if(0===t)return e;for(var r=c.slice(),s=0;s<t;++s)if(r[s].flags>0)return n(e,r,t);return function(e,t,r){u=!0;for(var n=0;n<r;++n){var s=t[n];s.create&&s.create(s.data)}return u=!1,function(){h.push(c),c=d(t,c);var r=e.apply(this,arguments);return c=h.pop(),r}}(e,r,t)}})),fn=y(((e,t)=>{"use strict";t.exports=(e,t)=>class extends e{constructor(e){var r,n;super((function(e,i){r=this,n=[function(r){return t(s,!1),e(r)},function(e){return t(s,!1),i(e)}]}));var s=this;try{e.apply(r,n)}catch(e){n[1](e)}return s}}})),gn=y((()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var e=Qr(),t=dn(),n=e.wrap,s=e.massWrap,i=pn(),o=r(3837),a=t.gte(process.version,"6.0.0"),c=t.gte(process.version,"7.0.0"),l=t.gte(process.version,"8.0.0"),u=t.gte(process.version,"11.0.0"),h=r(1808);function d(e){return function(){this.on("connection",(function(e){e._handle&&(e._handle.onread=i(e._handle.onread))}));try{return e.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=i(this._handle.onconnection))}}}function p(e){if(e&&e._handle){var t=e._handle;t._originalOnread||(t._originalOnread=t.onread),t.onread=i(t._originalOnread)}}c&&!h._normalizeArgs?h._normalizeArgs=function(e){if(0===e.length)return[{},null];var t=e[0],r={};"object"==typeof t&&null!==t?r=t:function(e){return"string"==typeof e&&!1===function(e){return(e=Number(e))>=0&&e}(e)}(t)?r.path=t:(r.port=t,e.length>1&&"string"==typeof e[1]&&(r.host=e[1]));var n=e[e.length-1];return"function"!=typeof n?[r,null]:[r,n]}:!c&&!h._normalizeConnectArgs&&(h._normalizeConnectArgs=function(e){var t={};"object"==typeof e[0]&&null!==e[0]?t=e[0]:"string"==typeof e[0]&&!1===function(e){return(e=Number(e))>=0&&e}(e[0])?t.path=e[0]:(t.port=e[0],"string"==typeof e[1]&&(t.host=e[1]));var r=e[e.length-1];return"function"==typeof r?[t,r]:[t]}),"_setUpListenHandle"in h.Server.prototype?n(h.Server.prototype,"_setUpListenHandle",d):n(h.Server.prototype,"_listen2",d),n(h.Socket.prototype,"connect",(function(e){return function(){var t;(t=l&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?arguments[0]:c?h._normalizeArgs(arguments):h._normalizeConnectArgs(arguments))[1]&&(t[1]=i(t[1]));var r=e.apply(this,t);return p(this),r}}));var f=r(3685);n(f.Agent.prototype,"addRequest",(function(e){return function(t){var r=t.onSocket;return t.onSocket=i((function(e){return p(e),r.apply(this,arguments)})),e.apply(this,arguments)}}));var g=r(2081);function m(e){Array.isArray(e.stdio)&&e.stdio.forEach((function(e){e&&e._handle&&(e._handle.onread=i(e._handle.onread),n(e._handle,"close",x))})),e._handle&&(e._handle.onexit=i(e._handle.onexit))}g.ChildProcess?n(g.ChildProcess.prototype,"spawn",(function(e){return function(){var t=e.apply(this,arguments);return m(this),t}})):s(g,["execFile","fork","spawn"],(function(e){return function(){var t=e.apply(this,arguments);return m(t),t}})),process._fatalException||(process._originalNextTick=process.nextTick);var y=[];process._nextDomainTick&&y.push("_nextDomainTick"),process._tickDomainCallback&&y.push("_tickDomainCallback"),s(process,y,I),n(process,"nextTick",x);var v=["setTimeout","setInterval"];global.setImmediate&&v.push("setImmediate");var w=r(9512),S=global.setTimeout===w.setTimeout;s(w,v,x),S&&s(global,v,x);var b=r(9523);s(b,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],I),b.resolveNaptr&&n(b,"resolveNaptr",I);var _,E,T,C=r(7147);s(C,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],I),C.lchown&&n(C,"lchown",I),C.lchmod&&n(C,"lchmod",I),C.ftruncate&&n(C,"ftruncate",I);try{_=r(9796)}catch{}_&&_.Deflate&&_.Deflate.prototype&&((E=Object.getPrototypeOf(_.Deflate.prototype))._transform?n(E,"_transform",I):E.write&&E.flush&&E.end&&s(E,["write","flush","end"],I));try{T=r(6113)}catch{}T&&(P=["pbkdf2","randomBytes"],u||P.push("pseudoRandomBytes"),s(T,P,I));var P,A,R=!!global.Promise&&"function Promise() { [native code] }"===Promise.toString()&&"function toString() { [native code] }"===Promise.toString.toString();function I(e){var t=function(){var t,r=arguments.length-1;if("function"==typeof arguments[r]){t=Array(arguments.length);for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n];t[r]=i(arguments[r])}return e.apply(this,t||arguments)};switch(e.length){case 1:return function(r){return 1!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=i(r)),e.call(this,r))};case 2:return function(r,n){return 2!==arguments.length?t.apply(this,arguments):("function"==typeof n&&(n=i(n)),e.call(this,r,n))};case 3:return function(r,n,s){return 3!==arguments.length?t.apply(this,arguments):("function"==typeof s&&(s=i(s)),e.call(this,r,n,s))};case 4:return function(r,n,s,o){return 4!==arguments.length?t.apply(this,arguments):("function"==typeof o&&(o=i(o)),e.call(this,r,n,s,o))};case 5:return function(r,n,s,o,a){return 5!==arguments.length?t.apply(this,arguments):("function"==typeof a&&(a=i(a)),e.call(this,r,n,s,o,a))};case 6:return function(r,n,s,o,a,c){return 6!==arguments.length?t.apply(this,arguments):("function"==typeof c&&(c=i(c)),e.call(this,r,n,s,o,a,c))};default:return t}}function x(e){var t=function(){var t;if("function"==typeof arguments[0]){(t=Array(arguments.length))[0]=i(arguments[0]);for(var r=1;r<arguments.length;r++)t[r]=arguments[r]}return e.apply(this,t||arguments)};switch(e.length){case 1:return function(r){return 1!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=i(r)),e.call(this,r))};case 2:return function(r,n){return 2!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=i(r)),e.call(this,r,n))};case 3:return function(r,n,s){return 3!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=i(r)),e.call(this,r,n,s))};case 4:return function(r,n,s,o){return 4!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=i(r)),e.call(this,r,n,s,o))};case 5:return function(r,n,s,o,a){return 5!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=i(r)),e.call(this,r,n,s,o,a))};case 6:return function(r,n,s,o,a,c){return 6!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=i(r)),e.call(this,r,n,s,o,a,c))};default:return t}}R&&(A=process.addAsyncListener({create:function(){R=!1}}),global.Promise.resolve(!0).then((function(){R=!1})),process.removeAsyncListener(A)),R&&function(){var e=global.Promise;function t(n){if(!(this instanceof t))return e(n);if("function"!=typeof n)return new e(n);var s,i,o=new e((function(e,t){s=this,i=[function(t){return r(o,!1),e(t)},function(e){return r(o,!1),t(e)}]}));o.__proto__=t.prototype;try{n.apply(s,i)}catch(e){i[1](e)}return o}function r(e,t){(!e.__asl_wrapper||t)&&(e.__asl_wrapper=i(s))}function s(t,n,i,o){var a;try{return{returnVal:a=n.call(t,i),error:!1}}catch(e){return{errorVal:e,error:!0}}finally{a instanceof e?o.__asl_wrapper=function(){var e=a.__asl_wrapper||s;return e.apply(this,arguments)}:r(o,!0)}}function c(e){return function(){var t=this,r=e.apply(t,Array.prototype.map.call(arguments,n));return r.__asl_wrapper=function(e,n,i,o){return t.__asl_wrapper?(t.__asl_wrapper(e,(function(){}),null,r),r.__asl_wrapper(e,n,i,o)):s(e,n,i,o)},r;function n(e){return"function"!=typeof e?e:i((function(n){var i=(t.__asl_wrapper||s)(this,e,n,r);if(i.error)throw i.errorVal;return i.returnVal}))}}}o.inherits(t,e),n(e.prototype,"then",c),e.prototype.chain&&n(e.prototype,"chain",c),a?global.Promise=fn()(e,r):(["all","race","reject","resolve","accept","defer"].forEach((function(r){"function"==typeof e[r]&&(t[r]=e[r])})),global.Promise=t)}()})),mn=y(((e,t)=>{"use strict";var n=r(9491),s=Xr(),i="cls@contexts",o="error@context";function a(e){this.name=e,this.active=null,this._set=[],this.id=null}function c(e){return process.namespaces[e]}function l(e){var t=c(e);n.ok(t,"can't delete nonexistent namespace!"),n.ok(t.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(t.id),process.namespaces[e]=null}function u(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){l(e)})),process.namespaces=Object.create(null)}process.addAsyncListener||gn(),a.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,t},a.prototype.get=function(e){if(this.active)return this.active[e]},a.prototype.createContext=function(){return Object.create(this.active)},a.prototype.run=function(e){var t=this.createContext();this.enter(t);try{return e(t),t}catch(e){throw e&&(e[o]=t),e}finally{this.exit(t)}},a.prototype.runAndReturn=function(e){var t;return this.run((function(r){t=e(r)})),t},a.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());var r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e[o]=t),e}finally{r.exit(t)}}},a.prototype.enter=function(e){n.ok(e,"context must be provided for entering"),this._set.push(this.active),this.active=e},a.prototype.exit=function(e){if(n.ok(e,"context must be provided for exiting"),this.active===e)return n.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());var t=this._set.lastIndexOf(e);n.ok(t>=0,"context not currently entered; can't exit"),n.ok(t,"can't remove top context"),this._set.splice(t,1)},a.prototype.bindEmitter=function(e){n.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");var t=this,r="context@"+this.name;s(e,(function(e){!e||(e[i]||(e[i]=Object.create(null)),e[i][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e[i])return e;var t=e,r=e[i];return Object.keys(r).forEach((function(e){var n=r[e];t=n.namespace.bind(t,n.context)})),t}))},a.prototype.fromException=function(e){return e[o]},process.namespaces||u(),t.exports={getNamespace:c,createNamespace:function(e){n.ok(e,"namespace must be given a name!");var t=new a(e);return t.id=process.addAsyncListener({create:function(){return t.active},before:function(e,r){r&&t.enter(r)},after:function(e,r){r&&t.exit(r)},error:function(e){e&&t.exit(e)}}),process.namespaces[e]=t,t},destroyNamespace:l,reset:u}})),yn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CorrelationContextManager=void 0;var t=S(),r=Xt(),n=tr(),s=rr(),i=Gr(),o=function(){function e(){}return e.getCurrentContext=function(){if(!e.enabled)return null;var t=e.session.get(e.CONTEXT_NAME);return void 0===t?null:t},e.generateContextObject=function(e,t,r,n,s,i){return t=t||e,this.enabled?{operation:{name:r,id:e,parentId:t,traceparent:s,tracestate:i},customProperties:new a(n)}:null},e.spanToContextObject=function(t,r,s){var i=new n;return i.traceId=t.traceId,i.spanId=t.spanId,i.traceFlag=n.formatOpenTelemetryTraceFlags(t.traceFlags)||n.DEFAULT_TRACE_FLAG,i.parentId=r,e.generateContextObject(i.traceId,i.parentId,s,null,i)},e.runWithContext=function(t,r){var n;return e.enabled?e.session.bind(r,((n={})[e.CONTEXT_NAME]=t,n))():r()},e.wrapEmitter=function(t){e.enabled&&e.session.bindEmitter(t)},e.wrapCallback=function(t,r){var n;return e.enabled?e.session.bind(t,r?((n={})[e.CONTEXT_NAME]=r,n):void 0):t},e.enable=function(t){if(!this.enabled){if(!this.isNodeVersionCompatible())return void(this.enabled=!1);e.hasEverEnabled||(this.forceClsHooked=t,this.hasEverEnabled=!0,typeof this.cls>"u"&&(!0===e.forceClsHooked||void 0===e.forceClsHooked&&e.shouldUseClsHooked()?this.cls=hn():this.cls=mn()),e.session=this.cls.createNamespace("AI-CLS-Session"),r.registerContextPreservation((function(t){return e.session.bind(t)}))),this.enabled=!0}},e.startOperation=function(r,o){var a=r&&r.traceContext||null,c=r&&r.traceId?r:null,l=r&&r.headers;if(c){var u=new n("00-"+c.traceId+"-"+c.spanId+"-01"),h=new s(c.traceState?c.traceState.serialize():null);return e.generateContextObject(c.traceId,"|"+c.traceId+"."+c.spanId+".","string"==typeof o?o:"",void 0,u,h)}if(a){u=new n(a.traceparent),h=new s(a.tracestate);var d="object"==typeof o?new i(o):null;return e.generateContextObject(u.traceId,u.parentId,"string"==typeof o?o:d.getOperationName({}),d&&d.getCorrelationContextHeader()||void 0,u,h)}return l?(u=new n(l.traceparent?l.traceparent.toString():null),h=new s(l.tracestate?l.tracestate.toString():null),d=new i(r),e.generateContextObject(u.traceId,u.parentId,d.getOperationName({}),d.getCorrelationContextHeader(),u,h)):(t.warn("startOperation was called with invalid arguments",arguments),null)},e.disable=function(){this.enabled=!1},e.reset=function(){e.hasEverEnabled&&(e.session=null,e.session=this.cls.createNamespace("AI-CLS-Session"))},e.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>3||parseInt(e[0])>2&&parseInt(e[1])>2},e.shouldUseClsHooked=function(){var e=process.versions.node.split(".");return parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=2},e.canUseClsHooked=function(){var e=process.versions.node.split("."),t=parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=0,r=parseInt(e[0])<8||parseInt(e[0])<=8&&parseInt(e[1])<2,n=parseInt(e[0])>4||parseInt(e[0])>=4&&parseInt(e[1])>=7;return!(t&&r)&&n},e.enabled=!1,e.hasEverEnabled=!1,e.forceClsHooked=void 0,e.CONTEXT_NAME="ApplicationInsights-Context",e}();e.CorrelationContextManager=o;var a=function(){function e(e){this.props=[],this.addHeaderData(e)}return e.prototype.addHeaderData=function(e){var t=e?e.split(", "):[];this.props=t.map((function(e){var t=e.split("=");return{key:t[0],value:t[1]}})).concat(this.props)},e.prototype.serializeToHeader=function(){return this.props.map((function(e){return e.key+"="+e.value})).join(", ")},e.prototype.getProperty=function(e){for(var t=0;t<this.props.length;++t){var r=this.props[t];if(r.key===e)return r.value}},e.prototype.setProperty=function(r,n){if(e.bannedCharacters.test(r)||e.bannedCharacters.test(n))t.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+r+" and value: "+n);else{for(var s=0;s<this.props.length;++s){var i=this.props[s];if(i.key===r)return void(i.value=n)}this.props.push({key:r,value:n})}},e.bannedCharacters=/[,=]/,e}()})),vn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.enable=void 0;var t=zr(),r=C(),n=[],s=function(e){var r=e.data.message;n.forEach((function(n){r instanceof Error?n.trackException({exception:r}):(r.lastIndexOf("\n")==r.length-1&&(r=r.substring(0,r.length-1)),n.trackTrace({message:r,severity:e.data.stderr?t.SeverityLevel.Warning:t.SeverityLevel.Information}))}))};e.enable=function(e,t){e?(0===n.length&&r.channel.subscribe("console",s),n.push(t)):0===(n=n.filter((function(e){return e!=t}))).length&&r.channel.unsubscribe("console",s)},e.dispose=function(){r.channel.unsubscribe("console",s),n=[]}})),wn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.enable=void 0;var t=zr(),r=C(),n=[],s={10:t.SeverityLevel.Verbose,20:t.SeverityLevel.Verbose,30:t.SeverityLevel.Information,40:t.SeverityLevel.Warning,50:t.SeverityLevel.Error,60:t.SeverityLevel.Critical},i=function(e){var t=e.data.result;n.forEach((function(r){var n=s[e.data.level];t instanceof Error?r.trackException({exception:t}):r.trackTrace({message:t,severity:n})}))};e.enable=function(e,t){e?(0===n.length&&r.channel.subscribe("bunyan",i),n.push(t)):0===(n=n.filter((function(e){return e!=t}))).length&&r.channel.unsubscribe("bunyan",i)},e.dispose=function(){r.channel.unsubscribe("bunyan",i),n=[]}})),Sn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.enable=void 0;var t=zr(),r=C(),n=[],s={syslog:function(e){var r={emerg:t.SeverityLevel.Critical,alert:t.SeverityLevel.Critical,crit:t.SeverityLevel.Critical,error:t.SeverityLevel.Error,warning:t.SeverityLevel.Warning,notice:t.SeverityLevel.Information,info:t.SeverityLevel.Information,debug:t.SeverityLevel.Verbose};return void 0===r[e]?t.SeverityLevel.Information:r[e]},npm:function(e){var r={error:t.SeverityLevel.Error,warn:t.SeverityLevel.Warning,info:t.SeverityLevel.Information,verbose:t.SeverityLevel.Verbose,debug:t.SeverityLevel.Verbose,silly:t.SeverityLevel.Verbose};return void 0===r[e]?t.SeverityLevel.Information:r[e]},unknown:function(e){return t.SeverityLevel.Information}},i=function(e){var t=e.data.message;n.forEach((function(r){if(t instanceof Error)r.trackException({exception:t,properties:e.data.meta});else{var n=s[e.data.levelKind](e.data.level);r.trackTrace({message:t,severity:n,properties:e.data.meta})}}))};e.enable=function(e,t){e?(0===n.length&&r.channel.subscribe("winston",i),n.push(t)):0===(n=n.filter((function(e){return e!=t}))).length&&r.channel.unsubscribe("winston",i)},e.dispose=function(){r.channel.unsubscribe("winston",i),n=[]}})),bn=y(((e,t)=>{"use strict";var r=Xt(),n=function(){function e(t){if(e.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=t,e.INSTANCE=this}return e.prototype.enable=function(e,t){r.IsInitialized&&(vn().enable(e&&t,this._client),wn().enable(e,this._client),Sn().enable(e,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1,!1)},e._methodNames=["debug","info","log","warn","error"],e}();t.exports=n})),_n=y(((e,t)=>{"use strict";var r=function(){function e(t){if(e.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t;var r=process.versions.node.split(".");e._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||13===parseInt(r[0])&&parseInt(r[1])>=7}return e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.enable=function(t){var r=this;if(t){if(this._isInitialized=!0,!this._exceptionListenerHandle){var n=function(t,n,s){void 0===s&&(s=new Error(e._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:s}),r._client.flush({isAppCrashing:!0}),t&&n&&1===process.listeners(n).length&&(console.error(s),process.exit(1))};e._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=n.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=n.bind(this,!0,e.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=n.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(e._canUseUncaughtExceptionMonitor?process.removeListener(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.INSTANCE=null,e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",e.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",e.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",e._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",e._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",e._canUseUncaughtExceptionMonitor=!1,e}();t.exports=r})),En=y((e=>{"use strict";var t,r,n,s;Object.defineProperty(e,"__esModule",{value:!0}),e.HeartBeatMetricName=e.DependencyTypeName=e.SpanAttribute=e.TelemetryTypeStringToQuickPulseDocumentType=e.TelemetryTypeStringToQuickPulseType=e.QuickPulseType=e.QuickPulseDocumentType=e.PerformanceToQuickPulseCounter=e.MetricId=e.PerformanceCounter=e.QuickPulseCounter=e.DEFAULT_LIVEMETRICS_HOST=e.DEFAULT_LIVEMETRICS_ENDPOINT=e.DEFAULT_BREEZE_ENDPOINT=void 0,e.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com",e.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com",e.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com",(n=r=e.QuickPulseCounter||(e.QuickPulseCounter={})).COMMITTED_BYTES="\\Memory\\Committed Bytes",n.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",n.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",n.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",n.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",n.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",n.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",n.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",n.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec",function(e){e.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",e.AVAILABLE_BYTES="\\Memory\\Available Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",e.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",e.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"}(s=e.PerformanceCounter||(e.PerformanceCounter={})),function(e){e.REQUESTS_DURATION="requests/duration",e.DEPENDENCIES_DURATION="dependencies/duration",e.EXCEPTIONS_COUNT="exceptions/count",e.TRACES_COUNT="traces/count"}(e.MetricId||(e.MetricId={})),e.PerformanceToQuickPulseCounter=((t={})[s.PROCESSOR_TIME]=r.PROCESSOR_TIME,t[s.REQUEST_RATE]=r.REQUEST_RATE,t[s.REQUEST_DURATION]=r.REQUEST_DURATION,t[r.COMMITTED_BYTES]=r.COMMITTED_BYTES,t[r.REQUEST_FAILURE_RATE]=r.REQUEST_FAILURE_RATE,t[r.DEPENDENCY_RATE]=r.DEPENDENCY_RATE,t[r.DEPENDENCY_FAILURE_RATE]=r.DEPENDENCY_FAILURE_RATE,t[r.DEPENDENCY_DURATION]=r.DEPENDENCY_DURATION,t[r.EXCEPTION_RATE]=r.EXCEPTION_RATE,t),e.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"},e.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"},e.TelemetryTypeStringToQuickPulseType={EventData:e.QuickPulseType.Event,ExceptionData:e.QuickPulseType.Exception,MessageData:e.QuickPulseType.Trace,MetricData:e.QuickPulseType.Metric,RequestData:e.QuickPulseType.Request,RemoteDependencyData:e.QuickPulseType.Dependency,AvailabilityData:e.QuickPulseType.Availability,PageViewData:e.QuickPulseType.PageView},e.TelemetryTypeStringToQuickPulseDocumentType={EventData:e.QuickPulseDocumentType.Event,ExceptionData:e.QuickPulseDocumentType.Exception,MessageData:e.QuickPulseDocumentType.Trace,MetricData:e.QuickPulseDocumentType.Metric,RequestData:e.QuickPulseDocumentType.Request,RemoteDependencyData:e.QuickPulseDocumentType.Dependency,AvailabilityData:e.QuickPulseDocumentType.Availability,PageViewData:e.QuickPulseDocumentType.PageView},e.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"},e.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"},e.HeartBeatMetricName="HeartBeat"})),Tn=y(((e,t)=>{"use strict";var n=r(2037),s=En(),i=function(){function e(t,r,n){void 0===r&&(r=6e4),void 0===n&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return e.prototype.enable=function(t,r){var s=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._lastCpus=n.cpus(),this._lastRequests={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:e._totalExceptionCount,time:+new Date},"function"==typeof process.cpuUsage&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval((function(){return s.trackPerformance()}),this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countRequest=function(t,r){var n;if(e.isEnabled()){if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}e._intervalRequestExecutionTime+=n,!1===r&&e._totalFailedRequestCount++,e._totalRequestCount++}},e.countException=function(){e._totalExceptionCount++},e.countDependency=function(t,r){var n;if(e.isEnabled()){if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}e._intervalDependencyExecutionTime+=n,!1===r&&e._totalFailedDependencyCount++,e._totalDependencyCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},e.prototype._trackCpu=function(){var e=n.cpus();if(e&&e.length&&this._lastCpus&&e.length===this._lastCpus.length){for(var t=0,r=0,i=0,o=0,a=0,c=0;e&&c<e.length;c++){var l=e[c],u=this._lastCpus[c],h=(l.model,l.speed,l.times),d=u.times;t+=h.user-d.user||0,r+=h.sys-d.sys||0,i+=h.nice-d.nice||0,o+=h.idle-d.idle||0,a+=h.irq-d.irq||0}var p=void 0;if("function"==typeof process.cpuUsage){var f=process.cpuUsage(),g=process.hrtime(),m=f.user-this._lastAppCpuUsage.user+(f.system-this._lastAppCpuUsage.system)||0;typeof this._lastHrtime<"u"&&2===this._lastHrtime.length&&(p=100*m/((1e6*(g[0]-this._lastHrtime[0])+(g[1]-this._lastHrtime[1])/1e3||0)*e.length)),this._lastAppCpuUsage=f,this._lastHrtime=g}var y=t+r+i+o+a||1;this._client.trackMetric({name:s.PerformanceCounter.PROCESSOR_TIME,value:(y-o)/y*100}),this._client.trackMetric({name:s.PerformanceCounter.PROCESS_TIME,value:p||t/y*100})}this._lastCpus=e},e.prototype._trackMemory=function(){var e=n.freemem(),t=process.memoryUsage().rss,r=n.totalmem()-e;this._client.trackMetric({name:s.PerformanceCounter.PRIVATE_BYTES,value:t}),this._client.trackMetric({name:s.PerformanceCounter.AVAILABLE_BYTES,value:e}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:s.QuickPulseCounter.COMMITTED_BYTES,value:r})},e.prototype._trackNetwork=function(){var t=this._lastRequests,r={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-t.totalRequestCount||0,i=r.totalFailedRequestCount-t.totalFailedRequestCount||0,o=r.time-t.time,a=o/1e3,c=(e._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=e._intervalRequestExecutionTime,o>0){var l=n/a,u=i/a;this._client.trackMetric({name:s.PerformanceCounter.REQUEST_RATE,value:l}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:s.PerformanceCounter.REQUEST_DURATION,value:c}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:s.QuickPulseCounter.REQUEST_FAILURE_RATE,value:u})}this._lastRequests=r},e.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastDependencies,r={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-t.totalDependencyCount||0,i=r.totalFailedDependencyCount-t.totalFailedDependencyCount||0,o=r.time-t.time,a=o/1e3,c=(e._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=e._intervalDependencyExecutionTime,o>0){var l=n/a,u=i/a;this._client.trackMetric({name:s.QuickPulseCounter.DEPENDENCY_RATE,value:l}),this._client.trackMetric({name:s.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:s.QuickPulseCounter.DEPENDENCY_DURATION,value:c})}this._lastDependencies=r}},e.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastExceptions,r={totalExceptionCount:e._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-t.totalExceptionCount||0,i=r.time-t.time;if(i>0){var o=n/(i/1e3);this._client.trackMetric({name:s.QuickPulseCounter.EXCEPTION_RATE,value:o})}this._lastExceptions=r}},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e._totalRequestCount=0,e._totalFailedRequestCount=0,e._totalDependencyCount=0,e._totalFailedDependencyCount=0,e._totalExceptionCount=0,e._intervalDependencyExecutionTime=0,e._intervalRequestExecutionTime=0,e}();t.exports=i})),Cn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AggregatedMetricCounter=void 0;e.AggregatedMetricCounter=function(e){this.dimensions=e,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}})),Pn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PreaggregatedMetricPropertyNames=void 0,e.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}})),An=y(((e,t)=>{"use strict";var r=e&&e.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},r.apply(this,arguments)},n=En(),s=Cn(),i=Pn(),o=function(){function e(t,r){void 0===r&&(r=6e4),e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,e._dependencyCountersCollection=[],e._requestCountersCollection=[],e._exceptionCountersCollection=[],e._traceCountersCollection=[],this._client=t,this._collectionInterval=r}return e.prototype.enable=function(e,t){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._collectionInterval=t||this._collectionInterval,this._handle=setInterval((function(){return r.trackPreAggregatedMetrics()}),this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countException=function(t){e.isEnabled()&&e._getAggregatedCounter(t,this._exceptionCountersCollection).totalCount++},e.countTrace=function(t){e.isEnabled()&&e._getAggregatedCounter(t,this._traceCountersCollection).totalCount++},e.countRequest=function(t,r){if(e.isEnabled()){var n,s=e._getAggregatedCounter(r,this._requestCountersCollection);if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}s.intervalExecutionTime+=n,s.totalCount++}},e.countDependency=function(t,r){if(e.isEnabled()){var n,s=e._getAggregatedCounter(r,this._dependencyCountersCollection);if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}s.intervalExecutionTime+=n,s.totalCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},e._getAggregatedCounter=function(e,t){for(var r=!1,n=0;n<t.length;n++){if(e===t[n].dimensions)return t[n];if(Object.keys(e).length===Object.keys(t[n].dimensions).length){for(var i in e)if(e[i]!=t[n].dimensions[i]){r=!0;break}if(!r)return t[n];r=!1}}var o=new s.AggregatedMetricCounter(e);return t.push(o),o},e.prototype._trackRequestMetrics=function(){for(var t=0;t<e._requestCountersCollection.length;t++){var r=e._requestCountersCollection[t];r.time=+new Date;var s=r.totalCount-r.lastTotalCount||0,i=r.time-r.lastTime,o=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/s||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,i>0&&s>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:r.dimensions,value:o,count:s,aggregationInterval:i,metricType:n.MetricId.REQUESTS_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackDependencyMetrics=function(){for(var t=0;t<e._dependencyCountersCollection.length;t++){var r=e._dependencyCountersCollection[t];r.time=+new Date;var s=r.totalCount-r.lastTotalCount||0,i=r.time-r.lastTime,o=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/s||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,i>0&&s>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:r.dimensions,value:o,count:s,aggregationInterval:i,metricType:n.MetricId.DEPENDENCIES_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackExceptionMetrics=function(){for(var t=0;t<e._exceptionCountersCollection.length;t++){var r=e._exceptionCountersCollection[t],s=r.totalCount-r.lastTotalCount||0,i=r.time-r.lastTime;this._trackPreAggregatedMetric({name:"Exceptions",dimensions:r.dimensions,value:s,count:s,aggregationInterval:i,metricType:n.MetricId.EXCEPTIONS_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackTraceMetrics=function(){for(var t=0;t<e._traceCountersCollection.length;t++){var r=e._traceCountersCollection[t],s=r.totalCount-r.lastTotalCount||0,i=r.time-r.lastTime;this._trackPreAggregatedMetric({name:"Traces",dimensions:r.dimensions,value:s,count:s,aggregationInterval:i,metricType:n.MetricId.TRACES_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackPreAggregatedMetric=function(e){var t={};for(var n in e.dimensions)t[i.PreaggregatedMetricPropertyNames[n]]=e.dimensions[n];t=r(r({},t),{"_MS.MetricId":e.metricType,"_MS.AggregationIntervalMs":String(e.aggregationInterval),"_MS.IsAutocollected":"True"});var s={name:e.name,value:e.value,count:e.count,properties:t,kind:"Aggregation"};this._client.trackMetric(s)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e}();t.exports=o})),Rn=y(((e,t)=>{"use strict";var n=r(2037),s=r(7147),i=r(1017),o=zr(),a=S(),c=function(){function e(e){this.keys=new o.ContextTagKeys,this.tags={},this._loadApplicationContext(e),this._loadDeviceContext(),this._loadInternalContext()}return e.prototype._loadApplicationContext=function(t){if(t=t||i.resolve(__dirname,"../../../../package.json"),!e.appVersion[t]){e.appVersion[t]="unknown";try{var r=JSON.parse(s.readFileSync(t,"utf8"));r&&"string"==typeof r.version&&(e.appVersion[t]=r.version)}catch(e){a.info("unable to read app version: ",e)}}this.tags[this.keys.applicationVersion]=e.appVersion[t]},e.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=n&&n.hostname(),this.tags[this.keys.deviceOSVersion]=n&&n.type()+" "+n.release(),this.tags[this.keys.cloudRole]=e.DefaultRoleName,this.tags["ai.device.osArchitecture"]=n&&n.arch(),this.tags["ai.device.osPlatform"]=n&&n.platform()},e.prototype._loadInternalContext=function(){var t=i.resolve(__dirname,"../../package.json");if(!e.sdkVersion){e.sdkVersion="unknown";try{var r=JSON.parse(s.readFileSync(t,"utf8"));r&&"string"==typeof r.version&&(e.sdkVersion=r.version)}catch(e){a.info("unable to read app version: ",e)}}this.tags[this.keys.internalSdkVersion]="node:"+e.sdkVersion},e.DefaultRoleName="Web",e.appVersion={},e.sdkVersion=null,e}();t.exports=c})),In=y(((e,t)=>{"use strict";var n,s=e&&e.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=r(7310),o=zr(),a=Zt(),c=Jt(),l=Wr(),u=er(),h=function(e){function t(r,n){var s=e.call(this)||this;return n&&n.method&&r&&(s.method=n.method,s.url=t._getUrlFromRequestOptions(r,n),s.startTime=+new Date),s}return s(t,e),t.prototype.onError=function(e){this._setStatus(void 0,e)},t.prototype.onResponse=function(e){this._setStatus(e.statusCode,void 0),this.correlationId=a.getCorrelationContextTarget(e,c.requestContextTargetKey)},t.prototype.getDependencyTelemetry=function(e,t){var r=i.parse(this.url);r.search=void 0,r.hash=void 0;var n=this.method.toUpperCase()+" "+r.pathname,s=o.RemoteDependencyDataConstants.TYPE_HTTP,a=r.hostname;r.port&&(a+=":"+r.port),this.correlationId?(s=o.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==u.correlationIdPrefix&&(a+=" | "+this.correlationId)):s=o.RemoteDependencyDataConstants.TYPE_HTTP;var c={id:t,name:n,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:s,target:a};if(e&&e.time?c.time=e.time:this.startTime&&(c.time=new Date(this.startTime)),e){for(var l in e)c[l]||(c[l]=e[l]);if(e.properties)for(var l in e.properties)c.properties[l]=e.properties[l]}return c},t._getUrlFromRequestOptions=function(e,t){if("string"==typeof e)if(0===e.indexOf("http://")||0===e.indexOf("https://"))e=i.parse(e);else{var r=i.parse(e);e="443"===r.host?i.parse("https://"+e):i.parse("http://"+e)}else{if(e&&"function"==typeof i.URL&&e instanceof i.URL)return i.format(e);var n=e;e={},n&&Object.keys(n).forEach((function(t){e[t]=n[t]}))}if(e.path){var s=i.parse(e.path);e.pathname=s.pathname,e.search=s.search}return e.host&&e.port&&!i.parse("http://"+e.host).port&&e.port&&(e.hostname=e.host,delete e.host),e.protocol=e.protocol||t.agent&&t.agent.protocol||t.protocol||void 0,e.hostname=e.hostname||"localhost",i.format(e)},t}(l);t.exports=h})),xn=y((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.spanToTelemetryContract=void 0;var r=Se(),n=En();function s(e){var r=t({},e);return Object.keys(n.SpanAttribute).forEach((function(e){delete r[e]})),r}e.spanToTelemetryContract=function(e){var i="|"+e.spanContext().traceId+"."+e.spanContext().spanId+".",o=Math.round(1e3*e._duration[0]+e._duration[1]/1e6),a=e.attributes["peer.address"]?e.attributes["peer.address"].toString():"",c=e.attributes.component?e.attributes.component.toString():"",l=c.toUpperCase()===n.DependencyTypeName.Http||!!e.attributes[n.SpanAttribute.HttpUrl],u=c.toLowerCase()===n.DependencyTypeName.Grpc;if(l){var h=e.attributes[n.SpanAttribute.HttpMethod]||"GET",d=new URL(e.attributes[n.SpanAttribute.HttpUrl].toString()),p=e.attributes[n.SpanAttribute.HttpHost]||d.host,f=e.attributes[n.SpanAttribute.HttpPort]||d.port||null,g=h+" "+(d.pathname||"/"),m=n.DependencyTypeName.Http,y=f?(p+":"+f).toString():p.toString(),v=d.toString(),w=e.attributes[n.SpanAttribute.HttpStatusCode]||e.status.code||0;return{id:i,name:g,dependencyTypeName:m,target:y,data:v,success:w<400,duration:o,url:v,resultCode:String(w),properties:s(e.attributes)}}if(u){h=e.attributes[n.SpanAttribute.GrpcMethod]||"rpc";var S=e.attributes[n.SpanAttribute.GrpcService],b=S?h+" "+S:e.name;return{id:i,duration:o,name:b,target:S.toString(),data:S.toString()||b,url:S.toString()||b,dependencyTypeName:n.DependencyTypeName.Grpc,resultCode:String(e.status.code||0),success:0===e.status.code,properties:s(e.attributes)}}var _=e.name,E=e.links&&e.links.map((function(e){return{operation_Id:e.context.traceId,id:e.context.spanId}}));return{id:i,duration:o,name:_,target:a,data:a||_,url:a||_,dependencyTypeName:e.kind===r.SpanKind.INTERNAL?n.DependencyTypeName.InProc:c||e.name,resultCode:String(e.status.code||0),success:0===e.status.code,properties:t(t({},s(e.attributes)),{"_MS.links":E||void 0})}}})),On=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=Se(),r=C(),n=tr(),s=xn(),i=b(),o=[];e.subscriber=function(e){var r=e.data,a=s.spanToTelemetryContract(r),c=r.spanContext(),l=new n;l.traceId=c.traceId,l.spanId=c.spanId,l.traceFlag=n.formatOpenTelemetryTraceFlags(c.traceFlags),l.parentId=r.parentSpanId?"|"+c.traceId+"."+r.parentSpanId+".":null,i.AsyncScopeManager.with(r,(function(){o.forEach((function(e){r.kind===t.SpanKind.SERVER?e.trackRequest(a):(r.kind===t.SpanKind.CLIENT||r.kind===t.SpanKind.INTERNAL)&&e.trackDependency(a)}))}))},e.enable=function(t,n){t?(0===o.length&&r.channel.subscribe("azure-coretracing",e.subscriber),o.push(n)):0===(o=o.filter((function(e){return e!=n}))).length&&r.channel.unsubscribe("azure-coretracing",e.subscriber)}})),kn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=C(),r=[];e.subscriber=function(e){"ismaster"!==e.data.event.commandName&&r.forEach((function(t){var r=e.data.startedData&&e.data.startedData.databaseName||"Unknown database";t.trackDependency({target:r,data:e.data.event.commandName,name:e.data.event.commandName,duration:e.data.event.duration,success:e.data.succeeded,resultCode:e.data.succeeded?"0":"1",time:e.data.startedData.time,dependencyTypeName:"mongodb"})}))},e.enable=function(n,s){n?(0===r.length&&t.channel.subscribe("mongodb",e.subscriber),r.push(s)):0===(r=r.filter((function(e){return e!=s}))).length&&t.channel.unsubscribe("mongodb",e.subscriber)}})),Mn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=C(),r=[];e.subscriber=function(e){r.forEach((function(t){var r=e.data.query||{},n=r.sql||"Unknown query",s=!e.data.err,i=(r._connection||{}).config||{},o=i.socketPath?i.socketPath:(i.host||"localhost")+":"+i.port;t.trackDependency({target:o,data:n,name:n,duration:e.data.duration,success:s,resultCode:s?"0":"1",time:e.data.time,dependencyTypeName:"mysql"})}))},e.enable=function(n,s){n?(0===r.length&&t.channel.subscribe("mysql",e.subscriber),r.push(s)):0===(r=r.filter((function(e){return e!=s}))).length&&t.channel.unsubscribe("mysql",e.subscriber)}})),Nn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=C(),r=[];e.subscriber=function(e){r.forEach((function(t){"info"!==e.data.commandObj.command&&t.trackDependency({target:e.data.address,name:e.data.commandObj.command,data:e.data.commandObj.command,duration:e.data.duration,success:!e.data.err,resultCode:e.data.err?"1":"0",time:e.data.time,dependencyTypeName:"redis"})}))},e.enable=function(n,s){n?(0===r.length&&t.channel.subscribe("redis",e.subscriber),r.push(s)):0===(r=r.filter((function(e){return e!=s}))).length&&t.channel.unsubscribe("redis",e.subscriber)}})),Dn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=C(),r=[];e.subscriber=function(e){r.forEach((function(t){var r=e.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",s=!e.data.error,i=e.data.database.host+":"+e.data.database.port;t.trackDependency({target:i,data:n,name:n,duration:e.data.duration,success:s,resultCode:s?"0":"1",time:e.data.time,dependencyTypeName:"postgres"})}))},e.enable=function(n,s){n?(0===r.length&&t.channel.subscribe("postgres",e.subscriber),r.push(s)):0===(r=r.filter((function(e){return e!=s}))).length&&t.channel.unsubscribe("postgres",e.subscriber)}})),Ln=y(((e,t)=>{"use strict";var n=e&&e.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),s=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n},s=r(3685),i=r(5687),o=S(),a=Zt(),c=Jt(),l=In(),u=yn(),h=er(),d=tr(),p=Xt(),f=function(){function e(t){if(e.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(e){this._isEnabled=e,this._isEnabled&&!this._isInitialized&&this._initialize(),p.IsInitialized&&(On().enable(!0,this._client),kn().enable(e,this._client),Mn().enable(e,this._client),Nn().enable(e,this._client),Dn().enable(e,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=s.request,o=i.request,a=function(r,n){var s=!n[e.disableCollectionRequestOption]&&!r[e.alreadyAutoCollectedFlag];n.headers&&n.headers["user-agent"]&&-1!==n.headers["user-agent"].toString().indexOf("azsdk-js")&&(s=!1),r[e.alreadyAutoCollectedFlag]=!0,r&&n&&s&&(u.CorrelationContextManager.wrapEmitter(r),e.trackRequest(t._client,{options:n,request:r}))};s.request=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=r.call.apply(r,n([s,e],t));return a(o,e),o},i.request=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var s=o.call.apply(o,n([i,e],t));return a(s,e),s},s.get=function(e){for(var t,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=(t=s.request).call.apply(t,n([s,e],r));return o.end(),o},i.get=function(e){for(var t,r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var o=(t=i.request).call.apply(t,n([i,e],r));return o.end(),o}},e.trackRequest=function(t,r){if(r.options&&r.request&&t){var n,s,i=new l(r.options,r.request),p=u.CorrelationContextManager.getCurrentContext();if(p&&p.operation&&p.operation.traceparent&&d.isValidTraceId(p.operation.traceparent.traceId)?(p.operation.traceparent.updateSpanId(),n=p.operation.traceparent.getBackCompatRequestId()):h.w3cEnabled?(s=(g=new d).toString(),n=g.getBackCompatRequestId()):n=p&&p.operation&&p.operation.parentId+e.requestNumber+++".",a.canIncludeCorrelationHeader(t,i.getUrl())&&r.request.getHeader&&r.request.setHeader&&t.config&&t.config.correlationId){var f=r.request.getHeader(c.requestContextHeader);try{a.safeIncludeCorrelationHeader(t,r.request,f)}catch(e){o.warn("Request-Context header could not be set. Correlation of requests may be lost",e)}if(p&&p.operation)try{if(r.request.setHeader(c.requestIdHeader,n),t.config.ignoreLegacyHeaders||(r.request.setHeader(c.parentIdHeader,p.operation.id),r.request.setHeader(c.rootIdHeader,n)),s||p.operation.traceparent)r.request.setHeader(c.traceparentHeader,s||p.operation.traceparent.toString());else if(h.w3cEnabled){var g=(new d).toString();r.request.setHeader(c.traceparentHeader,g)}if(p.operation.tracestate){var m=p.operation.tracestate.toString();m&&r.request.setHeader(c.traceStateHeader,m)}var y=p.customProperties.serializeToHeader();y&&r.request.setHeader(c.correlationContextHeader,y)}catch(e){o.warn("Correlation headers could not be set. Correlation of requests may be lost.",e)}}r.request.on&&(r.request.on("response",(function(e){i.onResponse(e);var s=i.getDependencyTelemetry(r,n);s.contextObjects=s.contextObjects||{},s.contextObjects["http.RequestOptions"]=r.options,s.contextObjects["http.ClientRequest"]=r.request,s.contextObjects["http.ClientResponse"]=e,t.trackDependency(s)})),r.request.on("error",(function(e){i.onError(e);var s=i.getDependencyTelemetry(r,n);s.contextObjects=s.contextObjects||{},s.contextObjects["http.RequestOptions"]=r.options,s.contextObjects["http.ClientRequest"]=r.request,s.contextObjects.Error=e,t.trackDependency(s)})),r.request.on("abort",(function(){i.onError(new Error);var e=i.getDependencyTelemetry(r,n);e.contextObjects=e.contextObjects||{},e.contextObjects["http.RequestOptions"]=r.options,e.contextObjects["http.ClientRequest"]=r.request,t.trackDependency(e)})))}else o.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!t)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.disableCollectionRequestOption="disableAppInsightsAutoCollection",e.requestNumber=1,e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();t.exports=f})),Bn=y(((e,t)=>{"use strict";var n=r(2037),s=En(),i=Zt(),o=Rn(),a=Ln(),c=function(){function e(t){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t}return e.prototype.enable=function(e,t){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._handle=setInterval((function(){return r.trackHeartBeat(t,(function(){}))}),this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackHeartBeat=function(e,t){var r=this,i=!1,a={},c=o.sdkVersion;a.sdk=c,a.osType=n.type(),process.env.WEBSITE_SITE_NAME?(a.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",a.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",a.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?a.azfunction_appId=process.env.WEBSITE_HOSTNAME:e&&(void 0===this._isVM?(i=!0,this._getAzureComputeMetadata(e,(function(){r._isVM&&Object.keys(r._vmData).length>0&&(a.azInst_vmId=r._vmData.vmId||"",a.azInst_subscriptionId=r._vmData.subscriptionId||"",a.azInst_osType=r._vmData.osType||"",r._azInst_vmId=r._vmData.vmId||"",r._azInst_subscriptionId=r._vmData.subscriptionId||"",r._azInst_osType=r._vmData.osType||""),r._client.trackMetric({name:s.HeartBeatMetricName,value:0,properties:a}),t()}))):this._isVM&&(a.azInst_vmId=this._azInst_vmId,a.azInst_subscriptionId=this._azInst_subscriptionId,a.azInst_osType=this._azInst_osType)),i||(this._client.trackMetric({name:s.HeartBeatMetricName,value:0,properties:a}),t())},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.prototype._getAzureComputeMetadata=function(e,t){var r,n=this,s=((r={method:"GET"})[a.disableCollectionRequestOption]=!0,r.headers={Metadata:"True"},r),o=i.makeRequest(e,"http://169.254.169.254/metadata/instance/compute?api-version=2017-12-01&format=json",s,(function(e){if(200===e.statusCode){n._isVM=!0;var r="";e.on("data",(function(e){r+=e})),e.on("end",(function(){n._vmData=n._isJSON(r)?JSON.parse(r):{},t()}))}else t()}));o&&(o.on("error",(function(e){e&&e.message&&e.message.indexOf("ENETUNREACH")>-1&&(n._isVM=!1),t()})),o.end())},e.prototype._isJSON=function(e){try{return JSON.parse(e)&&!!e}catch{return!1}},e}();t.exports=c})),qn=y(((e,t)=>{"use strict";var n=r(3685),s=r(5687),i=S(),o=Zt(),a=Jt(),c=Gr(),l=yn(),u=Tn(),h=function(){function e(t){if(e.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(e){this._isEnabled=e,(this._isAutoCorrelating||this._isEnabled||u.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},e.prototype.useAutoCorrelation=function(e,t){e&&!this._isAutoCorrelating?l.CorrelationContextManager.enable(t):!e&&this._isAutoCorrelating&&l.CorrelationContextManager.disable(),this._isAutoCorrelating=e},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},e.prototype._generateCorrelationContext=function(e){if(this._isAutoCorrelating)return l.CorrelationContextManager.generateContextObject(e.getOperationId(this._client.context.tags),e.getRequestId(),e.getOperationName(this._client.context.tags),e.getCorrelationContextHeader(),e.getTraceparent(),e.getTracestate())},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=function(r){if(r){if("function"!=typeof r)throw new Error("onRequest handler must be a function");return function(n,s){l.CorrelationContextManager.wrapEmitter(n),l.CorrelationContextManager.wrapEmitter(s);var i=n&&!n[e.alreadyAutoCollectedFlag];if(n&&i){var o=new c(n),a=t._generateCorrelationContext(o);l.CorrelationContextManager.runWithContext(a,(function(){t._isEnabled&&(n[e.alreadyAutoCollectedFlag]=!0,e.trackRequest(t._client,{request:n,response:s},o)),"function"==typeof r&&r(n,s)}))}else"function"==typeof r&&r(n,s)}}},i=function(e){var t=e.addListener.bind(e);e.addListener=function(e,n){switch(e){case"request":case"checkContinue":return t(e,r(n));default:return t(e,n)}},e.on=e.addListener},o=n.createServer;n.createServer=function(e,t){if(t&&"function"==typeof t){var n=o(e,r(t));return i(n),n}return n=o(r(e)),i(n),n};var a=s.createServer;s.createServer=function(e,t){var n=a(e,r(t));return i(n),n}},e.trackRequestSync=function(t,r){if(r.request&&r.response&&t){e.addResponseCorrelationIdHeader(t,r.response);var n=l.CorrelationContextManager.getCurrentContext(),s=new c(r.request,n&&n.operation.parentId);n&&(n.operation.id=s.getOperationId(t.context.tags)||n.operation.id,n.operation.name=s.getOperationName(t.context.tags)||n.operation.name,n.operation.parentId=s.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(s.getCorrelationContextHeader())),e.endRequest(t,s,r,r.duration,r.error)}else i.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!t)},e.trackRequest=function(t,r,n){if(r.request&&r.response&&t){var s=l.CorrelationContextManager.getCurrentContext(),a=n||new c(r.request,s&&s.operation.parentId);o.canIncludeCorrelationHeader(t,a.getUrl())&&e.addResponseCorrelationIdHeader(t,r.response),s&&!n&&(s.operation.id=a.getOperationId(t.context.tags)||s.operation.id,s.operation.name=a.getOperationName(t.context.tags)||s.operation.name,s.operation.parentId=a.getOperationParentId(t.context.tags)||s.operation.parentId,s.customProperties.addHeaderData(a.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",(function(){e.endRequest(t,a,r,null,null)})),r.request.on&&r.request.on("error",(function(n){e.endRequest(t,a,r,null,n)})),r.request.on&&r.request.on("aborted",(function(){e.endRequest(t,a,r,null,"The request has been aborted and the network socket has closed.")}))}else i.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!t)},e.addResponseCorrelationIdHeader=function(e,t){if(e.config&&e.config.correlationId&&t.getHeader&&t.setHeader&&!t.headersSent){var r=t.getHeader(a.requestContextHeader);o.safeIncludeCorrelationHeader(e,t,r)}},e.endRequest=function(e,t,r,n,s){s?t.onError(s,n):t.onResponse(r.response,n);var i=t.getRequestTelemetry(r);if(i.tagOverrides=t.getRequestTags(e.context.tags),r.tagOverrides)for(var o in r.tagOverrides)i.tagOverrides[o]=r.tagOverrides[o];var a=t.getLegacyRootId();a&&(i.properties.ai_legacyRootId=a),i.contextObjects=i.contextObjects||{},i.contextObjects["http.ServerRequest"]=r.request,i.contextObjects["http.ServerResponse"]=r.response,e.trackRequest(i)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1,l.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();t.exports=h})),jn=y(((e,t)=>{"use strict";var n=e&&e.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},n.apply(this,arguments)},s=r(2037),i=zr(),o=En(),a=Zt(),c=S(),l=a.w3cTraceId(),u=function(){function e(){}return e.createQuickPulseEnvelope=function(e,t,r,n){var i=s&&"function"==typeof s.hostname&&s.hostname()||"Unknown",o=n.tags&&n.keys&&n.keys.cloudRoleInstance&&n.tags[n.keys.cloudRoleInstance]||i,a=n.tags&&n.keys&&n.keys.cloudRole&&n.tags[n.keys.cloudRole]||null;return{Documents:t.length>0?t:null,InstrumentationKey:r.instrumentationKey||"",Metrics:e.length>0?e:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:n.tags[n.keys.internalSdkVersion],StreamId:l,MachineName:i,Instance:o,RoleName:a}},e.createQuickPulseMetric=function(e){return{Name:e.name,Value:e.value,Weight:e.count||1}},e.telemetryEnvelopeToQuickPulseDocument=function(t){switch(t.data.baseType){case i.TelemetryTypeString.Event:return e.createQuickPulseEventDocument(t);case i.TelemetryTypeString.Exception:return e.createQuickPulseExceptionDocument(t);case i.TelemetryTypeString.Trace:return e.createQuickPulseTraceDocument(t);case i.TelemetryTypeString.Dependency:return e.createQuickPulseDependencyDocument(t);case i.TelemetryTypeString.Request:return e.createQuickPulseRequestDocument(t)}return null},e.createQuickPulseEventDocument=function(t){var r=e.createQuickPulseDocument(t),s=t.data.baseData.name;return n(n({},r),{Name:s})},e.createQuickPulseTraceDocument=function(t){var r=e.createQuickPulseDocument(t),s=t.data.baseData.severityLevel||0;return n(n({},r),{Message:t.data.baseData.message,SeverityLevel:i.SeverityLevel[s]})},e.createQuickPulseExceptionDocument=function(t){var r=e.createQuickPulseDocument(t),s=t.data.baseData.exceptions,i="",o="",a="";return s&&s.length>0&&(s[0].parsedStack&&s[0].parsedStack.length>0?s[0].parsedStack.forEach((function(e){i+=e.assembly+"\n"})):s[0].stack&&s[0].stack.length>0&&(i=s[0].stack),o=s[0].message,a=s[0].typeName),n(n({},r),{Exception:i,ExceptionMessage:o,ExceptionType:a})},e.createQuickPulseRequestDocument=function(t){var r=e.createQuickPulseDocument(t),s=t.data.baseData;return n(n({},r),{Name:s.name,Success:s.success,Duration:s.duration,ResponseCode:s.responseCode,OperationName:s.name})},e.createQuickPulseDependencyDocument=function(t){var r=e.createQuickPulseDocument(t),s=t.data.baseData;return n(n({},r),{Name:s.name,Target:s.target,Success:s.success,Duration:s.duration,ResultCode:s.resultCode,CommandName:s.data,OperationName:r.OperationId,DependencyTypeName:s.type})},e.createQuickPulseDocument=function(t){var r,n;return t.data.baseType?(n=o.TelemetryTypeStringToQuickPulseType[t.data.baseType],r=o.TelemetryTypeStringToQuickPulseDocumentType[t.data.baseType]):c.warn("Document type invalid; not sending live metric document",t.data.baseType),{DocumentType:r,__type:n,OperationId:t.tags[e.keys.operationId],Version:"1.0",Properties:e.aggregateProperties(t)}},e.aggregateProperties=function(e){var t=[],r=e.data.baseData.measurements||{};for(var n in r)if(r.hasOwnProperty(n)){var s={key:n,value:r[n]};t.push(s)}var i=e.data.baseData.properties||{};for(var n in i)i.hasOwnProperty(n)&&(s={key:n,value:i[n]},t.push(s));return t},e.keys=new i.ContextTagKeys,e}();t.exports=u})),Fn=y(((e,t)=>{"use strict";t.exports={getTransmissionTime:function(){return 1e4*(Date.now()+621355968e5)}}})),Un=y(((e,t)=>{"use strict";var n=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=e&&e.__generator||function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=r(5687),o=Ln(),a=S(),c=Fn(),l=Zt(),u="x-ms-qps-service-polling-interval-hint",h="x-ms-qps-service-endpoint-redirect",d=function(){function e(e){this._config=e,this._consecutiveErrors=0}return e.prototype.ping=function(e,t,r){var n=[{name:"x-ms-qps-stream-id",value:e.StreamId},{name:"x-ms-qps-machine-name",value:e.MachineName},{name:"x-ms-qps-role-name",value:e.RoleName},{name:"x-ms-qps-instance-name",value:e.Instance},{name:"x-ms-qps-invariant-version",value:e.InvariantVersion.toString()}];this._submitData(e,t,r,"ping",n)},e.prototype.post=function(e,t,r){return n(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this._submitData([e],t,r,"post")];case 1:return n.sent(),[2]}}))}))},e.prototype._submitData=function(e,t,r,a,d){return n(this,void 0,void 0,(function(){var n,p,f,g,m,y=this;return s(this,(function(s){return n=JSON.stringify(e),(g={})[o.disableCollectionRequestOption]=!0,g.host=t&&t.length>0?t:this._config.quickPulseHost,g.method="POST",g.path="/QuickPulseService.svc/"+a+"?ikey="+this._config.instrumentationKey,g.headers=((m={Expect:"100-continue"})["x-ms-qps-transmission-time"]=c.getTransmissionTime(),m["Content-Type"]="application/json",m["Content-Length"]=Buffer.byteLength(n),m),p=g,d&&d.length>0&&d.forEach((function(e){return p.headers[e.name]=e.value})),this._config.httpsAgent?p.agent=this._config.httpsAgent:p.agent=l.tlsRestrictedAgent,(f=i.request(p,(function(e){if(200==e.statusCode){var t="true"===e.headers["x-ms-qps-subscribed"],n=e.headers[h]?e.headers[h].toString():null,s=e.headers[u]?parseInt(e.headers[u].toString()):null;y._consecutiveErrors=0,r(t,e,n,s)}else y._onError("StatusCode:"+e.statusCode+" StatusMessage:"+e.statusMessage),r()}))).on("error",(function(e){y._onError(e),r()})),f.write(n),f.end(),[2]}))}))},e.prototype._onError=function(t){this._consecutiveErrors++;var r="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%e.MAX_QPS_FAILURES_BEFORE_WARN==0?(r="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",a.warn(e.TAG,r,t)):a.info(e.TAG,r,t)},e.TAG="QuickPulseSender",e.MAX_QPS_FAILURES_BEFORE_WARN=25,e}();t.exports=d})),$n=y(((e,t)=>{"use strict";var r=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))},n=e&&e.__generator||function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},s=S(),i=jn(),o=Un(),a=En(),c=Rn(),l=function(){function e(e,t){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=e,this.context=t||new c,this._sender=new o(this.config),this._isEnabled=!1}return e.prototype.addCollector=function(e){this._collectors.push(e)},e.prototype.trackMetric=function(e){this._addMetric(e)},e.prototype.addDocument=function(e){var t=i.telemetryEnvelopeToQuickPulseDocument(e);t&&this._documents.push(t)},e.prototype.enable=function(e){e&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!e&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},e.prototype.enableCollectors=function(e){this._collectors.forEach((function(t){t.enable(e)}))},e.prototype._addMetric=function(e){var t=e.value,r=e.count||1,n=a.PerformanceToQuickPulseCounter[e.name];n&&(this._metrics[n]?(this._metrics[n].Value=(this._metrics[n].Value*this._metrics[n].Weight+t*r)/(this._metrics[n].Weight+r),this._metrics[n].Weight+=r):(this._metrics[n]=i.createQuickPulseMetric(e),this._metrics[n].Name=n,this._metrics[n].Weight=1))},e.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},e.prototype._goQuickPulse=function(){return r(this,void 0,void 0,(function(){var t,r,s,o,a=this;return n(this,(function(n){switch(n.label){case 0:return t=Object.keys(this._metrics).map((function(e){return a._metrics[e]})),r=i.createQuickPulseEnvelope(t,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(r)]:[3,2];case 1:return n.sent(),[3,3];case 2:this._ping(r),n.label=3;case 3:return s=this._pollingIntervalHint>0?this._pollingIntervalHint:e.PING_INTERVAL,o=this._isCollectingData?e.POST_INTERVAL:s,this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,o=e.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(o=e.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),o),this._handle.unref(),[2]}}))}))},e.prototype._ping=function(e){this._sender.ping(e,this._redirectedHost,this._quickPulseDone.bind(this))},e.prototype._post=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this._sender.post(e,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return t.sent(),[2]}}))}))},e.prototype._quickPulseDone=function(e,t,r,n){null!=e?(this._isCollectingData!==e&&(s.info("Live Metrics sending data",e),this.enableCollectors(e)),this._isCollectingData=e,r&&r.length>0&&(this._redirectedHost=r,s.info("Redirecting endpoint to: ",r)),n&&n>0&&(this._pollingIntervalHint=n),t&&t.statusCode<300&&t.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},e.MAX_POST_WAIT_TIME=2e4,e.MAX_PING_WAIT_TIME=6e4,e.FALLBACK_INTERVAL=6e4,e.PING_INTERVAL=5e3,e.POST_INTERVAL=1e3,e}();t.exports=l})),Hn=y(((e,t)=>{"use strict";var r=En(),n=function(){function e(){}return e.parse=function(t){if(!t)return{};var n=t.split(e._FIELDS_SEPARATOR).reduce((function(t,r){var n=r.split(e._FIELD_KEY_VALUE_SEPARATOR);if(2===n.length){var s=n[0].toLowerCase(),i=n[1];t[s]=i}return t}),{});if(Object.keys(n).length>0){if(n.endpointsuffix){var s=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+s+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+s+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||r.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||r.DEFAULT_LIVEMETRICS_ENDPOINT}return n},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}();t.exports=n})),Kn=y(((e,t)=>{"use strict";var n=er(),s=Hn(),i=(S(),En()),o=r(7310),a=function(){function e(t){var r=this;this.endpointBase=i.DEFAULT_BREEZE_ENDPOINT;var n=process.env[e.ENV_connectionString],a=s.parse(t),c=s.parse(n),l=!a.instrumentationkey&&Object.keys(a).length>0?null:t;this.instrumentationKey=a.instrumentationkey||l||c.instrumentationkey||e._getInstrumentationKey(),e._validateInstrumentationKey(this.instrumentationKey),this.endpointUrl=(a.ingestionendpoint||c.ingestionendpoint||this.endpointBase)+"/v2.1/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=3e4,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(e){return r.correlationId=e},this.proxyHttpUrl=process.env[e.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[e.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=a.ingestionendpoint||c.ingestionendpoint||process.env[e.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=a.liveendpoint||c.liveendpoint||process.env[e.ENV_quickPulseHost]||i.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=o.parse(this._quickPulseHost).host)}return Object.defineProperty(e.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(e){n.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=e,this.correlationId=n.correlationIdPrefix,n.queryCorrelationId(this,this.setCorrelationId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(e){this._quickPulseHost=e},enumerable:!1,configurable:!0}),e._getInstrumentationKey=function(){var t=process.env[e.ENV_iKey]||process.env[e.ENV_azurePrefix+e.ENV_iKey]||process.env[e.legacy_ENV_iKey]||process.env[e.ENV_azurePrefix+e.legacy_ENV_iKey];if(!t||""==t)throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return t},e._validateInstrumentationKey=function(e){return new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e)},e.ENV_azurePrefix="APPSETTING_",e.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",e.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",e.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",e.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",e.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",e.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",e.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",e.ENV_http_proxy="http_proxy",e.ENV_https_proxy="https_proxy",e}();t.exports=a})),Vn=y((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.AutoCollectNativePerformance=void 0;var n=Kn(),s=Rn(),i=S(),o=function(){function e(t){this._disabledMetrics={},e.INSTANCE&&e.INSTANCE.dispose(),e.INSTANCE=this,this._client=t}return e.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>=6},e.prototype.enable=function(t,n,s){var o=this;if(void 0===n&&(n={}),void 0===s&&(s=6e4),e.isNodeVersionCompatible()){if(null==e._metricsAvailable&&t&&!this._isInitialized)try{var a=r(Object(function(){var e=new Error("Cannot find module 'applicationinsights-native-metrics'");throw e.code="MODULE_NOT_FOUND",e}()));e._emitter=new a,e._metricsAvailable=!0,i.info("Native metrics module successfully loaded!")}catch{return void(e._metricsAvailable=!1)}this._isEnabled=t,this._disabledMetrics=n,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&e._emitter?(e._emitter.enable(!0,s),this._handle||(this._handle=setInterval((function(){return o._trackNativeMetrics()}),s),this._handle.unref())):e._emitter&&(e._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},e.prototype.dispose=function(){this.enable(!1)},e.parseEnabled=function(e){var r=process.env[n.ENV_nativeMetricsDisableAll],s=process.env[n.ENV_nativeMetricsDisablers];if(r)return{isEnabled:!1,disabledMetrics:{}};if(s){var i=s.split(","),o={};if(i.length>0)for(var a=0,c=i;a<c.length;a++)o[c[a]]=!0;return"object"==typeof e?{isEnabled:!0,disabledMetrics:t(t({},e),o)}:{isEnabled:e,disabledMetrics:o}}return"boolean"==typeof e?{isEnabled:e,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:e}},e.prototype._trackNativeMetrics=function(){var e=!0;"object"!=typeof this._isEnabled&&(e=this._isEnabled),e&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},e.prototype._trackGarbageCollection=function(){var t;if(!this._disabledMetrics.gc){var r=e._emitter.getGCData();for(var n in r){var i=r[n].metrics,o=n+" Garbage Collection Duration",a=Math.sqrt(i.sumSquares/i.count-Math.pow(i.total/i.count,2))||0;this._client.trackMetric({name:o,value:i.total,count:i.count,max:i.max,min:i.min,stdDev:a,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+s.sdkVersion,t)})}}},e.prototype._trackEventLoop=function(){var t;if(!this._disabledMetrics.loop){var r=e._emitter.getLoopData().loopUsage;if(0!=r.count){var n=Math.sqrt(r.sumSquares/r.count-Math.pow(r.total/r.count,2))||0;this._client.trackMetric({name:"Event Loop CPU Time",value:r.total,count:r.count,min:r.min,max:r.max,stdDev:n,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+s.sdkVersion,t)})}}},e.prototype._trackHeapUsage=function(){var e,t,r;if(!this._disabledMetrics.heap){var n=process.memoryUsage(),i=n.heapUsed,o=n.heapTotal,a=n.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:i,count:1,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+s.sdkVersion,e)}),this._client.trackMetric({name:"Memory Total (Heap)",value:o,count:1,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+s.sdkVersion,t)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:a-o,count:1,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+s.sdkVersion,r)})}},e}();e.AutoCollectNativePerformance=o})),zn=y(((e,t)=>{"use strict";var r=S(),n=function(){function e(e,t,r,n){this._buffer=[],this._lastSend=0,this._isDisabled=e,this._getBatchSize=t,this._getBatchIntervalMs=r,this._sender=n}return e.prototype.setUseDiskRetryCaching=function(e,t,r){this._sender.setDiskRetryMode(e,t,r)},e.prototype.send=function(e){var t=this;if(!this._isDisabled()){if(!e)return void r.warn("Cannot send null/undefined telemetry");if(this._buffer.push(e),this._buffer.length>=this._getBatchSize())return void this.triggerSend(!1);!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout((function(){t._timeoutHandle=null,t.triggerSend(!1)}),this._getBatchIntervalMs()))}},e.prototype.triggerSend=function(e,t){var r=this._buffer.length<1;r||(e?(this._sender.saveOnCrash(this._buffer),"function"==typeof t&&t("data saved on crash")):this._sender.send(this._buffer,t)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,r&&"function"==typeof t&&t("no data to send")},e}();t.exports=n})),Wn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.azureRoleEnvironmentTelemetryProcessor=void 0,e.azureRoleEnvironmentTelemetryProcessor=function(e,t){process.env.WEBSITE_SITE_NAME&&(e.tags[t.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}})),Gn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSamplingHashCode=e.samplingTelemetryProcessor=void 0;var t=zr();function r(e){var t=2147483647,r=5381;if(!e)return 0;for(;e.length<8;)e+=e;for(var n=0;n<e.length;n++)r=((r<<5)+r|0)+e.charCodeAt(n)|0;return(r=r<=-2147483648?t:Math.abs(r))/t*100}e.samplingTelemetryProcessor=function(e,n){var s=e.sampleRate;return!!(null==s||s>=100||e.data&&t.TelemetryType.Metric===t.baseTypeToTelemetryType(e.data.baseType))||(n.correlationContext&&n.correlationContext.operation?r(n.correlationContext.operation.id)<s:100*Math.random()<s)},e.getSamplingHashCode=r})),Yn=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.performanceMetricsTelemetryProcessor=void 0;var t=Tn(),r=zr();e.performanceMetricsTelemetryProcessor=function(e,n){switch(n&&n.addDocument(e),e.data.baseType){case r.TelemetryTypeString.Exception:t.countException();break;case r.TelemetryTypeString.Request:var s=e.data.baseData;t.countRequest(s.duration,s.success);break;case r.TelemetryTypeString.Dependency:var i=e.data.baseData;t.countDependency(i.duration,i.success)}return!0}})),Qn=y((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.preAggregatedMetricsTelemetryProcessor=void 0;var r=zr(),n=An(),s=zr();e.preAggregatedMetricsTelemetryProcessor=function(e,i){if(n.isEnabled())switch(e.data.baseType){case s.TelemetryTypeString.Exception:var o=e.data.baseData;o.properties=t(t({},o.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var a={cloudRoleInstance:e.tags[i.keys.cloudRoleInstance],cloudRoleName:e.tags[i.keys.cloudRole]};n.countException(a);break;case s.TelemetryTypeString.Trace:var c=e.data.baseData;c.properties=t(t({},c.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var l={cloudRoleInstance:e.tags[i.keys.cloudRoleInstance],cloudRoleName:e.tags[i.keys.cloudRole],traceSeverityLevel:r.SeverityLevel[c.severity]};n.countTrace(l);break;case s.TelemetryTypeString.Request:var u=e.data.baseData;u.properties=t(t({},u.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var h={cloudRoleInstance:e.tags[i.keys.cloudRoleInstance],cloudRoleName:e.tags[i.keys.cloudRole],operationSynthetic:e.tags[i.keys.operationSyntheticSource],requestSuccess:u.success,requestResultCode:u.responseCode};n.countRequest(u.duration,h);break;case s.TelemetryTypeString.Dependency:var d=e.data.baseData;d.properties=t(t({},d.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var p={cloudRoleInstance:e.tags[i.keys.cloudRoleInstance],cloudRoleName:e.tags[i.keys.cloudRole],operationSynthetic:e.tags[i.keys.operationSyntheticSource],dependencySuccess:d.success,dependencyType:d.type,dependencyTarget:d.target,dependencyResultCode:d.resultCode};n.countDependency(d.duration,p)}return!0}})),Xn=y((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Wn(),e),r(Gn(),e),r(Yn(),e),r(Qn(),e)})),Jn=y(((e,t)=>{"use strict";var n=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=e&&e.__generator||function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=r(7147),o=r(2037),a=r(1017),c=r(9796),l=r(2081),u=S(),h=Ln(),d=Zt(),p=function(){function e(t,r,n){if(this._redirectedHost=null,this._config=t,this._onSuccess=r,this._onError=n,this._enableDiskRetryMode=!1,this._resendInterval=e.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=e.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._fileCleanupTimer=null,this._tempDir=a.join(o.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey),!e.OS_PROVIDES_FILE_PROTECTION)if(e.USE_ICACLS){try{e.OS_PROVIDES_FILE_PROTECTION=i.existsSync(e.ICACLS_PATH)}catch{}e.OS_PROVIDES_FILE_PROTECTION||u.warn(e.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else e.OS_PROVIDES_FILE_PROTECTION=!0}return e.prototype.setDiskRetryMode=function(t,r,n){var s=this;this._enableDiskRetryMode=e.OS_PROVIDES_FILE_PROTECTION&&t,"number"==typeof r&&r>=0&&(this._resendInterval=Math.floor(r)),"number"==typeof n&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),t&&!e.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,u.warn(e.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout((function(){s._fileCleanupTask()}),e.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref()):this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer)},e.prototype.send=function(t,r){return n(this,void 0,void 0,(function(){var n,i,o,a,l=this;return s(this,(function(s){return t&&(n=this._redirectedHost||this._config.endpointUrl,i={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},o="",t.forEach((function(e){var t=l._stringify(e);"string"==typeof t&&(o+=t+"\n")})),o.length>0&&(o=o.substring(0,o.length-1)),a=Buffer.from?Buffer.from(o):new Buffer(o),c.gzip(a,(function(s,o){var c=o;s?(u.warn(s),c=a,i.headers["Content-Length"]=a.length.toString()):(i.headers["Content-Encoding"]="gzip",i.headers["Content-Length"]=o.length.toString()),u.info(e.TAG,i),i[h.disableCollectionRequestOption]=!0;var p=d.makeRequest(l._config,n,i,(function(n){n.setEncoding("utf-8");var s="";n.on("data",(function(e){s+=e})),n.on("end",(function(){if(l._numConsecutiveFailures=0,l._enableDiskRetryMode)if(200===n.statusCode)l._resendTimer||(l._resendTimer=setTimeout((function(){l._resendTimer=null,l._sendFirstFileOnDisk()}),l._resendInterval),l._resendTimer.unref());else if(l._isRetriable(n.statusCode))try{var i=JSON.parse(s),o=[];i.errors.forEach((function(e){l._isRetriable(e.statusCode)&&o.push(t[e.index])})),o.length>0&&l._storeToDisk(o)}catch{l._storeToDisk(t)}if(307===n.statusCode||308===n.statusCode)if(l._numConsecutiveRedirects++,l._numConsecutiveRedirects<10){var a=n.headers.location?n.headers.location.toString():null;a&&(l._redirectedHost=a,l.send(t,r))}else"function"==typeof r&&r("Error sending telemetry because of circular redirects.");else l._numConsecutiveRedirects=0,"function"==typeof r&&r(s),u.info(e.TAG,s),"function"==typeof l._onSuccess&&l._onSuccess(s)}))}));p.on("error",(function(n){if(l._numConsecutiveFailures++,!l._enableDiskRetryMode||l._numConsecutiveFailures>0&&l._numConsecutiveFailures%e.MAX_CONNECTION_FAILURES_BEFORE_WARN==0){var s="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";l._enableDiskRetryMode&&(s="Ingestion endpoint could not be reached "+l._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),u.warn(e.TAG,s,d.dumpObj(n))}else s="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:",u.info(e.TAG,s,d.dumpObj(n));l._onErrorHelper(n),"function"==typeof r&&(n&&r(d.dumpObj(n)),r("Error sending telemetry")),l._enableDiskRetryMode&&l._storeToDisk(t)})),p.write(c),p.end()}))),[2]}))}))},e.prototype.saveOnCrash=function(e){this._enableDiskRetryMode&&this._storeToDiskSync(this._stringify(e))},e.prototype._isRetriable=function(e){return 206===e||408===e||429===e||439===e||500===e||503===e},e.prototype._runICACLS=function(t,r){var n=l.spawn(e.ICACLS_PATH,t,{windowsHide:!0});n.on("error",(function(e){return r(e)})),n.on("close",(function(e,t){return r(0===e?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+e+")"))}))},e.prototype._runICACLSSync=function(t){if(!l.spawnSync)throw new Error("Could not synchronously call ICACLS under current version of Node.js");var r=l.spawnSync(e.ICACLS_PATH,t,{windowsHide:!0});if(r.error)throw r.error;if(0!==r.status)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")},e.prototype._getACLIdentity=function(t){if(e.ACL_IDENTITY)return t(null,e.ACL_IDENTITY);var r=l.spawn(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",(function(e){return n+=e})),r.on("error",(function(e){return t(e,null)})),r.on("close",(function(r,s){return e.ACL_IDENTITY=n&&n.trim(),t(0===r?null:new Error("Getting ACL identity did not succeed (PS returned code "+r+")"),e.ACL_IDENTITY)}))},e.prototype._getACLIdentitySync=function(){if(e.ACL_IDENTITY)return e.ACL_IDENTITY;if(l.spawnSync){var t=l.spawnSync(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(t.error)throw t.error;if(0!==t.status)throw new Error("Getting ACL identity did not succeed (PS returned code "+t.status+")");return e.ACL_IDENTITY=t.stdout&&t.stdout.toString().trim(),e.ACL_IDENTITY}throw new Error("Could not synchronously get ACL identity under current version of Node.js")},e.prototype._getACLArguments=function(e,t){return[e,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",t+":(OI)(CI)F","/inheritance:r"]},e.prototype._applyACLRules=function(t,r){var n=this;return e.USE_ICACLS?void 0!==e.ACLED_DIRECTORIES[t]?r(e.ACLED_DIRECTORIES[t]?null:new Error("Setting ACL restrictions did not succeed (cached result)")):(e.ACLED_DIRECTORIES[t]=!1,void this._getACLIdentity((function(s,i){if(s)return e.ACLED_DIRECTORIES[t]=!1,r(s);n._runICACLS(n._getACLArguments(t,i),(function(n){return e.ACLED_DIRECTORIES[t]=!n,r(n)}))}))):r(null)},e.prototype._applyACLRulesSync=function(t){if(e.USE_ICACLS){if(void 0===e.ACLED_DIRECTORIES[t])return this._runICACLSSync(this._getACLArguments(t,this._getACLIdentitySync())),void(e.ACLED_DIRECTORIES[t]=!0);if(!e.ACLED_DIRECTORIES[t])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},e.prototype._confirmDirExists=function(e,t){var r=this;i.lstat(e,(function(n,s){n&&"ENOENT"===n.code?i.mkdir(e,(function(n){n&&"EEXIST"!==n.code?t(n):r._applyACLRules(e,t)})):!n&&s.isDirectory()?r._applyACLRules(e,t):t(n||new Error("Path existed but was not a directory"))}))},e.prototype._getShallowDirectorySize=function(e,t){i.readdir(e,(function(r,n){if(r)return t(r,-1);var s=null,o=0,c=0;if(0!==n.length)for(var l=0;l<n.length;l++)i.stat(a.join(e,n[l]),(function(e,r){c++,e?s=e:r.isFile()&&(o+=r.size),c===n.length&&t(s,s?-1:o)}));else t(null,0)}))},e.prototype._getShallowDirectorySizeSync=function(e){for(var t=i.readdirSync(e),r=0,n=0;n<t.length;n++)r+=i.statSync(a.join(e,t[n])).size;return r},e.prototype._storeToDisk=function(t){var r=this;u.info(e.TAG,"Checking existence of data storage directory: "+this._tempDir),this._confirmDirExists(this._tempDir,(function(n){if(n)return u.warn(e.TAG,"Error while checking/creating directory: "+(n&&n.message)),void r._onErrorHelper(n);r._getShallowDirectorySize(r._tempDir,(function(n,s){if(n||s<0)return u.warn(e.TAG,"Error while checking directory size: "+(n&&n.message)),void r._onErrorHelper(n);if(s>r._maxBytesOnDisk)u.warn(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+s);else{var o=(new Date).getTime()+".ai.json",c=a.join(r._tempDir,o);u.info(e.TAG,"saving data to disk at: "+c),i.writeFile(c,r._stringify(t),{mode:384},(function(e){return r._onErrorHelper(e)}))}}))}))},e.prototype._storeToDiskSync=function(t){try{u.info(e.TAG,"Checking existence of data storage directory: "+this._tempDir),i.existsSync(this._tempDir)||i.mkdirSync(this._tempDir),this._applyACLRulesSync(this._tempDir);var r=this._getShallowDirectorySizeSync(this._tempDir);if(r>this._maxBytesOnDisk)return void u.info(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+r);var n=(new Date).getTime()+".ai.json",s=a.join(this._tempDir,n);u.info(e.TAG,"saving data before crash to disk at: "+s),i.writeFileSync(s,t,{mode:384})}catch(t){u.warn(e.TAG,"Error while saving data to disk: "+(t&&t.message)),this._onErrorHelper(t)}},e.prototype._sendFirstFileOnDisk=function(){var e=this;i.exists(this._tempDir,(function(t){t&&i.readdir(e._tempDir,(function(t,r){if(t)e._onErrorHelper(t);else if((r=r.filter((function(e){return a.basename(e).indexOf(".ai.json")>-1}))).length>0){var n=r[0],s=a.join(e._tempDir,n);i.readFile(s,(function(t,r){t?e._onErrorHelper(t):i.unlink(s,(function(t){if(t)e._onErrorHelper(t);else try{var n=JSON.parse(r.toString());e.send(n)}catch(e){u.warn("Failed to read persisted file",e)}}))}))}}))}))},e.prototype._onErrorHelper=function(e){"function"==typeof this._onError&&this._onError(e)},e.prototype._stringify=function(e){try{return JSON.stringify(e)}catch(t){u.warn("Failed to serialize payload",t,e)}},e.prototype._fileCleanupTask=function(){var t=this;i.exists(this._tempDir,(function(r){r&&i.readdir(t._tempDir,(function(r,n){r?t._onErrorHelper(r):(n=n.filter((function(e){return a.basename(e).indexOf(".ai.json")>-1}))).length>0&&n.forEach((function(r){var n=new Date(parseInt(r.split(".ai.json")[0]));if(new Date(+new Date-e.FILE_RETEMPTION_PERIOD)>n){var s=a.join(t._tempDir,r);i.unlink(s,(function(e){e&&t._onErrorHelper(e)}))}}))}))}))},e.TAG="Sender",e.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",e.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",e.ACLED_DIRECTORIES={},e.ACL_IDENTITY=null,e.WAIT_BETWEEN_RESEND=6e4,e.MAX_BYTES_ON_DISK=52428800,e.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,e.CLEANUP_TIMEOUT=36e5,e.FILE_RETEMPTION_PERIOD=6048e5,e.TEMPDIR_PREFIX="appInsights-node",e.OS_PROVIDES_FILE_PROTECTION=!1,e.USE_ICACLS="Windows_NT"===o.type(),e}();t.exports=p})),Zn=y(((e,t)=>{"use strict";var r=zr(),n=Zt(),s=yn(),i=function(){function e(){}return e.createEnvelope=function(t,s,i,o,a){var c=null;switch(s){case r.TelemetryType.Trace:c=e.createTraceData(t);break;case r.TelemetryType.Dependency:c=e.createDependencyData(t);break;case r.TelemetryType.Event:c=e.createEventData(t);break;case r.TelemetryType.Exception:c=e.createExceptionData(t);break;case r.TelemetryType.Request:c=e.createRequestData(t);break;case r.TelemetryType.Metric:c=e.createMetricData(t);break;case r.TelemetryType.Availability:c=e.createAvailabilityData(t);break;case r.TelemetryType.PageView:c=e.createPageViewData(t)}if(i&&r.domainSupportsProperties(c.baseData)){if(c&&c.baseData)if(c.baseData.properties)for(var l in i)c.baseData.properties[l]||(c.baseData.properties[l]=i[l]);else c.baseData.properties=i;c.baseData.properties=n.validateStringMap(c.baseData.properties)}var u=a&&a.instrumentationKey||"",h=new r.Envelope;return h.data=c,h.iKey=u,h.name="Microsoft.ApplicationInsights."+u.replace(/-/g,"")+"."+c.baseType.substr(0,c.baseType.length-4),h.tags=this.getTags(o,t.tagOverrides),h.time=(new Date).toISOString(),h.ver=1,h.sampleRate=a?a.samplingPercentage:100,s===r.TelemetryType.Metric&&(h.sampleRate=100),h},e.createTraceData=function(e){var t=new r.MessageData;t.message=e.message,t.properties=e.properties,isNaN(e.severity)?t.severityLevel=r.SeverityLevel.Information:t.severityLevel=e.severity;var n=new r.Data;return n.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Trace),n.baseData=t,n},e.createDependencyData=function(e){var t=new r.RemoteDependencyData;"string"==typeof e.name&&(t.name=e.name.length>1024?e.name.slice(0,1021)+"...":e.name),t.data=e.data,t.target=e.target,t.duration=n.msToTimeSpan(e.duration),t.success=e.success,t.type=e.dependencyTypeName,t.properties=e.properties,t.resultCode=e.resultCode?e.resultCode+"":"",e.id?t.id=e.id:t.id=n.w3cTraceId();var s=new r.Data;return s.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Dependency),s.baseData=t,s},e.createEventData=function(e){var t=new r.EventData;t.name=e.name,t.properties=e.properties,t.measurements=e.measurements;var n=new r.Data;return n.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Event),n.baseData=t,n},e.createExceptionData=function(e){var t=new r.ExceptionData;t.properties=e.properties,isNaN(e.severity)?t.severityLevel=r.SeverityLevel.Error:t.severityLevel=e.severity,t.measurements=e.measurements,t.exceptions=[];var s=e.exception.stack,i=new r.ExceptionDetails;i.message=e.exception.message,i.typeName=e.exception.name,i.parsedStack=this.parseStack(s),i.hasFullStack=n.isArray(i.parsedStack)&&i.parsedStack.length>0,t.exceptions.push(i);var o=new r.Data;return o.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Exception),o.baseData=t,o},e.createRequestData=function(e){var t=new r.RequestData;e.id?t.id=e.id:t.id=n.w3cTraceId(),t.name=e.name,t.url=e.url,t.source=e.source,t.duration=n.msToTimeSpan(e.duration),t.responseCode=e.resultCode?e.resultCode+"":"",t.success=e.success,t.properties=e.properties;var s=new r.Data;return s.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Request),s.baseData=t,s},e.createMetricData=function(e){var t=new r.MetricData;t.metrics=[];var n=new r.DataPoint;n.count=isNaN(e.count)?1:e.count,n.kind=r.DataPointType.Aggregation,n.max=isNaN(e.max)?e.value:e.max,n.min=isNaN(e.min)?e.value:e.min,n.name=e.name,n.stdDev=isNaN(e.stdDev)?0:e.stdDev,n.value=e.value,t.metrics.push(n),t.properties=e.properties;var s=new r.Data;return s.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Metric),s.baseData=t,s},e.createAvailabilityData=function(e){var t=new r.AvailabilityData;e.id?t.id=e.id:t.id=n.w3cTraceId(),t.name=e.name,t.duration=n.msToTimeSpan(e.duration),t.success=e.success,t.runLocation=e.runLocation,t.message=e.message,t.measurements=e.measurements,t.properties=e.properties;var s=new r.Data;return s.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Availability),s.baseData=t,s},e.createPageViewData=function(e){var t=new r.PageViewData;t.name=e.name,t.duration=n.msToTimeSpan(e.duration),t.url=e.url,t.measurements=e.measurements,t.properties=e.properties;var s=new r.Data;return s.baseType=r.telemetryTypeToBaseType(r.TelemetryType.PageView),s.baseData=t,s},e.getTags=function(e,t){var r=s.CorrelationContextManager.getCurrentContext(),n={};if(e&&e.tags)for(var i in e.tags)n[i]=e.tags[i];if(t)for(var i in t)n[i]=t[i];return r&&(n[e.keys.operationId]=n[e.keys.operationId]||r.operation.id,n[e.keys.operationName]=n[e.keys.operationName]||r.operation.name,n[e.keys.operationParentId]=n[e.keys.operationParentId]||r.operation.parentId),n},e.parseStack=function(e){var t=void 0;if("string"==typeof e){var r=e.split("\n");t=[];for(var n=0,s=0,i=0;i<=r.length;i++){var a=r[i];if(o.regex.test(a)){var c=new o(r[i],n++);s+=c.sizeInBytes,t.push(c)}}if(s>32768)for(var l=0,u=t.length-1,h=0,d=l,p=u;l<u;){if((h+=t[l].sizeInBytes+t[u].sizeInBytes)>32768){var f=p-d+1;t.splice(d,f);break}d=l,p=u,l++,u--}}return t},e}(),o=function(){function e(t,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=n.trim(t);var s=t.match(e.regex);s&&s.length>=5&&(this.method=n.trim(s[2])||this.method,this.fileName=n.trim(s[4])||"<no_filename>",this.line=parseInt(s[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=e.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return e.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,e.baseSize=58,e}();t.exports=i})),es=y(((e,t)=>{"use strict";var n=r(7310),s=Kn(),i=Rn(),o=zr(),a=zn(),c=Xn(),l=yn(),u=Jn(),h=Zt(),d=S(),p=Zn(),f=function(){function e(e){this._telemetryProcessors=[],this._enableAzureProperties=!1;var t=new s(e);this.config=t,this.context=new i,this.commonProperties={};var r=new u(this.config);this.channel=new a((function(){return t.disableAppInsights}),(function(){return t.maxBatchSize}),(function(){return t.maxBatchIntervalMs}),r)}return e.prototype.trackAvailability=function(e){this.track(e,o.TelemetryType.Availability)},e.prototype.trackPageView=function(e){this.track(e,o.TelemetryType.PageView)},e.prototype.trackTrace=function(e){this.track(e,o.TelemetryType.Trace)},e.prototype.trackMetric=function(e){this.track(e,o.TelemetryType.Metric)},e.prototype.trackException=function(e){e&&e.exception&&!h.isError(e.exception)&&(e.exception=new Error(e.exception.toString())),this.track(e,o.TelemetryType.Exception)},e.prototype.trackEvent=function(e){this.track(e,o.TelemetryType.Event)},e.prototype.trackRequest=function(e){this.track(e,o.TelemetryType.Request)},e.prototype.trackDependency=function(e){e&&!e.target&&e.data&&(e.target=n.parse(e.data).host),this.track(e,o.TelemetryType.Dependency)},e.prototype.flush=function(e){this.channel.triggerSend(!!e&&!!e.isAppCrashing,e?e.callback:void 0)},e.prototype.track=function(e,t){if(e&&o.telemetryTypeToBaseType(t)){var r=p.createEnvelope(e,t,this.commonProperties,this.context,this.config);e.time&&(r.time=e.time.toISOString()),this._enableAzureProperties&&c.azureRoleEnvironmentTelemetryProcessor(r,this.context);var n=this.runTelemetryProcessors(r,e.contextObjects);n=n&&c.samplingTelemetryProcessor(r,{correlationContext:l.CorrelationContextManager.getCurrentContext()}),c.preAggregatedMetricsTelemetryProcessor(r,this.context),n&&(c.performanceMetricsTelemetryProcessor(r,this.quickPulseClient),this.channel.send(r))}else d.warn("track() requires telemetry object and telemetryType to be specified.")},e.prototype.setAutoPopulateAzureProperties=function(e){this._enableAzureProperties=e},e.prototype.addTelemetryProcessor=function(e){this._telemetryProcessors.push(e)},e.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},e.prototype.runTelemetryProcessors=function(e,t){var r=!0,n=this._telemetryProcessors.length;if(0===n)return r;(t=t||{}).correlationContext=l.CorrelationContextManager.getCurrentContext();for(var s=0;s<n;++s)try{var i=this._telemetryProcessors[s];if(i&&!1===i.apply(null,[e,t])){r=!1;break}}catch(t){r=!0,d.warn("One of telemetry processors failed, telemetry item will be sent.",t,e)}return r&&(e&&e.tags&&(e.tags=h.validateStringMap(e.tags)),e&&e.data&&e.data.baseData&&e.data.baseData.properties&&(e.data.baseData.properties=h.validateStringMap(e.data.baseData.properties))),r},e}();t.exports=f})),ts=y(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=es(),i=qn(),o=Ln(),a=S(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.trackNodeHttpRequestSync=function(e){e&&e.request&&e.response&&e.duration?i.trackRequestSync(this,e):a.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},t.prototype.trackNodeHttpRequest=function(e){(e.duration||e.error)&&a.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),e&&e.request&&e.response?i.trackRequest(this,e):a.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},t.prototype.trackNodeHttpDependency=function(e){e&&e.request?o.trackRequest(this,e):a.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},t}(s);t.exports=c})),rs=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ns=y((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.Configuration=e.wrapWithCorrelationContext=e.startOperation=e.getCorrelationContext=e.start=e.setup=e.liveMetricsClient=e.defaultClient=e.DistributedTracingModes=void 0;var t,r,n=yn(),s=bn(),i=_n(),o=Tn(),a=An(),c=Bn(),l=Ln(),u=qn(),h=er(),d=S(),p=$n(),f=Vn();e.TelemetryClient=ts(),e.Contracts=zr(),e.azureFunctionsTypes=rs(),(r=t=e.DistributedTracingModes||(e.DistributedTracingModes={}))[r.AI=0]="AI",r[r.AI_AND_W3C=1]="AI_AND_W3C";var g,m,y,v,w,b,_,E,T,C,P,A=!0,R=!1,I=!0,x=!0,O=!0,k=!1,M=!0,N=!0,D=!0,L=!0,B=!1,q=!0,j=void 0,F=void 0,U=!1;function $(){return e.defaultClient?(U=!0,y.enable(A,R),v.enable(I),w.enable(x),b.enable(O),_.enable(k,e.defaultClient.config),E.enable(q,m),T.useAutoCorrelation(L,g),T.enable(M),C.enable(N),e.liveMetricsClient&&B&&e.liveMetricsClient.enable(B)):d.warn("Start cannot be called before setup"),H}e.setup=function(t){return e.defaultClient?d.info("The default client is already setup"):(e.defaultClient=new e.TelemetryClient(t),y=new s(e.defaultClient),v=new i(e.defaultClient),w=new o(e.defaultClient),b=new a(e.defaultClient),_=new c(e.defaultClient),T=new u(e.defaultClient),C=new l(e.defaultClient),E||(E=new f.AutoCollectNativePerformance(e.defaultClient))),e.defaultClient&&e.defaultClient.channel&&e.defaultClient.channel.setUseDiskRetryCaching(D,j,F),H},e.start=$,e.getCorrelationContext=function(){return L?n.CorrelationContextManager.getCurrentContext():null},e.startOperation=function(e,t){return n.CorrelationContextManager.startOperation(e,t)},e.wrapWithCorrelationContext=function(e,t){return n.CorrelationContextManager.wrapCallback(e,t)};var H=function(){function r(){}return r.setDistributedTracingMode=function(e){return h.w3cEnabled=e===t.AI_AND_W3C,r},r.setAutoCollectConsole=function(e,t){return void 0===t&&(t=!1),A=e,R=t,U&&y.enable(e,t),r},r.setAutoCollectExceptions=function(e){return I=e,U&&v.enable(e),r},r.setAutoCollectPerformance=function(e,t){void 0===t&&(t=!0),x=e;var n=f.AutoCollectNativePerformance.parseEnabled(t);return q=n.isEnabled,m=n.disabledMetrics,U&&(w.enable(e),E.enable(n.isEnabled,n.disabledMetrics)),r},r.setAutoCollectPreAggregatedMetrics=function(e){return O=e,U&&b.enable(e),r},r.setAutoCollectHeartbeat=function(t){return k=t,U&&_.enable(t,e.defaultClient.config),r},r.setAutoCollectRequests=function(e){return M=e,U&&T.enable(e),r},r.setAutoCollectDependencies=function(e){return N=e,U&&C.enable(e),r},r.setAutoDependencyCorrelation=function(e,t){return L=e,g=t,U&&T.useAutoCorrelation(e,t),r},r.setUseDiskRetryCaching=function(t,n,s){return D=t,j=n,F=s,e.defaultClient&&e.defaultClient.channel&&e.defaultClient.channel.setUseDiskRetryCaching(t,n,s),r},r.setInternalLogging=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!0),d.enableDebug=e,d.disableWarnings=!t,r},r.setSendLiveMetrics=function(t){return void 0===t&&(t=!1),e.defaultClient?(!e.liveMetricsClient&&t?(e.liveMetricsClient=new p(e.defaultClient.config,null),P=new o(e.liveMetricsClient,1e3,!0),e.liveMetricsClient.addCollector(P),e.defaultClient.quickPulseClient=e.liveMetricsClient):e.liveMetricsClient&&e.liveMetricsClient.enable(t),B=t,r):(d.warn("Live metrics client cannot be setup without the default client"),r)},r.start=$,r}();e.Configuration=H,e.dispose=function(){h.w3cEnabled=!0,e.defaultClient=null,U=!1,y&&y.dispose(),v&&v.dispose(),w&&w.dispose(),b&&b.dispose(),_&&_.dispose(),E&&E.dispose(),T&&T.dispose(),C&&C.dispose(),e.liveMetricsClient&&(e.liveMetricsClient.enable(!1),B=!1,e.liveMetricsClient=void 0)}})),ss={};((e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})})(ss,{default:()=>ls}),e.exports=(n=ss,v(i({},"__esModule",{value:!0}),n));var is=w(r(2037)),os=w(r(9496)),as=w(r(5687)),cs=class{constructor(e){this.vscodeAPI=e}getTelemetryLevel(){try{let e=this.vscodeAPI.env.telemetryConfiguration;return e.isUsageEnabled&&e.isErrorsEnabled&&e.isCrashEnabled?"on":e.isErrorsEnabled&&e.isCrashEnabled?"error":"off"}catch{return void 0!==this.vscodeAPI.env.isTelemetryEnabled?this.vscodeAPI.env.isTelemetryEnabled?"on":"off":this.vscodeAPI.workspace.getConfiguration("telemetry").get("enableTelemetry")?"on":"off"}}static applyReplacements(e,t){for(let r of Object.keys(e))for(let n of t)n.lookup.test(r)&&(void 0!==n.replacementString?e[r]=n.replacementString:delete e[r])}static shouldUseOneDataSystemSDK(e){return 74===e.length&&"-"===e[32]&&"-"===e[41]&&"-"===e[46]&&"-"===e[51]&&"-"===e[56]&&"-"===e[69]}static getInstance(e){return cs._instance||(cs._instance=new cs(e)),cs._instance}},ls=class extends class{constructor(e,t,r,n,s,i){this.extensionId=e,this.extensionVersion=t,this.telemetryAppender=r,this.osShim=n,this.vscodeAPI=s,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!i,this.updateUserOptStatus(),void 0!==s.env.onDidChangeTelemetryEnabled?(this.disposables.push(s.env.onDidChangeTelemetryEnabled((()=>this.updateUserOptStatus()))),this.disposables.push(s.workspace.onDidChangeConfiguration((()=>this.updateUserOptStatus())))):this.disposables.push(s.workspace.onDidChangeConfiguration((()=>this.updateUserOptStatus())))}updateUserOptStatus(){let e=cs.getInstance(this.vscodeAPI).getTelemetryLevel();this.userOptIn="on"===e,this.errorOptIn="error"===e||this.userOptIn,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(e){if(!e)return"none";let t="other";return["ssh-remote","dev-container","attached-container","wsl","codespaces"].forEach((r=>{0===e.indexOf(`${r}`)&&(t=r)})),t}get extension(){return void 0===this._extension&&(this._extension=this.vscodeAPI.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(e,t){if(null===e||"object"!=typeof e||"function"!=typeof t)return e;let r={};for(let n in e)r[n]=t(n,e[n]);return r}shouldSendErrorTelemetry(){return!(!1===this.errorOptIn||this.firstParty&&this.vscodeAPI.env.remoteName&&"other"===this.cleanRemoteName(this.vscodeAPI.env.remoteName))}getCommonProperties(){let e={};if(e["common.os"]=this.osShim.platform,e["common.nodeArch"]=this.osShim.architecture,e["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),e["common.extname"]=this.extensionId,e["common.extversion"]=this.extensionVersion,this.vscodeAPI&&this.vscodeAPI.env){switch(e["common.vscodemachineid"]=this.vscodeAPI.env.machineId,e["common.vscodesessionid"]=this.vscodeAPI.env.sessionId,e["common.vscodeversion"]=this.vscodeAPI.version,e["common.isnewappinstall"]=this.vscodeAPI.env.isNewAppInstall?this.vscodeAPI.env.isNewAppInstall.toString():"false",e["common.product"]=this.vscodeAPI.env.appHost,this.vscodeAPI.env.uiKind){case this.vscodeAPI.UIKind.Web:e["common.uikind"]="web";break;case this.vscodeAPI.UIKind.Desktop:e["common.uikind"]="desktop";break;default:e["common.uikind"]="unknown"}e["common.remotename"]=this.cleanRemoteName(this.vscodeAPI.env.remoteName)}return e}anonymizeFilePaths(e,t){let r;if(null==e)return"";let n=[];""!==this.vscodeAPI.env.appRoot&&n.push(new RegExp(this.vscodeAPI.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&n.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let s=e;if(t){let t=[];for(let s of n)for(;(r=s.exec(e))&&r;)t.push([r.index,s.lastIndex]);let i=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,o=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,a=0;for(s="";(r=o.exec(e))&&r;)r[0]&&!i.test(r[0])&&t.every((([e,t])=>r.index<e||r.index>=t))&&(s+=e.substring(a,r.index)+"<REDACTED: user-file-path>",a=o.lastIndex);a<e.length&&(s+=e.substr(a))}for(let e of n)s=s.replace(e,"");return s}removePropertiesWithPossibleUserInfo(e){if("object"!=typeof e)return;let t={};for(let r of Object.keys(e)){let n=e[r];if(!n)continue;let s=/@[a-zA-Z0-9-.]+/,i=/xox[pbaors]-[a-zA-Z0-9]+-[a-zA-Z0-9-]+?/;/(key|token|sig|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/.test(n.toLowerCase())?t[r]="<REDACTED: secret>":s.test(n)?t[r]="<REDACTED: email>":i.test(n)?t[r]="<REDACTED: token>":t[r]=n}return t}get telemetryLevel(){switch(cs.getInstance(this.vscodeAPI).getTelemetryLevel()){case"on":return"all";case"error":return"error";case"off":return"off"}}internalSendTelemetryEvent(e,t,r,n,s){if((this.userOptIn||s)&&""!==e){if(t=g(g({},t),this.getCommonProperties()),n){let e=this.cloneAndChange(t,((e,t)=>this.anonymizeFilePaths(t,this.firstParty)));t=this.removePropertiesWithPossibleUserInfo(e)}t=t??{},r=r??{},e=`${this.extensionId}/${e}`,this.telemetryAppender.logEvent(e,{properties:t,measurements:r})}}sendTelemetryEvent(e,t,r){this.internalSendTelemetryEvent(e,t,r,!0,!1)}sendRawTelemetryEvent(e,t,r){this.internalSendTelemetryEvent(e,t,r,!1,!1)}sendDangerousTelemetryEvent(e,t,r,n=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryEvent(e,t,r,n,!0)}internalSendTelemetryErrorEvent(e,t,r,n,s){if((this.shouldSendErrorTelemetry()||s)&&""!==e){if(t=g(g({},t),this.getCommonProperties()),n){let e=this.cloneAndChange(t,((e,t)=>this.anonymizeFilePaths(t,this.firstParty)));t=this.removePropertiesWithPossibleUserInfo(e)}t=t??{},r=r??{},e=`${this.extensionId}/${e}`,this.telemetryAppender.logEvent(e,{properties:t,measurements:r})}}sendTelemetryErrorEvent(e,t,r){this.internalSendTelemetryErrorEvent(e,t,r,!0,!1)}sendDangerousTelemetryErrorEvent(e,t,r,n=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryErrorEvent(e,t,r,n,!0)}internalSendTelemetryException(e,t,r,n,s){if((this.shouldSendErrorTelemetry()||s)&&e){if(t=g(g({},t),this.getCommonProperties()),n){let r=this.cloneAndChange(t,((e,t)=>this.anonymizeFilePaths(t,this.firstParty)));e.stack&&(e.stack=this.anonymizeFilePaths(e.stack,this.firstParty)),t=this.removePropertiesWithPossibleUserInfo(r)}t=t??{},r=r??{},this.telemetryAppender.logException(e,{properties:t,measurements:r})}}sendTelemetryException(e,t,r){this.internalSendTelemetryException(e,t,r,!0,!1)}sendDangerousTelemetryException(e,t,r,n=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryException(e,t,r,n,!0)}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map((e=>e.dispose())))}}{constructor(e,t,n,s,i){let o=e=>(async(e,t)=>{let r;try{process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL="1";let t=await Promise.resolve().then((()=>w(ns())));t.defaultClient?(r=new t.TelemetryClient(e),r.channel.setUseDiskRetryCaching(!0)):(t.setup(e).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setAutoCollectHeartbeat(!1).setUseDiskRetryCaching(!0).start(),r=t.defaultClient),os&&os.env&&(r.context.tags[r.context.keys.userId]=os.env.machineId,r.context.tags[r.context.keys.sessionId]=os.env.sessionId,r.context.tags[r.context.keys.cloudRole]=os.env.appName,r.context.tags[r.context.keys.cloudRoleInstance]=os.env.appName),e&&0===e.indexOf("AIF-")&&(r.config.endpointUrl="https://mobile.events.data.microsoft.com/collect/v1")}catch(e){return Promise.reject("Failed to initialize app insights!\n"+e.message)}return null!=t&&t.length&&function(e,t){e.addTelemetryProcessor((e=>(Array.isArray(e.tags)?e.tags.forEach((e=>cs.applyReplacements(e,t))):e.tags&&cs.applyReplacements(e.tags,t),e.data.baseData&&cs.applyReplacements(e.data.baseData,t),!0)))}(r,t),{logEvent:(e,t)=>{try{null==r||r.trackEvent({name:e,properties:null==t?void 0:t.properties,measurements:null==t?void 0:t.measurements})}catch(e){throw new Error("Failed to log event to app insights!\n"+e.message)}},logException:(e,t)=>{try{null==r||r.trackException({exception:e,properties:null==t?void 0:t.properties,measurements:null==t?void 0:t.measurements})}catch(e){throw new Error("Failed to log exception to app insights!\n"+e.message)}},flush:async()=>{try{null==r||r.flush()}catch(e){throw new Error("Failed to flush app insights!\n"+e.message)}}}})(e,i);cs.shouldUseOneDataSystemSDK(n)&&(o=e=>(async(e,t,n)=>{let s=await(async(e,t,n)=>{let s=await Promise.all([r.e(98),r.e(657)]).then(r.bind(r,6657)),i=await Promise.all([r.e(98),r.e(278)]).then(r.bind(r,278)),o=new s.AppInsightsCore,a=new i.PostChannel,c={instrumentationKey:e,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[a]]};if(n){c.extensionConfig={};let e={alwaysUseXhrOverride:!0,httpXHROverride:n};c.extensionConfig[a.identifier]=e}let l=t.workspace.getConfiguration("telemetry").get("internalTesting");return o.initialize(c,[]),o.addTelemetryInitializer((e=>{!l||(e.ext=e.ext??{},e.ext.utc=e.ext.utc??{},e.ext.utc.flags=8462029)})),o})(e,t,n);return{logEvent:(e,t)=>{try{null==s||s.track({name:e,baseData:{name:e,properties:null==t?void 0:t.properties,measurements:null==t?void 0:t.measurements}})}catch(e){throw new Error("Failed to log event to app insights!\n"+e.message)}},logException:(e,t)=>{throw new Error("1DS SDK does not support logging exceptions, please use logEvent for exception tracking")},flush:async()=>{try{null==s||s.unload()}catch(e){throw new Error("Failed to flush app insights!\n"+e.message)}}}})(e,os,{sendPOST:(e,t)=>{let r={method:"POST",headers:m(g({},e.headers),{"Content-Type":"application/json","Content-Length":Buffer.byteLength(e.data)})};try{let n=as.request(e.urlString,r,(e=>{e.on("data",(function(r){t(e.statusCode??200,e.headers,r.toString())})),e.on("error",(function(){t(0,{})}))}));n.write(e.data),n.end()}catch{t(0,{})}}}));let a=new class{constructor(e,t){this._instantiationStatus=0,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}logEvent(e,t){this._telemetryClient?this._telemetryClient.logEvent(e,t):2!==this._instantiationStatus&&this._eventQueue.push({eventName:e,data:t})}logException(e,t){this._telemetryClient?this._telemetryClient.logException(e,t):2!==this._instantiationStatus&&this._exceptionQueue.push({exception:e,data:t})}async flush(){this._telemetryClient&&(await this._telemetryClient.flush(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach((({eventName:e,data:t})=>this.logEvent(e,t))),this._eventQueue=[],this._exceptionQueue.forEach((({exception:e,data:t})=>this.logException(e,t))),this._exceptionQueue=[]}instantiateAppender(){0===this._instantiationStatus&&(this._instantiationStatus=1,this._clientFactory(this._key).then((e=>{this._telemetryClient=e,this._instantiationStatus=2,this._flushQueues()})).catch((e=>{console.error(e),this._instantiationStatus=2})))}}(n,o);n&&(0===n.indexOf("AIF-")||cs.shouldUseOneDataSystemSDK(n))&&(s=!0),super(e,t,a,{release:is.release(),platform:is.platform(),architecture:is.arch()},os,s)}}},2761:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const s=r(2361),i=n(r(8423)),o=n(r(1881)),a=i.default("agent-base");function c(){const{stack:e}=new Error;return"string"==typeof e&&e.split("\n").some((e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:")))}function l(e,t){return new l.Agent(e,t)}!function(e){class t extends s.EventEmitter{constructor(e,t){super();let r=t;"function"==typeof e?this.callback=e:e&&(r=e),this.timeout=null,r&&"number"==typeof r.timeout&&(this.timeout=r.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return"number"==typeof this.explicitDefaultPort?this.explicitDefaultPort:c()?443:80}set defaultPort(e){this.explicitDefaultPort=e}get protocol(){return"string"==typeof this.explicitProtocol?this.explicitProtocol:c()?"https:":"http:"}set protocol(e){this.explicitProtocol=e}callback(e,t,r){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(e,t){const r=Object.assign({},t);"boolean"!=typeof r.secureEndpoint&&(r.secureEndpoint=c()),null==r.host&&(r.host="localhost"),null==r.port&&(r.port=r.secureEndpoint?443:80),null==r.protocol&&(r.protocol=r.secureEndpoint?"https:":"http:"),r.host&&r.path&&delete r.path,delete r.agent,delete r.hostname,delete r._defaultAgent,delete r.defaultPort,delete r.createConnection,e._last=!0,e.shouldKeepAlive=!1;let n=!1,s=null;const i=r.timeout||this.timeout,l=t=>{e._hadError||(e.emit("error",t),e._hadError=!0)},u=()=>{s=null,n=!0;const e=new Error(`A "socket" was not created for HTTP request before ${i}ms`);e.code="ETIMEOUT",l(e)},h=e=>{n||(null!==s&&(clearTimeout(s),s=null),l(e))},d=t=>{if(n)return;if(null!=s&&(clearTimeout(s),s=null),i=t,Boolean(i)&&"function"==typeof i.addRequest)return a("Callback returned another Agent instance %o",t.constructor.name),void t.addRequest(e,r);var i;if(t)return t.once("free",(()=>{this.freeSocket(t,r)})),void e.onSocket(t);const o=new Error(`no Duplex stream was returned to agent-base for \`${e.method} ${e.path}\``);l(o)};if("function"==typeof this.callback){this.promisifiedCallback||(this.callback.length>=3?(a("Converting legacy callback function to promise"),this.promisifiedCallback=o.default(this.callback)):this.promisifiedCallback=this.callback),"number"==typeof i&&i>0&&(s=setTimeout(u,i)),"port"in r&&"number"!=typeof r.port&&(r.port=Number(r.port));try{a("Resolving socket for %o request: %o",r.protocol,`${e.method} ${e.path}`),Promise.resolve(this.promisifiedCallback(e,r)).then(d,h)}catch(e){Promise.reject(e).catch(h)}}else l(new Error("`callback` is not defined"))}freeSocket(e,t){a("Freeing socket %o %o",e.constructor.name,t),e.destroy()}destroy(){a("Destroying agent %o",this.constructor.name)}}e.Agent=t,e.prototype=e.Agent.prototype}(l||(l={})),e.exports=l},1881:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(t,r){return new Promise(((n,s)=>{e.call(this,t,r,((e,t)=>{e?s(e):n(t)}))}))}}},4932:e=>{e.exports={newInvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}},6846:(e,t,r)=>{var n=r(4932),s=r(170),i=r(4588),o=r(4241);for(var a in e.exports={Reader:i,Writer:o},s)s.hasOwnProperty(a)&&(e.exports[a]=s[a]);for(var c in n)n.hasOwnProperty(c)&&(e.exports[c]=n[c])},4588:(e,t,r)=>{var n=r(9491),s=r(443).Buffer,i=r(170),o=r(4932).newInvalidAsn1Error;function a(e){if(!e||!s.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}Object.defineProperty(a.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(a.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(a.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),a.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=255&this._buf[this._offset];return e||(this._offset+=1),t},a.prototype.peek=function(){return this.readByte(!0)},a.prototype.readLength=function(e){if(void 0===e&&(e=this._offset),e>=this._size)return null;var t=255&this._buf[e++];if(null===t)return null;if(128==(128&t)){if(0==(t&=127))throw o("Indefinite length not supported");if(t>4)throw o("encoding too long");if(this._size-e<t)return null;this._len=0;for(var r=0;r<t;r++)this._len=(this._len<<8)+(255&this._buf[e++])}else this._len=t;return e},a.prototype.readSequence=function(e){var t=this.peek();if(null===t)return null;if(void 0!==e&&e!==t)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);return null===r?null:(this._offset=r,t)},a.prototype.readInt=function(){return this._readTag(i.Integer)},a.prototype.readBoolean=function(){return 0!==this._readTag(i.Boolean)},a.prototype.readEnumeration=function(){return this._readTag(i.Enumeration)},a.prototype.readString=function(e,t){e||(e=i.OctetString);var r=this.peek();if(null===r)return null;if(r!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(null===n)return null;if(this.length>this._size-n)return null;if(this._offset=n,0===this.length)return t?s.alloc(0):"";var a=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?a:a.toString("utf8")},a.prototype.readOID=function(e){e||(e=i.OID);var t=this.readString(e,!0);if(null===t)return null;for(var r=[],n=0,s=0;s<t.length;s++){var o=255&t[s];n<<=7,n+=127&o,0==(128&o)&&(r.push(n),n=0)}return n=r.shift(),r.unshift(n%40),r.unshift(n/40>>0),r.join(".")},a.prototype._readTag=function(e){n.ok(void 0!==e);var t=this.peek();if(null===t)return null;if(t!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>4)throw o("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var s=this._buf[this._offset],i=0,a=0;a<this.length;a++)i<<=8,i|=255&this._buf[this._offset++];return 128==(128&s)&&4!==a&&(i-=1<<8*a),i>>0},e.exports=a},170:e=>{e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},4241:(e,t,r)=>{var n=r(9491),s=r(443).Buffer,i=r(170),o=r(4932).newInvalidAsn1Error,a={size:1024,growthFactor:8};function c(e){var t,r;t=a,r=e||{},n.ok(t),n.equal(typeof t,"object"),n.ok(r),n.equal(typeof r,"object"),Object.getOwnPropertyNames(t).forEach((function(e){if(!r[e]){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n)}})),e=r,this._buf=s.alloc(e.size||1024),this._size=this._buf.length,this._offset=0,this._options=e,this._seq=[]}Object.defineProperty(c.prototype,"buffer",{get:function(){if(this._seq.length)throw o(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}}),c.prototype.writeByte=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=e},c.prototype.writeInt=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");"number"!=typeof t&&(t=i.Integer);for(var r=4;(0==(4286578688&e)||-8388608==(4286578688&e))&&r>1;)r--,e<<=8;if(r>4)throw o("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=t,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(4278190080&e)>>>24,e<<=8},c.prototype.writeNull=function(){this.writeByte(i.Null),this.writeByte(0)},c.prototype.writeEnumeration=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");return"number"!=typeof t&&(t=i.Enumeration),this.writeInt(e,t)},c.prototype.writeBoolean=function(e,t){if("boolean"!=typeof e)throw new TypeError("argument must be a Boolean");"number"!=typeof t&&(t=i.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=e?255:0},c.prototype.writeString=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string (was: "+typeof e+")");"number"!=typeof t&&(t=i.OctetString);var r=s.byteLength(e);this.writeByte(t),this.writeLength(r),r&&(this._ensure(r),this._buf.write(e,this._offset),this._offset+=r)},c.prototype.writeBuffer=function(e,t){if("number"!=typeof t)throw new TypeError("tag must be a number");if(!s.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(e.length),this._ensure(e.length),e.copy(this._buf,this._offset,0,e.length),this._offset+=e.length},c.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach((function(e){t.writeString(e)}))},c.prototype.writeOID=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string");if("number"!=typeof t&&(t=i.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");var r=e.split("."),n=[];n.push(40*parseInt(r[0],10)+parseInt(r[1],10)),r.slice(2).forEach((function(e){!function(e,t){t<128?e.push(t):t<16384?(e.push(t>>>7|128),e.push(127&t)):t<2097152?(e.push(t>>>14|128),e.push(255&(t>>>7|128)),e.push(127&t)):t<268435456?(e.push(t>>>21|128),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t)):(e.push(255&(t>>>28|128)),e.push(255&(t>>>21|128)),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t))}(n,parseInt(e,10))}));var s=this;this._ensure(2+n.length),this.writeByte(t),this.writeLength(n.length),n.forEach((function(e){s.writeByte(e)}))},c.prototype.writeLength=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");if(this._ensure(4),e<=127)this._buf[this._offset++]=e;else if(e<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=e;else if(e<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else{if(!(e<=16777215))throw o("Length too long (> 4 bytes)");this._buf[this._offset++]=131,this._buf[this._offset++]=e>>16,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e}},c.prototype.startSequence=function(e){"number"!=typeof e&&(e=i.Sequence|i.Constructor),this.writeByte(e),this._seq.push(this._offset),this._ensure(3),this._offset+=3},c.prototype.endSequence=function(){var e=this._seq.pop(),t=e+3,r=this._offset-t;if(r<=127)this._shift(t,r,-2),this._buf[e]=r;else if(r<=255)this._shift(t,r,-1),this._buf[e]=129,this._buf[e+1]=r;else if(r<=65535)this._buf[e]=130,this._buf[e+1]=r>>8,this._buf[e+2]=r;else{if(!(r<=16777215))throw o("Sequence too long");this._shift(t,r,1),this._buf[e]=131,this._buf[e+1]=r>>16,this._buf[e+2]=r>>8,this._buf[e+3]=r}},c.prototype._shift=function(e,t,r){n.ok(void 0!==e),n.ok(void 0!==t),n.ok(r),this._buf.copy(this._buf,e+r,e,e+t),this._offset+=r},c.prototype._ensure=function(e){if(n.ok(e),this._size-this._offset<e){var t=this._size*this._options.growthFactor;t-this._offset<e&&(t+=e);var r=s.alloc(t);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=t}},e.exports=c},2701:(e,t,r)=>{var n=r(6846);e.exports={Ber:n,BerReader:n.Reader,BerWriter:n.Writer}},751:(e,t,r)=>{e.exports=r(9862)},400:(e,t,r)=>{"use strict";var n=r(6435),s=r(6551),i=r(3951),o=r(5597),a=r(3685),c=r(5687),l=r(2298).http,u=r(2298).https,h=r(7310),d=r(9796),p=r(9843),f=r(3375),g=r(6314),m=/https:?/;function y(e,t,r){if(e.hostname=t.host,e.host=t.host,e.port=t.port,e.path=r,t.auth){var n=Buffer.from(t.auth.username+":"+t.auth.password,"utf8").toString("base64");e.headers["Proxy-Authorization"]="Basic "+n}e.beforeRedirect=function(e){e.headers.host=e.host,y(e,t,e.href)}}e.exports=function(e){return new Promise((function(t,r){var v=function(e){t(e)},w=function(e){r(e)},S=e.data,b=e.headers;if("User-Agent"in b||"user-agent"in b?b["User-Agent"]||b["user-agent"]||(delete b["User-Agent"],delete b["user-agent"]):b["User-Agent"]="axios/"+p.version,S&&!n.isStream(S)){if(Buffer.isBuffer(S));else if(n.isArrayBuffer(S))S=Buffer.from(new Uint8Array(S));else{if(!n.isString(S))return w(f("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));S=Buffer.from(S,"utf-8")}b["Content-Length"]=S.length}var _=void 0;e.auth&&(_=(e.auth.username||"")+":"+(e.auth.password||""));var E=i(e.baseURL,e.url),T=h.parse(E),C=T.protocol||"http:";if(!_&&T.auth){var P=T.auth.split(":");_=(P[0]||"")+":"+(P[1]||"")}_&&delete b.Authorization;var A=m.test(C),R=A?e.httpsAgent:e.httpAgent,I={path:o(T.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method.toUpperCase(),headers:b,agent:R,agents:{http:e.httpAgent,https:e.httpsAgent},auth:_};e.socketPath?I.socketPath=e.socketPath:(I.hostname=T.hostname,I.port=T.port);var x,O=e.proxy;if(!O&&!1!==O){var k=C.slice(0,-1)+"_proxy",M=process.env[k]||process.env[k.toUpperCase()];if(M){var N=h.parse(M),D=process.env.no_proxy||process.env.NO_PROXY,L=!0;if(D&&(L=!D.split(",").map((function(e){return e.trim()})).some((function(e){return!!e&&("*"===e||"."===e[0]&&T.hostname.substr(T.hostname.length-e.length)===e||T.hostname===e)}))),L&&(O={host:N.hostname,port:N.port,protocol:N.protocol},N.auth)){var B=N.auth.split(":");O.auth={username:B[0],password:B[1]}}}}O&&(I.headers.host=T.hostname+(T.port?":"+T.port:""),y(I,O,C+"//"+T.hostname+(T.port?":"+T.port:"")+I.path));var q=A&&(!O||m.test(O.protocol));e.transport?x=e.transport:0===e.maxRedirects?x=q?c:a:(e.maxRedirects&&(I.maxRedirects=e.maxRedirects),x=q?u:l),e.maxBodyLength>-1&&(I.maxBodyLength=e.maxBodyLength);var j=x.request(I,(function(t){if(!j.aborted){var r=t,i=t.req||j;if(204!==t.statusCode&&"HEAD"!==i.method&&!1!==e.decompress)switch(t.headers["content-encoding"]){case"gzip":case"compress":case"deflate":r=r.pipe(d.createUnzip()),delete t.headers["content-encoding"]}var o={status:t.statusCode,statusText:t.statusMessage,headers:t.headers,config:e,request:i};if("stream"===e.responseType)o.data=r,s(v,w,o);else{var a=[],c=0;r.on("data",(function(t){a.push(t),c+=t.length,e.maxContentLength>-1&&c>e.maxContentLength&&(r.destroy(),w(f("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,i)))})),r.on("error",(function(t){j.aborted||w(g(t,e,null,i))})),r.on("end",(function(){var t=Buffer.concat(a);"arraybuffer"!==e.responseType&&(t=t.toString(e.responseEncoding),e.responseEncoding&&"utf8"!==e.responseEncoding||(t=n.stripBOM(t))),o.data=t,s(v,w,o)}))}}}));if(j.on("error",(function(t){j.aborted&&"ERR_FR_TOO_MANY_REDIRECTS"!==t.code||w(g(t,e,null,j))})),e.timeout){var F=parseInt(e.timeout,10);if(isNaN(F))return void w(f("error trying to parse `config.timeout` to int",e,"ERR_PARSE_TIMEOUT",j));j.setTimeout(F,(function(){j.abort(),w(f("timeout of "+F+"ms exceeded",e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",j))}))}e.cancelToken&&e.cancelToken.promise.then((function(e){j.aborted||(j.abort(),w(e))})),n.isStream(S)?S.on("error",(function(t){w(g(t,e,null,j))})).pipe(j):j.end(S)}))}},4291:(e,t,r)=>{"use strict";var n=r(6435),s=r(6551),i=r(7675),o=r(5597),a=r(3951),c=r(9452),l=r(1197),u=r(3375);e.exports=function(e){return new Promise((function(t,r){var h=e.data,d=e.headers,p=e.responseType;n.isFormData(h)&&delete d["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var g=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";d.Authorization="Basic "+btoa(g+":"+m)}var y=a(e.baseURL,e.url);function v(){if(f){var n="getAllResponseHeaders"in f?c(f.getAllResponseHeaders()):null,i={data:p&&"text"!==p&&"json"!==p?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};s(t,r,i),f=null}}if(f.open(e.method.toUpperCase(),o(y,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,"onloadend"in f?f.onloadend=v:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(v)},f.onabort=function(){f&&(r(u("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){r(u("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(u(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var w=(e.withCredentials||l(y))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;w&&(d[e.xsrfHeaderName]=w)}"setRequestHeader"in f&&n.forEach(d,(function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete d[t]:f.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),p&&"json"!==p&&(f.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),r(e),f=null)})),h||(h=null),f.send(h)}))}},9862:(e,t,r)=>{"use strict";var n=r(6435),s=r(2309),i=r(6586),o=r(6470);function a(e){var t=new i(e),r=s(i.prototype.request,t);return n.extend(r,i.prototype,t),n.extend(r,t),r}var c=a(r(6674));c.Axios=i,c.create=function(e){return a(o(c.defaults,e))},c.Cancel=r(2719),c.CancelToken=r(7013),c.isCancel=r(2641),c.all=function(e){return Promise.all(e)},c.spread=r(80),c.isAxiosError=r(3889),e.exports=c,e.exports.default=c},2719:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},7013:(e,t,r)=>{"use strict";var n=r(2719);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},2641:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},6586:(e,t,r)=>{"use strict";var n=r(6435),s=r(5597),i=r(3372),o=r(4626),a=r(6470),c=r(5250),l=c.validators;function u(e){this.defaults=e,this.interceptors={request:new i,response:new i}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:l.transitional(l.boolean,"1.0.0"),forcedJSONParsing:l.transitional(l.boolean,"1.0.0"),clarifyTimeoutError:l.transitional(l.boolean,"1.0.0")},!1);var r=[],n=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(n=n&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var s,i=[];if(this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)})),!n){var u=[o,void 0];for(Array.prototype.unshift.apply(u,r),u=u.concat(i),s=Promise.resolve(e);u.length;)s=s.then(u.shift(),u.shift());return s}for(var h=e;r.length;){var d=r.shift(),p=r.shift();try{h=d(h)}catch(e){p(e);break}}try{s=o(h)}catch(e){return Promise.reject(e)}for(;i.length;)s=s.then(i.shift(),i.shift());return s},u.prototype.getUri=function(e){return e=a(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,n){return this.request(a(n||{},{method:e,url:t,data:r}))}})),e.exports=u},3372:(e,t,r)=>{"use strict";var n=r(6435);function s(){this.handlers=[]}s.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},3951:(e,t,r)=>{"use strict";var n=r(542),s=r(8088);e.exports=function(e,t){return e&&!n(t)?s(e,t):t}},3375:(e,t,r)=>{"use strict";var n=r(6314);e.exports=function(e,t,r,s,i){var o=new Error(e);return n(o,t,r,s,i)}},4626:(e,t,r)=>{"use strict";var n=r(6435),s=r(8820),i=r(2641),o=r(6674);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=s.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=s.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(a(e),t&&t.response&&(t.response.data=s.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},6314:e=>{"use strict";e.exports=function(e,t,r,n,s){return e.config=t,r&&(e.code=r),e.request=n,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},6470:(e,t,r)=>{"use strict";var n=r(6435);e.exports=function(e,t){t=t||{};var r={},s=["url","method","data"],i=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function l(s){n.isUndefined(t[s])?n.isUndefined(e[s])||(r[s]=c(void 0,e[s])):r[s]=c(e[s],t[s])}n.forEach(s,(function(e){n.isUndefined(t[e])||(r[e]=c(void 0,t[e]))})),n.forEach(i,l),n.forEach(o,(function(s){n.isUndefined(t[s])?n.isUndefined(e[s])||(r[s]=c(void 0,e[s])):r[s]=c(void 0,t[s])})),n.forEach(a,(function(n){n in t?r[n]=c(e[n],t[n]):n in e&&(r[n]=c(void 0,e[n]))}));var u=s.concat(i).concat(o).concat(a),h=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return n.forEach(h,l),r}},6551:(e,t,r)=>{"use strict";var n=r(3375);e.exports=function(e,t,r){var s=r.config.validateStatus;r.status&&s&&!s(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},8820:(e,t,r)=>{"use strict";var n=r(6435),s=r(6674);e.exports=function(e,t,r){var i=this||s;return n.forEach(r,(function(r){e=r.call(i,e,t)})),e}},6674:(e,t,r)=>{"use strict";var n=r(6435),s=r(2038),i=r(6314),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,l={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:("undefined"!=typeof XMLHttpRequest?c=r(4291):"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)&&(c=r(400)),c),transformRequest:[function(e,t){return s(t,"Accept"),s(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,r){if(n.isString(e))try{return(0,JSON.parse)(e),n.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,r=t&&t.silentJSONParsing,s=t&&t.forcedJSONParsing,o=!r&&"json"===this.responseType;if(o||s&&n.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw i(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){l.headers[e]=n.merge(o)})),e.exports=l},2309:e=>{"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},5597:(e,t,r)=>{"use strict";var n=r(6435);function s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(n.isURLSearchParams(t))i=t.toString();else{var o=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),o.push(s(t)+"="+s(e))})))})),i=o.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},8088:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},7675:(e,t,r)=>{"use strict";var n=r(6435);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,s,i,o){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(s)&&a.push("path="+s),n.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},542:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},3889:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},1197:(e,t,r)=>{"use strict";var n=r(6435);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function s(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=s(window.location.href),function(t){var r=n.isString(t)?s(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},2038:(e,t,r)=>{"use strict";var n=r(6435);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},9452:(e,t,r)=>{"use strict";var n=r(6435),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,o={};return e?(n.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),r=n.trim(e.substr(i+1)),t){if(o[t]&&s.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+", "+r:r}})),o):o}},80:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},5250:(e,t,r)=>{"use strict";var n=r(9843),s={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){s[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var i={},o=n.version.split(".");function a(e,t){for(var r=t?t.split("."):o,n=e.split("."),s=0;s<3;s++){if(r[s]>n[s])return!0;if(r[s]<n[s])return!1}return!1}s.transitional=function(e,t,r){var s=t&&a(t);function o(e,t){return"[Axios v"+n.version+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,a){if(!1===e)throw new Error(o(n," has been removed in "+t));return s&&!i[n]&&(i[n]=!0,console.warn(o(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),s=n.length;s-- >0;){var i=n[s],o=t[i];if(o){var a=e[i],c=void 0===a||o(a,i,e);if(!0!==c)throw new TypeError("option "+i+" must be "+c)}else if(!0!==r)throw Error("Unknown option "+i)}},validators:s}},6435:(e,t,r)=>{"use strict";var n=r(2309),s=Object.prototype.toString;function i(e){return"[object Array]"===s.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==s.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===s.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:o,isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:l,isStream:function(e){return a(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function r(r,n){c(t[n])&&c(r)?t[n]=e(t[n],r):c(r)?t[n]=e({},r):i(r)?t[n]=r.slice():t[n]=r}for(var n=0,s=arguments.length;n<s;n++)u(arguments[n],r);return t},extend:function(e,t,r){return u(t,(function(t,s){e[s]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},4857:e=>{"use strict";e.exports={mask:(e,t,r,n,s)=>{for(var i=0;i<s;i++)r[n+i]=e[i]^t[3&i]},unmask:(e,t)=>{const r=e.length;for(var n=0;n<r;n++)e[n]^=t[3&n]}}},848:(e,t,r)=>{"use strict";try{e.exports=r(816)(__dirname)}catch(t){e.exports=r(4857)}},3847:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(1311)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},1311:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(2807),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},8423:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(3847):e.exports=r(8825)},8825:(e,t,r)=>{const n=r(6224),s=r(3837);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(s.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:s}=this;if(s){const t=this.color,s="[3"+(t<8?t:"8;5;"+t),i=`  ${s};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=s.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(6795);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(1311)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)}},2257:(e,t,r)=>{var n=r(6113);t.DiffieHellmanGroup=n.DiffieHellmanGroup,t.createDiffieHellmanGroup=n.createDiffieHellmanGroup,t.getDiffieHellman=n.getDiffieHellman,t.createDiffieHellman=n.createDiffieHellman,t.DiffieHellman=n.DiffieHellman},7730:(e,t,r)=>{var n;e.exports=function(){if(!n){try{n=r(8423)("follow-redirects")}catch(e){}"function"!=typeof n&&(n=function(){})}n.apply(null,arguments)}},2298:(e,t,r)=>{var n=r(7310),s=n.URL,i=r(3685),o=r(5687),a=r(2781).Writable,c=r(9491),l=r(7730),u=["abort","aborted","connect","error","socket","timeout"],h=Object.create(null);u.forEach((function(e){h[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}}));var d=b("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),p=b("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),f=b("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),g=b("ERR_STREAM_WRITE_AFTER_END","write after end");function m(e,t){a.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(e){r._processResponse(e)},this._performRequest()}function y(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach((function(i){var o=i+":",a=r[o]=e[i],u=t[i]=Object.create(a);Object.defineProperties(u,{request:{value:function(e,i,a){if("string"==typeof e){var u=e;try{e=w(new s(u))}catch(t){e=n.parse(u)}}else s&&e instanceof s?e=w(e):(a=i,i=e,e={protocol:o});return"function"==typeof i&&(a=i,i=null),(i=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,i)).nativeProtocols=r,c.equal(i.protocol,o,"protocol mismatch"),l("options",i),new m(i,a)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(e,t,r){var n=u.request(e,t,r);return n.end(),n},configurable:!0,enumerable:!0,writable:!0}})})),t}function v(){}function w(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return""!==e.port&&(t.port=Number(e.port)),t}function S(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return null==r?void 0:String(r).trim()}function b(e,t){function r(e){Error.captureStackTrace(this,this.constructor),e?(this.message=t+": "+e.message,this.cause=e):this.message=t}return r.prototype=new Error,r.prototype.constructor=r,r.prototype.name="Error ["+e+"]",r.prototype.code=e,r}function _(e){for(var t=0;t<u.length;t++)e.removeListener(u[t],h[u[t]]);e.on("error",v),e.abort()}m.prototype=Object.create(a.prototype),m.prototype.abort=function(){_(this._currentRequest),this.emit("abort")},m.prototype.write=function(e,t,r){if(this._ending)throw new g;if(!("string"==typeof e||"object"==typeof e&&"length"in e))throw new TypeError("data should be a string, Buffer or Uint8Array");"function"==typeof t&&(r=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new f),this.abort()):r&&r()},m.prototype.end=function(e,t,r){if("function"==typeof e?(r=e,e=t=null):"function"==typeof t&&(r=t,t=null),e){var n=this,s=this._currentRequest;this.write(e,t,(function(){n._ended=!0,s.end(null,null,r)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,r)},m.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},m.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},m.prototype.setTimeout=function(e,t){var r=this;function n(t){t.setTimeout(e),t.removeListener("timeout",t.destroy),t.addListener("timeout",t.destroy)}function s(t){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout((function(){r.emit("timeout"),i()}),e),n(t)}function i(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",i),r.removeListener("error",i),r.removeListener("response",i),t&&r.removeListener("timeout",t),r.socket||r._currentRequest.removeListener("socket",s)}return t&&this.on("timeout",t),this.socket?s(this.socket):this._currentRequest.once("socket",s),this.on("socket",n),this.on("abort",i),this.on("error",i),this.on("response",i),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){m.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(m.prototype,e,{get:function(){return this._currentRequest[e]}})})),m.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},m.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var r=e.slice(0,-1);this._options.agent=this._options.agents[r]}var s=this._currentRequest=t.request(this._options,this._onNativeResponse);this._currentUrl=n.format(this._options),s._redirectable=this;for(var i=0;i<u.length;i++)s.on(u[i],h[u[i]]);if(this._isRedirect){var o=0,a=this,c=this._requestBodyBuffers;!function e(t){if(s===a._currentRequest)if(t)a.emit("error",t);else if(o<c.length){var r=c[o++];s.finished||s.write(r.data,r.encoding,e)}else a._ended&&s.end()}()}}else this.emit("error",new TypeError("Unsupported protocol "+e))},m.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r=e.headers.location;if(!r||!1===this._options.followRedirects||t<300||t>=400)return e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),void(this._requestBodyBuffers=[]);if(_(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects)this.emit("error",new p);else{var s,i=this._options.beforeRedirect;i&&(s=Object.assign({Host:e.req.getHeader("host")},this._options.headers));var o=this._options.method;((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],S(/^content-/i,this._options.headers));var a,c=S(/^host$/i,this._options.headers),u=n.parse(this._currentUrl),h=c||u.host,f=/^\w+:/.test(r)?this._currentUrl:n.format(Object.assign(u,{host:h}));try{a=n.resolve(f,r)}catch(e){return void this.emit("error",new d(e))}l("redirecting to",a),this._isRedirect=!0;var g=n.parse(a);if(Object.assign(this._options,g),(g.protocol!==u.protocol&&"https:"!==g.protocol||g.host!==h&&!function(e,t){const r=e.length-t.length-1;return r>0&&"."===e[r]&&e.endsWith(t)}(g.host,h))&&S(/^(?:authorization|cookie)$/i,this._options.headers),"function"==typeof i){var m={headers:e.headers,statusCode:t},y={url:f,method:o,headers:s};try{i(this._options,m,y)}catch(e){return void this.emit("error",e)}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(e){this.emit("error",new d(e))}}},e.exports=y({http:i,https:o}),e.exports.wrap=y},9002:e=>{"use strict";e.exports=(e,t)=>{t=t||process.argv;const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),s=t.indexOf("--");return-1!==n&&(-1===s||n<s)}},7211:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(r(1808)),o=s(r(4404)),a=s(r(7310)),c=s(r(9491)),l=s(r(8423)),u=r(2761),h=s(r(807)),d=l.default("https-proxy-agent:agent");class p extends u.Agent{constructor(e){let t;if(t="string"==typeof e?a.default.parse(e):e,!t)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");d("creating new HttpsProxyAgent instance: %o",t),super(t);const r=Object.assign({},t);var n;this.secureProxy=t.secureProxy||"string"==typeof(n=r.protocol)&&/^https:?$/i.test(n),r.host=r.hostname||r.host,"string"==typeof r.port&&(r.port=parseInt(r.port,10)),!r.port&&r.host&&(r.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in r)&&(r.ALPNProtocols=["http 1.1"]),r.host&&r.path&&(delete r.path,delete r.pathname),this.proxy=r}callback(e,t){return n(this,void 0,void 0,(function*(){const{proxy:r,secureProxy:n}=this;let s;n?(d("Creating `tls.Socket`: %o",r),s=o.default.connect(r)):(d("Creating `net.Socket`: %o",r),s=i.default.connect(r));const a=Object.assign({},r.headers);let l=`CONNECT ${t.host}:${t.port} HTTP/1.1\r\n`;r.auth&&(a["Proxy-Authorization"]=`Basic ${Buffer.from(r.auth).toString("base64")}`);let{host:u,port:p,secureEndpoint:g}=t;(function(e,t){return Boolean(!t&&80===e||t&&443===e)})(p,g)||(u+=`:${p}`),a.Host=u,a.Connection="close";for(const e of Object.keys(a))l+=`${e}: ${a[e]}\r\n`;const m=h.default(s);s.write(`${l}\r\n`);const{statusCode:y,buffered:v}=yield m;if(200===y){if(e.once("socket",f),t.secureEndpoint){d("Upgrading socket connection to TLS");const e=t.servername||t.host;return o.default.connect(Object.assign(Object.assign({},function(e,...t){const r={};let n;for(n in e)t.includes(n)||(r[n]=e[n]);return r}(t,"host","hostname","path","port")),{socket:s,servername:e}))}return s}s.destroy();const w=new i.default.Socket({writable:!1});return w.readable=!0,e.once("socket",(e=>{d("replaying proxy buffer for failed request"),c.default(e.listenerCount("data")>0),e.push(v),e.push(null)})),w}))}}function f(e){e.resume()}t.default=p},3795:function(e,t,r){"use strict";const n=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(r(7211));function s(e){return new n.default(e)}!function(e){e.HttpsProxyAgent=n.default,e.prototype=n.default.prototype}(s||(s={})),e.exports=s},807:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(r(8423)).default("https-proxy-agent:parse-proxy-response");t.default=function(e){return new Promise(((t,r)=>{let n=0;const i=[];function o(){const r=e.read();r?function(e){i.push(e),n+=e.length;const r=Buffer.concat(i,n);if(-1===r.indexOf("\r\n\r\n"))return s("have not received end of HTTP headers yet..."),void o();const a=r.toString("ascii",0,r.indexOf("\r\n")),c=+a.split(" ")[1];s("got proxy server response: %o",a),t({statusCode:c,buffered:r})}(r):e.once("readable",o)}function a(e){s("onclose had error %o",e)}function c(){s("onend")}e.on("error",(function t(n){e.removeListener("end",c),e.removeListener("error",t),e.removeListener("close",a),e.removeListener("readable",o),s("onerror %o",n),r(n)})),e.on("close",a),e.on("end",c),o()}))}},4957:e=>{e.exports=n,n.strict=s,n.loose=i;var t=Object.prototype.toString,r={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function n(e){return s(e)||i(e)}function s(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function i(e){return r[t.call(e)]}},2807:e=>{var t=1e3,r=60*t,n=60*r,s=24*n;function i(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,o){o=o||{};var a,c,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var o=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===l&&isFinite(e))return o.long?(a=e,(c=Math.abs(a))>=s?i(a,c,s,"day"):c>=n?i(a,c,n,"hour"):c>=r?i(a,c,r,"minute"):c>=t?i(a,c,t,"second"):a+" ms"):function(e){var i=Math.abs(e);return i>=s?Math.round(e/s)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},4841:(e,t,r)=>{if(!globalThis.DOMException)try{const{MessageChannel:e}=r(1267),t=(new e).port1,n=new ArrayBuffer;t.postMessage(n,[n,n])}catch(e){"DOMException"===e.constructor.name&&(globalThis.DOMException=e.constructor)}e.exports=globalThis.DOMException},816:(e,t,r)=>{var n=r(7147),s=r(1017),i=r(2037),o=require,a=process.config&&process.config.variables||{},c=!!process.env.PREBUILDS_ONLY,l=process.versions.modules,u=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":process.versions&&process.versions.nw?"node-webkit":"node",h=i.arch(),d=i.platform(),p=process.env.LIBC||(function(e){return"linux"===e&&n.existsSync("/etc/alpine-release")}(d)?"musl":"glibc"),f=process.env.ARM_VERSION||("arm64"===h?"8":a.arm_version)||"",g=(process.versions.uv||"").split(".")[0];function m(e){return o(m.path(e))}function y(e){try{return n.readdirSync(e)}catch(e){return[]}}function v(e,t){var r=y(e).filter(t);return r[0]&&s.join(e,r[0])}function w(e){return/\.node$/.test(e)}function S(e){var t=e.split("-");if(2===t.length){var r=t[0],n=t[1].split("+");if(r&&n.length&&n.every(Boolean))return{name:e,platform:r,architectures:n}}}function b(e,t){return function(r){return null!=r&&r.platform===e&&r.architectures.includes(t)}}function _(e,t){return e.architectures.length-t.architectures.length}function E(e){var t=e.split("."),r={file:e,specificity:0};if("node"===t.pop()){for(var n=0;n<t.length;n++){var s=t[n];if("node"===s||"electron"===s||"node-webkit"===s)r.runtime=s;else if("napi"===s)r.napi=!0;else if("abi"===s.slice(0,3))r.abi=s.slice(3);else if("uv"===s.slice(0,2))r.uv=s.slice(2);else if("armv"===s.slice(0,4))r.armv=s.slice(4);else{if("glibc"!==s&&"musl"!==s)continue;r.libc=s}r.specificity++}return r}}function T(e,t){return function(r){return!(null==r||r.runtime!==e&&!function(e){return"node"===e.runtime&&e.napi}(r)||r.abi!==t&&!r.napi||r.uv&&r.uv!==g||r.armv&&r.armv!==f||r.libc&&r.libc!==p)}}function C(e){return function(t,r){return t.runtime!==r.runtime?t.runtime===e?-1:1:t.abi!==r.abi?t.abi?-1:1:t.specificity!==r.specificity?t.specificity>r.specificity?-1:1:0}}e.exports=m,m.path=function(e){e=s.resolve(e||".");try{var t=o(s.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[t+"_PREBUILD"]&&(e=process.env[t+"_PREBUILD"])}catch(e){}if(!c){var r=v(s.join(e,"build/Release"),w);if(r)return r;var n=v(s.join(e,"build/Debug"),w);if(n)return n}var i=P(e);if(i)return i;var a=P(s.dirname(process.execPath));if(a)return a;var m=["platform="+d,"arch="+h,"runtime="+u,"abi="+l,"uv="+g,f?"armv="+f:"","libc="+p,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ");throw new Error("No native build was found for "+m+"\n    loaded from: "+e+"\n");function P(e){var t=y(s.join(e,"prebuilds")).map(S).filter(b(d,h)).sort(_)[0];if(t){var r=s.join(e,"prebuilds",t.name),n=y(r).map(E).filter(T(u,l)).sort(C(u))[0];return n?s.join(r,n.file):void 0}}},m.parseTags=E,m.matchTags=T,m.compareTags=C,m.parseTuple=S,m.matchTuple=b,m.compareTuples=_},4024:(e,t,r)=>{var n=r(2057),s=r(450),i=(r(6113),r(2701).Ber,r(3016)._),o=r(3016),a=r(5954),c=r(4969);void 0===n.RSA_NO_PADDING&&(n.RSA_NO_PADDING=3),e.exports=function(){var e={node10:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],node:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],iojs:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],browser:["md5","ripemd160","sha1","sha256","sha512"]},t="pkcs1_oaep",r="pkcs1",n={private:"pkcs1-private-pem","private-der":"pkcs1-private-der",public:"pkcs8-public-pem","public-der":"pkcs8-public-der"};function l(e,n,a){if(!(this instanceof l))return new l(e,n,a);i.isObject(n)&&(a=n,n=void 0),this.$options={signingScheme:r,signingSchemeOptions:{hash:"sha256",saltLength:null},encryptionScheme:t,encryptionSchemeOptions:{hash:"sha1",label:null},environment:o.detectEnvironment(),rsaUtils:this},this.keyPair=new s.Key,this.$cache={},Buffer.isBuffer(e)||i.isString(e)?this.importKey(e,n):i.isObject(e)&&this.generateKeyPair(e.b,e.e),this.setOptions(a)}return l.prototype.setOptions=function(n){if((n=n||{}).environment&&(this.$options.environment=n.environment),n.signingScheme){if(i.isString(n.signingScheme)){var s=n.signingScheme.toLowerCase().split("-");1==s.length?e.node.indexOf(s[0])>-1?(this.$options.signingSchemeOptions={hash:s[0]},this.$options.signingScheme=r):(this.$options.signingScheme=s[0],this.$options.signingSchemeOptions={hash:null}):(this.$options.signingSchemeOptions={hash:s[1]},this.$options.signingScheme=s[0])}else i.isObject(n.signingScheme)&&(this.$options.signingScheme=n.signingScheme.scheme||r,this.$options.signingSchemeOptions=i.omit(n.signingScheme,"scheme"));if(!a.isSignature(this.$options.signingScheme))throw Error("Unsupported signing scheme");if(this.$options.signingSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}if(n.encryptionScheme){if(i.isString(n.encryptionScheme)?(this.$options.encryptionScheme=n.encryptionScheme.toLowerCase(),this.$options.encryptionSchemeOptions={}):i.isObject(n.encryptionScheme)&&(this.$options.encryptionScheme=n.encryptionScheme.scheme||t,this.$options.encryptionSchemeOptions=i.omit(n.encryptionScheme,"scheme")),!a.isEncryption(this.$options.encryptionScheme))throw Error("Unsupported encryption scheme");if(this.$options.encryptionSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}this.keyPair.setOptions(this.$options)},l.prototype.generateKeyPair=function(e,t){if(t=t||65537,(e=e||2048)%8!=0)throw Error("Key size must be a multiple of 8.");return this.keyPair.generate(e,t.toString(16)),this.$cache={},this},l.prototype.importKey=function(e,t){if(!e)throw Error("Empty key given");if(t&&(t=n[t]||t),!c.detectAndImport(this.keyPair,e,t)&&void 0===t)throw Error("Key format must be specified");return this.$cache={},this},l.prototype.exportKey=function(e){return e=n[e=e||"private"]||e,this.$cache[e]||(this.$cache[e]=c.detectAndExport(this.keyPair,e)),this.$cache[e]},l.prototype.isPrivate=function(){return this.keyPair.isPrivate()},l.prototype.isPublic=function(e){return this.keyPair.isPublic(e)},l.prototype.isEmpty=function(e){return!(this.keyPair.n||this.keyPair.e||this.keyPair.d)},l.prototype.encrypt=function(e,t,r){return this.$$encryptKey(!1,e,t,r)},l.prototype.decrypt=function(e,t){return this.$$decryptKey(!1,e,t)},l.prototype.encryptPrivate=function(e,t,r){return this.$$encryptKey(!0,e,t,r)},l.prototype.decryptPublic=function(e,t){return this.$$decryptKey(!0,e,t)},l.prototype.$$encryptKey=function(e,t,r,n){try{var s=this.keyPair.encrypt(this.$getDataForEncrypt(t,n),e);return"buffer"!=r&&r?s.toString(r):s}catch(e){throw Error("Error during encryption. Original error: "+e)}},l.prototype.$$decryptKey=function(e,t,r){try{t=i.isString(t)?Buffer.from(t,"base64"):t;var n=this.keyPair.decrypt(t,e);if(null===n)throw Error("Key decrypt method returns null.");return this.$getDecryptedData(n,r)}catch(e){throw Error("Error during decryption (probably incorrect key). Original error: "+e)}},l.prototype.sign=function(e,t,r){if(!this.isPrivate())throw Error("This is not private key");var n=this.keyPair.sign(this.$getDataForEncrypt(e,r));return t&&"buffer"!=t&&(n=n.toString(t)),n},l.prototype.verify=function(e,t,r,n){if(!this.isPublic())throw Error("This is not public key");return n=n&&"buffer"!=n?n:null,this.keyPair.verify(this.$getDataForEncrypt(e,r),t,n)},l.prototype.getKeySize=function(){return this.keyPair.keySize},l.prototype.getMaxMessageSize=function(){return this.keyPair.maxMessageLength},l.prototype.$getDataForEncrypt=function(e,t){if(i.isString(e)||i.isNumber(e))return Buffer.from(""+e,t||"utf8");if(Buffer.isBuffer(e))return e;if(i.isObject(e))return Buffer.from(JSON.stringify(e));throw Error("Unexpected data type")},l.prototype.$getDecryptedData=function(e,t){return"buffer"==(t=t||"buffer")?e:"json"==t?JSON.parse(e.toString()):e.toString(t)},l}()},6591:(e,t,r)=>{var n=r(6113);e.exports={getEngine:function(e,t){var s=r(4689);return"node"===t.environment&&"function"==typeof n.publicEncrypt&&"function"==typeof n.privateDecrypt&&(s="function"==typeof n.privateEncrypt&&"function"==typeof n.publicDecrypt?r(5536):r(8170)),s(e,t)}}},5536:(e,t,r)=>{var n=r(6113),s=r(2057),i=r(5954);e.exports=function(e,t){var r=i.pkcs1.makeScheme(e,t);return{encrypt:function(e,i){var o;if(i)return o=s.RSA_PKCS1_PADDING,t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding),n.privateEncrypt({key:t.rsaUtils.exportKey("private"),padding:o},e);o=s.RSA_PKCS1_OAEP_PADDING,"pkcs1"===t.encryptionScheme&&(o=s.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding);var a=e;return o===s.RSA_NO_PADDING&&(a=r.pkcs0pad(e)),n.publicEncrypt({key:t.rsaUtils.exportKey("public"),padding:o},a)},decrypt:function(e,i){var o;if(i)return o=s.RSA_PKCS1_PADDING,t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding),n.publicDecrypt({key:t.rsaUtils.exportKey("public"),padding:o},e);o=s.RSA_PKCS1_OAEP_PADDING,"pkcs1"===t.encryptionScheme&&(o=s.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding);var a=n.privateDecrypt({key:t.rsaUtils.exportKey("private"),padding:o},e);return o===s.RSA_NO_PADDING?r.pkcs0unpad(a):a}}}},4689:(e,t,r)=>{var n=r(6200),s=r(5954);e.exports=function(e,t){var r=s.pkcs1.makeScheme(e,t);return{encrypt:function(t,s){var i,o;return s?(i=new n(r.encPad(t,{type:1})),o=e.$doPrivate(i)):(i=new n(e.encryptionScheme.encPad(t)),o=e.$doPublic(i)),o.toBuffer(e.encryptedDataLength)},decrypt:function(t,s){var i,o=new n(t);return s?(i=e.$doPublic(o),r.encUnPad(i.toBuffer(e.encryptedDataLength),{type:1})):(i=e.$doPrivate(o),e.encryptionScheme.encUnPad(i.toBuffer(e.encryptedDataLength)))}}}},8170:(e,t,r)=>{var n=r(6113),s=r(2057),i=r(5954);e.exports=function(e,t){var o=r(4689)(e,t),a=i.pkcs1.makeScheme(e,t);return{encrypt:function(e,r){if(r)return o.encrypt(e,r);var i=s.RSA_PKCS1_OAEP_PADDING;"pkcs1"===t.encryptionScheme&&(i=s.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(i=t.encryptionSchemeOptions.padding);var c=e;return i===s.RSA_NO_PADDING&&(c=a.pkcs0pad(e)),n.publicEncrypt({key:t.rsaUtils.exportKey("public"),padding:i},c)},decrypt:function(e,r){if(r)return o.decrypt(e,r);var i=s.RSA_PKCS1_OAEP_PADDING;"pkcs1"===t.encryptionScheme&&(i=s.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(i=t.encryptionSchemeOptions.padding);var c=n.privateDecrypt({key:t.rsaUtils.exportKey("private"),padding:i},e);return i===s.RSA_NO_PADDING?a.pkcs0unpad(c):c}}}},5624:(e,t,r)=>{r(3016)._,r(3016),e.exports={privateExport:function(e,t){return{n:e.n.toBuffer(),e:e.e,d:e.d.toBuffer(),p:e.p.toBuffer(),q:e.q.toBuffer(),dmp1:e.dmp1.toBuffer(),dmq1:e.dmq1.toBuffer(),coeff:e.coeff.toBuffer()}},privateImport:function(e,t,r){if(!(t.n&&t.e&&t.d&&t.p&&t.q&&t.dmp1&&t.dmq1&&t.coeff))throw Error("Invalid key data");e.setPrivate(t.n,t.e,t.d,t.p,t.q,t.dmp1,t.dmq1,t.coeff)},publicExport:function(e,t){return{n:e.n.toBuffer(),e:e.e}},publicImport:function(e,t,r){if(!t.n||!t.e)throw Error("Invalid key data");e.setPublic(t.n,t.e)},autoImport:function(t,r){return!(!r.n||!r.e||(r.d&&r.p&&r.q&&r.dmp1&&r.dmq1&&r.coeff?(e.exports.privateImport(t,r),0):(e.exports.publicImport(t,r),0)))}}},4969:(e,t,r)=>{function n(e){e=e.split("-");for(var t="private",r={type:"default"},n=1;n<e.length;n++)if(e[n])switch(e[n]){case"public":case"private":t=e[n];break;case"pem":case"der":r.type=e[n]}return{scheme:e[0],keyType:t,keyOpt:r}}r(3016)._,e.exports={pkcs1:r(2768),pkcs8:r(6769),components:r(5624),openssh:r(7789),isPrivateExport:function(t){return e.exports[t]&&"function"==typeof e.exports[t].privateExport},isPrivateImport:function(t){return e.exports[t]&&"function"==typeof e.exports[t].privateImport},isPublicExport:function(t){return e.exports[t]&&"function"==typeof e.exports[t].publicExport},isPublicImport:function(t){return e.exports[t]&&"function"==typeof e.exports[t].publicImport},detectAndImport:function(t,r,s){if(void 0===s){for(var i in e.exports)if("function"==typeof e.exports[i].autoImport&&e.exports[i].autoImport(t,r))return!0}else if(s){var o=n(s);if(!e.exports[o.scheme])throw Error("Unsupported key format");"private"===o.keyType?e.exports[o.scheme].privateImport(t,r,o.keyOpt):e.exports[o.scheme].publicImport(t,r,o.keyOpt)}return!1},detectAndExport:function(t,r){if(r){var s=n(r);if(e.exports[s.scheme]){if("private"===s.keyType){if(!t.isPrivate())throw Error("This is not private key");return e.exports[s.scheme].privateExport(t,s.keyOpt)}if(!t.isPublic())throw Error("This is not public key");return e.exports[s.scheme].publicExport(t,s.keyOpt)}throw Error("Unsupported key format")}}}},7789:(e,t,r)=>{var n=r(3016)._,s=r(3016),i=r(6200);const o="-----BEGIN OPENSSH PRIVATE KEY-----",a="-----END OPENSSH PRIVATE KEY-----";function c(e){const t=e.buf.readInt32BE(e.off);e.off+=4;const r=e.buf.slice(e.off,e.off+t);return e.off+=t,r}function l(e,t){e.buf.writeInt32BE(t.byteLength,e.off),e.off+=4,e.off+=t.copy(e.buf,e.off)}e.exports={privateExport:function(e,t){const r=e.n.toBuffer();let n=Buffer.alloc(4);for(n.writeUInt32BE(e.e,0);0===n[0];)n=n.slice(1);const i=e.d.toBuffer(),c=e.coeff.toBuffer(),u=e.p.toBuffer(),h=e.q.toBuffer();let d;d=void 0!==e.sshcomment?Buffer.from(e.sshcomment):Buffer.from([]);const p=15+n.byteLength+4+r.byteLength,f=23+r.byteLength+4+n.byteLength+4+i.byteLength+4+c.byteLength+4+u.byteLength+4+h.byteLength+4+d.byteLength;let g=43+p+4+f;g+=8*Math.ceil(f/8)-f;const m=Buffer.alloc(g),y={buf:m,off:0};m.write("openssh-key-v1","utf8"),m.writeUInt8(0,14),y.off+=15,l(y,Buffer.from("none")),l(y,Buffer.from("none")),l(y,Buffer.from("")),y.off=y.buf.writeUInt32BE(1,y.off),y.off=y.buf.writeUInt32BE(p,y.off),l(y,Buffer.from("ssh-rsa")),l(y,n),l(y,r),y.off=y.buf.writeUInt32BE(g-47-p,y.off),y.off+=8,l(y,Buffer.from("ssh-rsa")),l(y,r),l(y,n),l(y,i),l(y,c),l(y,u),l(y,h),l(y,d);let v=1;for(;y.off<g;)y.off=y.buf.writeUInt8(v++,y.off);return"der"===t.type?y.buf:o+"\n"+s.linebrk(m.toString("base64"),70)+"\n"+a+"\n"},privateImport:function(e,t,r){var l;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),!n.isString(t))throw Error("Unsupported key format");var u=s.trimSurroundingText(t,o,a).replace(/\s+|\n\r|\n|\r$/gm,"");l=Buffer.from(u,"base64")}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");l=t}const h={buf:l,off:0};if("openssh-key-v1"!==l.slice(0,14).toString("ascii"))throw"Invalid file format.";if(h.off+=15,"none"!==c(h).toString("ascii"))throw Error("Unsupported key type");if("none"!==c(h).toString("ascii"))throw Error("Unsupported key type");if(""!==c(h).toString("ascii"))throw Error("Unsupported key type");if(h.off+=4,h.off+=4,"ssh-rsa"!==c(h).toString("ascii"))throw Error("Unsupported key type");if(c(h),c(h),h.off+=12,"ssh-rsa"!==c(h).toString("ascii"))throw Error("Unsupported key type");const d=c(h),p=c(h),f=c(h),g=c(h),m=c(h),y=c(h),v=new i(f),w=new i(y),S=new i(m),b=v.mod(S.subtract(i.ONE)),_=v.mod(w.subtract(i.ONE));e.setPrivate(d,p,f,m,y,b.toBuffer(),_.toBuffer(),g),e.sshcomment=c(h).toString("ascii")},publicExport:function(e,t){let r=Buffer.alloc(4);for(r.writeUInt32BE(e.e,0);0===r[0];)r=r.slice(1);const n=e.n.toBuffer(),s=Buffer.alloc(r.byteLength+4+n.byteLength+4+"ssh-rsa".length+4),i={buf:s,off:0};l(i,Buffer.from("ssh-rsa")),l(i,r),l(i,n);let o=e.sshcomment||"";return"der"===t.type?i.buf:"ssh-rsa "+s.toString("base64")+" "+o+"\n"},publicImport:function(e,t,r){var s;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),!n.isString(t))throw Error("Unsupported key format");{if("ssh-rsa "!==t.substring(0,8))throw Error("Unsupported key format");let r=t.indexOf(" ",8);-1===r?r=t.length:e.sshcomment=t.substring(r+1).replace(/\s+|\n\r|\n|\r$/gm,"");const n=t.substring(8,r).replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(n,"base64")}}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");s=t}const i={buf:s,off:0},o=c(i).toString("ascii");if("ssh-rsa"!==o)throw Error("Invalid key type: "+o);const a=c(i),l=c(i);e.setPublic(l,a)},autoImport:function(t,r){return/^[\S\s]*-----BEGIN OPENSSH PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END OPENSSH PRIVATE KEY-----[\S\s]*$/g.test(r)?(e.exports.privateImport(t,r),!0):!!/^[\S\s]*ssh-rsa \s*(?=(([A-Za-z0-9+/=]+\s*)+))\1[\S\s]*$/g.test(r)&&(e.exports.publicImport(t,r),!0)}}},2768:(e,t,r)=>{var n=r(2701).Ber,s=r(3016)._,i=r(3016);const o="-----BEGIN RSA PRIVATE KEY-----",a="-----END RSA PRIVATE KEY-----",c="-----BEGIN RSA PUBLIC KEY-----",l="-----END RSA PUBLIC KEY-----";e.exports={privateExport:function(e,t){t=t||{};var r=e.n.toBuffer(),s=e.d.toBuffer(),c=e.p.toBuffer(),l=e.q.toBuffer(),u=e.dmp1.toBuffer(),h=e.dmq1.toBuffer(),d=e.coeff.toBuffer(),p=r.length+s.length+c.length+l.length+u.length+h.length+d.length+512,f=new n.Writer({size:p});return f.startSequence(),f.writeInt(0),f.writeBuffer(r,2),f.writeInt(e.e),f.writeBuffer(s,2),f.writeBuffer(c,2),f.writeBuffer(l,2),f.writeBuffer(u,2),f.writeBuffer(h,2),f.writeBuffer(d,2),f.endSequence(),"der"===t.type?f.buffer:o+"\n"+i.linebrk(f.buffer.toString("base64"),64)+"\n"+a},privateImport:function(e,t,r){var c;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),!s.isString(t))throw Error("Unsupported key format");var l=i.trimSurroundingText(t,o,a).replace(/\s+|\n\r|\n|\r$/gm,"");c=Buffer.from(l,"base64")}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");c=t}var u=new n.Reader(c);u.readSequence(),u.readString(2,!0),e.setPrivate(u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0))},publicExport:function(e,t){t=t||{};var r=e.n.toBuffer(),s=r.length+512,o=new n.Writer({size:s});return o.startSequence(),o.writeBuffer(r,2),o.writeInt(e.e),o.endSequence(),"der"===t.type?o.buffer:c+"\n"+i.linebrk(o.buffer.toString("base64"),64)+"\n"+l},publicImport:function(e,t,r){var o;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),s.isString(t)){var a=i.trimSurroundingText(t,c,l).replace(/\s+|\n\r|\n|\r$/gm,"");o=Buffer.from(a,"base64")}}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");o=t}var u=new n.Reader(o);u.readSequence(),e.setPublic(u.readString(2,!0),u.readString(2,!0))},autoImport:function(t,r){return/^[\S\s]*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PRIVATE KEY-----[\S\s]*$/g.test(r)?(e.exports.privateImport(t,r),!0):!!/^[\S\s]*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PUBLIC KEY-----[\S\s]*$/g.test(r)&&(e.exports.publicImport(t,r),!0)}}},6769:(e,t,r)=>{var n=r(2701).Ber,s=r(3016)._,i="1.2.840.113549.1.1.1",o=r(3016);const a="-----BEGIN PRIVATE KEY-----",c="-----END PRIVATE KEY-----",l="-----BEGIN PUBLIC KEY-----",u="-----END PUBLIC KEY-----";e.exports={privateExport:function(e,t){t=t||{};var r=e.n.toBuffer(),s=e.d.toBuffer(),l=e.p.toBuffer(),u=e.q.toBuffer(),h=e.dmp1.toBuffer(),d=e.dmq1.toBuffer(),p=e.coeff.toBuffer(),f=r.length+s.length+l.length+u.length+h.length+d.length+p.length+512,g=new n.Writer({size:f});g.startSequence(),g.writeInt(0),g.writeBuffer(r,2),g.writeInt(e.e),g.writeBuffer(s,2),g.writeBuffer(l,2),g.writeBuffer(u,2),g.writeBuffer(h,2),g.writeBuffer(d,2),g.writeBuffer(p,2),g.endSequence();var m=new n.Writer({size:f});return m.startSequence(),m.writeInt(0),m.startSequence(),m.writeOID(i),m.writeNull(),m.endSequence(),m.writeBuffer(g.buffer,4),m.endSequence(),"der"===t.type?m.buffer:a+"\n"+o.linebrk(m.buffer.toString("base64"),64)+"\n"+c},privateImport:function(e,t,r){var l;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),!s.isString(t))throw Error("Unsupported key format");var u=o.trimSurroundingText(t,a,c).replace("-----END PRIVATE KEY-----","").replace(/\s+|\n\r|\n|\r$/gm,"");l=Buffer.from(u,"base64")}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");l=t}var h=new n.Reader(l);if(h.readSequence(),h.readInt(0),new n.Reader(h.readString(48,!0)).readOID(6,!0)!==i)throw Error("Invalid Public key format");var d=new n.Reader(h.readString(4,!0));d.readSequence(),d.readString(2,!0),e.setPrivate(d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0))},publicExport:function(e,t){t=t||{};var r=e.n.toBuffer(),s=r.length+512,a=new n.Writer({size:s});a.writeByte(0),a.startSequence(),a.writeBuffer(r,2),a.writeInt(e.e),a.endSequence();var c=new n.Writer({size:s});return c.startSequence(),c.startSequence(),c.writeOID(i),c.writeNull(),c.endSequence(),c.writeBuffer(a.buffer,3),c.endSequence(),"der"===t.type?c.buffer:l+"\n"+o.linebrk(c.buffer.toString("base64"),64)+"\n"+u},publicImport:function(e,t,r){var a;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),s.isString(t)){var c=o.trimSurroundingText(t,l,u).replace(/\s+|\n\r|\n|\r$/gm,"");a=Buffer.from(c,"base64")}}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");a=t}var h=new n.Reader(a);if(h.readSequence(),new n.Reader(h.readString(48,!0)).readOID(6,!0)!==i)throw Error("Invalid Public key format");var d=new n.Reader(h.readString(3,!0));d.readByte(),d.readSequence(),e.setPublic(d.readString(2,!0),d.readString(2,!0))},autoImport:function(t,r){return/^[\S\s]*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PRIVATE KEY-----[\S\s]*$/g.test(r)?(e.exports.privateImport(t,r),!0):!!/^[\S\s]*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PUBLIC KEY-----[\S\s]*$/g.test(r)&&(e.exports.publicImport(t,r),!0)}}},6200:(e,t,r)=>{var n=r(6113),s=r(3016)._;function i(e,t){null!=e&&("number"==typeof e?this.fromNumber(e,t):Buffer.isBuffer(e)?this.fromBuffer(e):null==t&&"string"!=typeof e?this.fromByteArray(e):this.fromString(e,t))}function o(){return new i(null)}i.prototype.am=function(e,t,r,n,s,i){for(var o=16383&t,a=t>>14;--i>=0;){var c=16383&this[e],l=this[e++]>>14,u=a*c+l*o;s=((c=o*c+((16383&u)<<14)+r[n]+s)>>28)+(u>>14)+a*l,r[n++]=268435455&c}return s},i.prototype.DB=28,i.prototype.DM=268435455,i.prototype.DV=1<<28,i.prototype.FV=Math.pow(2,52),i.prototype.F1=24,i.prototype.F2=4;var a,c,l=new Array;for(a="0".charCodeAt(0),c=0;c<=9;++c)l[a++]=c;for(a="a".charCodeAt(0),c=10;c<36;++c)l[a++]=c;for(a="A".charCodeAt(0),c=10;c<36;++c)l[a++]=c;function u(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function h(e,t){var r=l[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=o();return t.fromInt(e),t}function p(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function f(e){this.m=e}function g(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function m(e,t){return e&t}function y(e,t){return e|t}function v(e,t){return e^t}function w(e,t){return e&~t}function S(e){if(0===e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function b(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function _(){}function E(e){return e}function T(e){this.r2=o(),this.q3=o(),i.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}f.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},f.prototype.revert=function(e){return e},f.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},f.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},f.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},g.prototype.convert=function(e){var t=o();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(i.ZERO)>0&&this.m.subTo(t,t),t},g.prototype.revert=function(e){var t=o();return e.copyTo(t),this.reduce(t),t},g.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},g.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},g.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},_.prototype.convert=E,_.prototype.revert=E,_.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},_.prototype.sqrTo=function(e,t){e.squareTo(t)},T.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=o();return e.copyTo(t),this.reduce(t),t},T.prototype.revert=function(e){return e},T.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},T.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},T.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var C=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],P=(1<<26)/C[C.length-1];i.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},i.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0},i.prototype.fromString=function(e,t,r){var n;switch(t){case 2:n=1;break;case 4:n=2;break;case 8:n=3;break;case 16:n=4;break;case 32:n=5;break;case 256:n=8;break;default:return void this.fromRadix(e,t)}this.t=0,this.s=0;for(var s=e.length,o=!1,a=0;--s>=0;){var c=8==n?255&e[s]:h(e,s);c<0?"-"==e.charAt(s)&&(o=!0):(o=!1,0===a?this[this.t++]=c:a+n>this.DB?(this[this.t-1]|=(c&(1<<this.DB-a)-1)<<a,this[this.t++]=c>>this.DB-a):this[this.t-1]|=c<<a,(a+=n)>=this.DB&&(a-=this.DB))}r||8!=n||0==(128&e[0])||(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),o&&i.ZERO.subTo(this,this)},i.prototype.fromByteArray=function(e,t){this.fromString(e,256,t)},i.prototype.fromBuffer=function(e){this.fromString(e,256,!0)},i.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},i.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},i.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},i.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,s=this.DB-n,i=(1<<s)-1,o=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+o+1]=this[r]>>s|a,a=(this[r]&i)<<n;for(r=o-1;r>=0;--r)t[r]=0;t[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()},i.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,s=this.DB-n,i=(1<<n)-1;t[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&i)<<s,t[o-r]=this[o]>>n;n>0&&(t[this.t-r-1]|=(this.s&i)<<s),t.t=this.t-r,t.clamp()}},i.prototype.subTo=function(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},i.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),s=r.t;for(t.t=s+n.t;--s>=0;)t[s]=0;for(s=0;s<n.t;++s)t[s+r.t]=r.am(0,n[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&i.ZERO.subTo(t,t)},i.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},i.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=o());var a=o(),c=this.s,l=e.s,u=this.DB-p(n[n.t-1]);u>0?(n.lShiftTo(u,a),s.lShiftTo(u,r)):(n.copyTo(a),s.copyTo(r));var h=a.t,d=a[h-1];if(0!==d){var f=d*(1<<this.F1)+(h>1?a[h-2]>>this.F2:0),g=this.FV/f,m=(1<<this.F1)/f,y=1<<this.F2,v=r.t,w=v-h,S=null==t?o():t;for(a.dlShiftTo(w,S),r.compareTo(S)>=0&&(r[r.t++]=1,r.subTo(S,r)),i.ONE.dlShiftTo(h,S),S.subTo(a,a);a.t<h;)a[a.t++]=0;for(;--w>=0;){var b=r[--v]==d?this.DM:Math.floor(r[v]*g+(r[v-1]+y)*m);if((r[v]+=a.am(0,b,r,w,0,h))<b)for(a.dlShiftTo(w,S),r.subTo(S,r);r[v]<--b;)r.subTo(S,r)}null!=t&&(r.drShiftTo(h,t),c!=l&&i.ZERO.subTo(t,t)),r.t=h,r.clamp(),u>0&&r.rShiftTo(u,r),c<0&&i.ZERO.subTo(r,r)}}},i.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},i.prototype.isEven=function(){return 0===(this.t>0?1&this[0]:this.s)},i.prototype.exp=function(e,t){if(e>4294967295||e<1)return i.ONE;var r=o(),n=o(),s=t.convert(this),a=p(e)-1;for(s.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,s,r);else{var c=r;r=n,n=c}return t.revert(r)},i.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},i.prototype.toRadix=function(e){if(null==e&&(e=10),0===this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=d(r),s=o(),i=o(),a="";for(this.divRemTo(n,s,i);s.signum()>0;)a=(r+i.intValue()).toString(e).substr(1)+a,s.divRemTo(n,s,i);return i.intValue().toString(e)+a},i.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),s=!1,o=0,a=0,c=0;c<e.length;++c){var l=h(e,c);l<0?"-"==e.charAt(c)&&0===this.signum()&&(s=!0):(a=t*a+l,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),s&&i.ZERO.subTo(this,this)},i.prototype.fromNumber=function(e,t){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e),this.testBit(e-1)||this.bitwiseTo(i.ONE.shiftLeft(e-1),y,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(i.ONE.shiftLeft(e-1),this);else{var r=n.randomBytes(1+(e>>3)),s=7&e;s>0?r[0]&=(1<<s)-1:r[0]=0,this.fromByteArray(r)}},i.prototype.bitwiseTo=function(e,t,r){var n,s,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(s=e.s&this.DM,n=i;n<this.t;++n)r[n]=t(this[n],s);r.t=this.t}else{for(s=this.s&this.DM,n=i;n<e.t;++n)r[n]=t(s,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},i.prototype.changeBit=function(e,t){var r=i.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},i.prototype.addTo=function(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},i.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},i.prototype.dAddOffset=function(e,t){if(0!==e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},i.prototype.multiplyLowerTo=function(e,t,r){var n,s=Math.min(this.t+e.t,t);for(r.s=0,r.t=s;s>0;)r[--s]=0;for(n=r.t-this.t;s<n;++s)r[s+this.t]=this.am(0,e[s],r,s,0,this.t);for(n=Math.min(e.t,t);s<n;++s)this.am(0,e[s],r,s,0,t-s);r.clamp()},i.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},i.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0===t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},i.prototype.millerRabin=function(e){var t=this.subtract(i.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>C.length&&(e=C.length);for(var s=o(),a=0;a<e;++a){s.fromInt(C[Math.floor(Math.random()*C.length)]);var c=s.modPow(n,this);if(0!=c.compareTo(i.ONE)&&0!=c.compareTo(t)){for(var l=1;l++<r&&0!=c.compareTo(t);)if(0===(c=c.modPowInt(2,this)).compareTo(i.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},i.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,s=!1,i="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this[o]>>a)>0&&(s=!0,i=u(r));o>=0;)a<t?(r=(this[o]&(1<<a)-1)<<t-a,r|=this[--o]>>(a+=this.DB-t)):(r=this[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(s=!0),s&&(i+=u(r));return s?i:"0"},i.prototype.negate=function(){var e=o();return i.ZERO.subTo(this,e),e},i.prototype.abs=function(){return this.s<0?this.negate():this},i.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},i.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+p(this[this.t-1]^this.s&this.DM)},i.prototype.mod=function(e){var t=o();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(i.ZERO)>0&&e.subTo(t,t),t},i.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new f(t):new g(t),this.exp(e,r)},i.prototype.clone=function(){var e=o();return this.copyTo(e),e},i.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},i.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},i.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},i.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},i.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,s=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[s++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0===s&&(128&this.s)!=(128&r)&&++s,(s>0||r!=this.s)&&(t[s++]=r);return t},i.prototype.toBuffer=function(e){var t=Buffer.from(this.toByteArray());if(!0===e&&0===t[0])t=t.slice(1);else if(s.isNumber(e)){if(t.length>e){for(var r=0;r<t.length-e;r++)if(0!==t[r])return null;return t.slice(t.length-e)}if(t.length<e){var n=Buffer.alloc(e);return n.fill(0,0,e-t.length),t.copy(n,e-t.length),n}}return t},i.prototype.equals=function(e){return 0==this.compareTo(e)},i.prototype.min=function(e){return this.compareTo(e)<0?this:e},i.prototype.max=function(e){return this.compareTo(e)>0?this:e},i.prototype.and=function(e){var t=o();return this.bitwiseTo(e,m,t),t},i.prototype.or=function(e){var t=o();return this.bitwiseTo(e,y,t),t},i.prototype.xor=function(e){var t=o();return this.bitwiseTo(e,v,t),t},i.prototype.andNot=function(e){var t=o();return this.bitwiseTo(e,w,t),t},i.prototype.not=function(){for(var e=o(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},i.prototype.shiftLeft=function(e){var t=o();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},i.prototype.shiftRight=function(e){var t=o();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},i.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+S(this[e]);return this.s<0?this.t*this.DB:-1},i.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=b(this[r]^t);return e},i.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},i.prototype.setBit=function(e){return this.changeBit(e,y)},i.prototype.clearBit=function(e){return this.changeBit(e,w)},i.prototype.flipBit=function(e){return this.changeBit(e,v)},i.prototype.add=function(e){var t=o();return this.addTo(e,t),t},i.prototype.subtract=function(e){var t=o();return this.subTo(e,t),t},i.prototype.multiply=function(e){var t=o();return this.multiplyTo(e,t),t},i.prototype.divide=function(e){var t=o();return this.divRemTo(e,t,null),t},i.prototype.remainder=function(e){var t=o();return this.divRemTo(e,null,t),t},i.prototype.divideAndRemainder=function(e){var t=o(),r=o();return this.divRemTo(e,t,r),new Array(t,r)},i.prototype.modPow=function(e,t){var r,n,s=e.bitLength(),i=d(1);if(s<=0)return i;r=s<18?1:s<48?3:s<144?4:s<768?5:6,n=s<8?new f(t):t.isEven()?new T(t):new g(t);var a=new Array,c=3,l=r-1,u=(1<<r)-1;if(a[1]=n.convert(this),r>1){var h=o();for(n.sqrTo(a[1],h);c<=u;)a[c]=o(),n.mulTo(h,a[c-2],a[c]),c+=2}var m,y,v=e.t-1,w=!0,S=o();for(s=p(e[v])-1;v>=0;){for(s>=l?m=e[v]>>s-l&u:(m=(e[v]&(1<<s+1)-1)<<l-s,v>0&&(m|=e[v-1]>>this.DB+s-l)),c=r;0==(1&m);)m>>=1,--c;if((s-=c)<0&&(s+=this.DB,--v),w)a[m].copyTo(i),w=!1;else{for(;c>1;)n.sqrTo(i,S),n.sqrTo(S,i),c-=2;c>0?n.sqrTo(i,S):(y=i,i=S,S=y),n.mulTo(S,a[m],i)}for(;v>=0&&0==(e[v]&1<<s);)n.sqrTo(i,S),y=i,i=S,S=y,--s<0&&(s=this.DB-1,--v)}return n.revert(i)},i.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0===e.signum())return i.ZERO;for(var r=e.clone(),n=this.clone(),s=d(1),o=d(0),a=d(0),c=d(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&s.subTo(a,s),o.subTo(c,o)):(n.subTo(r,n),t&&a.subTo(s,a),c.subTo(o,c))}return 0!=n.compareTo(i.ONE)?i.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},i.prototype.pow=function(e){return this.exp(e,new _)},i.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var s=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(s<i&&(i=s),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(s=t.getLowestSetBit())>0&&t.rShiftTo(s,t),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},i.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=C[C.length-1]){for(t=0;t<C.length;++t)if(r[0]==C[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<C.length;){for(var n=C[t],s=t+1;s<C.length&&n<P;)n*=C[s++];for(n=r.modInt(n);t<s;)if(n%C[t++]==0)return!1}return r.millerRabin(e)},i.int2char=u,i.ZERO=d(0),i.ONE=d(1),i.prototype.square=function(){var e=o();return this.squareTo(e),e},e.exports=i},450:(e,t,r)=>{var n=r(3016)._,s=(r(6113),r(6200)),i=r(3016),o=r(5954),a=r(6591);t.BigInteger=s,e.exports.Key=function(){function e(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return e.prototype.setOptions=function(e){var t=o[e.signingScheme],r=o[e.encryptionScheme];t===r?this.signingScheme=this.encryptionScheme=r.makeScheme(this,e):(this.encryptionScheme=r.makeScheme(this,e),this.signingScheme=t.makeScheme(this,e)),this.encryptEngine=a.getEngine(this,e)},e.prototype.generate=function(e,t){var r=e>>1;this.e=parseInt(t,16);for(var n=new s(t,16);;){for(;this.p=new s(e-r,1),0!==this.p.subtract(s.ONE).gcd(n).compareTo(s.ONE)||!this.p.isProbablePrime(10););for(;this.q=new s(r,1),0!==this.q.subtract(s.ONE).gcd(n).compareTo(s.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var i=this.p;this.p=this.q,this.q=i}var o=this.p.subtract(s.ONE),a=this.q.subtract(s.ONE),c=o.multiply(a);if(0===c.gcd(n).compareTo(s.ONE)){if(this.n=this.p.multiply(this.q),this.n.bitLength()<e)continue;this.d=n.modInverse(c),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.$$recalculateCache()},e.prototype.setPrivate=function(e,t,r,o,a,c,l,u){if(!(e&&t&&r&&e.length>0&&(n.isNumber(t)||t.length>0)&&r.length>0))throw Error("Invalid RSA private key");this.n=new s(e),this.e=n.isNumber(t)?t:i.get32IntFromBuffer(t,0),this.d=new s(r),o&&a&&c&&l&&u&&(this.p=new s(o),this.q=new s(a),this.dmp1=new s(c),this.dmq1=new s(l),this.coeff=new s(u)),this.$$recalculateCache()},e.prototype.setPublic=function(e,t){if(!(e&&t&&e.length>0&&(n.isNumber(t)||t.length>0)))throw Error("Invalid RSA public key");this.n=new s(e),this.e=n.isNumber(t)?t:i.get32IntFromBuffer(t,0),this.$$recalculateCache()},e.prototype.$doPrivate=function(e){if(this.p||this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},e.prototype.$doPublic=function(e){return e.modPowInt(this.e,this.n)},e.prototype.encrypt=function(e,t){var r=[],n=[],s=e.length,i=Math.ceil(s/this.maxMessageLength)||1,o=Math.ceil(s/i||1);if(1==i)r.push(e);else for(var a=0;a<i;a++)r.push(e.slice(a*o,(a+1)*o));for(var c=0;c<r.length;c++)n.push(this.encryptEngine.encrypt(r[c],t));return Buffer.concat(n)},e.prototype.decrypt=function(e,t){if(e.length%this.encryptedDataLength>0)throw Error("Incorrect data or key");for(var r=[],n=0,s=0,i=e.length/this.encryptedDataLength,o=0;o<i;o++)s=(n=o*this.encryptedDataLength)+this.encryptedDataLength,r.push(this.encryptEngine.decrypt(e.slice(n,Math.min(s,e.length)),t));return Buffer.concat(r)},e.prototype.sign=function(e){return this.signingScheme.sign.apply(this.signingScheme,arguments)},e.prototype.verify=function(e,t,r){return this.signingScheme.verify.apply(this.signingScheme,arguments)},e.prototype.isPrivate=function(){return!!(this.n&&this.e&&this.d)},e.prototype.isPublic=function(e){return this.n&&this.e&&!(e&&this.d)||!1},Object.defineProperty(e.prototype,"keySize",{get:function(){return this.cache.keyBitLength}}),Object.defineProperty(e.prototype,"encryptedDataLength",{get:function(){return this.cache.keyByteLength}}),Object.defineProperty(e.prototype,"maxMessageLength",{get:function(){return this.encryptionScheme.maxMessageLength()}}),e.prototype.$$recalculateCache=function(){this.cache=this.cache||{},this.cache.keyBitLength=this.n.bitLength(),this.cache.keyByteLength=this.cache.keyBitLength+6>>3},e}()},2313:(e,t,r)=>{r(6200);var n=r(6113);e.exports={isEncryption:!0,isSignature:!1},e.exports.digestLength={md4:16,md5:16,ripemd160:20,rmd160:20,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64};var s="sha1";e.exports.eme_oaep_mgf1=function(t,r,i){i=i||s;for(var o=e.exports.digestLength[i],a=Math.ceil(r/o),c=Buffer.alloc(o*a),l=Buffer.alloc(4),u=0;u<a;++u){var h=n.createHash(i);h.update(t),l.writeUInt32BE(u,0),h.update(l),h.digest().copy(c,u*o)}return c.slice(0,r)},e.exports.makeScheme=function(t,r){function i(e,t){this.key=e,this.options=t}return i.prototype.maxMessageLength=function(){return this.key.encryptedDataLength-2*e.exports.digestLength[this.options.encryptionSchemeOptions.hash||s]-2},i.prototype.encPad=function(t){var r=this.options.encryptionSchemeOptions.hash||s,i=this.options.encryptionSchemeOptions.mgf||e.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),a=this.key.encryptedDataLength,c=e.exports.digestLength[r];if(t.length>a-2*c-2)throw new Error("Message is too long to encode into an encoded message with a length of "+a+" bytes, increaseemLen to fix this error (minimum value for given parameters and options: "+(a-2*c-2)+")");var l=n.createHash(r);l.update(o),l=l.digest();var u=Buffer.alloc(a-t.length-2*c-1);u.fill(0),u[u.length-1]=1;for(var h=Buffer.concat([l,u,t]),d=n.randomBytes(c),p=i(d,h.length,r),f=0;f<h.length;f++)h[f]^=p[f];for(p=i(h,c,r),f=0;f<d.length;f++)d[f]^=p[f];var g=Buffer.alloc(1+d.length+h.length);return g[0]=0,d.copy(g,1),h.copy(g,1+d.length),g},i.prototype.encUnPad=function(t){var r=this.options.encryptionSchemeOptions.hash||s,i=this.options.encryptionSchemeOptions.mgf||e.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),a=e.exports.digestLength[r];if(t.length<2*a+2)throw new Error("Error decoding message, the supplied message is not long enough to be a valid OAEP encoded message");for(var c=t.slice(1,a+1),l=t.slice(1+a),u=i(l,a,r),h=0;h<c.length;h++)c[h]^=u[h];for(u=i(c,l.length,r),h=0;h<l.length;h++)l[h]^=u[h];var d=n.createHash(r);if(d.update(o),d=d.digest(),l.slice(0,a).toString("hex")!=d.toString("hex"))throw new Error("Error decoding message, the lHash calculated from the label provided and the lHash in the encrypted data do not match.");for(h=a;0===l[h++]&&h<l.length;);if(1!=l[h-1])throw new Error("Error decoding message, there is no padding message separator byte");return l.slice(h)},new i(t,r)}},1381:(e,t,r)=>{var n=r(6200),s=r(6113),i=r(2057),o={md2:Buffer.from("3020300c06082a864886f70d020205000410","hex"),md5:Buffer.from("3020300c06082a864886f70d020505000410","hex"),sha1:Buffer.from("3021300906052b0e03021a05000414","hex"),sha224:Buffer.from("302d300d06096086480165030402040500041c","hex"),sha256:Buffer.from("3031300d060960864801650304020105000420","hex"),sha384:Buffer.from("3041300d060960864801650304020205000430","hex"),sha512:Buffer.from("3051300d060960864801650304020305000440","hex"),ripemd160:Buffer.from("3021300906052b2403020105000414","hex"),rmd160:Buffer.from("3021300906052b2403020105000414","hex")},a={ripemd160:"rmd160"},c="sha256";e.exports={isEncryption:!0,isSignature:!0},e.exports.makeScheme=function(e,t){function r(e,t){this.key=e,this.options=t}return r.prototype.maxMessageLength=function(){return this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==i.RSA_NO_PADDING?this.key.encryptedDataLength:this.key.encryptedDataLength-11},r.prototype.encPad=function(e,t){var r;if(t=t||{},e.length>this.key.maxMessageLength)throw new Error("Message too long for RSA (n="+this.key.encryptedDataLength+", l="+e.length+")");if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==i.RSA_NO_PADDING)return(r=Buffer.alloc(this.key.maxMessageLength-e.length)).fill(0),Buffer.concat([r,e]);if(1===t.type)return(r=Buffer.alloc(this.key.encryptedDataLength-e.length-1)).fill(255,0,r.length-1),r[0]=1,r[r.length-1]=0,Buffer.concat([r,e]);(r=Buffer.alloc(this.key.encryptedDataLength-e.length))[0]=0,r[1]=2;for(var n=s.randomBytes(r.length-3),o=0;o<n.length;o++){for(var a=n[o];0===a;)a=s.randomBytes(1)[0];r[o+2]=a}return r[r.length-1]=0,Buffer.concat([r,e])},r.prototype.encUnPad=function(e,t){t=t||{};var r=0;if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==i.RSA_NO_PADDING)return"function"==typeof e.lastIndexOf?e.slice(e.lastIndexOf("\0")+1,e.length):e.slice(String.prototype.lastIndexOf.call(e,"\0")+1,e.length);if(e.length<4)return null;if(1===t.type){if(0!==e[0]||1!==e[1])return null;for(r=3;0!==e[r];)if(255!=e[r]||++r>=e.length)return null}else{if(0!==e[0]||2!==e[1])return null;for(r=3;0!==e[r];)if(++r>=e.length)return null}return e.slice(r+1,e.length)},r.prototype.sign=function(e){var t=this.options.signingSchemeOptions.hash||c;if("browser"===this.options.environment){t=a[t]||t;var r=s.createHash(t);r.update(e);var i=this.pkcs1pad(r.digest(),t);return this.key.$doPrivate(new n(i)).toBuffer(this.key.encryptedDataLength)}var o=s.createSign("RSA-"+t.toUpperCase());return o.update(e),o.sign(this.options.rsaUtils.exportKey("private"))},r.prototype.verify=function(e,t,r){if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==i.RSA_NO_PADDING)return!1;var o=this.options.signingSchemeOptions.hash||c;if("browser"===this.options.environment){o=a[o]||o,r&&(t=Buffer.from(t,r));var l=s.createHash(o);l.update(e);var u=this.pkcs1pad(l.digest(),o);return this.key.$doPublic(new n(t)).toBuffer().toString("hex")==u.toString("hex")}var h=s.createVerify("RSA-"+o.toUpperCase());return h.update(e),h.verify(this.options.rsaUtils.exportKey("public"),t,r)},r.prototype.pkcs0pad=function(e){var t=Buffer.alloc(this.key.maxMessageLength-e.length);return t.fill(0),Buffer.concat([t,e])},r.prototype.pkcs0unpad=function(e){return"function"==typeof e.lastIndexOf?e.slice(e.lastIndexOf("\0")+1,e.length):e.slice(String.prototype.lastIndexOf.call(e,"\0")+1,e.length)},r.prototype.pkcs1pad=function(e,t){var r=o[t];if(!r)throw Error("Unsupported hash algorithm");var n=Buffer.concat([r,e]);if(n.length+10>this.key.encryptedDataLength)throw Error("Key is too short for signing algorithm ("+t+")");var s=Buffer.alloc(this.key.encryptedDataLength-n.length-1);return s.fill(255,0,s.length-1),s[0]=1,s[s.length-1]=0,Buffer.concat([s,n])},new r(e,t)}},7971:(e,t,r)=>{var n=r(6200),s=r(6113);e.exports={isEncryption:!1,isSignature:!0};var i="sha1";e.exports.makeScheme=function(e,t){var o=r(5954).pkcs1_oaep;function a(e,t){this.key=e,this.options=t}return a.prototype.sign=function(e){var t=s.createHash(this.options.signingSchemeOptions.hash||i);t.update(e);var r=this.emsa_pss_encode(t.digest(),this.key.keySize-1);return this.key.$doPrivate(new n(r)).toBuffer(this.key.encryptedDataLength)},a.prototype.verify=function(e,t,r){r&&(t=Buffer.from(t,r)),t=new n(t);var o=Math.ceil((this.key.keySize-1)/8),a=this.key.$doPublic(t).toBuffer(o),c=s.createHash(this.options.signingSchemeOptions.hash||i);return c.update(e),this.emsa_pss_verify(c.digest(),a,this.key.keySize-1)},a.prototype.emsa_pss_encode=function(e,t){var r=this.options.signingSchemeOptions.hash||i,n=this.options.signingSchemeOptions.mgf||o.eme_oaep_mgf1,a=this.options.signingSchemeOptions.saltLength||20,c=o.digestLength[r],l=Math.ceil(t/8);if(l<c+a+2)throw new Error("Output length passed to emBits("+t+") is too small for the options specified("+r+", "+a+"). To fix this issue increase the value of emBits. (minimum size: "+(8*c+8*a+9)+")");var u=s.randomBytes(a),h=Buffer.alloc(8+c+a);h.fill(0,0,8),e.copy(h,8),u.copy(h,8+e.length);var d=s.createHash(r);d.update(h),d=d.digest();var p=Buffer.alloc(l-u.length-c-2);p.fill(0);var f=Buffer.alloc(p.length+1+u.length);p.copy(f),f[p.length]=1,u.copy(f,p.length+1);for(var g=n(d,f.length,r),m=Buffer.alloc(f.length),y=0;y<g.length;y++)m[y]=f[y]^g[y];var v=8*l-t,w=255^255>>8-v<<8-v;m[0]=m[0]&w;var S=Buffer.alloc(m.length+d.length+1);return m.copy(S,0),d.copy(S,m.length),S[S.length-1]=188,S},a.prototype.emsa_pss_verify=function(e,t,r){var n=this.options.signingSchemeOptions.hash||i,a=this.options.signingSchemeOptions.mgf||o.eme_oaep_mgf1,c=this.options.signingSchemeOptions.saltLength||20,l=o.digestLength[n],u=Math.ceil(r/8);if(u<l+c+2||188!=t[t.length-1])return!1;var h=Buffer.alloc(u-l-1);t.copy(h,0,0,u-l-1);for(var d=0,p=0,f=8*u-r;p<f;p++)d|=1<<7-p;if(0!=(h[0]&d))return!1;var g=t.slice(u-l-1,u-1),m=a(g,h.length,n);for(p=0;p<h.length;p++)h[p]^=m[p];for(d=255^255>>8-(f=8*u-r)<<8-f,h[0]=h[0]&d,p=0;0===h[p]&&p<h.length;p++);if(1!=h[p])return!1;var y=h.slice(h.length-c),v=Buffer.alloc(8+l+c);v.fill(0,0,8),e.copy(v,8),y.copy(v,8+e.length);var w=s.createHash(n);return w.update(v),w=w.digest(),g.toString("hex")===w.toString("hex")},new a(e,t)}},5954:(e,t,r)=>{e.exports={pkcs1:r(1381),pkcs1_oaep:r(2313),pss:r(7971),isEncryption:function(t){return e.exports[t]&&e.exports[t].isEncryption},isSignature:function(t){return e.exports[t]&&e.exports[t].isSignature}}},3016:(e,t,r)=>{r(6113),e.exports.linebrk=function(e,t){for(var r="",n=0;n+t<e.length;)r+=e.substring(n,n+t)+"\n",n+=t;return r+e.substring(n,e.length)},e.exports.detectEnvironment=function(){return"undefined"==typeof window||!window||process&&"node"===process.title?"node":"browser"},e.exports.get32IntFromBuffer=function(e,t){var r;if(t=t||0,(r=e.length-t)>0){if(r>=4)return e.readUIntBE(t,r);for(var n=0,s=t+r,i=0;s>t;s--,i+=2)n+=e[s-1]*Math.pow(16,i);return n}return NaN},e.exports._={isObject:function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)},isString:function(e){return"string"==typeof e||e instanceof String},isNumber:function(e){return"number"==typeof e||!isNaN(parseFloat(e))&&isFinite(e)},omit:function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&n!==t&&(r[n]=e[n]);return r}},e.exports.trimSurroundingText=function(e,t,r){var n=0,s=e.length,i=e.indexOf(t);i>=0&&(n=i+t.length);var o=e.indexOf(r,i);return o>=0&&(s=o),e.substring(n,s)}},443:(e,t,r)=>{"use strict";var n,s=r(4300),i=s.Buffer,o={};for(n in s)s.hasOwnProperty(n)&&"SlowBuffer"!==n&&"Buffer"!==n&&(o[n]=s[n]);var a=o.Buffer={};for(n in i)i.hasOwnProperty(n)&&"allocUnsafe"!==n&&"allocUnsafeSlow"!==n&&(a[n]=i[n]);if(o.Buffer.prototype=i.prototype,a.from&&a.from!==Uint8Array.from||(a.from=function(e,t,r){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return i(e,t,r)}),a.alloc||(a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=i(e);return t&&0!==t.length?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n}),!o.kStringMaxLength)try{o.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}o.constants||(o.constants={MAX_LENGTH:o.kMaxLength},o.kStringMaxLength&&(o.constants.MAX_STRING_LENGTH=o.kStringMaxLength)),e.exports=o},7672:(e,t,r)=>{"use strict";const{Transform:n}=r(2781),{StringDecoder:s}=r(1576),i=Symbol("last"),o=Symbol("decoder");function a(e,t,r){let n;if(this.overflow){if(n=this[o].write(e).split(this.matcher),1===n.length)return r();n.shift(),this.overflow=!1}else this[i]+=this[o].write(e),n=this[i].split(this.matcher);this[i]=n.pop();for(let e=0;e<n.length;e++)try{l(this,this.mapper(n[e]))}catch(e){return r(e)}this.overflow=this[i].length>this.maxLength,!this.overflow||this.skipOverflow?r():r(new Error("maximum buffer reached"))}function c(e){if(this[i]+=this[o].end(),this[i])try{l(this,this.mapper(this[i]))}catch(t){return e(t)}e()}function l(e,t){void 0!==t&&e.push(t)}function u(e){return e}e.exports=function(e,t,r){switch(e=e||/\r?\n/,t=t||u,r=r||{},arguments.length){case 1:"function"==typeof e?(t=e,e=/\r?\n/):"object"!=typeof e||e instanceof RegExp||e[Symbol.split]||(r=e,e=/\r?\n/);break;case 2:"function"==typeof e?(r=t,t=e,e=/\r?\n/):"object"==typeof t&&(r=t,t=u)}(r=Object.assign({},r)).autoDestroy=!0,r.transform=a,r.flush=c,r.readableObjectMode=!0;const l=new n(r);return l[i]="",l[o]=new s("utf8"),l.matcher=e,l.mapper=t,l.maxLength=r.maxLength,l.skipOverflow=r.skipOverflow||!1,l.overflow=!1,l._destroy=function(e,t){this._writableState.errorEmitted=!1,t(e)},l}},6795:(e,t,r)=>{"use strict";const n=r(2037),s=r(9002),i=process.env;let o;function a(e){const t=function(e){if(!1===o)return 0;if(s("color=16m")||s("color=full")||s("color=truecolor"))return 3;if(s("color=256"))return 2;if(e&&!e.isTTY&&!0!==o)return 0;const t=o?1:0;if("win32"===process.platform){const e=n.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in i)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((e=>e in i))||"codeship"===i.CI_NAME?1:t;if("TEAMCITY_VERSION"in i)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(i.TEAMCITY_VERSION)?1:0;if("truecolor"===i.COLORTERM)return 3;if("TERM_PROGRAM"in i){const e=parseInt((i.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(i.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(i.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(i.TERM)||"COLORTERM"in i?1:(i.TERM,t)}(e);return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(t)}s("no-color")||s("no-colors")||s("color=false")?o=!1:(s("color")||s("colors")||s("color=true")||s("color=always"))&&(o=!0),"FORCE_COLOR"in i&&(o=0===i.FORCE_COLOR.length||0!==parseInt(i.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},901:(e,t,r)=>{var n=r(4957).strict;e.exports=function(e){if(n(e)){var t=Buffer.from(e.buffer);return e.byteLength!==e.buffer.byteLength&&(t=t.slice(e.byteOffset,e.byteOffset+e.byteLength)),t}return Buffer.from(e)}},533:e=>{"use strict";e.exports=function(e){const t=e.length;let r=0;for(;r<t;)if(0==(128&e[r]))r++;else if(192==(224&e[r])){if(r+1===t||128!=(192&e[r+1])||192==(254&e[r]))return!1;r+=2}else if(224==(240&e[r])){if(r+2>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||224===e[r]&&128==(224&e[r+1])||237===e[r]&&160==(224&e[r+1]))return!1;r+=3}else{if(240!=(248&e[r]))return!1;if(r+3>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||128!=(192&e[r+3])||240===e[r]&&128==(240&e[r+1])||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}},3682:(e,t,r)=>{"use strict";try{e.exports=r(816)(__dirname)}catch(t){e.exports=r(533)}},1328:(e,t,r)=>{var n=r(5195),s=r(6876),i=s;i.v1=n,i.v4=s,e.exports=i},6746:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var n=r||0,s=t;return[s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]]].join("")}},2373:(e,t,r)=>{var n=r(6113);e.exports=function(){return n.randomBytes(16)}},5195:(e,t,r)=>{var n,s,i=r(2373),o=r(6746),a=0,c=0;e.exports=function(e,t,r){var l=t&&r||0,u=t||[],h=(e=e||{}).node||n,d=void 0!==e.clockseq?e.clockseq:s;if(null==h||null==d){var p=i();null==h&&(h=n=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=s=16383&(p[6]<<8|p[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:c+1,m=f-a+(g-c)/1e4;if(m<0&&void 0===e.clockseq&&(d=d+1&16383),(m<0||f>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,c=g,s=d;var y=(1e4*(268435455&(f+=122192928e5))+g)%4294967296;u[l++]=y>>>24&255,u[l++]=y>>>16&255,u[l++]=y>>>8&255,u[l++]=255&y;var v=f/4294967296*1e4&268435455;u[l++]=v>>>8&255,u[l++]=255&v,u[l++]=v>>>24&15|16,u[l++]=v>>>16&255,u[l++]=d>>>8|128,u[l++]=255&d;for(var w=0;w<6;++w)u[l+w]=h[w];return t||o(u)}},6876:(e,t,r)=>{var n=r(2373),s=r(6746);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[i+a]=o[a];return t||s(o)}},2962:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8957),s=r(5897);var i;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:n.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:n.Event.None}),e.is=function(t){let r=t;return r&&(r===e.None||r===e.Cancelled||s.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}}(i=t.CancellationToken||(t.CancellationToken={}));const o=Object.freeze((function(e,t){let r=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(r)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._emitter=void 0))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new n.Emitter),this._emitter.event)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=i.Cancelled}dispose(){this.cancel()}}},8957:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}},function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class r{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var r=!1,n=0,s=this._callbacks.length;n<s;n++)if(this._callbacks[n]===e){if(this._contexts[n]===t)return this._callbacks.splice(n,1),void this._contexts.splice(n,1);r=!0}if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],r=this._callbacks.slice(0),n=this._contexts.slice(0),s=0,i=r.length;s<i;s++)try{t.push(r[s].apply(n[s],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class n{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,s)=>{let i;return this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),i={dispose:()=>{this._callbacks.remove(e,t),i.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(s)&&s.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}n._noop=function(){},t.Emitter=n},5897:(e,t)=>{"use strict";function r(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=r,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every((e=>r(e)))}},4274:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(r=t.Touch||(t.Touch={})),t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,n=r.None){let s=this._map.get(e);if(s)s.value=t,n!==r.None&&this.touch(s,n);else{switch(s={key:e,value:t,next:void 0,previous:void 0},n){case r.None:this.addItemLast(s);break;case r.First:this.addItemFirst(s);break;case r.Last:default:this.addItemLast(s)}this._map.set(e,s),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._head;for(;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.next}forEachReverse(e,t){let r=this._tail;for(;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===r.First||t===r.Last)if(t===r.First){if(e===this._head)return;const t=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(t.previous=r,r.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===r.Last){if(e===this._tail)return;const t=e.next,r=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=r,r.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},5844:(e,t,r)=>{"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});const s=r(5897),i=r(1907);t.RequestType=i.RequestType,t.RequestType0=i.RequestType0,t.RequestType1=i.RequestType1,t.RequestType2=i.RequestType2,t.RequestType3=i.RequestType3,t.RequestType4=i.RequestType4,t.RequestType5=i.RequestType5,t.RequestType6=i.RequestType6,t.RequestType7=i.RequestType7,t.RequestType8=i.RequestType8,t.RequestType9=i.RequestType9,t.ResponseError=i.ResponseError,t.ErrorCodes=i.ErrorCodes,t.NotificationType=i.NotificationType,t.NotificationType0=i.NotificationType0,t.NotificationType1=i.NotificationType1,t.NotificationType2=i.NotificationType2,t.NotificationType3=i.NotificationType3,t.NotificationType4=i.NotificationType4,t.NotificationType5=i.NotificationType5,t.NotificationType6=i.NotificationType6,t.NotificationType7=i.NotificationType7,t.NotificationType8=i.NotificationType8,t.NotificationType9=i.NotificationType9;const o=r(8152);t.MessageReader=o.MessageReader,t.StreamMessageReader=o.StreamMessageReader,t.IPCMessageReader=o.IPCMessageReader,t.SocketMessageReader=o.SocketMessageReader;const a=r(1618);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=r(8957);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=r(2962);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const u=r(4274);var h,d,p,f,g,m,y;n(r(3718)),n(r(2351)),function(e){e.type=new i.NotificationType("$/cancelRequest")}(h||(h={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(d=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(d=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new i.NotificationType("$/setTraceNotification")}(f=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new i.NotificationType("$/logTraceNotification")}(g=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(m=t.ConnectionErrors||(t.ConnectionErrors={}));class v extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,v.prototype)}}function w(e,t,r,n){let o=0,a=0,w=0;const S="2.0";let b,_,E,T,C=Object.create(null),P=Object.create(null),A=new u.LinkedMap,R=Object.create(null),I=Object.create(null),x=d.Off,O=p.Text,k=y.New,M=new c.Emitter,N=new c.Emitter,D=new c.Emitter,L=new c.Emitter;function B(e){return"req-"+e.toString()}function q(e){}function j(){return k===y.Listening}function F(){return k===y.Closed}function U(){return k===y.Disposed}function $(){k!==y.New&&k!==y.Listening||(k=y.Closed,N.fire(void 0))}function H(){E||0===A.size||(E=setImmediate((()=>{E=void 0,function(){if(0===A.size)return;let e=A.shift();try{i.isRequestMessage(e)?function(e){if(U())return;function r(r,n,s){let o={jsonrpc:S,id:e.id};r instanceof i.ResponseError?o.error=r.toJson():o.result=void 0===r?null:r,V(o,n,s),t.write(o)}function n(r,n,s){let i={jsonrpc:S,id:e.id,error:r.toJson()};V(i,n,s),t.write(i)}!function(e){if(x!==d.Off&&T)if(O===p.Text){let t;x===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),T.log(`Received request '${e.method} - (${e.id})'.`,t)}else z("receive-request",e)}(e);let o,a,c=C[e.method];c&&(o=c.type,a=c.handler);let u=Date.now();if(a||b){let c=new l.CancellationTokenSource,h=String(e.id);I[h]=c;try{let l;l=void 0===e.params||void 0!==o&&0===o.numberOfParams?a?a(c.token):b(e.method,c.token):s.array(e.params)&&(void 0===o||o.numberOfParams>1)?a?a(...e.params,c.token):b(e.method,...e.params,c.token):a?a(e.params,c.token):b(e.method,e.params,c.token);let d=l;l?d.then?d.then((t=>{delete I[h],r(t,e.method,u)}),(t=>{delete I[h],t instanceof i.ResponseError?n(t,e.method,u):t&&s.string(t.message)?n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)})):(delete I[h],r(l,e.method,u)):(delete I[h],function(r,n,s){void 0===r&&(r=null);let i={jsonrpc:S,id:e.id,result:r};V(i,n,s),t.write(i)}(l,e.method,u))}catch(t){delete I[h],t instanceof i.ResponseError?r(t,e.method,u):t&&s.string(t.message)?n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else n(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):i.isNotificationMessage(e)?function(e){if(U())return;let t,n;if(e.method===h.type.method)n=e=>{let t=e.id,r=I[String(t)];r&&r.cancel()};else{let r=P[e.method];r&&(n=r.handler,t=r.type)}if(n||_)try{!function(e){if(x!==d.Off&&T&&e.method!==g.type.method)if(O===p.Text){let t;x===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),T.log(`Received notification '${e.method}'.`,t)}else z("receive-notification",e)}(e),void 0===e.params||void 0!==t&&0===t.numberOfParams?n?n():_(e.method):s.array(e.params)&&(void 0===t||t.numberOfParams>1)?n?n(...e.params):_(e.method,...e.params):n?n(e.params):_(e.method,e.params)}catch(t){t.message?r.error(`Notification handler '${e.method}' failed with message: ${t.message}`):r.error(`Notification handler '${e.method}' failed unexpectedly.`)}else D.fire(e)}(e):i.isResponseMessage(e)?function(e){if(!U())if(null===e.id)e.error?r.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):r.error("Received response message without id. No further error information provided.");else{let t=String(e.id),n=R[t];if(function(e,t){if(x!==d.Off&&T)if(O===p.Text){let r;if(x===d.Verbose&&(e.error&&e.error.data?r=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?r=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),t){let n=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";T.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${n}`,r)}else T.log(`Received response ${e.id} without active response promise.`,r)}else z("receive-response",e)}(e,n),n){delete R[t];try{if(e.error){let t=e.error;n.reject(new i.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?r.error(`Response handler '${n.method}' failed with message: ${e.message}`):r.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void r.error("Received empty message.");r.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(s.string(t.id)||s.number(t.id)){let e=String(t.id),r=R[e];r&&r.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{H()}}()})))}e.onClose($),e.onError((function(e){M.fire([e,void 0,void 0])})),t.onClose($),t.onError((function(e){M.fire(e)}));let K=e=>{try{if(i.isNotificationMessage(e)&&e.method===h.type.method){let r=B(e.params.id),s=A.get(r);if(i.isRequestMessage(s)){let i=n&&n.cancelUndispatched?n.cancelUndispatched(s,q):void 0;if(i&&(void 0!==i.error||void 0!==i.result))return A.delete(r),i.id=s.id,V(i,e.method,Date.now()),void t.write(i)}}!function(e,t){var r;i.isRequestMessage(t)?e.set(B(t.id),t):i.isResponseMessage(t)?e.set(null===(r=t.id)?"res-unknown-"+(++w).toString():"res-"+r.toString(),t):e.set("not-"+(++a).toString(),t)}(A,e)}finally{H()}};function V(e,t,r){if(x!==d.Off&&T)if(O===p.Text){let n;x===d.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),T.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-r}ms`,n)}else z("send-response",e)}function z(e,t){if(!T||x===d.Off)return;const r={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};T.log(r)}function W(){if(F())throw new v(m.Closed,"Connection is closed.");if(U())throw new v(m.Disposed,"Connection is disposed.")}function G(e){return void 0===e?null:e}function Y(e,t){let r,n=e.numberOfParams;switch(n){case 0:r=null;break;case 1:r=G(t[0]);break;default:r=[];for(let e=0;e<t.length&&e<n;e++)r.push(G(t[e]));if(t.length<n)for(let e=t.length;e<n;e++)r.push(null)}return r}let Q={sendNotification:(e,...r)=>{let n,i;if(W(),s.string(e))switch(n=e,r.length){case 0:i=null;break;case 1:i=r[0];break;default:i=r}else n=e.method,i=Y(e,r);let o={jsonrpc:S,method:n,params:i};!function(e){if(x!==d.Off&&T)if(O===p.Text){let t;x===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),T.log(`Sending notification '${e.method}'.`,t)}else z("send-notification",e)}(o),t.write(o)},onNotification:(e,t)=>{W(),s.func(e)?_=e:t&&(s.string(e)?P[e]={type:void 0,handler:t}:P[e.method]={type:e,handler:t})},sendRequest:(e,...r)=>{let n,a,c;if(W(),function(){if(!j())throw new Error("Call listen() first.")}(),s.string(e))switch(n=e,r.length){case 0:a=null;break;case 1:l.CancellationToken.is(r[0])?(a=null,c=r[0]):a=G(r[0]);break;default:const e=r.length-1;l.CancellationToken.is(r[e])?(c=r[e],a=2===r.length?G(r[0]):r.slice(0,e).map((e=>G(e)))):a=r.map((e=>G(e)))}else{n=e.method,a=Y(e,r);let t=e.numberOfParams;c=l.CancellationToken.is(r[t])?r[t]:void 0}let u=o++,f=new Promise(((e,r)=>{let s={jsonrpc:S,id:u,method:n,params:a},o={method:n,timerStart:Date.now(),resolve:e,reject:r};!function(e){if(x!==d.Off&&T)if(O===p.Text){let t;x===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),T.log(`Sending request '${e.method} - (${e.id})'.`,t)}else z("send-request",e)}(s);try{t.write(s)}catch(e){o.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),o=null}o&&(R[String(u)]=o)}));return c&&c.onCancellationRequested((()=>{Q.sendNotification(h.type,{id:u})})),f},onRequest:(e,t)=>{W(),s.func(e)?b=e:t&&(s.string(e)?C[e]={type:void 0,handler:t}:C[e.method]={type:e,handler:t})},trace:(e,t,r)=>{let n=!1,i=p.Text;void 0!==r&&(s.boolean(r)?n=r:(n=r.sendNotification||!1,i=r.traceFormat||p.Text)),x=e,O=i,T=x===d.Off?void 0:t,!n||F()||U()||Q.sendNotification(f.type,{value:d.toString(e)})},onError:M.event,onClose:N.event,onUnhandledNotification:D.event,onDispose:L.event,dispose:()=>{if(U())return;k=y.Disposed,L.fire(void 0);let r=new Error("Connection got disposed.");Object.keys(R).forEach((e=>{R[e].reject(r)})),R=Object.create(null),I=Object.create(null),A=new u.LinkedMap,s.func(t.dispose)&&t.dispose(),s.func(e.dispose)&&e.dispose()},listen:()=>{W(),function(){if(j())throw new v(m.AlreadyListening,"Connection is already listening")}(),k=y.Listening,e.listen(K)},inspect:()=>{console.log("inspect")}};return Q.onNotification(g.type,(e=>{x!==d.Off&&T&&T.log(e.message,x===d.Verbose?e.verbose:void 0)})),Q}t.ConnectionError=v,(t.ConnectionStrategy||(t.ConnectionStrategy={})).is=function(e){let t=e;return t&&s.func(t.cancelUndispatched)},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,r,n,s){n||(n=t.NullLogger);let i=void 0!==(c=e).listen&&void 0===c.read?e:new o.StreamMessageReader(e);var c;let l=function(e){return void 0!==e.write&&void 0===e.end}(r)?r:new a.StreamMessageWriter(r);return w(i,l,n,s)}},8152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8957),s=r(5897);let i=8192,o=Buffer.from("\r","ascii")[0],a=Buffer.from("\n","ascii")[0];class c{constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(i)}append(e){var t=e;if("string"==typeof e){var r=e,n=Buffer.byteLength(r,this.encoding);(t=Buffer.allocUnsafe(n)).write(r,0,n,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var s=(Math.ceil((this.index+t.length)/i)+1)*i;0===this.index?(this.buffer=Buffer.allocUnsafe(s),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],s)}this.index+=t.length}tryReadHeaders(){let e,t=0;for(;t+3<this.index&&(this.buffer[t]!==o||this.buffer[t+1]!==a||this.buffer[t+2]!==o||this.buffer[t+3]!==a);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach((t=>{let r=t.indexOf(":");if(-1===r)throw new Error("Message header must separate key and value using :");let n=t.substr(0,r),s=t.substr(r+1).trim();e[n]=s}));let r=t+4;return this.buffer=this.buffer.slice(r),this.index=this.index-r,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),r=e;return this.buffer.copy(this.buffer,0,r),this.index=this.index-r,t}get numberOfBytes(){return this.index}}(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&s.func(t.listen)&&s.func(t.dispose)&&s.func(t.onError)&&s.func(t.onClose)&&s.func(t.onPartialMessage)};class l{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.partialMessageEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader recevied error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=l;class u extends l{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new c(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",(e=>{this.onData(e)})),this.readable.on("error",(e=>this.fireError(e))),this.readable.on("close",(()=>this.fireClose()))}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let r=parseInt(t);if(isNaN(r))throw new Error("Content-Length value must be a number.");this.nextMessageLength=r}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var r=JSON.parse(t);this.callback(r)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=u,t.IPCMessageReader=class extends l{constructor(e){super(),this.process=e;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose()))}listen(e){this.process.on("message",e)}},t.SocketMessageReader=class extends u{constructor(e,t="utf-8"){super(e,t)}}},1618:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8957),s=r(5897);let i="Content-Length: ",o="\r\n";(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&s.func(t.dispose)&&s.func(t.onClose)&&s.func(t.onError)&&s.func(t.write)};class a{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer recevied error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=a,t.StreamMessageWriter=class extends a{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",(e=>this.fireError(e))),this.writable.on("close",(()=>this.fireClose()))}write(e){let t=JSON.stringify(e),r=Buffer.byteLength(t,this.encoding),n=[i,r.toString(),o,o];try{this.writable.write(n.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}},t.IPCMessageWriter=class extends a{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose))}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,(t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}},t.SocketMessageWriter=class extends a{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",(e=>this.fireError(e))),this.socket.on("close",(()=>this.fireClose()))}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){let t=JSON.stringify(e),r=Buffer.byteLength(t,this.encoding),n=[i,r.toString(),o,o];try{this.sending=!0,this.socket.write(n.join(""),"ascii",(r=>{r&&this.handleError(r,e);try{this.socket.write(t,this.encoding,(t=>{this.sending=!1,t?this.handleError(t,e):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(r){this.handleError(r,e)}}))}catch(t){this.handleError(t,e)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}},1907:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5897);var s;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.MessageWriteError=1,e.MessageReadError=2}(s=t.ErrorCodes||(t.ErrorCodes={}));class i extends Error{constructor(e,t,r){super(t),this.code=n.number(e)?e:s.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,i.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=i;class o{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=o,t.RequestType0=class extends o{constructor(e){super(e,0),this._=void 0}},t.RequestType=class extends o{constructor(e){super(e,1),this._=void 0}},t.RequestType1=class extends o{constructor(e){super(e,1),this._=void 0}},t.RequestType2=class extends o{constructor(e){super(e,2),this._=void 0}},t.RequestType3=class extends o{constructor(e){super(e,3),this._=void 0}},t.RequestType4=class extends o{constructor(e){super(e,4),this._=void 0}},t.RequestType5=class extends o{constructor(e){super(e,5),this._=void 0}},t.RequestType6=class extends o{constructor(e){super(e,6),this._=void 0}},t.RequestType7=class extends o{constructor(e){super(e,7),this._=void 0}},t.RequestType8=class extends o{constructor(e){super(e,8),this._=void 0}},t.RequestType9=class extends o{constructor(e){super(e,9),this._=void 0}},t.NotificationType=class extends o{constructor(e){super(e,1),this._=void 0}},t.NotificationType0=class extends o{constructor(e){super(e,0),this._=void 0}},t.NotificationType1=class extends o{constructor(e){super(e,1),this._=void 0}},t.NotificationType2=class extends o{constructor(e){super(e,2),this._=void 0}},t.NotificationType3=class extends o{constructor(e){super(e,3),this._=void 0}},t.NotificationType4=class extends o{constructor(e){super(e,4),this._=void 0}},t.NotificationType5=class extends o{constructor(e){super(e,5),this._=void 0}},t.NotificationType6=class extends o{constructor(e){super(e,6),this._=void 0}},t.NotificationType7=class extends o{constructor(e){super(e,7),this._=void 0}},t.NotificationType8=class extends o{constructor(e){super(e,8),this._=void 0}},t.NotificationType9=class extends o{constructor(e){super(e,9),this._=void 0}},t.isRequestMessage=function(e){let t=e;return t&&n.string(t.method)&&(n.string(t.id)||n.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&n.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(n.string(t.id)||n.number(t.id)||null===t.id)}},3718:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1017),s=r(2037),i=r(6113),o=r(1808),a=r(8152),c=r(1618);t.generateRandomPipeName=function(){const e=i.randomBytes(21).toString("hex");return"win32"===process.platform?`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`:n.join(s.tmpdir(),`vscode-${e}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let r,n=new Promise(((e,t)=>{r=e}));return new Promise(((s,i)=>{let l=o.createServer((e=>{l.close(),r([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])}));l.on("error",i),l.listen(e,(()=>{l.removeListener("error",i),s({onConnected:()=>n})}))}))},t.createServerPipeTransport=function(e,t="utf-8"){const r=o.createConnection(e);return[new a.SocketMessageReader(r,t),new c.SocketMessageWriter(r,t)]}},2351:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1808),s=r(8152),i=r(1618);t.createClientSocketTransport=function(e,t="utf-8"){let r,o=new Promise(((e,t)=>{r=e}));return new Promise(((a,c)=>{let l=n.createServer((e=>{l.close(),r([new s.SocketMessageReader(e,t),new i.SocketMessageWriter(e,t)])}));l.on("error",c),l.listen(e,"127.0.0.1",(()=>{l.removeListener("error",c),a({onConnected:()=>o})}))}))},t.createServerSocketTransport=function(e,t="utf-8"){const r=n.createConnection(e,"127.0.0.1");return[new s.SocketMessageReader(r,t),new i.SocketMessageWriter(r,t)]}},5952:function(e,t){var r;r=function(e){"use strict";const t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:e=>`Symbol(${e})`;function r(){}const n="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0;function s(e){return"object"==typeof e&&null!==e||"function"==typeof e}const i=r,o=Promise,a=Promise.prototype.then,c=Promise.resolve.bind(o),l=Promise.reject.bind(o);function u(e){return new o(e)}function h(e){return c(e)}function d(e){return l(e)}function p(e,t,r){return a.call(e,t,r)}function f(e,t,r){p(p(e,t,r),void 0,i)}function g(e,t){f(e,t)}function m(e,t){f(e,void 0,t)}function y(e,t,r){return p(e,t,r)}function v(e){p(e,void 0,i)}const w=(()=>{const e=n&&n.queueMicrotask;if("function"==typeof e)return e;const t=h(void 0);return e=>p(t,e)})();function S(e,t,r){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function b(e,t,r){try{return h(S(e,t,r))}catch(e){return d(e)}}class _{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){const t=this._back;let r=t;16383===t._elements.length&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size}shift(){const e=this._front;let t=e;const r=this._cursor;let n=r+1;const s=e._elements,i=s[r];return 16384===n&&(t=e._next,n=0),--this._size,this._cursor=n,e!==t&&(this._front=t),s[r]=void 0,i}forEach(e){let t=this._cursor,r=this._front,n=r._elements;for(;!(t===n.length&&void 0===r._next||t===n.length&&(r=r._next,n=r._elements,t=0,0===n.length));)e(n[t]),++t}peek(){const e=this._front,t=this._cursor;return e._elements[t]}}function E(e,t){e._ownerReadableStream=t,t._reader=e,"readable"===t._state?A(e):"closed"===t._state?function(e){A(e),x(e)}(e):R(e,t._storedError)}function T(e,t){return Sr(e._ownerReadableStream,t)}function C(e){"readable"===e._ownerReadableStream._state?I(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(e,t){R(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness"))}(e),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function P(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function A(e){e._closedPromise=u(((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r}))}function R(e,t){A(e),I(e,t)}function I(e,t){void 0!==e._closedPromise_reject&&(v(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function x(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}const O=t("[[AbortSteps]]"),k=t("[[ErrorSteps]]"),M=t("[[CancelSteps]]"),N=t("[[PullSteps]]"),D=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},L=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function B(e,t){if(void 0!==e&&"object"!=typeof(r=e)&&"function"!=typeof r)throw new TypeError(`${t} is not an object.`);var r}function q(e,t){if("function"!=typeof e)throw new TypeError(`${t} is not a function.`)}function j(e,t){if(!function(e){return"object"==typeof e&&null!==e||"function"==typeof e}(e))throw new TypeError(`${t} is not an object.`)}function F(e,t,r){if(void 0===e)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function U(e,t,r){if(void 0===e)throw new TypeError(`${t} is required in '${r}'.`)}function $(e){return Number(e)}function H(e){return 0===e?0:e}function K(e,t){const r=Number.MAX_SAFE_INTEGER;let n=Number(e);if(n=H(n),!D(n))throw new TypeError(`${t} is not a finite number`);if(n=function(e){return H(L(e))}(n),n<0||n>r)throw new TypeError(`${t} is outside the accepted range of 0 to ${r}, inclusive`);return D(n)&&0!==n?n:0}function V(e,t){if(!vr(e))throw new TypeError(`${t} is not a ReadableStream.`)}function z(e){return new X(e)}function W(e,t){e._reader._readRequests.push(t)}function G(e,t,r){const n=e._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(t)}function Y(e){return e._reader._readRequests.length}function Q(e){const t=e._reader;return void 0!==t&&!!J(t)}class X{constructor(e){if(F(e,1,"ReadableStreamDefaultReader"),V(e,"First parameter"),wr(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");E(this,e),this._readRequests=new _}get closed(){return J(this)?this._closedPromise:d(ee("closed"))}cancel(e){return J(this)?void 0===this._ownerReadableStream?d(P("cancel")):T(this,e):d(ee("cancel"))}read(){if(!J(this))return d(ee("read"));if(void 0===this._ownerReadableStream)return d(P("read from"));let e,t;const r=u(((r,n)=>{e=r,t=n}));return Z(this,{_chunkSteps:t=>e({value:t,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:e=>t(e)}),r}releaseLock(){if(!J(this))throw ee("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");C(this)}}}function J(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof X}function Z(e,t){const r=e._ownerReadableStream;r._disturbed=!0,"closed"===r._state?t._closeSteps():"errored"===r._state?t._errorSteps(r._storedError):r._readableStreamController[N](t)}function ee(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}Object.defineProperties(X.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(X.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});const te=Object.getPrototypeOf(Object.getPrototypeOf((async function*(){})).prototype);class re{constructor(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}next(){const e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?y(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){const t=()=>this._returnSteps(e);return this._ongoingPromise?y(this._ongoingPromise,t,t):t()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const e=this._reader;if(void 0===e._ownerReadableStream)return d(P("iterate"));let t,r;const n=u(((e,n)=>{t=e,r=n}));return Z(e,{_chunkSteps:e=>{this._ongoingPromise=void 0,w((()=>t({value:e,done:!1})))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,C(e),t({value:void 0,done:!0})},_errorSteps:t=>{this._ongoingPromise=void 0,this._isFinished=!0,C(e),r(t)}}),n}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;const t=this._reader;if(void 0===t._ownerReadableStream)return d(P("finish iterating"));if(!this._preventCancel){const r=T(t,e);return C(t),y(r,(()=>({value:e,done:!0})))}return C(t),h({value:e,done:!0})}}const ne={next(){return se(this)?this._asyncIteratorImpl.next():d(ie("next"))},return(e){return se(this)?this._asyncIteratorImpl.return(e):d(ie("return"))}};function se(e){if(!s(e))return!1;if(!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof re}catch(e){return!1}}function ie(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}void 0!==te&&Object.setPrototypeOf(ne,te);const oe=Number.isNaN||function(e){return e!=e};function ae(e){return e.slice()}function ce(e,t,r,n,s){new Uint8Array(e).set(new Uint8Array(r,n,s),t)}function le(e,t,r){if(e.slice)return e.slice(t,r);const n=r-t,s=new ArrayBuffer(n);return ce(s,0,e,t,n),s}function ue(e){const t=le(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function he(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function de(e,t,r){if("number"!=typeof(n=r)||oe(n)||n<0||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");var n;e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function pe(e){e._queue=new _,e._queueTotalSize=0}class fe{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!ye(this))throw je("view");return this._view}respond(e){if(!ye(this))throw je("respond");if(F(e,1,"respond"),e=K(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");this._view.buffer,Le(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!ye(this))throw je("respondWithNewView");if(F(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");e.buffer,Be(this._associatedReadableByteStreamController,e)}}Object.defineProperties(fe.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(fe.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class ge{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!me(this))throw Fe("byobRequest");return Ne(this)}get desiredSize(){if(!me(this))throw Fe("desiredSize");return De(this)}close(){if(!me(this))throw Fe("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const e=this._controlledReadableByteStream._state;if("readable"!==e)throw new TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);Oe(this)}enqueue(e){if(!me(this))throw Fe("enqueue");if(F(e,1,"enqueue"),!ArrayBuffer.isView(e))throw new TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw new TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const t=this._controlledReadableByteStream._state;if("readable"!==t)throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);ke(this,e)}error(e){if(!me(this))throw Fe("error");Me(this,e)}[M](e){we(this),pe(this);const t=this._cancelAlgorithm(e);return xe(this),t}[N](e){const t=this._controlledReadableByteStream;if(this._queueTotalSize>0){const t=this._queue.shift();this._queueTotalSize-=t.byteLength,Ce(this);const r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return void e._chunkSteps(r)}const r=this._autoAllocateChunkSize;if(void 0!==r){let t;try{t=new ArrayBuffer(r)}catch(t){return void e._errorSteps(t)}const n={buffer:t,bufferByteLength:r,byteOffset:0,byteLength:r,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(n)}W(t,e),ve(this)}}function me(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof ge}function ye(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof fe}function ve(e){const t=function(e){const t=e._controlledReadableByteStream;return"readable"===t._state&&!e._closeRequested&&!!e._started&&(!!(Q(t)&&Y(t)>0)||!!(Ke(t)&&He(t)>0)||De(e)>0)}(e);t&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,f(e._pullAlgorithm(),(()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ve(e))}),(t=>{Me(e,t)}))))}function we(e){Pe(e),e._pendingPullIntos=new _}function Se(e,t){let r=!1;"closed"===e._state&&(r=!0);const n=be(t);"default"===t.readerType?G(e,n,r):function(e,t,r){const n=e._reader._readIntoRequests.shift();r?n._closeSteps(t):n._chunkSteps(t)}(e,n,r)}function be(e){const t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function _e(e,t,r,n){e._queue.push({buffer:t,byteOffset:r,byteLength:n}),e._queueTotalSize+=n}function Ee(e,t){const r=t.elementSize,n=t.bytesFilled-t.bytesFilled%r,s=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),i=t.bytesFilled+s,o=i-i%r;let a=s,c=!1;o>n&&(a=o-t.bytesFilled,c=!0);const l=e._queue;for(;a>0;){const r=l.peek(),n=Math.min(a,r.byteLength),s=t.byteOffset+t.bytesFilled;ce(t.buffer,s,r.buffer,r.byteOffset,n),r.byteLength===n?l.shift():(r.byteOffset+=n,r.byteLength-=n),e._queueTotalSize-=n,Te(0,n,t),a-=n}return c}function Te(e,t,r){r.bytesFilled+=t}function Ce(e){0===e._queueTotalSize&&e._closeRequested?(xe(e),br(e._controlledReadableByteStream)):ve(e)}function Pe(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Ae(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;const t=e._pendingPullIntos.peek();Ee(e,t)&&(Ie(e),Se(e._controlledReadableByteStream,t))}}function Re(e,t){const r=e._pendingPullIntos.peek();Pe(e),"closed"===e._controlledReadableByteStream._state?function(e,t){const r=e._controlledReadableByteStream;if(Ke(r))for(;He(r)>0;)Se(r,Ie(e))}(e):function(e,t,r){if(Te(0,t,r),r.bytesFilled<r.elementSize)return;Ie(e);const n=r.bytesFilled%r.elementSize;if(n>0){const t=r.byteOffset+r.bytesFilled,s=le(r.buffer,t-n,t);_e(e,s,0,s.byteLength)}r.bytesFilled-=n,Se(e._controlledReadableByteStream,r),Ae(e)}(e,t,r),ve(e)}function Ie(e){return e._pendingPullIntos.shift()}function xe(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Oe(e){const t=e._controlledReadableByteStream;if(!e._closeRequested&&"readable"===t._state)if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Me(e,t),t}xe(e),br(t)}}function ke(e,t){const r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;const n=t.buffer,s=t.byteOffset,i=t.byteLength,o=n;if(e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek();t.buffer,t.buffer=t.buffer}Pe(e),Q(r)?0===Y(r)?_e(e,o,s,i):(e._pendingPullIntos.length>0&&Ie(e),G(r,new Uint8Array(o,s,i),!1)):Ke(r)?(_e(e,o,s,i),Ae(e)):_e(e,o,s,i),ve(e)}function Me(e,t){const r=e._controlledReadableByteStream;"readable"===r._state&&(we(e),pe(e),xe(e),_r(r,t))}function Ne(e){if(null===e._byobRequest&&e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),n=Object.create(fe.prototype);!function(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}(n,e,r),e._byobRequest=n}return e._byobRequest}function De(e){const t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Le(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===t)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=r.buffer,Re(e,t)}function Be(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t.byteLength)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===t.byteLength)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const n=t.byteLength;r.buffer=t.buffer,Re(e,n)}function qe(e,t,r,n,s,i,o){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,pe(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=s,t._autoAllocateChunkSize=o,t._pendingPullIntos=new _,e._readableStreamController=t,f(h(r()),(()=>{t._started=!0,ve(t)}),(e=>{Me(t,e)}))}function je(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Fe(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Ue(e){return new Ve(e)}function $e(e,t){e._reader._readIntoRequests.push(t)}function He(e){return e._reader._readIntoRequests.length}function Ke(e){const t=e._reader;return void 0!==t&&!!ze(t)}Object.defineProperties(ge.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(ge.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class Ve{constructor(e){if(F(e,1,"ReadableStreamBYOBReader"),V(e,"First parameter"),wr(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!me(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");E(this,e),this._readIntoRequests=new _}get closed(){return ze(this)?this._closedPromise:d(Ge("closed"))}cancel(e){return ze(this)?void 0===this._ownerReadableStream?d(P("cancel")):T(this,e):d(Ge("cancel"))}read(e){if(!ze(this))return d(Ge("read"));if(!ArrayBuffer.isView(e))return d(new TypeError("view must be an array buffer view"));if(0===e.byteLength)return d(new TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return d(new TypeError("view's buffer must have non-zero byteLength"));if(e.buffer,void 0===this._ownerReadableStream)return d(P("read from"));let t,r;const n=u(((e,n)=>{t=e,r=n}));return We(this,e,{_chunkSteps:e=>t({value:e,done:!1}),_closeSteps:e=>t({value:e,done:!0}),_errorSteps:e=>r(e)}),n}releaseLock(){if(!ze(this))throw Ge("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");C(this)}}}function ze(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof Ve}function We(e,t,r){const n=e._ownerReadableStream;n._disturbed=!0,"errored"===n._state?r._errorSteps(n._storedError):function(e,t,r){const n=e._controlledReadableByteStream;let s=1;t.constructor!==DataView&&(s=t.constructor.BYTES_PER_ELEMENT);const i=t.constructor,o=t.buffer,a={buffer:o,bufferByteLength:o.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:s,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(a),void $e(n,r);if("closed"!==n._state){if(e._queueTotalSize>0){if(Ee(e,a)){const t=be(a);return Ce(e),void r._chunkSteps(t)}if(e._closeRequested){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");return Me(e,t),void r._errorSteps(t)}}e._pendingPullIntos.push(a),$e(n,r),ve(e)}else{const e=new i(a.buffer,a.byteOffset,0);r._closeSteps(e)}}(n._readableStreamController,t,r)}function Ge(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Ye(e,t){const{highWaterMark:r}=e;if(void 0===r)return t;if(oe(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Qe(e){const{size:t}=e;return t||(()=>1)}function Xe(e,t){B(e,t);const r=null==e?void 0:e.highWaterMark,n=null==e?void 0:e.size;return{highWaterMark:void 0===r?void 0:$(r),size:void 0===n?void 0:Je(n,`${t} has member 'size' that`)}}function Je(e,t){return q(e,t),t=>$(e(t))}function Ze(e,t,r){return q(e,r),r=>b(e,t,[r])}function et(e,t,r){return q(e,r),()=>b(e,t,[])}function tt(e,t,r){return q(e,r),r=>S(e,t,[r])}function rt(e,t,r){return q(e,r),(r,n)=>b(e,t,[r,n])}function nt(e,t){if(!ct(e))throw new TypeError(`${t} is not a WritableStream.`)}Object.defineProperties(Ve.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Ve.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});const st="function"==typeof AbortController;class it{constructor(e={},t={}){void 0===e?e=null:j(e,"First parameter");const r=Xe(t,"Second parameter"),n=function(e,t){B(e,t);const r=null==e?void 0:e.abort,n=null==e?void 0:e.close,s=null==e?void 0:e.start,i=null==e?void 0:e.type,o=null==e?void 0:e.write;return{abort:void 0===r?void 0:Ze(r,e,`${t} has member 'abort' that`),close:void 0===n?void 0:et(n,e,`${t} has member 'close' that`),start:void 0===s?void 0:tt(s,e,`${t} has member 'start' that`),write:void 0===o?void 0:rt(o,e,`${t} has member 'write' that`),type:i}}(e,"First parameter");if(at(this),void 0!==n.type)throw new RangeError("Invalid type is specified");const s=Qe(r);!function(e,t,r,n){const s=Object.create(Ct.prototype);let i=()=>{},o=()=>h(void 0),a=()=>h(void 0),c=()=>h(void 0);void 0!==t.start&&(i=()=>t.start(s)),void 0!==t.write&&(o=e=>t.write(e,s)),void 0!==t.close&&(a=()=>t.close()),void 0!==t.abort&&(c=e=>t.abort(e)),At(e,s,i,o,a,c,r,n)}(this,n,Ye(r,1),s)}get locked(){if(!ct(this))throw Nt("locked");return lt(this)}abort(e){return ct(this)?lt(this)?d(new TypeError("Cannot abort a stream that already has a writer")):ut(this,e):d(Nt("abort"))}close(){return ct(this)?lt(this)?d(new TypeError("Cannot close a stream that already has a writer")):gt(this)?d(new TypeError("Cannot close an already-closing stream")):ht(this):d(Nt("close"))}getWriter(){if(!ct(this))throw Nt("getWriter");return ot(this)}}function ot(e){return new vt(e)}function at(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new _,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function ct(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof it}function lt(e){return void 0!==e._writer}function ut(e,t){var r;if("closed"===e._state||"errored"===e._state)return h(void 0);e._writableStreamController._abortReason=t,null===(r=e._writableStreamController._abortController)||void 0===r||r.abort();const n=e._state;if("closed"===n||"errored"===n)return h(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let s=!1;"erroring"===n&&(s=!0,t=void 0);const i=u(((r,n)=>{e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:n,_reason:t,_wasAlreadyErroring:s}}));return e._pendingAbortRequest._promise=i,s||pt(e,t),i}function ht(e){const t=e._state;if("closed"===t||"errored"===t)return d(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const r=u(((t,r)=>{const n={_resolve:t,_reject:r};e._closeRequest=n})),n=e._writer;var s;return void 0!==n&&e._backpressure&&"writable"===t&&zt(n),de(s=e._writableStreamController,Tt,0),xt(s),r}function dt(e,t){"writable"!==e._state?ft(e):pt(e,t)}function pt(e,t){const r=e._writableStreamController;e._state="erroring",e._storedError=t;const n=e._writer;void 0!==n&&bt(n,t),!function(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}(e)&&r._started&&ft(e)}function ft(e){e._state="errored",e._writableStreamController[k]();const t=e._storedError;if(e._writeRequests.forEach((e=>{e._reject(t)})),e._writeRequests=new _,void 0===e._pendingAbortRequest)return void mt(e);const r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void mt(e);f(e._writableStreamController[O](r._reason),(()=>{r._resolve(),mt(e)}),(t=>{r._reject(t),mt(e)}))}function gt(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function mt(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;void 0!==t&&Ft(t,e._storedError)}function yt(e,t){const r=e._writer;void 0!==r&&t!==e._backpressure&&(t?function(e){$t(e)}(r):zt(r)),e._backpressure=t}Object.defineProperties(it.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(it.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});class vt{constructor(e){if(F(e,1,"WritableStreamDefaultWriter"),nt(e,"First parameter"),lt(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;const t=e._state;if("writable"===t)!gt(e)&&e._backpressure?$t(this):Kt(this),qt(this);else if("erroring"===t)Ht(this,e._storedError),qt(this);else if("closed"===t)Kt(this),qt(this),Ut(this);else{const t=e._storedError;Ht(this,t),jt(this,t)}}get closed(){return wt(this)?this._closedPromise:d(Lt("closed"))}get desiredSize(){if(!wt(this))throw Lt("desiredSize");if(void 0===this._ownerWritableStream)throw Bt("desiredSize");return function(e){const t=e._ownerWritableStream,r=t._state;return"errored"===r||"erroring"===r?null:"closed"===r?0:It(t._writableStreamController)}(this)}get ready(){return wt(this)?this._readyPromise:d(Lt("ready"))}abort(e){return wt(this)?void 0===this._ownerWritableStream?d(Bt("abort")):function(e,t){return ut(e._ownerWritableStream,t)}(this,e):d(Lt("abort"))}close(){if(!wt(this))return d(Lt("close"));const e=this._ownerWritableStream;return void 0===e?d(Bt("close")):gt(e)?d(new TypeError("Cannot close an already-closing stream")):St(this)}releaseLock(){if(!wt(this))throw Lt("releaseLock");void 0!==this._ownerWritableStream&&_t(this)}write(e){return wt(this)?void 0===this._ownerWritableStream?d(Bt("write to")):Et(this,e):d(Lt("write"))}}function wt(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof vt}function St(e){return ht(e._ownerWritableStream)}function bt(e,t){"pending"===e._readyPromiseState?Vt(e,t):function(e,t){Ht(e,t)}(e,t)}function _t(e){const t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");bt(e,r),function(e,t){"pending"===e._closedPromiseState?Ft(e,t):function(e,t){jt(e,t)}(e,t)}(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function Et(e,t){const r=e._ownerWritableStream,n=r._writableStreamController,s=function(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return Ot(e,t),1}}(n,t);if(r!==e._ownerWritableStream)return d(Bt("write to"));const i=r._state;if("errored"===i)return d(r._storedError);if(gt(r)||"closed"===i)return d(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===i)return d(r._storedError);const o=function(e){return u(((t,r)=>{const n={_resolve:t,_reject:r};e._writeRequests.push(n)}))}(r);return function(e,t,r){try{de(e,t,r)}catch(t){return void Ot(e,t)}const n=e._controlledWritableStream;gt(n)||"writable"!==n._state||yt(n,kt(e)),xt(e)}(n,t,s),o}Object.defineProperties(vt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(vt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const Tt={};class Ct{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Pt(this))throw Dt("abortReason");return this._abortReason}get signal(){if(!Pt(this))throw Dt("signal");if(void 0===this._abortController)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e){if(!Pt(this))throw Dt("error");"writable"===this._controlledWritableStream._state&&Mt(this,e)}[O](e){const t=this._abortAlgorithm(e);return Rt(this),t}[k](){pe(this)}}function Pt(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof Ct}function At(e,t,r,n,s,i,o,a){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,pe(t),t._abortReason=void 0,t._abortController=function(){if(st)return new AbortController}(),t._started=!1,t._strategySizeAlgorithm=a,t._strategyHWM=o,t._writeAlgorithm=n,t._closeAlgorithm=s,t._abortAlgorithm=i;const c=kt(t);yt(e,c),f(h(r()),(()=>{t._started=!0,xt(t)}),(r=>{t._started=!0,dt(e,r)}))}function Rt(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function It(e){return e._strategyHWM-e._queueTotalSize}function xt(e){const t=e._controlledWritableStream;if(!e._started)return;if(void 0!==t._inFlightWriteRequest)return;if("erroring"===t._state)return void ft(t);if(0===e._queue.length)return;const r=e._queue.peek().value;r===Tt?function(e){const t=e._controlledWritableStream;(function(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0})(t),he(e);const r=e._closeAlgorithm();Rt(e),f(r,(()=>{!function(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";const t=e._writer;void 0!==t&&Ut(t)}(t)}),(e=>{!function(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),dt(e,t)}(t,e)}))}(e):function(e,t){const r=e._controlledWritableStream;!function(e){e._inFlightWriteRequest=e._writeRequests.shift()}(r),f(e._writeAlgorithm(t),(()=>{!function(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}(r);const t=r._state;if(he(e),!gt(r)&&"writable"===t){const t=kt(e);yt(r,t)}xt(e)}),(t=>{"writable"===r._state&&Rt(e),function(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,dt(e,t)}(r,t)}))}(e,r)}function Ot(e,t){"writable"===e._controlledWritableStream._state&&Mt(e,t)}function kt(e){return It(e)<=0}function Mt(e,t){const r=e._controlledWritableStream;Rt(e),pt(r,t)}function Nt(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Dt(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Lt(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Bt(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function qt(e){e._closedPromise=u(((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"}))}function jt(e,t){qt(e),Ft(e,t)}function Ft(e,t){void 0!==e._closedPromise_reject&&(v(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Ut(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function $t(e){e._readyPromise=u(((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r})),e._readyPromiseState="pending"}function Ht(e,t){$t(e),Vt(e,t)}function Kt(e){$t(e),zt(e)}function Vt(e,t){void 0!==e._readyPromise_reject&&(v(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function zt(e){void 0!==e._readyPromise_resolve&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(Ct.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Ct.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const Wt="undefined"!=typeof DOMException?DOMException:void 0,Gt=function(e){if("function"!=typeof e&&"object"!=typeof e)return!1;try{return new e,!0}catch(e){return!1}}(Wt)?Wt:function(){const e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}();function Yt(e,t,n,s,i,o){const a=z(e),c=ot(t);e._disturbed=!0;let l=!1,y=h(void 0);return u(((w,S)=>{let b;if(void 0!==o){if(b=()=>{const r=new Gt("Aborted","AbortError"),n=[];s||n.push((()=>"writable"===t._state?ut(t,r):h(void 0))),i||n.push((()=>"readable"===e._state?Sr(e,r):h(void 0))),R((()=>Promise.all(n.map((e=>e())))),!0,r)},o.aborted)return void b();o.addEventListener("abort",b)}var _,E,T;if(A(e,a._closedPromise,(e=>{s?I(!0,e):R((()=>ut(t,e)),!0,e)})),A(t,c._closedPromise,(t=>{i?I(!0,t):R((()=>Sr(e,t)),!0,t)})),_=e,E=a._closedPromise,T=()=>{n?I():R((()=>function(e){const t=e._ownerWritableStream,r=t._state;return gt(t)||"closed"===r?h(void 0):"errored"===r?d(t._storedError):St(e)}(c)))},"closed"===_._state?T():g(E,T),gt(t)||"closed"===t._state){const t=new TypeError("the destination writable stream closed before all data could be piped to it");i?I(!0,t):R((()=>Sr(e,t)),!0,t)}function P(){const e=y;return p(y,(()=>e!==y?P():void 0))}function A(e,t,r){"errored"===e._state?r(e._storedError):m(t,r)}function R(e,r,n){function s(){f(e(),(()=>x(r,n)),(e=>x(!0,e)))}l||(l=!0,"writable"!==t._state||gt(t)?s():g(P(),s))}function I(e,r){l||(l=!0,"writable"!==t._state||gt(t)?x(e,r):g(P(),(()=>x(e,r))))}function x(e,t){_t(c),C(a),void 0!==o&&o.removeEventListener("abort",b),e?S(t):w(void 0)}v(u(((e,t)=>{!function n(s){s?e():p(l?h(!0):p(c._readyPromise,(()=>u(((e,t)=>{Z(a,{_chunkSteps:t=>{y=p(Et(c,t),void 0,r),e(!1)},_closeSteps:()=>e(!0),_errorSteps:t})})))),n,t)}(!1)})))}))}class Qt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Xt(this))throw ar("desiredSize");return sr(this)}close(){if(!Xt(this))throw ar("close");if(!ir(this))throw new TypeError("The stream is not in a state that permits close");tr(this)}enqueue(e){if(!Xt(this))throw ar("enqueue");if(!ir(this))throw new TypeError("The stream is not in a state that permits enqueue");return rr(this,e)}error(e){if(!Xt(this))throw ar("error");nr(this,e)}[M](e){pe(this);const t=this._cancelAlgorithm(e);return er(this),t}[N](e){const t=this._controlledReadableStream;if(this._queue.length>0){const r=he(this);this._closeRequested&&0===this._queue.length?(er(this),br(t)):Jt(this),e._chunkSteps(r)}else W(t,e),Jt(this)}}function Xt(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof Qt}function Jt(e){Zt(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,f(e._pullAlgorithm(),(()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Jt(e))}),(t=>{nr(e,t)}))))}function Zt(e){const t=e._controlledReadableStream;return!!ir(e)&&!!e._started&&(!!(wr(t)&&Y(t)>0)||sr(e)>0)}function er(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function tr(e){if(!ir(e))return;const t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(er(e),br(t))}function rr(e,t){if(!ir(e))return;const r=e._controlledReadableStream;if(wr(r)&&Y(r)>0)G(r,t,!1);else{let r;try{r=e._strategySizeAlgorithm(t)}catch(t){throw nr(e,t),t}try{de(e,t,r)}catch(t){throw nr(e,t),t}}Jt(e)}function nr(e,t){const r=e._controlledReadableStream;"readable"===r._state&&(pe(e),er(e),_r(r,t))}function sr(e){const t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function ir(e){const t=e._controlledReadableStream._state;return!e._closeRequested&&"readable"===t}function or(e,t,r,n,s,i,o){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,pe(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=o,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=s,e._readableStreamController=t,f(h(r()),(()=>{t._started=!0,Jt(t)}),(e=>{nr(t,e)}))}function ar(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function cr(e,t,r){return q(e,r),r=>b(e,t,[r])}function lr(e,t,r){return q(e,r),r=>b(e,t,[r])}function ur(e,t,r){return q(e,r),r=>S(e,t,[r])}function hr(e,t){if("bytes"!=(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function dr(e,t){if("byob"!=(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function pr(e,t){B(e,t);const r=null==e?void 0:e.preventAbort,n=null==e?void 0:e.preventCancel,s=null==e?void 0:e.preventClose,i=null==e?void 0:e.signal;return void 0!==i&&function(e,t){if(!function(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}(e))throw new TypeError(`${t} is not an AbortSignal.`)}(i,`${t} has member 'signal' that`),{preventAbort:Boolean(r),preventCancel:Boolean(n),preventClose:Boolean(s),signal:i}}Object.defineProperties(Qt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Qt.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});class fr{constructor(e={},t={}){void 0===e?e=null:j(e,"First parameter");const r=Xe(t,"Second parameter"),n=function(e,t){B(e,t);const r=e,n=null==r?void 0:r.autoAllocateChunkSize,s=null==r?void 0:r.cancel,i=null==r?void 0:r.pull,o=null==r?void 0:r.start,a=null==r?void 0:r.type;return{autoAllocateChunkSize:void 0===n?void 0:K(n,`${t} has member 'autoAllocateChunkSize' that`),cancel:void 0===s?void 0:cr(s,r,`${t} has member 'cancel' that`),pull:void 0===i?void 0:lr(i,r,`${t} has member 'pull' that`),start:void 0===o?void 0:ur(o,r,`${t} has member 'start' that`),type:void 0===a?void 0:hr(a,`${t} has member 'type' that`)}}(e,"First parameter");if(yr(this),"bytes"===n.type){if(void 0!==r.size)throw new RangeError("The strategy for a byte stream cannot have a size function");!function(e,t,r){const n=Object.create(ge.prototype);let s=()=>{},i=()=>h(void 0),o=()=>h(void 0);void 0!==t.start&&(s=()=>t.start(n)),void 0!==t.pull&&(i=()=>t.pull(n)),void 0!==t.cancel&&(o=e=>t.cancel(e));const a=t.autoAllocateChunkSize;if(0===a)throw new TypeError("autoAllocateChunkSize must be greater than 0");qe(e,n,s,i,o,r,a)}(this,n,Ye(r,0))}else{const e=Qe(r);!function(e,t,r,n){const s=Object.create(Qt.prototype);let i=()=>{},o=()=>h(void 0),a=()=>h(void 0);void 0!==t.start&&(i=()=>t.start(s)),void 0!==t.pull&&(o=()=>t.pull(s)),void 0!==t.cancel&&(a=e=>t.cancel(e)),or(e,s,i,o,a,r,n)}(this,n,Ye(r,1),e)}}get locked(){if(!vr(this))throw Er("locked");return wr(this)}cancel(e){return vr(this)?wr(this)?d(new TypeError("Cannot cancel a stream that already has a reader")):Sr(this,e):d(Er("cancel"))}getReader(e){if(!vr(this))throw Er("getReader");return void 0===function(e,t){B(e,t);const r=null==e?void 0:e.mode;return{mode:void 0===r?void 0:dr(r,`${t} has member 'mode' that`)}}(e,"First parameter").mode?z(this):Ue(this)}pipeThrough(e,t={}){if(!vr(this))throw Er("pipeThrough");F(e,1,"pipeThrough");const r=function(e,t){B(e,t);const r=null==e?void 0:e.readable;U(r,"readable","ReadableWritablePair"),V(r,`${t} has member 'readable' that`);const n=null==e?void 0:e.writable;return U(n,"writable","ReadableWritablePair"),nt(n,`${t} has member 'writable' that`),{readable:r,writable:n}}(e,"First parameter"),n=pr(t,"Second parameter");if(wr(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(lt(r.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return v(Yt(this,r.writable,n.preventClose,n.preventAbort,n.preventCancel,n.signal)),r.readable}pipeTo(e,t={}){if(!vr(this))return d(Er("pipeTo"));if(void 0===e)return d("Parameter 1 is required in 'pipeTo'.");if(!ct(e))return d(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let r;try{r=pr(t,"Second parameter")}catch(e){return d(e)}return wr(this)?d(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):lt(e)?d(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Yt(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)}tee(){if(!vr(this))throw Er("tee");return ae(me((e=this)._readableStreamController)?function(e){let t,r,n,s,i,o=z(e),a=!1,c=!1,l=!1,d=!1,p=!1;const f=u((e=>{i=e}));function g(e){m(e._closedPromise,(t=>{e===o&&(Me(n._readableStreamController,t),Me(s._readableStreamController,t),d&&p||i(void 0))}))}function y(){ze(o)&&(C(o),o=z(e),g(o)),Z(o,{_chunkSteps:t=>{w((()=>{c=!1,l=!1;const r=t;let o=t;if(!d&&!p)try{o=ue(t)}catch(t){return Me(n._readableStreamController,t),Me(s._readableStreamController,t),void i(Sr(e,t))}d||ke(n._readableStreamController,r),p||ke(s._readableStreamController,o),a=!1,c?S():l&&b()}))},_closeSteps:()=>{a=!1,d||Oe(n._readableStreamController),p||Oe(s._readableStreamController),n._readableStreamController._pendingPullIntos.length>0&&Le(n._readableStreamController,0),s._readableStreamController._pendingPullIntos.length>0&&Le(s._readableStreamController,0),d&&p||i(void 0)},_errorSteps:()=>{a=!1}})}function v(t,r){J(o)&&(C(o),o=Ue(e),g(o));const u=r?s:n,h=r?n:s;We(o,t,{_chunkSteps:t=>{w((()=>{c=!1,l=!1;const n=r?p:d;if(r?d:p)n||Be(u._readableStreamController,t);else{let r;try{r=ue(t)}catch(t){return Me(u._readableStreamController,t),Me(h._readableStreamController,t),void i(Sr(e,t))}n||Be(u._readableStreamController,t),ke(h._readableStreamController,r)}a=!1,c?S():l&&b()}))},_closeSteps:e=>{a=!1;const t=r?p:d,n=r?d:p;t||Oe(u._readableStreamController),n||Oe(h._readableStreamController),void 0!==e&&(t||Be(u._readableStreamController,e),!n&&h._readableStreamController._pendingPullIntos.length>0&&Le(h._readableStreamController,0)),t&&n||i(void 0)},_errorSteps:()=>{a=!1}})}function S(){if(a)return c=!0,h(void 0);a=!0;const e=Ne(n._readableStreamController);return null===e?y():v(e._view,!1),h(void 0)}function b(){if(a)return l=!0,h(void 0);a=!0;const e=Ne(s._readableStreamController);return null===e?y():v(e._view,!0),h(void 0)}function _(){}return n=mr(_,S,(function(n){if(d=!0,t=n,p){const n=ae([t,r]),s=Sr(e,n);i(s)}return f})),s=mr(_,b,(function(n){if(p=!0,r=n,d){const n=ae([t,r]),s=Sr(e,n);i(s)}return f})),g(o),[n,s]}(e):function(e,t){const r=z(e);let n,s,i,o,a,c=!1,l=!1,d=!1,p=!1;const f=u((e=>{a=e}));function g(){return c?(l=!0,h(void 0)):(c=!0,Z(r,{_chunkSteps:e=>{w((()=>{l=!1;const t=e,r=e;d||rr(i._readableStreamController,t),p||rr(o._readableStreamController,r),c=!1,l&&g()}))},_closeSteps:()=>{c=!1,d||tr(i._readableStreamController),p||tr(o._readableStreamController),d&&p||a(void 0)},_errorSteps:()=>{c=!1}}),h(void 0))}function y(){}return i=gr(y,g,(function(t){if(d=!0,n=t,p){const t=ae([n,s]),r=Sr(e,t);a(r)}return f})),o=gr(y,g,(function(t){if(p=!0,s=t,d){const t=ae([n,s]),r=Sr(e,t);a(r)}return f})),m(r._closedPromise,(e=>{nr(i._readableStreamController,e),nr(o._readableStreamController,e),d&&p||a(void 0)})),[i,o]}(e));var e}values(e){if(!vr(this))throw Er("values");return function(e,t){const r=z(e),n=new re(r,t),s=Object.create(ne);return s._asyncIteratorImpl=n,s}(this,function(e,t){B(e,"First parameter");const r=null==e?void 0:e.preventCancel;return{preventCancel:Boolean(r)}}(e).preventCancel)}}function gr(e,t,r,n=1,s=(()=>1)){const i=Object.create(fr.prototype);return yr(i),or(i,Object.create(Qt.prototype),e,t,r,n,s),i}function mr(e,t,r){const n=Object.create(fr.prototype);return yr(n),qe(n,Object.create(ge.prototype),e,t,r,0,void 0),n}function yr(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function vr(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof fr}function wr(e){return void 0!==e._reader}function Sr(e,t){if(e._disturbed=!0,"closed"===e._state)return h(void 0);if("errored"===e._state)return d(e._storedError);br(e);const n=e._reader;return void 0!==n&&ze(n)&&(n._readIntoRequests.forEach((e=>{e._closeSteps(void 0)})),n._readIntoRequests=new _),y(e._readableStreamController[M](t),r)}function br(e){e._state="closed";const t=e._reader;void 0!==t&&(x(t),J(t)&&(t._readRequests.forEach((e=>{e._closeSteps()})),t._readRequests=new _))}function _r(e,t){e._state="errored",e._storedError=t;const r=e._reader;void 0!==r&&(I(r,t),J(r)?(r._readRequests.forEach((e=>{e._errorSteps(t)})),r._readRequests=new _):(r._readIntoRequests.forEach((e=>{e._errorSteps(t)})),r._readIntoRequests=new _))}function Er(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Tr(e,t){B(e,t);const r=null==e?void 0:e.highWaterMark;return U(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:$(r)}}Object.defineProperties(fr.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(fr.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"==typeof t.asyncIterator&&Object.defineProperty(fr.prototype,t.asyncIterator,{value:fr.prototype.values,writable:!0,configurable:!0});const Cr=e=>e.byteLength;try{Object.defineProperty(Cr,"name",{value:"size",configurable:!0})}catch(e){}class Pr{constructor(e){F(e,1,"ByteLengthQueuingStrategy"),e=Tr(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!Rr(this))throw Ar("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Rr(this))throw Ar("size");return Cr}}function Ar(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function Rr(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")&&e instanceof Pr}Object.defineProperties(Pr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Pr.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});const Ir=()=>1;try{Object.defineProperty(Ir,"name",{value:"size",configurable:!0})}catch(e){}class xr{constructor(e){F(e,1,"CountQueuingStrategy"),e=Tr(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!kr(this))throw Or("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!kr(this))throw Or("size");return Ir}}function Or(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function kr(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")&&e instanceof xr}function Mr(e,t,r){return q(e,r),r=>b(e,t,[r])}function Nr(e,t,r){return q(e,r),r=>S(e,t,[r])}function Dr(e,t,r){return q(e,r),(r,n)=>b(e,t,[r,n])}Object.defineProperties(xr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(xr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});class Lr{constructor(e={},t={},r={}){void 0===e&&(e=null);const n=Xe(t,"Second parameter"),s=Xe(r,"Third parameter"),i=function(e,t){B(e,t);const r=null==e?void 0:e.flush,n=null==e?void 0:e.readableType,s=null==e?void 0:e.start,i=null==e?void 0:e.transform,o=null==e?void 0:e.writableType;return{flush:void 0===r?void 0:Mr(r,e,`${t} has member 'flush' that`),readableType:n,start:void 0===s?void 0:Nr(s,e,`${t} has member 'start' that`),transform:void 0===i?void 0:Dr(i,e,`${t} has member 'transform' that`),writableType:o}}(e,"First parameter");if(void 0!==i.readableType)throw new RangeError("Invalid readableType specified");if(void 0!==i.writableType)throw new RangeError("Invalid writableType specified");const o=Ye(s,0),a=Qe(s),c=Ye(n,1),l=Qe(n);let p;!function(e,t,r,n,s,i){function o(){return t}e._writable=function(e,t,r,n,s=1,i=(()=>1)){const o=Object.create(it.prototype);return at(o),At(o,Object.create(Ct.prototype),e,t,r,n,s,i),o}(o,(function(t){return function(e,t){const r=e._transformStreamController;return e._backpressure?y(e._backpressureChangePromise,(()=>{const n=e._writable;if("erroring"===n._state)throw n._storedError;return Vr(r,t)})):Vr(r,t)}(e,t)}),(function(){return function(e){const t=e._readable,r=e._transformStreamController,n=r._flushAlgorithm();return Hr(r),y(n,(()=>{if("errored"===t._state)throw t._storedError;tr(t._readableStreamController)}),(r=>{throw qr(e,r),t._storedError}))}(e)}),(function(t){return function(e,t){return qr(e,t),h(void 0)}(e,t)}),r,n),e._readable=gr(o,(function(){return function(e){return Fr(e,!1),e._backpressureChangePromise}(e)}),(function(t){return jr(e,t),h(void 0)}),s,i),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Fr(e,!0),e._transformStreamController=void 0}(this,u((e=>{p=e})),c,l,o,a),function(e,t){const r=Object.create(Ur.prototype);let n=e=>{try{return Kr(r,e),h(void 0)}catch(e){return d(e)}},s=()=>h(void 0);void 0!==t.transform&&(n=e=>t.transform(e,r)),void 0!==t.flush&&(s=()=>t.flush(r)),function(e,t,r,n){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=n}(e,r,n,s)}(this,i),void 0!==i.start?p(i.start(this._transformStreamController)):p(void 0)}get readable(){if(!Br(this))throw Wr("readable");return this._readable}get writable(){if(!Br(this))throw Wr("writable");return this._writable}}function Br(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof Lr}function qr(e,t){nr(e._readable._readableStreamController,t),jr(e,t)}function jr(e,t){Hr(e._transformStreamController),Ot(e._writable._writableStreamController,t),e._backpressure&&Fr(e,!1)}function Fr(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=u((t=>{e._backpressureChangePromise_resolve=t})),e._backpressure=t}Object.defineProperties(Lr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Lr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});class Ur{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!$r(this))throw zr("desiredSize");return sr(this._controlledTransformStream._readable._readableStreamController)}enqueue(e){if(!$r(this))throw zr("enqueue");Kr(this,e)}error(e){if(!$r(this))throw zr("error");var t;t=e,qr(this._controlledTransformStream,t)}terminate(){if(!$r(this))throw zr("terminate");!function(e){const t=e._controlledTransformStream;tr(t._readable._readableStreamController);jr(t,new TypeError("TransformStream terminated"))}(this)}}function $r(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof Ur}function Hr(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Kr(e,t){const r=e._controlledTransformStream,n=r._readable._readableStreamController;if(!ir(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{rr(n,t)}catch(e){throw jr(r,e),r._readable._storedError}const s=function(e){return!Zt(e)}(n);s!==r._backpressure&&Fr(r,!0)}function Vr(e,t){return y(e._transformAlgorithm(t),void 0,(t=>{throw qr(e._controlledTransformStream,t),t}))}function zr(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Wr(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}Object.defineProperties(Ur.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Ur.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0}),e.ByteLengthQueuingStrategy=Pr,e.CountQueuingStrategy=xr,e.ReadableByteStreamController=ge,e.ReadableStream=fr,e.ReadableStreamBYOBReader=Ve,e.ReadableStreamBYOBRequest=fe,e.ReadableStreamDefaultController=Qt,e.ReadableStreamDefaultReader=X,e.TransformStream=Lr,e.TransformStreamDefaultController=Ur,e.WritableStream=it,e.WritableStreamDefaultController=Ct,e.WritableStreamDefaultWriter=vt,Object.defineProperty(e,"__esModule",{value:!0})},r(t)},8766:(e,t,r)=>{e.exports=r(5729)},9168:e=>{var t={disableWarnings:!1,deprecationWarningMap:{},warn:function(e){!this.disableWarnings&&this.deprecationWarningMap[e]&&(console.warn("DEPRECATION WARNING: "+this.deprecationWarningMap[e]),this.deprecationWarningMap[e]=!1)}};e.exports=t},348:(e,t,r)=>{var n=r(2339),s=r(901),i=r(1334);const o=0,a=1,c=2,l=3;function u(e,t,r,s,a,c){i.EventTarget.call(this),(c=c||{}).assembleFragments=!0;var l=this;this._url=e,this._readyState=o,this._protocol=void 0,this._extensions="",this._bufferedAmount=0,this._binaryType="arraybuffer",this._connection=void 0,this._client=new n(c),this._client.on("connect",(function(e){p.call(l,e)})),this._client.on("connectFailed",(function(){f.call(l)})),this._client.connect(e,t,r,s,a)}function h(e,t){var r=new i.Event("close");return r.code=e,r.reason=t,r.wasClean=void 0===e||1e3===e,r}function d(e){var t=new i.Event("message");return t.data=e,t}function p(e){var t=this;this._readyState=a,this._connection=e,this._protocol=e.protocol,this._extensions=e.extensions,this._connection.on("close",(function(e,r){g.call(t,e,r)})),this._connection.on("message",(function(e){m.call(t,e)})),this.dispatchEvent(new i.Event("open"))}function f(){y.call(this),this._readyState=l;try{this.dispatchEvent(new i.Event("error"))}finally{this.dispatchEvent(h(1006,"connection failed"))}}function g(e,t){y.call(this),this._readyState=l,this.dispatchEvent(h(e,t||""))}function m(e){if(e.utf8Data)this.dispatchEvent(d(e.utf8Data));else if(e.binaryData&&"arraybuffer"===this.binaryType){for(var t=e.binaryData,r=new ArrayBuffer(t.length),n=new Uint8Array(r),s=0,i=t.length;s<i;++s)n[s]=t[s];this.dispatchEvent(d(r))}}function y(){this._client.removeAllListeners(),this._connection&&this._connection.removeAllListeners()}e.exports=u,Object.defineProperties(u.prototype,{url:{get:function(){return this._url}},readyState:{get:function(){return this._readyState}},protocol:{get:function(){return this._protocol}},extensions:{get:function(){return this._extensions}},bufferedAmount:{get:function(){return this._bufferedAmount}}}),Object.defineProperties(u.prototype,{binaryType:{get:function(){return this._binaryType},set:function(e){if("arraybuffer"!==e)throw new SyntaxError('just "arraybuffer" type allowed for "binaryType" attribute');this._binaryType=e}}}),[["CONNECTING",o],["OPEN",a],["CLOSING",c],["CLOSED",l]].forEach((function(e){Object.defineProperty(u.prototype,e[0],{get:function(){return e[1]}})})),[["CONNECTING",o],["OPEN",a],["CLOSING",c],["CLOSED",l]].forEach((function(e){Object.defineProperty(u,e[0],{get:function(){return e[1]}})})),u.prototype.send=function(e){if(this._readyState!==a)throw new Error("cannot call send() while not connected");if("string"==typeof e||e instanceof String)this._connection.sendUTF(e);else if(e instanceof Buffer)this._connection.sendBytes(e);else{if(!e.byteLength&&0!==e.byteLength)throw new Error("unknown binary data:",e);e=s(e),this._connection.sendBytes(e)}},u.prototype.close=function(e,t){switch(this._readyState){case o:f.call(this),this._client.on("connect",(function(r){e?r.close(e,t):r.close()}));break;case a:this._readyState=c,e?this._connection.close(e,t):this._connection.close()}}},2339:(e,t,r)=>{var n=r(144),s=n.extend,i=r(3837),o=r(2361).EventEmitter,a=r(3685),c=r(5687),l=r(7310),u=r(6113),h=r(4016),d=n.bufferAllocUnsafe,p=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"," ",String.fromCharCode(9)],f=["hostname","port","method","path","headers"];function g(e){var t;switch(o.call(this),this.config={maxReceivedFrameSize:1048576,maxReceivedMessageSize:8388608,fragmentOutgoingMessages:!0,fragmentationThreshold:16384,webSocketVersion:13,assembleFragments:!0,disableNagleAlgorithm:!0,closeTimeout:5e3,tlsOptions:{}},e&&(e.tlsOptions?(t=e.tlsOptions,delete e.tlsOptions):t={},s(this.config,e),s(this.config.tlsOptions,t)),this._req=null,this.config.webSocketVersion){case 8:case 13:break;default:throw new Error("Requested webSocketVersion is not supported. Allowed values are 8 and 13.")}}i.inherits(g,o),g.prototype.connect=function(e,t,r,i,o){var u=this;if("string"==typeof t&&(t=t.length>0?[t]:[]),t instanceof Array||(t=[]),this.protocols=t,this.origin=r,this.url="string"==typeof e?l.parse(e):e,!this.url.protocol)throw new Error("You must specify a full WebSocket URL, including protocol.");if(!this.url.host)throw new Error("You must specify a full WebSocket URL, including hostname. Relative URLs are not supported.");this.secure="wss:"===this.url.protocol,this.protocols.forEach((function(e){for(var t=0;t<e.length;t++){var r=e.charCodeAt(t),n=e.charAt(t);if(r<33||r>126||-1!==p.indexOf(n))throw new Error('Protocol list contains invalid character "'+String.fromCharCode(r)+'"')}})),this.url.port||(this.url.port={"ws:":"80","wss:":"443"}[this.url.protocol]);for(var h=d(16),g=0;g<16;g++)h[g]=Math.round(255*Math.random());this.base64nonce=h.toString("base64");var m=this.url.hostname;("ws:"===this.url.protocol&&"80"!==this.url.port||"wss:"===this.url.protocol&&"443"!==this.url.port)&&(m+=":"+this.url.port);var y,v={};function w(e){u._req=null,u.emit("connectFailed",e)}this.secure&&this.config.tlsOptions.hasOwnProperty("headers")&&s(v,this.config.tlsOptions.headers),i&&s(v,i),s(v,{Upgrade:"websocket",Connection:"Upgrade","Sec-WebSocket-Version":this.config.webSocketVersion.toString(10),"Sec-WebSocket-Key":this.base64nonce,Host:v.Host||m}),this.protocols.length>0&&(v["Sec-WebSocket-Protocol"]=this.protocols.join(", ")),this.origin&&(13===this.config.webSocketVersion?v.Origin=this.origin:8===this.config.webSocketVersion&&(v["Sec-WebSocket-Origin"]=this.origin)),y=this.url.pathname?this.url.path:this.url.path?"/"+this.url.path:"/";var S={agent:!1};if(o&&s(S,o),s(S,{hostname:this.url.hostname,port:this.url.port,method:"GET",path:y,headers:v}),this.secure){var b=this.config.tlsOptions;for(var _ in b)b.hasOwnProperty(_)&&-1===f.indexOf(_)&&(S[_]=b[_])}var E=this._req=(this.secure?c:a).request(S);E.on("upgrade",(function(e,t,r){u._req=null,E.removeListener("error",w),u.socket=t,u.response=e,u.firstDataChunk=r,u.validateHandshake()})),E.on("error",w),E.on("response",(function(e){if(u._req=null,n.eventEmitterListenerCount(u,"httpResponse")>0)u.emit("httpResponse",e,u),e.socket&&e.socket.end();else{var t=[];for(var r in e.headers)t.push(r+": "+e.headers[r]);u.failHandshake("Server responded with a non-101 status: "+e.statusCode+" "+e.statusMessage+"\nResponse Headers Follow:\n"+t.join("\n")+"\n")}})),E.end()},g.prototype.validateHandshake=function(){var e=this.response.headers;if(this.protocols.length>0){if(this.protocol=e["sec-websocket-protocol"],!this.protocol)return void this.failHandshake("Expected a Sec-WebSocket-Protocol header.");if(-1===this.protocols.indexOf(this.protocol))return void this.failHandshake("Server did not respond with a requested protocol.")}if(e.connection&&"upgrade"===e.connection.toLocaleLowerCase())if(e.upgrade&&"websocket"===e.upgrade.toLocaleLowerCase()){var t=u.createHash("sha1");t.update(this.base64nonce+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var r=t.digest("base64");e["sec-websocket-accept"]?e["sec-websocket-accept"]===r?this.succeedHandshake():this.failHandshake("Sec-WebSocket-Accept header from server didn't match expected value of "+r):this.failHandshake("Expected Sec-WebSocket-Accept header from server")}else this.failHandshake("Expected an Upgrade: websocket header from the server");else this.failHandshake("Expected a Connection: Upgrade header from the server")},g.prototype.failHandshake=function(e){this.socket&&this.socket.writable&&this.socket.end(),this.emit("connectFailed",new Error(e))},g.prototype.succeedHandshake=function(){var e=new h(this.socket,[],this.protocol,!0,this.config);e.webSocketVersion=this.config.webSocketVersion,e._addSocketEventListeners(),this.emit("connect",e),this.firstDataChunk.length>0&&e.handleSocketData(this.firstDataChunk),this.firstDataChunk=null},g.prototype.abort=function(){this._req&&this._req.abort()},e.exports=g},4016:(e,t,r)=>{var n=r(3837),s=r(144),i=r(2361).EventEmitter,o=r(347),a=r(8452),c=r(3682),l=s.bufferAllocUnsafe,u=s.bufferFromString;const h="open",d="peer_requested_close",p="ending",f="closed";var g="setImmediate"in global?global.setImmediate.bind(global):process.nextTick.bind(process),m=0;function y(e,t,r,n,c){if(this._debug=s.BufferingLogger("websocket:connection",++m),this._debug("constructor"),this._debug.enabled&&function(e,t){if(e._debug.enabled){var r=t.emit;for(var n in t.emit=function(t){e._debug("||| Socket Event  '%s'",t),r.apply(this,arguments)},t)"function"==typeof t[n]&&-1===["emit"].indexOf(n)&&function(r){var n=t[r];t[r]="on"!==r?function(){return e._debug("||| Socket method called:  %s",r),n.apply(this,arguments)}:function(){return e._debug("||| Socket method called:  %s (%s)",r,arguments[0]),n.apply(this,arguments)}}(n)}}(this,e),i.call(this),this._pingListenerCount=0,this.on("newListener",(function(e){"ping"===e&&this._pingListenerCount++})).on("removeListener",(function(e){"ping"===e&&this._pingListenerCount--})),this.config=c,this.socket=e,this.protocol=r,this.extensions=t,this.remoteAddress=e.remoteAddress,this.closeReasonCode=-1,this.closeDescription=null,this.closeEventEmitted=!1,this.maskOutgoingPackets=n,this.maskBytes=l(4),this.frameHeader=l(10),this.bufferList=new a,this.currentFrame=new o(this.maskBytes,this.frameHeader,this.config),this.fragmentationSize=0,this.frameQueue=[],this.connected=!0,this.state=h,this.waitingForCloseResponse=!1,this.receivedEnd=!1,this.closeTimeout=this.config.closeTimeout,this.assembleFragments=this.config.assembleFragments,this.maxReceivedMessageSize=this.config.maxReceivedMessageSize,this.outputBufferFull=!1,this.inputPaused=!1,this.receivedDataHandler=this.processReceivedData.bind(this),this._closeTimerHandler=this.handleCloseTimer.bind(this),this.socket.setNoDelay(this.config.disableNagleAlgorithm),this.socket.setTimeout(0),this.config.keepalive&&!this.config.useNativeKeepalive){if("number"!=typeof this.config.keepaliveInterval)throw new Error("keepaliveInterval must be specified and numeric if keepalive is true.");if(this._keepaliveTimerHandler=this.handleKeepaliveTimer.bind(this),this.setKeepaliveTimer(),this.config.dropConnectionOnKeepaliveTimeout){if("number"!=typeof this.config.keepaliveGracePeriod)throw new Error("keepaliveGracePeriod  must be specified and numeric if dropConnectionOnKeepaliveTimeout is true.");this._gracePeriodTimerHandler=this.handleGracePeriodTimer.bind(this)}}else if(this.config.keepalive&&this.config.useNativeKeepalive){if(!("setKeepAlive"in this.socket))throw new Error("Unable to use native keepalive: unsupported by this version of Node.");this.socket.setKeepAlive(!0,this.config.keepaliveInterval)}this.socket.removeAllListeners("error")}function v(e){return!(e<1e3)&&(e>=1e3&&e<=2999?-1!==[1e3,1001,1002,1003,1007,1008,1009,1010,1011,1012,1013,1014,1015].indexOf(e):e>=3e3&&e<=3999||e>=4e3&&e<=4999||!(e>=5e3)&&void 0)}y.CLOSE_REASON_NORMAL=1e3,y.CLOSE_REASON_GOING_AWAY=1001,y.CLOSE_REASON_PROTOCOL_ERROR=1002,y.CLOSE_REASON_UNPROCESSABLE_INPUT=1003,y.CLOSE_REASON_RESERVED=1004,y.CLOSE_REASON_NOT_PROVIDED=1005,y.CLOSE_REASON_ABNORMAL=1006,y.CLOSE_REASON_INVALID_DATA=1007,y.CLOSE_REASON_POLICY_VIOLATION=1008,y.CLOSE_REASON_MESSAGE_TOO_BIG=1009,y.CLOSE_REASON_EXTENSION_REQUIRED=1010,y.CLOSE_REASON_INTERNAL_SERVER_ERROR=1011,y.CLOSE_REASON_TLS_HANDSHAKE_FAILED=1015,y.CLOSE_DESCRIPTIONS={1e3:"Normal connection closure",1001:"Remote peer is going away",1002:"Protocol error",1003:"Unprocessable input",1004:"Reserved",1005:"Reason not provided",1006:"Abnormal closure, no further detail available",1007:"Invalid data received",1008:"Policy violation",1009:"Message too big",1010:"Extension requested by client is required",1011:"Internal Server Error",1015:"TLS Handshake Failed"},n.inherits(y,i),y.prototype._addSocketEventListeners=function(){this.socket.on("error",this.handleSocketError.bind(this)),this.socket.on("end",this.handleSocketEnd.bind(this)),this.socket.on("close",this.handleSocketClose.bind(this)),this.socket.on("drain",this.handleSocketDrain.bind(this)),this.socket.on("pause",this.handleSocketPause.bind(this)),this.socket.on("resume",this.handleSocketResume.bind(this)),this.socket.on("data",this.handleSocketData.bind(this))},y.prototype.setKeepaliveTimer=function(){this._debug("setKeepaliveTimer"),this.config.keepalive&&!this.config.useNativeKeepalive&&(this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this._keepaliveTimeoutID=setTimeout(this._keepaliveTimerHandler,this.config.keepaliveInterval))},y.prototype.clearKeepaliveTimer=function(){this._keepaliveTimeoutID&&clearTimeout(this._keepaliveTimeoutID)},y.prototype.handleKeepaliveTimer=function(){this._debug("handleKeepaliveTimer"),this._keepaliveTimeoutID=null,this.ping(),this.config.dropConnectionOnKeepaliveTimeout?this.setGracePeriodTimer():this.setKeepaliveTimer()},y.prototype.setGracePeriodTimer=function(){this._debug("setGracePeriodTimer"),this.clearGracePeriodTimer(),this._gracePeriodTimeoutID=setTimeout(this._gracePeriodTimerHandler,this.config.keepaliveGracePeriod)},y.prototype.clearGracePeriodTimer=function(){this._gracePeriodTimeoutID&&clearTimeout(this._gracePeriodTimeoutID)},y.prototype.handleGracePeriodTimer=function(){this._debug("handleGracePeriodTimer"),this._gracePeriodTimeoutID=null,this.drop(y.CLOSE_REASON_ABNORMAL,"Peer not responding.",!0)},y.prototype.handleSocketData=function(e){this._debug("handleSocketData"),this.setKeepaliveTimer(),this.bufferList.write(e),this.processReceivedData()},y.prototype.processReceivedData=function(){if(this._debug("processReceivedData"),this.connected&&!this.inputPaused){var e=this.currentFrame;if(e.addData(this.bufferList)){var t=this;if(e.protocolError)return this._debug("-- protocol error"),void process.nextTick((function(){t.drop(y.CLOSE_REASON_PROTOCOL_ERROR,e.dropReason)}));if(e.frameTooLarge)return this._debug("-- frame too large"),void process.nextTick((function(){t.drop(y.CLOSE_REASON_MESSAGE_TOO_BIG,e.dropReason)}));if(e.rsv1||e.rsv2||e.rsv3)return this._debug("-- illegal rsv flag"),void process.nextTick((function(){t.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Unsupported usage of rsv bits without negotiated extension.")}));this.assembleFragments||(this._debug("-- emitting frame"),process.nextTick((function(){t.emit("frame",e)}))),process.nextTick((function(){t.processFrame(e)})),this.currentFrame=new o(this.maskBytes,this.frameHeader,this.config),this.bufferList.length>0&&g(this.receivedDataHandler)}else this._debug("-- insufficient data for frame")}},y.prototype.handleSocketError=function(e){this._debug("handleSocketError: %j",e),this.state!==f?(this.closeReasonCode=y.CLOSE_REASON_ABNORMAL,this.closeDescription="Socket Error: "+e.syscall+" "+e.code,this.connected=!1,this.state=f,this.fragmentationSize=0,s.eventEmitterListenerCount(this,"error")>0&&this.emit("error",e),this.socket.destroy(),this._debug.printOutput()):this._debug("  --- Socket 'error' after 'close'")},y.prototype.handleSocketEnd=function(){this._debug("handleSocketEnd: received socket end.  state = %s",this.state),this.receivedEnd=!0,this.state!==f?this.state!==d&&this.state!==p&&(this._debug("  --- UNEXPECTED socket end."),this.socket.end()):this._debug("  --- Socket 'end' after 'close'")},y.prototype.handleSocketClose=function(e){this._debug("handleSocketClose: received socket close"),this.socketHadError=e,this.connected=!1,this.state=f,-1===this.closeReasonCode&&(this.closeReasonCode=y.CLOSE_REASON_ABNORMAL,this.closeDescription="Connection dropped by remote peer."),this.clearCloseTimer(),this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this.closeEventEmitted||(this.closeEventEmitted=!0,this._debug("-- Emitting WebSocketConnection close event"),this.emit("close",this.closeReasonCode,this.closeDescription))},y.prototype.handleSocketDrain=function(){this._debug("handleSocketDrain: socket drain event"),this.outputBufferFull=!1,this.emit("drain")},y.prototype.handleSocketPause=function(){this._debug("handleSocketPause: socket pause event"),this.inputPaused=!0,this.emit("pause")},y.prototype.handleSocketResume=function(){this._debug("handleSocketResume: socket resume event"),this.inputPaused=!1,this.emit("resume"),this.processReceivedData()},y.prototype.pause=function(){this._debug("pause: pause requested"),this.socket.pause()},y.prototype.resume=function(){this._debug("resume: resume requested"),this.socket.resume()},y.prototype.close=function(e,t){if(this.connected){if(this._debug("close: Initating clean WebSocket close sequence."),"number"!=typeof e&&(e=y.CLOSE_REASON_NORMAL),!v(e))throw new Error("Close code "+e+" is not valid.");"string"!=typeof t&&(t=y.CLOSE_DESCRIPTIONS[e]),this.closeReasonCode=e,this.closeDescription=t,this.setCloseTimer(),this.sendCloseFrame(this.closeReasonCode,this.closeDescription),this.state=p,this.connected=!1}},y.prototype.drop=function(e,t,r){this._debug("drop"),"number"!=typeof e&&(e=y.CLOSE_REASON_PROTOCOL_ERROR),"string"!=typeof t&&(t=y.CLOSE_DESCRIPTIONS[e]),this._debug("Forcefully dropping connection. skipCloseFrame: %s, code: %d, description: %s",r,e,t),this.closeReasonCode=e,this.closeDescription=t,this.frameQueue=[],this.fragmentationSize=0,r||this.sendCloseFrame(e,t),this.connected=!1,this.state=f,this.clearCloseTimer(),this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this.closeEventEmitted||(this.closeEventEmitted=!0,this._debug("Emitting WebSocketConnection close event"),this.emit("close",this.closeReasonCode,this.closeDescription)),this._debug("Drop: destroying socket"),this.socket.destroy()},y.prototype.setCloseTimer=function(){this._debug("setCloseTimer"),this.clearCloseTimer(),this._debug("Setting close timer"),this.waitingForCloseResponse=!0,this.closeTimer=setTimeout(this._closeTimerHandler,this.closeTimeout)},y.prototype.clearCloseTimer=function(){this._debug("clearCloseTimer"),this.closeTimer&&(this._debug("Clearing close timer"),clearTimeout(this.closeTimer),this.waitingForCloseResponse=!1,this.closeTimer=null)},y.prototype.handleCloseTimer=function(){this._debug("handleCloseTimer"),this.closeTimer=null,this.waitingForCloseResponse&&(this._debug("Close response not received from client.  Forcing socket end."),this.waitingForCloseResponse=!1,this.state=f,this.socket.end())},y.prototype.processFrame=function(e){if(this._debug("processFrame"),this._debug(" -- frame: %s",e),0!==this.frameQueue.length&&e.opcode>0&&e.opcode<8)this.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Illegal frame opcode 0x"+e.opcode.toString(16)+" received in middle of fragmented message.");else switch(e.opcode){case 2:this._debug("-- Binary Frame"),this.assembleFragments&&(e.fin?(this._debug("---- Emitting 'message' event"),this.emit("message",{type:"binary",binaryData:e.binaryPayload})):(this.frameQueue.push(e),this.fragmentationSize=e.length));break;case 1:if(this._debug("-- Text Frame"),this.assembleFragments)if(e.fin){if(!c(e.binaryPayload))return void this.drop(y.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this._debug("---- Emitting 'message' event"),this.emit("message",{type:"utf8",utf8Data:e.binaryPayload.toString("utf8")})}else this.frameQueue.push(e),this.fragmentationSize=e.length;break;case 0:if(this._debug("-- Continuation Frame"),this.assembleFragments){if(0===this.frameQueue.length)return void this.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Unexpected Continuation Frame");if(this.fragmentationSize+=e.length,this.fragmentationSize>this.maxReceivedMessageSize)return void this.drop(y.CLOSE_REASON_MESSAGE_TOO_BIG,"Maximum message size exceeded.");if(this.frameQueue.push(e),e.fin){var t=0,r=l(this.fragmentationSize),n=this.frameQueue[0].opcode;switch(this.frameQueue.forEach((function(e){e.binaryPayload.copy(r,t),t+=e.binaryPayload.length})),this.frameQueue=[],this.fragmentationSize=0,n){case 2:this.emit("message",{type:"binary",binaryData:r});break;case 1:if(!c(r))return void this.drop(y.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this.emit("message",{type:"utf8",utf8Data:r.toString("utf8")});break;default:return void this.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Unexpected first opcode in fragmentation sequence: 0x"+n.toString(16))}}}break;case 9:if(this._debug("-- Ping Frame"),this._pingListenerCount>0){var s=!1;this.emit("ping",(function(){s=!0}),e.binaryPayload),s||this.pong(e.binaryPayload)}else this.pong(e.binaryPayload);break;case 10:this._debug("-- Pong Frame"),this.emit("pong",e.binaryPayload);break;case 8:if(this._debug("-- Close Frame"),this.waitingForCloseResponse)return this._debug("---- Got close response from peer.  Completing closing handshake."),this.clearCloseTimer(),this.waitingForCloseResponse=!1,this.state=f,void this.socket.end();var i;if(this._debug("---- Closing handshake initiated by peer."),this.state=d,e.invalidCloseFrameLength?(this.closeReasonCode=1005,i=y.CLOSE_REASON_PROTOCOL_ERROR):-1===e.closeStatus||v(e.closeStatus)?(this.closeReasonCode=e.closeStatus,i=y.CLOSE_REASON_NORMAL):(this.closeReasonCode=e.closeStatus,i=y.CLOSE_REASON_PROTOCOL_ERROR),e.binaryPayload.length>1){if(!c(e.binaryPayload))return void this.drop(y.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this.closeDescription=e.binaryPayload.toString("utf8")}else this.closeDescription=y.CLOSE_DESCRIPTIONS[this.closeReasonCode];this._debug("------ Remote peer %s - code: %d - %s - close frame payload length: %d",this.remoteAddress,this.closeReasonCode,this.closeDescription,e.length),this._debug("------ responding to remote peer's close request."),this.sendCloseFrame(i,null),this.connected=!1;break;default:this._debug("-- Unrecognized Opcode %d",e.opcode),this.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Unrecognized Opcode: 0x"+e.opcode.toString(16))}},y.prototype.send=function(e,t){if(this._debug("send"),Buffer.isBuffer(e))this.sendBytes(e,t);else{if("function"!=typeof e.toString)throw new Error("Data provided must either be a Node Buffer or implement toString()");this.sendUTF(e,t)}},y.prototype.sendUTF=function(e,t){e=u(e.toString(),"utf8"),this._debug("sendUTF: %d bytes",e.length);var r=new o(this.maskBytes,this.frameHeader,this.config);r.opcode=1,r.binaryPayload=e,this.fragmentAndSend(r,t)},y.prototype.sendBytes=function(e,t){if(this._debug("sendBytes"),!Buffer.isBuffer(e))throw new Error("You must pass a Node Buffer object to WebSocketConnection.prototype.sendBytes()");var r=new o(this.maskBytes,this.frameHeader,this.config);r.opcode=2,r.binaryPayload=e,this.fragmentAndSend(r,t)},y.prototype.ping=function(e){this._debug("ping");var t=new o(this.maskBytes,this.frameHeader,this.config);t.opcode=9,t.fin=!0,e&&(Buffer.isBuffer(e)||(e=u(e.toString(),"utf8")),e.length>125&&(this._debug("WebSocket: Data for ping is longer than 125 bytes.  Truncating."),e=e.slice(0,124)),t.binaryPayload=e),this.sendFrame(t)},y.prototype.pong=function(e){this._debug("pong");var t=new o(this.maskBytes,this.frameHeader,this.config);t.opcode=10,Buffer.isBuffer(e)&&e.length>125&&(this._debug("WebSocket: Data for pong is longer than 125 bytes.  Truncating."),e=e.slice(0,124)),t.binaryPayload=e,t.fin=!0,this.sendFrame(t)},y.prototype.fragmentAndSend=function(e,t){if(this._debug("fragmentAndSend"),e.opcode>7)throw new Error("You cannot fragment control frames.");var r=this.config.fragmentationThreshold,n=e.binaryPayload.length;if(!this.config.fragmentOutgoingMessages||e.binaryPayload&&n<=r)return e.fin=!0,void this.sendFrame(e,t);for(var s=Math.ceil(n/r),i=0,a=function(e){e?"function"==typeof t&&(t(e),t=null):++i===s&&"function"==typeof t&&t()},c=1;c<=s;c++){var l=new o(this.maskBytes,this.frameHeader,this.config);l.opcode=1===c?e.opcode:0,l.fin=c===s;var u=c===s?n-r*(c-1):r,h=r*(c-1);l.binaryPayload=e.binaryPayload.slice(h,h+u),this.sendFrame(l,a)}},y.prototype.sendCloseFrame=function(e,t,r){if("number"!=typeof e&&(e=y.CLOSE_REASON_NORMAL),this._debug("sendCloseFrame state: %s, reasonCode: %d, description: %s",this.state,e,t),this.state===h||this.state===d){var n=new o(this.maskBytes,this.frameHeader,this.config);n.fin=!0,n.opcode=8,n.closeStatus=e,"string"==typeof t&&(n.binaryPayload=u(t,"utf8")),this.sendFrame(n,r),this.socket.end()}},y.prototype.sendFrame=function(e,t){this._debug("sendFrame"),e.mask=this.maskOutgoingPackets;var r=this.socket.write(e.toBuffer(),t);return this.outputBufferFull=!r,r},e.exports=y},347:(e,t,r)=>{var n=r(848),s=r(144).bufferAllocUnsafe;function i(e,t,r){this.maskBytes=e,this.frameHeader=t,this.config=r,this.maxReceivedFrameSize=r.maxReceivedFrameSize,this.protocolError=!1,this.frameTooLarge=!1,this.invalidCloseFrameLength=!1,this.parseState=1,this.closeStatus=-1}i.prototype.addData=function(e){if(1===this.parseState&&e.length>=2){e.joinInto(this.frameHeader,0,0,2),e.advance(2);var t=this.frameHeader[0],r=this.frameHeader[1];if(this.fin=Boolean(128&t),this.rsv1=Boolean(64&t),this.rsv2=Boolean(32&t),this.rsv3=Boolean(16&t),this.mask=Boolean(128&r),this.opcode=15&t,this.length=127&r,this.opcode>=8){if(this.length>125)return this.protocolError=!0,this.dropReason="Illegal control frame longer than 125 bytes.",!0;if(!this.fin)return this.protocolError=!0,this.dropReason="Control frames must not be fragmented.",!0}126===this.length?this.parseState=2:127===this.length?this.parseState=3:this.parseState=4}if(2===this.parseState)e.length>=2&&(e.joinInto(this.frameHeader,2,0,2),e.advance(2),this.length=this.frameHeader.readUInt16BE(2),this.parseState=4);else if(3===this.parseState&&e.length>=8){e.joinInto(this.frameHeader,2,0,8),e.advance(8);var i=[this.frameHeader.readUInt32BE(2),this.frameHeader.readUInt32BE(6)];if(0!==i[0])return this.protocolError=!0,this.dropReason="Unsupported 64-bit length frame received",!0;this.length=i[1],this.parseState=4}if(4===this.parseState&&(this.mask?e.length>=4&&(e.joinInto(this.maskBytes,0,0,4),e.advance(4),this.parseState=5):this.parseState=5),5===this.parseState){if(this.length>this.maxReceivedFrameSize)return this.frameTooLarge=!0,this.dropReason="Frame size of "+this.length.toString(10)+" bytes exceeds maximum accepted frame size",!0;if(0===this.length)return this.binaryPayload=s(0),this.parseState=6,!0;if(e.length>=this.length)return this.binaryPayload=e.take(this.length),e.advance(this.length),this.mask&&n.unmask(this.binaryPayload,this.maskBytes),8===this.opcode&&(1===this.length&&(this.binaryPayload=s(0),this.invalidCloseFrameLength=!0),this.length>=2&&(this.closeStatus=this.binaryPayload.readUInt16BE(0),this.binaryPayload=this.binaryPayload.slice(2))),this.parseState=6,!0}return!1},i.prototype.throwAwayPayload=function(e){return e.length>=this.length&&(e.advance(this.length),this.parseState=6,!0)},i.prototype.toBuffer=function(e){var t,r,i,o=2,a=0,c=0;this.fin&&(a|=128),this.rsv1&&(a|=64),this.rsv2&&(a|=32),this.rsv3&&(a|=16),this.mask&&(c|=128),a|=15&this.opcode,8===this.opcode?(this.length=2,this.binaryPayload&&(this.length+=this.binaryPayload.length),(r=s(this.length)).writeUInt16BE(this.closeStatus,0),this.length>2&&this.binaryPayload.copy(r,2)):this.binaryPayload?(r=this.binaryPayload,this.length=r.length):this.length=0,this.length<=125?c|=127&this.length:this.length>125&&this.length<=65535?(c|=126,o+=2):this.length>65535&&(c|=127,o+=8);var l=s(this.length+o+(this.mask?4:0));return l[0]=a,l[1]=c,i=2,this.length>125&&this.length<=65535?(l.writeUInt16BE(this.length,i),i+=2):this.length>65535&&(l.writeUInt32BE(0,i),l.writeUInt32BE(this.length,i+4),i+=8),this.mask?(t=e?0:4294967295*Math.random()>>>0,this.maskBytes.writeUInt32BE(t,0),this.maskBytes.copy(l,i),i+=4,r&&n.mask(r,this.maskBytes,l,i,this.length)):r&&r.copy(l,i),l},i.prototype.toString=function(){return"Opcode: "+this.opcode+", fin: "+this.fin+", length: "+this.length+", hasPayload: "+Boolean(this.binaryPayload)+", masked: "+this.mask},e.exports=i},9332:(e,t,r)=>{for(var n=r(6113),s=r(3837),i=r(7310),o=r(2361).EventEmitter,a=r(4016),c=/,\s*/,l=/;\s*/,u=/[\r\n]/g,h=/,\s*/,d=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"," ",String.fromCharCode(9)],p=[String.fromCharCode(127)],f=0;f<31;f++)p.push(String.fromCharCode(f));var g=/([\x00-\x20\x22\x28\x29\x2c\x2f\x3a-\x3f\x40\x5b-\x5e\x7b\x7d\x7f])/,m=/[^\x21\x23-\x2b\x2d-\x3a\x3c-\x5b\x5d-\x7e]/,y=/^"[^"]*"$/,v=/[\x00-\x20\x3b]/g,w=/[;,] */,S={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",406:"Not Acceptable",407:"Proxy Authorization Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Long",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function b(e,t,r){o.call(this),this.socket=e,this.httpRequest=t,this.resource=t.url,this.remoteAddress=e.remoteAddress,this.remoteAddresses=[this.remoteAddress],this.serverConfig=r,this._socketIsClosing=!1,this._socketCloseHandler=this._handleSocketCloseBeforeAccept.bind(this),this.socket.on("end",this._socketCloseHandler),this.socket.on("close",this._socketCloseHandler),this._resolved=!1}function _(e){process.nextTick((function(){e.drop(1006,"TCP connection lost before handshake completed.",!0)}))}s.inherits(b,o),b.prototype.readHandshake=function(){var e=this,t=this.httpRequest;if(this.resourceURL=i.parse(this.resource,!0),this.host=t.headers.host,!this.host)throw new Error("Client must provide a Host header.");if(this.key=t.headers["sec-websocket-key"],!this.key)throw new Error("Client must provide a value for Sec-WebSocket-Key.");if(this.webSocketVersion=parseInt(t.headers["sec-websocket-version"],10),!this.webSocketVersion||isNaN(this.webSocketVersion))throw new Error("Client must provide a value for Sec-WebSocket-Version.");switch(this.webSocketVersion){case 8:case 13:break;default:var r=new Error("Unsupported websocket client version: "+this.webSocketVersion+"Only versions 8 and 13 are supported.");throw r.httpCode=426,r.headers={"Sec-WebSocket-Version":"13"},r}13===this.webSocketVersion?this.origin=t.headers.origin:8===this.webSocketVersion&&(this.origin=t.headers["sec-websocket-origin"]);var n=t.headers["sec-websocket-protocol"];if(this.protocolFullCaseMap={},this.requestedProtocols=[],n&&n.split(c).forEach((function(t){var r=t.toLocaleLowerCase();e.requestedProtocols.push(r),e.protocolFullCaseMap[r]=t})),!this.serverConfig.ignoreXForwardedFor&&t.headers["x-forwarded-for"]){var s=this.remoteAddress;this.remoteAddresses=t.headers["x-forwarded-for"].split(h),this.remoteAddresses.push(s),this.remoteAddress=this.remoteAddresses[0]}if(this.serverConfig.parseExtensions){var o=t.headers["sec-websocket-extensions"];this.requestedExtensions=this.parseExtensions(o)}else this.requestedExtensions=[];if(this.serverConfig.parseCookies){var a=t.headers.cookie;this.cookies=this.parseCookies(a)}else this.cookies=[]},b.prototype.parseExtensions=function(e){if(!e||0===e.length)return[];var t=e.toLocaleLowerCase().split(c);return t.forEach((function(e,t,r){var n=e.split(l),s=n[0],i=n.slice(1);i.forEach((function(e,t,r){var n=e.split("="),s={name:n[0],value:n[1]};r.splice(t,1,s)}));var o={name:s,params:i};r.splice(t,1,o)})),t},b.prototype.parseCookies=function(e){if(!e||"string"!=typeof e)return[];var t=[];return e.split(w).forEach((function(e){var r=e.indexOf("=");if(-1!==r){var n=e.substr(0,r).trim(),s=e.substr(++r,e.length).trim();'"'===s[0]&&(s=s.slice(1,-1)),t.push({name:n,value:decodeURIComponent(s)})}else t.push({name:e,value:null})})),t},b.prototype.accept=function(e,t,r){var s;this._verifyResolution(),e?void 0===(s=this.protocolFullCaseMap[e.toLocaleLowerCase()])&&(s=e):s=e,this.protocolFullCaseMap=null;var i=n.createHash("sha1");i.update(this.key+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var o="HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Accept: "+i.digest("base64")+"\r\n";if(s){for(var c=0;c<s.length;c++){var l=s.charCodeAt(c),h=s.charAt(c);if(l<33||l>126||-1!==d.indexOf(h))throw this.reject(500),new Error('Illegal character "'+String.fromCharCode(h)+'" in subprotocol.')}if(-1===this.requestedProtocols.indexOf(e))throw this.reject(500),new Error("Specified protocol was not requested by the client.");s=s.replace(u,""),o+="Sec-WebSocket-Protocol: "+s+"\r\n"}if(this.requestedProtocols=null,t&&(t=t.replace(u,""),13===this.webSocketVersion?o+="Origin: "+t+"\r\n":8===this.webSocketVersion&&(o+="Sec-WebSocket-Origin: "+t+"\r\n")),r){if(!Array.isArray(r))throw this.reject(500),new Error('Value supplied for "cookies" argument must be an array.');var p={};r.forEach(function(e){if(!e.name||!e.value)throw this.reject(500),new Error('Each cookie to set must at least provide a "name" and "value"');if(e.name=e.name.replace(v,""),e.value=e.value.replace(v,""),p[e.name])throw this.reject(500),new Error("You may not specify the same cookie name twice.");p[e.name]=!0;var t=e.name.match(g);if(t)throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie name");if(t=e.value.match(y)?e.value.slice(1,-1).match(m):e.value.match(m))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie value");var r=[e.name+"="+e.value];if(e.path){if(t=e.path.match(v))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie path");r.push("Path="+e.path)}if(e.domain){if("string"!=typeof e.domain)throw this.reject(500),new Error("Domain must be specified and must be a string.");if(t=e.domain.match(v))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie domain");r.push("Domain="+e.domain.toLowerCase())}if(e.expires){if(!(e.expires instanceof Date))throw this.reject(500),new Error('Value supplied for cookie "expires" must be a vaild date object');r.push("Expires="+e.expires.toGMTString())}if(e.maxage){var n=e.maxage;if("string"==typeof n&&(n=parseInt(n,10)),isNaN(n)||n<=0)throw this.reject(500),new Error('Value supplied for cookie "maxage" must be a non-zero number');n=Math.round(n),r.push("Max-Age="+n.toString(10))}if(e.secure){if("boolean"!=typeof e.secure)throw this.reject(500),new Error('Value supplied for cookie "secure" must be of type boolean');r.push("Secure")}if(e.httponly){if("boolean"!=typeof e.httponly)throw this.reject(500),new Error('Value supplied for cookie "httponly" must be of type boolean');r.push("HttpOnly")}o+="Set-Cookie: "+r.join(";")+"\r\n"}.bind(this))}this._resolved=!0,this.emit("requestResolved",this),o+="\r\n";var f=new a(this.socket,[],e,!1,this.serverConfig);f.webSocketVersion=this.webSocketVersion,f.remoteAddress=this.remoteAddress,f.remoteAddresses=this.remoteAddresses;var w=this;return this._socketIsClosing?_(f):this.socket.write(o,"ascii",(function(e){e?_(f):(w._removeSocketCloseListeners(),f._addSocketEventListeners())})),this.emit("requestAccepted",f),f},b.prototype.reject=function(e,t,r){this._verifyResolution(),this._resolved=!0,this.emit("requestResolved",this),"number"!=typeof e&&(e=403);var n="HTTP/1.1 "+e+" "+S[e]+"\r\nConnection: close\r\n";if(t&&(n+="X-WebSocket-Reject-Reason: "+(t=t.replace(u,""))+"\r\n"),r)for(var s in r){var i=r[s].toString().replace(u,"");n+=s.replace(u,"")+": "+i+"\r\n"}n+="\r\n",this.socket.end(n,"ascii"),this.emit("requestRejected",this)},b.prototype._handleSocketCloseBeforeAccept=function(){this._socketIsClosing=!0,this._removeSocketCloseListeners()},b.prototype._removeSocketCloseListeners=function(){this.socket.removeListener("end",this._socketCloseHandler),this.socket.removeListener("close",this._socketCloseHandler)},b.prototype._verifyResolution=function(){if(this._resolved)throw new Error("WebSocketRequest may only be accepted or rejected one time.")},e.exports=b},3544:(e,t,r)=>{var n=r(144).extend,s=r(3837),i=r(2361).EventEmitter,o=r(7998);function a(e){i.call(this),this.config={server:null},e&&n(this.config,e),this.handlers=[],this._requestHandler=this.handleRequest.bind(this),this.config.server&&this.attachServer(this.config.server)}s.inherits(a,i),a.prototype.attachServer=function(e){if(!e)throw new Error("You must specify a WebSocketServer instance to attach to.");this.server=e,this.server.on("request",this._requestHandler)},a.prototype.detachServer=function(){if(!this.server)throw new Error("Cannot detach from server: not attached.");this.server.removeListener("request",this._requestHandler),this.server=null},a.prototype.mount=function(e,t,r){if(!e)throw new Error("You must specify a path for this handler.");if(t||(t="____no_protocol____"),!r)throw new Error("You must specify a callback for this handler.");if(!((e=this.pathToRegExp(e))instanceof RegExp))throw new Error("Path must be specified as either a string or a RegExp.");var n=e.toString();if(t=t.toLocaleLowerCase(),-1!==this.findHandlerIndex(n,t))throw new Error("You may only mount one handler per path/protocol combination.");this.handlers.push({path:e,pathString:n,protocol:t,callback:r})},a.prototype.unmount=function(e,t){var r=this.findHandlerIndex(this.pathToRegExp(e).toString(),t);if(-1===r)throw new Error("Unable to find a route matching the specified path and protocol.");this.handlers.splice(r,1)},a.prototype.findHandlerIndex=function(e,t){t=t.toLocaleLowerCase();for(var r=0,n=this.handlers.length;r<n;r++){var s=this.handlers[r];if(s.pathString===e&&s.protocol===t)return r}return-1},a.prototype.pathToRegExp=function(e){return"string"==typeof e&&("*"===e?e=/^.*$/:(e=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),e=new RegExp("^"+e+"$"))),e},a.prototype.handleRequest=function(e){var t=e.requestedProtocols;0===t.length&&(t=["____no_protocol____"]);for(var r=0;r<t.length;r++)for(var n=t[r].toLocaleLowerCase(),s=0,i=this.handlers.length;s<i;s++){var a=this.handlers[s];if(a.path.test(e.resourceURL.pathname)&&(n===a.protocol||"*"===a.protocol)){var c=new o(e,n);return void a.callback(c)}}e.reject(404,"No handler is available for the given request.")},e.exports=a},7998:(e,t,r)=>{var n=r(3837),s=r(2361).EventEmitter;function i(e,t){s.call(this),this.webSocketRequest=e,this.protocol="____no_protocol____"===t?null:t,this.origin=e.origin,this.resource=e.resource,this.resourceURL=e.resourceURL,this.httpRequest=e.httpRequest,this.remoteAddress=e.remoteAddress,this.webSocketVersion=e.webSocketVersion,this.requestedExtensions=e.requestedExtensions,this.cookies=e.cookies}n.inherits(i,s),i.prototype.accept=function(e,t){var r=this.webSocketRequest.accept(this.protocol,e,t);return this.emit("requestAccepted",r),r},i.prototype.reject=function(e,t,r){this.webSocketRequest.reject(e,t,r),this.emit("requestRejected",this)},e.exports=i},1172:(e,t,r)=>{var n=r(144).extend,s=r(144),i=r(3837),o=r(8995)("websocket:server"),a=r(2361).EventEmitter,c=r(9332),l=function(e){a.call(this),this._handlers={upgrade:this.handleUpgrade.bind(this),requestAccepted:this.handleRequestAccepted.bind(this),requestResolved:this.handleRequestResolved.bind(this)},this.connections=[],this.pendingRequests=[],e&&this.mount(e)};i.inherits(l,a),l.prototype.mount=function(e){if(this.config={httpServer:null,maxReceivedFrameSize:65536,maxReceivedMessageSize:1048576,fragmentOutgoingMessages:!0,fragmentationThreshold:16384,keepalive:!0,keepaliveInterval:2e4,dropConnectionOnKeepaliveTimeout:!0,keepaliveGracePeriod:1e4,useNativeKeepalive:!1,assembleFragments:!0,autoAcceptConnections:!1,ignoreXForwardedFor:!1,parseCookies:!0,parseExtensions:!0,disableNagleAlgorithm:!0,closeTimeout:5e3},n(this.config,e),!this.config.httpServer)throw new Error("You must specify an httpServer on which to mount the WebSocket server.");Array.isArray(this.config.httpServer)||(this.config.httpServer=[this.config.httpServer]);var t=this._handlers.upgrade;this.config.httpServer.forEach((function(e){e.on("upgrade",t)}))},l.prototype.unmount=function(){var e=this._handlers.upgrade;this.config.httpServer.forEach((function(t){t.removeListener("upgrade",e)}))},l.prototype.closeAllConnections=function(){this.connections.forEach((function(e){e.close()})),this.pendingRequests.forEach((function(e){process.nextTick((function(){e.reject(503)}))}))},l.prototype.broadcast=function(e){Buffer.isBuffer(e)?this.broadcastBytes(e):"function"==typeof e.toString&&this.broadcastUTF(e)},l.prototype.broadcastUTF=function(e){this.connections.forEach((function(t){t.sendUTF(e)}))},l.prototype.broadcastBytes=function(e){this.connections.forEach((function(t){t.sendBytes(e)}))},l.prototype.shutDown=function(){this.unmount(),this.closeAllConnections()},l.prototype.handleUpgrade=function(e,t){var r=this,n=new c(t,e,this.config);try{n.readHandshake()}catch(e){return n.reject(e.httpCode?e.httpCode:400,e.message,e.headers),o("Invalid handshake: %s",e.message),void this.emit("upgradeError",e)}this.pendingRequests.push(n),n.once("requestAccepted",this._handlers.requestAccepted),n.once("requestResolved",this._handlers.requestResolved),t.once("close",(function(){r._handlers.requestResolved(n)})),!this.config.autoAcceptConnections&&s.eventEmitterListenerCount(this,"request")>0?this.emit("request",n):this.config.autoAcceptConnections?n.accept(n.requestedProtocols[0],n.origin):n.reject(404,"No handler is configured to accept the connection.")},l.prototype.handleRequestAccepted=function(e){var t=this;e.once("close",(function(r,n){t.handleConnectionClose(e,r,n)})),this.connections.push(e),this.emit("connect",e)},l.prototype.handleConnectionClose=function(e,t,r){var n=this.connections.indexOf(e);-1!==n&&this.connections.splice(n,1),this.emit("close",e,t,r)},l.prototype.handleRequestResolved=function(e){var t=this.pendingRequests.indexOf(e);-1!==t&&this.pendingRequests.splice(t,1)},e.exports=l},144:(e,t,r)=>{var n=t.noop=function(){};function s(e,t,r){this.logFunction=r,this.identifier=e,this.uniqueID=t,this.buffer=[]}t.extend=function(e,t){for(var r in t)e[r]=t[r]},t.eventEmitterListenerCount=r(2361).EventEmitter.listenerCount||function(e,t){return e.listeners(t).length},t.bufferAllocUnsafe=Buffer.allocUnsafe?Buffer.allocUnsafe:function(e){return new Buffer(e)},t.bufferFromString=Buffer.from?Buffer.from:function(e,t){return new Buffer(e,t)},t.BufferingLogger=function(e,t){var i=r(8995)(e);if(i.enabled){var o=new s(e,t,i),a=o.log.bind(o);return a.printOutput=o.printOutput.bind(o),a.enabled=i.enabled,a}return i.printOutput=n,i},s.prototype.log=function(){return this.buffer.push([new Date,Array.prototype.slice.call(arguments)]),this},s.prototype.clear=function(){return this.buffer=[],this},s.prototype.printOutput=function(e){e||(e=this.logFunction);var t=this.uniqueID;this.buffer.forEach((function(r){var n=r[0].toLocaleString(),s=r[1].slice(),i=s[0];null!=i&&(i="%s - %s - "+i.toString(),s.splice(0,1,i,n,t),e.apply(global,s))}))}},455:(e,t,r)=>{e.exports=r(5232).version},5729:(e,t,r)=>{e.exports={server:r(1172),client:r(2339),router:r(3544),frame:r(347),request:r(9332),connection:r(4016),w3cwebsocket:r(348),deprecation:r(9168),version:r(455)}},5965:(e,t,r)=>{function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(7723)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var s=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(s++,"%c"===e&&(i=s))})),e.splice(i,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())},7723:(e,t,r)=>{var n;function s(e){function r(){if(r.enabled){var e=r,s=+new Date,i=s-(n||s);e.diff=i,e.prev=n,e.curr=s,n=s;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;c++;var s=t.formatters[n];if("function"==typeof s){var i=o[c];r=s.call(e,i),o.splice(c,1),c--}return r})),t.formatArgs.call(e,o);var l=r.log||t.log||console.log.bind(console);l.apply(e,o)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=s.debug=s.default=s).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length,s=0;s<n;s++)r[s]&&("-"===(e=r[s].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(2939),t.names=[],t.skips=[],t.formatters={}},8995:(e,t,r)=>{"undefined"!=typeof process&&"renderer"===process.type?e.exports=r(5965):e.exports=r(6285)},6285:(e,t,r)=>{var n=r(6224),s=r(3837);(t=e.exports=r(7723)).init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){return o.write(s.format.apply(s,arguments)+"\n")},t.formatArgs=function(e){var r=this.namespace;if(this.useColors){var n=this.color,s="  [3"+n+";1m"+r+" [0m";e[0]=s+e[0].split("\n").join("\n"+s),e.push("[3"+n+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(new Date).toUTCString()+" "+r+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=a,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(i)},t.colors=[6,2,3,4,5,1],t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{});var i=parseInt(process.env.DEBUG_FD,10)||2;1!==i&&2!==i&&s.deprecate((function(){}),"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var o=1===i?process.stdout:2===i?process.stderr:function(e){var t;switch(process.binding("tty_wrap").guessHandleType(e)){case"TTY":(t=new n.WriteStream(e))._type="tty",t._handle&&t._handle.unref&&t._handle.unref();break;case"FILE":(t=new(r(7147).SyncWriteStream)(e,{autoClose:!1}))._type="fs";break;case"PIPE":case"TCP":(t=new(r(1808).Socket)({fd:e,readable:!1,writable:!0})).readable=!1,t.read=null,t._type="pipe",t._handle&&t._handle.unref&&t._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return t.fd=e,t._isStdio=!0,t}(i);function a(){return process.env.DEBUG}t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)},t.enable(a())},2939:e=>{var t=1e3,r=60*t,n=60*r,s=24*n;function i(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,o){o=o||{};var a,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(i){var o=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===c&&!1===isNaN(e))return o.long?i(a=e,s,"day")||i(a,n,"hour")||i(a,r,"minute")||i(a,t,"second")||a+" ms":function(e){return e>=s?Math.round(e/s)+"d":e>=n?Math.round(e/n)+"h":e>=r?Math.round(e/r)+"m":e>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},8452:(e,t,r)=>{var n=r(4300).Buffer,s=r(2361).EventEmitter,i=r(144).bufferAllocUnsafe;function o(e){if(!(this instanceof o))return new o(e);s.call(this);var t=this;void 0===e&&(e={}),t.encoding=e.encoding;var r={next:null,buffer:null},a={next:null,buffer:null},c=0;t.__defineGetter__("length",(function(){return c}));var l=0;t.write=function(e){return r.buffer?(a.next={next:null,buffer:e},a=a.next):(r.buffer=e,a=r),c+=e.length,t.emit("write",e),!0},t.end=function(e){n.isBuffer(e)&&t.write(e)},t.push=function(){var e=[].concat.apply([],arguments);return e.forEach(t.write),t},t.forEach=function(e){if(!r.buffer)return i(0);if(r.buffer.length-l<=0)return t;for(var n={buffer:r.buffer.slice(l),next:r.next};n&&n.buffer&&!e(n.buffer);)n=n.next;return t},t.join=function(e,n){if(!r.buffer)return i(0);null==e&&(e=0),null==n&&(n=t.length);var s=i(n-e),o=0;return t.forEach((function(t){if(e<o+t.length&&o<n&&t.copy(s,Math.max(0,o-e),Math.max(0,e-o),Math.min(t.length,n-o)),(o+=t.length)>n)return!0})),s},t.joinInto=function(e,n,s,o){if(!r.buffer)return new i(0);null==s&&(s=0),null==o&&(o=t.length);var a=e;if(a.length-n<o-s)throw new Error("Insufficient space available in target Buffer.");var c=0;return t.forEach((function(e){if(s<c+e.length&&c<o&&e.copy(a,Math.max(n,n+c-s),Math.max(0,s-c),Math.min(e.length,o-c)),(c+=e.length)>o)return!0})),a},t.advance=function(e){for(l+=e,c-=e;r.buffer&&l>=r.buffer.length;)l-=r.buffer.length,r=r.next?r.next:{buffer:null,next:null};return null===r.buffer&&(a={next:null,buffer:null}),t.emit("advance",e),t},t.take=function(e,r){if(null==e?e=t.length:"number"!=typeof e&&(r=e,e=t.length),r||(r=t.encoding),r){var n="";return t.forEach((function(t){if(e<=0)return!0;n+=t.toString(r,0,Math.min(e,t.length)),e-=t.length})),n}return t.join(0,e)},t.toString=function(){return t.take("binary")}}e.exports=o,e.exports.BufferList=o,r(3837).inherits(o,s)},1334:(e,t,r)=>{e.exports={EventTarget:r(4794),Event:r(2918)}},2918:e=>{e.exports=function(e){this.type=e,this.isTrusted=!1,this._yaeti=!0}},4794:e=>{function t(){"function"!=typeof this.addEventListener&&(this._listeners={},this.addEventListener=r,this.removeEventListener=n,this.dispatchEvent=s)}function r(e,t){var r,n,s;if(e&&t){for(void 0===(r=this._listeners[e])&&(this._listeners[e]=r=[]),n=0;s=r[n];n++)if(s===t)return;r.push(t)}}function n(e,t){var r,n,s;if(e&&t&&void 0!==(r=this._listeners[e])){for(n=0;s=r[n];n++)if(s===t){r.splice(n,1);break}0===r.length&&delete this._listeners[e]}}function s(e){var t,r,n,s,i,o=!1;if(!e||"string"!=typeof e.type)throw new Error("`event` must have a valid `type` property");e._yaeti&&(e.target=this,e.cancelable=!0);try{e.stopImmediatePropagation=function(){o=!0}}catch(e){}for(t=e.type,r=this._listeners[t]||[],"function"==typeof(n=this["on"+t])&&n.call(this,e),s=0;(i=r[s])&&!o;s++)i.call(this,e);return!e.defaultPrevented}e.exports=t,Object.defineProperties(t.prototype,{listeners:{get:function(){return this._listeners}}})},3807:(e,t,r)=>{(()=>{"use strict";var e=[,(e,t,r)=>{r.r(t),r.d(t,{Connection:()=>n.Connection,ConnectionBearer:()=>n.ConnectionBearer,ConnectionManager:()=>s.ConnectionManager,DeferredPromise:()=>i.DeferredPromise,ExecServer:()=>a.ExecServer,NetworkError:()=>o.NetworkError,RPCError:()=>n.RPCError,RemoteVersion:()=>c.RemoteVersion,ServerWebSocket:()=>l.ServerWebSocket,TimeoutError:()=>o.TimeoutError,closedDuplexStream:()=>u.closedDuplexStream,msgPackEncode:()=>n.msgPackEncode});var n=r(2),s=r(6),i=r(5),o=r(10),a=r(11),c=r(7),l=r(14),u=r(12)},(e,t,r)=>{r.r(t),r.d(t,{Connection:()=>c,ConnectionBearer:()=>h,RPCError:()=>a,msgPackEncode:()=>l});var n=r(3),s=r(4),i=r(5);let o=0;class a extends Error{constructor(e,t){super(`json rpc error ${e}: message`),this.code=e,this.message=t}}class c{constructor(e,t=s.encode,r=new u){this.tunnel=e,this.globalHandlers=r,this.callbacks=new Map,this.streams=new Map,this.notifyEmitter=new n.EventEmitter,this.closeEmitter=new n.EventEmitter,this.ownHandlers=new u,this.onClose=this.closeEmitter.event,this.registerRequestHandler=this.ownHandlers.register,this.encode=t,(async()=>{try{for await(const t of(0,s.decodeMultiStream)(e)){const e=t;"result"in e||"error"in e?this.callbacks.get(e.id)?.resolve(e):"id"in e&&"number"==typeof e.id?this.handleRequest(e):this.notifyEmitter.fire(e)}}catch(t){e.end(),this.closeEmitter.fire(t)}})(),e.once("close",(()=>{this.rejectAllCalls(new a(0,"Connection closed")),this.closeEmitter.fire(void 0)})),e.once("error",(e=>{const t=new a(0,e.message);this.rejectAllCalls(t),this.closeEmitter.fire(t)})),this.onNotification("stream_data",(e=>{this.streams.get(e.stream)?.data.fire(e.segment)})),this.onNotification("stream_end",(e=>{this.streams.get(e.stream)?.end.complete(),this.streams.delete(e.stream)})),this.onNotification("streams_started",(e=>{const t=e.stream_ids,r=this.callbacks.get(e.for_request_id);if(r?.onStream)for(const e of t){const t=new n.EventEmitter,s=new i.DeferredPromise;this.streams.set(e,{data:t,end:s}),r.onStream({id:e,onData:t.event,onEnd:s.p,write:t=>this.notify("stream_data",{stream:e,segment:t}),end:()=>this.notify("stream_ended",{stream:e})})}}))}static fromDuplexStreams(e,t){const r={once:(t,r)=>{"close"===t&&e.onEnd.then(r)},write:e=>t.write(e),async*[Symbol.asyncIterator](){let t=new i.DeferredPromise,r=t;for(e.onData((e=>{const r=new i.DeferredPromise;t.complete({data:e,next:r}),t=r})),e.onEnd.then((()=>{t.complete(void 0)}));;){const e=await r.p;if(!e)return;yield e.data,r=e.next}},end:()=>t.end()};return new c(r,s.encode)}dispose(){this.tunnel.end()}async call(e,t,r,n){const s=o++;return new Promise(((i,o)=>{this.callbacks.set(s,{onStream:n,resolve:e=>{"error"in e?o(new a(e.error?.code,e.error?.message)):i(e.result)},reject:o}),r?.addEventListener("abort",(()=>o(new a(0,"Operation cancelled")))),this.write(this.encode({id:s,method:e,params:t}))})).finally((()=>this.callbacks.delete(s)))}onNotification(e,t){return this.notifyEmitter.event((r=>{r.method===e&&t(r.params)}))}notify(e,t){this.write(this.encode({method:e,params:t}))}async handleRequest(e){const t=this.ownHandlers.map.get(e.method)||this.globalHandlers.map.get(e.method);if(!t){const t={id:e.id,error:{message:"Unknown method. Cannot resolve request",code:36}};return void this.write(this.encode(t))}let r;try{r={id:e.id,result:await t(e.params,e.id)}}catch(t){t instanceof a?r={id:e.id,error:{code:t.code,message:t.message}}:(console.warn("Unexpected error handling request",e,t),r={id:e.id,error:{code:-1,message:String(t)}})}this.write(this.encode(r))}write(e){this.tunnel.write(e)}rejectAllCalls(e){for(const{reject:t}of this.callbacks.values())t(e);this.callbacks.clear()}}function l(e){const t=(0,s.encode)(e),r=new Uint8Array(4+t.length);return new DataView(r.buffer).setUint32(0,t.length),r.set(t,4),r}class u{constructor(){this.map=new Map,this.register=(e,t)=>{this.map.has(e)&&console.warn("Overriding previous handler for method: ",e),this.map.set(e,t)}}}class h{constructor(e){this.callHandlers=new u,this.startEmitter=new n.EventEmitter,this.onStartConnecting=this.startEmitter.event,this.notifyEmitter=new n.EventEmitter,this.closeEmitter=new n.EventEmitter,this.onClose=this.closeEmitter.event,this.registerRequestHandler=this.callHandlers.register,this.BEARER_TYPE=e}async checkedAcquire(){if(this.streamPromise){const e=await this.streamPromise;if(await this.isStreamValid(e))return e;e.dispose()}this.streamPromise=this.acquireNow();try{return await this.streamPromise}catch(e){throw this.streamPromise=void 0,e}}async acquire(){this.streamPromise??(this.streamPromise=this.acquireNow());try{return await this.streamPromise}catch(e){throw this.streamPromise=void 0,e}}async isStreamValid(e){return!0}async close(){this.streamPromise?.then((e=>e.dispose())),this.streamPromise=void 0}async acquireNow(){const e=await this.getConnectionTunnel(),t=new c(e,(e=>this.encodeMessage(e)),this.callHandlers);return t.onClose((e=>{this.streamPromise=void 0,this.closeEmitter.fire(e)})),this.startEmitter.fire(t),t}}},e=>{e.exports=r(9016)},e=>{e.exports=r(2398)},(e,t,r)=>{r.r(t),r.d(t,{DeferredPromise:()=>n});class n{constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise(((e,t)=>{this.completeCallback=e,this.errorCallback=t}))}get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}complete(e){this.completeCallback(e),this.resolved=!0}error(e){this.errorCallback(e),this.rejected=!0}}},(e,t,r)=>{r.r(t),r.d(t,{ConnectionManager:()=>a});var n=r(3),s=r(8),i=r(5),o=r(7);class a{constructor({bearer:e}){this.socketId=0,this.connectingEmitter=new n.EventEmitter,this.onStartConnecting=this.connectingEmitter.event,this.connectedEmitter=new n.EventEmitter,this.onConnected=this.connectedEmitter.event,this.logEmitter=new n.EventEmitter,this.onLog=this.logEmitter.event,this.versionPromise=new i.DeferredPromise,this.bearer=e,this.bearer.onStartConnecting((e=>{e.onNotification("version",(({version:e,protocol_version:t})=>{this.versionPromise.isSettled&&(this.versionPromise=new i.DeferredPromise),this.versionPromise.complete(new o.RemoteVersion(e,t))}))})),this.onClose=this.bearer.onClose;let t=!0;this.bearer.onStartConnecting((e=>{if(this.connectingEmitter.fire(),e.onNotification("serverlog",(e=>{this.logEmitter.fire(e)})),e.onNotification("makehttpreq",(async({url:t,method:r,req_id:n})=>{this.makeHttpCall(e,t,r,n)})),t){const r=e.onNotification("servermsg",(()=>{t&&(this.connectedEmitter.fire(),r.dispose(),t=!1)}))}}))}get version(){return this.versionPromise.p}async makeHttpCall(e,t,r,n){let i;try{i=await(0,s.fetchFn)(t,{method:r})}catch(t){return e.notify("httpheaders",{headers:[],status_code:503,req_id:n}),void e.notify("httpbody",{segment:(new TextEncoder).encode(String(t)),complete:!0,req_id:n})}e.notify("httpheaders",{headers:[...i.headers],status_code:i.status,req_id:n});const o=()=>e.notify("httpbody",{segment:new Uint8Array,complete:!0,req_id:n});if(i.body&&"function"==typeof i.body.on){const t=i.body;return t.on("data",(t=>e.notify("httpbody",{segment:t,complete:!1,req_id:n}))),t.on("end",o),t.on("error",o),void t.resume()}const a=i.body;if(a)try{const t=a.getReader();for(;;){const{done:r,value:s}=await t.read();if(e.notify("httpbody",{segment:s||new Uint8Array,complete:r,req_id:n}),r)break}}catch(e){throw o(),e}else o()}nextSocketId(){return this.socketId++}async checkForUpdates(e){return(await this.bearer.acquire()).call("update",{do_update:e?.doUpdate??!1})}async call(e,t,r,n){const s=await this.bearer.acquire();return await s.call(e,t,r,n)}}},(e,t,r)=>{r.r(t),r.d(t,{RemoteVersion:()=>n});class n{constructor(e,t=0){this.cliVersion=e,this.protocolVerson=t}shouldWarnOutdated(){return this.protocolVerson<=2}canPing(){return this.protocolVerson>=1}canCompressServerMsg(){return this.protocolVerson>=2}usesConnectionToken(){return this.protocolVerson>=3}shouldLengthPrefixMessages(){return this.protocolVerson<4}}},(e,t,r)=>{r.r(t),r.d(t,{fetchFn:()=>s});var n=r(9);const s=r.n(n)()},e=>{e.exports=r(3765)},(e,t,r)=>{r.r(t),r.d(t,{NetworkError:()=>n,TimeoutError:()=>s});class n extends Error{constructor(e,t="ECONNREFUSED"){super(e.message),this.code=t,this.syscall="connect",this.stack=e.stack}}class s extends Error{constructor(){super("Operation timed out")}}},(e,t,r)=>{r.r(t),r.d(t,{ExecServer:()=>c});var n=r(3),s=r(13),i=r(2),o=r(5),a=r(12);class c{constructor(e){this.connection=e}async spawn(e,t,{env:r={},cwd:n}={}){const s=Array.from({length:3},(()=>new o.DeferredPromise)),i=Promise.all(s.map((e=>e.p))),c=this.connection.call("spawn",{command:e,args:t,env:r,cwd:n},void 0,(e=>{s.shift()?.complete(e)})).then((e=>(s.forEach((e=>e.complete(a.closedDuplexStream))),{status:e.exit_code,message:e.message}))),[l,u,h]=await i;return{stdin:l,stdout:u,stderr:h,onExit:c}}async spawnCli(e,t,{env:r={},cwd:n}={}){const s=Array.from({length:3},(()=>new o.DeferredPromise)),c=Promise.all(s.map((e=>e.p))),l=this.connection.call("spawn_cli",{command:e,args:t,env:r,cwd:n},void 0,(e=>{s.shift()?.complete(e)})).then((e=>(s.forEach((e=>e.complete(a.closedDuplexStream))),{status:e.exit_code,message:e.message}))),[u,h,d]=await c;return{connection:i.Connection.fromDuplexStreams(h,u),logs:d,onExit:l}}async acquireCli(e){return this.connection.call("acquire_cli",{command:e.command,args:e.args,platform:e.platform,quality:e.quality,commit_id:e.commit_id,env:e.env}).then((e=>({status:e.exit_code,message:e.message})))}async serve(e){return await this.connection.call("serve",e),new l(e.socket_id,this.connection,!!e.compress)}async env(){const e=await this.connection.call("get_env",{});return{env:e.env,osRelease:e.os_release,osPlatform:e.os_platform}}async fsStat(e){const t=await this.connection.call("fs_stat",{path:e});return t.exists?{exists:!0,size:t.size,type:t.type}:{exists:!1}}}class l{constructor(e,t,r){if(this.socketId=e,this.connection=t,this.id=0,this.disposables=[],this.onDataEmitter=new n.EventEmitter,this.onData=this.onDataEmitter.event,this.onCloseEmitter=new n.EventEmitter,this.onClose=this.onCloseEmitter.event,this.onEndDeferred=new o.DeferredPromise,this.onEnd=this.onEndDeferred.p,r){const r=this.zip={deflate:(0,s.createDeflateRaw)(),inflate:(0,s.createInflateRaw)()};r.inflate.on("data",(e=>this.onDataEmitter.fire(e))),r.deflate.on("data",(r=>{t.notify("servermsg",{i:e,body:r})})),this.disposables.push({dispose:()=>{r.deflate.close(),r.inflate.close()}})}this.disposables.push(t.onNotification("servermsg",(({i:t,body:r})=>{t===e&&(this.zip?this.zip.inflate.write(r):this.onDataEmitter.fire(r))})))}write(e){const t=this.socketId,r=e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength);this.zip?this.zip.deflate.write(r,void 0,(()=>{this.zip.deflate.flush(2)})):this.connection.notify("servermsg",{i:t,body:r})}end(){this.disposables.forEach((e=>e.dispose()))}}},(e,t,r)=>{r.r(t),r.d(t,{closedDuplexStream:()=>n});const n={id:0,onData:()=>({dispose:()=>{}}),onEnd:Promise.resolve(void 0),write:()=>{},end:()=>{}}},e=>{e.exports=r(9796)},(e,t,r)=>{r.r(t),r.d(t,{ServerWebSocket:()=>o});var n=r(3),s=r(10),i=r(11);class o{constructor(e,t){this.options=e,this.version=t,this.SOCKET_TYPE="Local Proxy Server Socket",this.dispose=[],this.onDataEmitter=new n.EventEmitter,this.onData=this.onDataEmitter.event,this.onOpenEmitter=new n.EventEmitter,this.onOpen=this.onOpenEmitter.event,this.onCloseEmitter=new n.EventEmitter,this.onClose=this.onCloseEmitter.event,this.onErrorEmitter=new n.EventEmitter,this.onError=this.onErrorEmitter.event}send(e){const t=e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength);this.stream?this.stream.write(t):console.warn(new Error("attempted to send data before socket was open").stack)}close(){this.dispose.forEach((e=>e.dispose()))}onMessage(e){this.onDataEmitter.fire(e)}upgradeToWebSocketConnection(){}async initialize(){const e=await this.options.bearer.checkedAcquire(),t=!!(await this.version).canCompressServerMsg()&&(this.options.compress??!0),r=this.stream=await new i.ExecServer(e).serve({socket_id:this.options.socketId,extensions:this.options.extensions||[],quality:this.options.product.quality,commit_id:this.options.product.commit,archive_path:this.options.archivePath,connection_token:this.options.connectionToken,compress:t});this.dispose.push(r.onData(this.onMessage,this)),this.dispose.push(e.onClose((e=>{e&&this.onErrorEmitter.fire(new s.NetworkError(e)),this.onCloseEmitter.fire()}))),this.upgradeToWebSocketConnection()}}},(e,t,r)=>{r.r(t),r.d(t,{ProxyConnection:()=>y,State:()=>m});var n=r(3),s=r(4),i=r(16),o=r(17),a=r(18),c=r(19),l=r(20),u=r(21),h=r(2),d=r(5),p=r(22),f=r(23);const g=!process.env.VSCODE_TUNNELS_DISABLE_PROCESS_REUSE;var m;!function(e){e[e.Idle=0]="Idle",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.Closed=3]="Closed"}(m||(m={}));class y{constructor(e,t){this.args=e,this.logger=t,this.bearerPromise=new d.DeferredPromise,this.bearer=this.bearerPromise.p,this.localPortPromise=new d.DeferredPromise,this.localPort=this.localPortPromise.p,this.startEmitter=new n.EventEmitter,this.onStartConnecting=this.startEmitter.event,this.closeEmitter=new n.EventEmitter,this.onClose=this.closeEmitter.event,this.connectedEmitter=new n.EventEmitter,this.onConnected=this.connectedEmitter.event,this.logEmitter=new n.EventEmitter,this.onLog=this.logEmitter.event,this._state=m.Idle,this.initialize(),this.bearer.catch((e=>{this.closeEmitter.fire(e)}))}get state(){return this._state}static async create(e){const t=y.getPathForRunningProxyInTmpDir(e.nonce),r={args:e.args,productInfo:e.productInfo,runningProxyInfoFile:t},n=await y.getValidProxySocket(t);if(n){e.logger.log(3,`Found running server in ${n}`);try{const t=new w({...r,proxySocketPath:n},e.logger);return await(0,p.timeoutPromise)(5e3,t.callOnProxy("greet",{})),t}catch(t){e.logger.log(3,`Error greeting the server, starting a new instance (${t})`)}}e.logger.log(3,"Creating new tunnel proxy server");const s=function(e,t){const r=(0,o.createHash)("sha256").update(e).update("\0").update(t).digest("hex").slice(0,16);return"win32"===process.platform?`\\\\.\\pipe\\vscode-tunneling-${r}-sock`:process.env.XDG_RUNTIME_DIR?u.join(process.env.XDG_RUNTIME_DIR,`vscode-tunneling-${r}.sock`):u.join(l.tmpdir(),`vscode-tunneling-${r}.sock`)}(e.nonce,(0,o.randomBytes)(20).toString("hex"));return new v({...r,proxySocketPath:s},e.logger,e.serverPath)}static async getValidProxySocket(e){try{const t=JSON.parse(await a.promises.readFile(e,"utf-8"));if(t.at>Date.now()-f.proxyFileTimeout)return await a.promises.stat(t.socket),t.socket}catch{}}static getPathForRunningProxyInTmpDir(e){const t=`vscode-server-proxy-${(0,o.createHash)("sha256").update(e).digest("hex").slice(0,16)}-daemon`;return u.join(l.tmpdir(),t)}async callOnProxy(e,t){return(await this.bearer).call(e,t)}async call(e,t,r,n){return(await this.bearer).call("calltunnel",{method:e,params:t,stream:!!n},r,n)}async initialize(){this.connectToProxyServer();const e=await this.bearer;e.onNotification("serverlog",(e=>{this.logger.log(e.level,`[server] ${e.line}`),this.logEmitter.fire(e)})),e.onNotification("proxylog",(e=>this.logger.log(e.level,`[proxy] ${e.message}`,...e.args))),e.onNotification("statechange",(e=>{switch(e.state){case"connecting":this._state=m.Connecting,this.startEmitter.fire();break;case"connected":this._state=m.Connected,this.connectedEmitter.fire();break;case"closed":let t;this._state=m.Closed,e.reason&&(t=new Error(e.reason.message),t.stack=e.reason.stack||t.stack),this.closeEmitter.fire(t)}})),e.onClose((e=>{this.closeEmitter.fire(e)}))}connectToProxyServer(){let e,t=!1;const r=()=>{t=!1,e?.destroy(),e=void 0},n=()=>{t||(r(),e=c.connect(this.args.proxySocketPath),e.on("connect",(async()=>{t=!0,this.bearerPromise.complete(new h.Connection(e,s.encode)),this.getPortOfTunnelProxyServer()})),e.on("error",(e=>{r()})))};let i;const o=()=>{n(),i&&clearTimeout(i),i=setTimeout((async()=>{t||o()}),500)};o()}async getPortOfTunnelProxyServer(){const e=await this.bearer,t=(await e.call("getlocalport",{})).value;this.localPortPromise.complete(t)}async dispose(){(await this.bearer).dispose()}}y.State=m;class v extends y{constructor(e,t,r){const n=i.spawn(process.execPath,[r],{detached:g,stdio:g?"ignore":"pipe",env:{...process.env,VSCODE_TUNNEL_ARGS:JSON.stringify(e)}});n.stdout?.on("data",(e=>console.log("Proxy process stdout:",e.toString().trim()))),n.stderr?.on("data",(e=>console.log("Proxy process stderr:",e.toString().trim()))),g&&n.unref(),super(e,t)}}class w extends y{}},e=>{e.exports=r(2081)},e=>{e.exports=r(6113)},e=>{e.exports=r(7147)},e=>{e.exports=r(1808)},e=>{e.exports=r(2037)},e=>{e.exports=r(1017)},(e,t,r)=>{r.r(t),r.d(t,{timeoutPromise:()=>n});const n=(e,t)=>new Promise(((r,n)=>{const s=setTimeout((()=>{n(new Error("Operation timed out"))}),e);t.finally((()=>clearTimeout(s))).then(r,n)}))},(e,t,r)=>{r.r(t),r.d(t,{proxyFileTimeout:()=>n});const n=6e3},(e,t,r)=>{r.r(t),r.d(t,{ProxyServer:()=>u});var n=r(4),s=r(18),i=r(19),o=r(5),a=r(2),c=r(14),l=r(25);class u{constructor(e){this._options=e,this.serverConnections=new Set,this.disposables=[],this.setupPromise=new o.DeferredPromise,this.setup=this.setupPromise.p,this.connectionCount=0,this.connectionIdCounter=0,this.args=e.args,this.proxyServer=i.createServer((async e=>{await this.onProxyConnection(e)})),this.disposables.push({dispose:()=>this.proxyServer.close()}),this.controlServer=i.createServer((async e=>{await this.onServerConnection(e)})),this.disposables.push({dispose:()=>this.controlServer.close()}),this.initialize().catch((e=>{this.log(5,`Failed to initialize proxy server: ${e}}`),console.error(e),process.exit(1)})),this.startSavingRunningInfo(),this.delayShutdown(9e4)}incrementConnectionCount(){this.connectionCount+=1,this.shutdownTimer&&(clearTimeout(this.shutdownTimer),this.shutdownTimer=void 0)}decrementConnectionCount(){this.connectionCount-=1,0===this.connectionCount&&this.delayShutdown(3e4)}static readArgsFromEnvironment(){return JSON.parse(process.env.VSCODE_TUNNEL_ARGS)}getWebSocket(e,t){return new c.ServerWebSocket(t,e.version)}onDidSetUpServerConnection(e){}async initialize(){await Promise.all([new Promise(((e,t)=>{this.proxyServer.listen(0,"127.0.0.1",(()=>e(this.acquireTunnel()))),this.proxyServer.on("error",t)})),new Promise(((e,t)=>{this.controlServer.listen(this._options.proxySocketPath,e),this.controlServer.on("error",t)}))])}delayShutdown(e=3e4){this.shutdownTimer&&clearTimeout(this.shutdownTimer),this.shutdownTimer=setTimeout((()=>{this.dispose(),this.log(2,"Timed out, shutting down"),process.exit(0)}),e)}async onServerConnection(e){this.log(2,"Server connection from:  ",e.localAddress," ",e.localPort),this.incrementConnectionCount();const t=new a.Connection(e,n.encode);this.serverConnections.add(t),t.onClose((e=>{this.log(2,`Server connection closed (err: ${e})`),this.serverConnections.delete(t),this.decrementConnectionCount()})),t.registerRequestHandler("greet",(()=>(this.log(2,"Server greeted"),Promise.resolve({})))),t.registerRequestHandler("getlocalport",(async()=>({value:this.proxyServer.address().port}))),t.onNotification("stream_data",(e=>t.notify("stream_data",e))),t.onNotification("stream_ended",(e=>t.notify("stream_ended",e))),t.registerRequestHandler("calltunnel",(async({method:e,params:r,stream:n},s)=>(await this.setup).call(e,r,void 0,n?e=>{t.notify("streams_started",{for_request_id:s,stream_ids:[e.id]}),e.onData((r=>t.notify("stream_data",{segment:r,stream:e.id}))),e.onEnd.then((()=>t.notify("stream_ended",{stream:e.id})))}:void 0))),this.onDidSetUpServerConnection(t),this.lastState&&t.notify("statechange",this.lastState)}async onProxyConnection(e){const t=`[connection.${this.connectionIdCounter++}]`;this.log(2,`${t} connection from:  ${e.localAddress} ${e.localPort}`),this.incrementConnectionCount();const r=(0,l.writeBuffer)();let n;e.on("data",(e=>r.write(e))),e.on("close",(()=>{n?.close(),this.decrementConnectionCount()}));try{const e=await this.setup,t=this.getWebSocket(e,{bearer:e.bearer,product:this._options.productInfo,socketId:e.nextSocketId(),compress:!0});await t.initialize(),n=t}catch(e){return this.log(5,`${t} error setting up websocket: ${e}`),void this.setState({state:"closed",reason:{message:e.message,stack:e.stack}})}r.connect((e=>n.send(e))),this.disposables.push(n.onData((t=>e.write(new Uint8Array(t)))),n.onError((e=>{this.log(5,`${t} tunnel connection error: ${e}`)})),n.onClose((()=>{this.log(5,`${t} tunnel connection ended`),e.end()}))),this.log(3,`${t} tunnel connection established`)}async acquireTunnel(){let e;try{e=await this.createConnectionManager()}catch(e){return this.log(5,e.message),this.setState({state:"closed",reason:{message:e.message,stack:e.stack}})}this.setupPromise.complete(e),e.onLog((e=>{this.serverConnections.forEach((t=>{t.notify("serverlog",e)}))})),e.onStartConnecting((()=>{this.log(2,"Tunnel started connecting"),this.setState({state:"connecting"})})),e.onConnected((()=>{this.log(3,"Tunnel connection successful"),this.setState({state:"connected"})})),e.onClose((e=>{this.log(5,`Tunnel connection closed with: ${e?.message}`),this.setState({state:"closed",reason:{message:e?.message||"Remote server disconnected"}})}))}setState(e){if(e.state!==this.lastState?.state){this.lastState=e;for(const t of this.serverConnections)t.notify("statechange",e);"closed"===e.state&&process.exit(1)}}startSavingRunningInfo(){this.log(2,`Saving socket path "${this._options.proxySocketPath}" to daemon in: ${this._options.runningProxyInfoFile}`);const e=()=>JSON.stringify({at:Date.now(),socket:this._options.proxySocketPath,pid:process.pid});s.writeFileSync(this._options.runningProxyInfoFile,e());const t=setInterval((()=>s.writeFile(this._options.runningProxyInfoFile,e(),(()=>{}))),3e3);this.disposables.push({dispose:()=>{clearInterval(t);try{s.rmSync(this._options.runningProxyInfoFile)}catch{}}})}log(e,t,...r){for(const n of this.serverConnections)n.notify("proxylog",{level:e,message:t,args:r})}dispose(){this.serverConnections.forEach((e=>{e.notify("statechange",{state:"closed",reason:new Error("Disposing proxy server.")}),e.dispose()})),this.disposables.forEach((e=>e.dispose()))}}},(e,t,r)=>{r.r(t),r.d(t,{writeBuffer:()=>n});const n=()=>{let e=[];return{write:t=>{e.push(t)},connect(t){for(const r of e)t(r);this.write=t,e=void 0}}}}],n={};function s(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,s),i.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{s.r(i),s.d(i,{Connection:()=>e.Connection,ConnectionBearer:()=>e.ConnectionBearer,ConnectionManager:()=>e.ConnectionManager,DeferredPromise:()=>e.DeferredPromise,ExecServer:()=>e.ExecServer,NetworkError:()=>e.NetworkError,ProxyConnection:()=>t.ProxyConnection,ProxyServer:()=>r.ProxyServer,RPCError:()=>e.RPCError,RemoteVersion:()=>e.RemoteVersion,ServerWebSocket:()=>e.ServerWebSocket,State:()=>t.State,TimeoutError:()=>e.TimeoutError,closedDuplexStream:()=>e.closedDuplexStream,msgPackEncode:()=>e.msgPackEncode});var e=s(1),t=s(15),r=s(24)})();var o=t;for(var a in i)o[a]=i[a];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})()},3758:(e,t,r)=>{(()=>{"use strict";var e,n,s=[(e,t,r)=>{r.r(t),r.d(t,{AccessTokenBasisClient:()=>o.AccessTokenBasisClient,BasisClient:()=>o.BasisClient,BasisConnectionBearer:()=>c.BasisConnectionBearer,BasisWebSocketFactory:()=>l.BasisWebSocketFactory,TunnelNotFoundError:()=>o.TunnelNotFoundError,TunnelNotFoundInSessionsError:()=>g,TunnelProvider:()=>u.TunnelProvider,createLoopbackHandler:()=>v,getConnectionToken:()=>m,getMatchingSessionForTunnel:()=>p,getMatchingSessionForTunnelName:()=>d,getProtocolVersionFromTags:()=>y,getTunnelNameFromTags:()=>h});var n=r(1),s=r(2),i=r(3),o=r(4),a=r(8),c=r(10),l=r(12),u=r(15);function h(e){if(e.tags?.includes("vscode-server-launcher"))return e.tags.length>=2?e.tags.find((e=>"vscode-server-launcher"!==e&&!/^protocolv\d+$/.test(e))):e.name||e.tunnelId}async function d({userAgent:e,name:t,sessions:r}){const n=await f({lookup:t,userAgent:e,getTunnel:async(e,t)=>e.getTunnelForTag(t),lookupToString:e=>e,sessions:r});return void 0!==n?n:p({userAgent:e,sessions:r,tunnel:{name:t}})}async function p({userAgent:e,tunnel:t,sessions:r}){return f({lookup:t,userAgent:e,getTunnel:async(e,t)=>e.getTunnel(t),lookupToString:e=>e.name||e.tunnelId,sessions:r})}async function f({lookup:e,userAgent:t,getTunnel:r,lookupToString:n,sessions:i}){const a=`tunneling-${t}-auth-attempted`,c=`tunneling-${t}-session-${n(e)}`,l=localStorage.getItem(c);if(l){const n=i.find((e=>e.id===l));if(n){const s=new o.AccessTokenBasisClient(n.provider,t,(()=>n.getAccessToken()));try{const t=await r(s,e);if(t)return console.log("Reusing session from localStorage"),localStorage.removeItem(a),{client:s,session:n,tunnel:t};localStorage.removeItem(c)}catch(e){console.error(e)}}}const u=await(0,s.firstPromise)(i.map((async n=>{if(n.id===l)return;const s=new o.AccessTokenBasisClient(n.provider,t,(()=>n.getAccessToken()));try{const t=await r(s,e);if(t)return{client:s,session:n,tunnel:t}}catch(e){console.error(e)}})));if(u)return localStorage.setItem(c,u.session.id),localStorage.removeItem(a),u;if(localStorage.getItem(a))throw localStorage.removeItem(a),new g(n(e));localStorage.setItem(a,"1")}class g extends Error{constructor(e){super(`Could not find a tunnel named ${e}. Please make sure you are logged into the correct account. You can reloading, logging in, then running 'Connect to Remote Server'.`),this.tunnelIdentifier=e}}async function m(e){if(!new n.RemoteVersion("",y(e)).usesConnectionToken())return;const t=await(0,a.sha256)(e.tunnelId);return(0,i.encodeBase64)(t,!1,!0)}function y(e){const t="protocolv",r=e.tags?.find((e=>e.startsWith(t)));return r?Number(r.slice(t.length))||void 0:2}const v=(e,t)=>async r=>{const n=new URLSearchParams({path:r.uri.path});t&&n.set("tkn",t);try{const t=await e.bearer.acquire(),s=await t.call("callserverhttp",{path:"/vscode-remote-resource?"+n,method:r.method,headers:r.headers}),i=new ArrayBuffer(s.body.length);return new Uint8Array(i).set(s.body),{status:s.status,body:i,headers:s.headers}}catch(e){return{status:500,headers:{},body:(new TextEncoder).encode(e.message).buffer}}}},e=>{e.exports=r(3807)},(e,t,r)=>{r.r(t),r.d(t,{TimeoutError:()=>s,firstPromise:()=>n,timeoutPromise:()=>i});const n=e=>new Promise(((t,r)=>{let n=e.length;for(const s of e)s.then((e=>{n--,void 0===e&&0!==n||(t(e),n=-1)})).catch(r)}));class s extends Error{}const i=(e,t,r)=>new Promise(((n,i)=>{const o=setTimeout((()=>i(new s(r??"Operation timed out"))),t);e.then(n,i).finally((()=>clearTimeout(o)))}))},(e,t,r)=>{function n(e,t=!0,r=!1){const n=r?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let s="";const i=e.byteLength%3;let o=0;for(;o<e.byteLength-i;o+=3){const t=e[o+0],r=e[o+1],i=e[o+2];s+=n[t>>>2],s+=n[63&(t<<4|r>>>4)],s+=n[63&(r<<2|i>>>6)],s+=n[63&i]}if(1===i){const r=e[o+0];s+=n[r>>>2],s+=n[r<<4&63],t&&(s+="==")}else if(2===i){const r=e[o+0],i=e[o+1];s+=n[r>>>2],s+=n[63&(r<<4|i>>>4)],s+=n[i<<2&63],t&&(s+="=")}return s}r.r(t),r.d(t,{encodeBase64:()=>n})},(e,t,r)=>{r.r(t),r.d(t,{AccessTokenBasisClient:()=>a,BasisClient:()=>o,TunnelNotFoundError:()=>c});var n=r(5),s=r(6),i=r(7);class o{constructor(){this.managementClient=new i.Lazy((()=>this.createTunnelManagementClient())),this.tunnelLookupCache=new Map,this.taggedTunnelLookupCache=new Map}getManagementClient(){return this.managementClient.getValue()}async connect(e){if(!e.endpoints){const t=await this.getTunnel(e);if(!t)throw new c;e=t}const{TunnelRelayTunnelClient:t}=await Promise.resolve().then(r.t.bind(r,16,23)),n=new t(void 0,await this.getManagementClient());return n.acceptLocalConnectionsForForwardedPorts=!1,await n.connectClient(e,e.endpoints),n}async getTunnelForTag(e){const t=e.toLowerCase();return await this._getTunnelForTag(t)??(t!==e?this._getTunnelForTag(e):void 0)}async _getTunnelForTag(e){if(this.taggedTunnelLookupCache.has(e))return this.taggedTunnelLookupCache.get(e);const t=await this.getManagementClient(),[r]=await t.listTunnels(void 0,void 0,{tags:[e,"vscode-server-launcher"],requireAllTags:!0,limit:1});if(!r)return;const n=await this.getTunnel(r);return n&&this.taggedTunnelLookupCache.set(e,n),n}async getTunnel(e,t=!0){const r=e.name||e.tunnelId;if(t&&this.tunnelLookupCache.has(r))return this.tunnelLookupCache.get(r);try{const t=await this.getManagementClient(),n=await t.getTunnel(e,{includePorts:!0,tokenScopes:["connect"]});return n&&this.tunnelLookupCache.set(r,n),n||void 0}catch(e){if(e instanceof Error&&e.message.includes("Not Found"))return;throw e}}}o.BASIS_SCOPES=[`${n.TunnelServiceProperties.production.serviceAppId}/.default`];class a extends o{constructor(e,t,r,n){super(),this.provider=e,this.userAgent=t,this.getAccessToken=r,this.agent=n}async createTunnelManagementClient(){const e="microsoft"===this.provider?`Bearer ${await this.getAccessToken()}`:`${this.provider}  ${await this.getAccessToken()}`;return new s.TunnelManagementHttpClient(this.userAgent,(async()=>e),void 0,this.agent)}}class c extends Error{constructor(){super("Tunnel not found")}}},e=>{e.exports=r(3399)},e=>{e.exports=r(5927)},(e,t,r)=>{r.r(t),r.d(t,{Lazy:()=>n});class n{constructor(e){this.executor=e,this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new n((()=>e(this.getValue())))}}},(e,t,r)=>{r.r(t),r.d(t,{sha256:()=>s});var n=r(9);const s=e=>{const t=(0,n.createHash)("sha256");return t.update(e),Promise.resolve(t.digest())}},e=>{e.exports=r(6113)},(e,t,r)=>{r.r(t),r.d(t,{BasisConnectionBearer:()=>c});var n=r(11),s=r(1),i=r(0),o=r(2);const a=3e4;class c extends s.ConnectionBearer{constructor(e,t,r){super("Port Forwarding Service"),this.basis=e,this.tunnel=t,this.port=r,this.tunnelMayBeStale=!1;const o=new s.RemoteVersion("",(0,i.getProtocolVersionFromTags)(t));this.encodeMessage=o.shouldLengthPrefixMessages()?s.msgPackEncode:n.encode,this.onStartConnecting((e=>{e.onNotification("version",(({version:e,protocol_version:t})=>{this.version=new s.RemoteVersion(e,t)}))}))}async isStreamValid(e){if(!0!==this.version?.canPing())return!0;const t=new AbortController,r=setTimeout((()=>t.abort()),5e3);try{return await e.call("ping",{},t.signal),!0}catch{return!1}finally{clearTimeout(r)}}async getConnectionTunnel(){if(this.tunnelMayBeStale){const e=await this.basis.getTunnel(this.tunnel,!1);e&&(this.tunnel=e)}if(!this.tunnel.endpoints?.length)throw new s.NetworkError(new Error("The VS Code gateway is not currently running."),"EHOSTDOWN");const e=await(0,o.timeoutPromise)(this.basis.connect(this.tunnel),a,"Timeout connecting to relay");try{await(0,o.timeoutPromise)(e.waitForForwardedPort(this.port),a,"Timeout waiting for forwarded port");const t=await(0,o.timeoutPromise)(e.connectToForwardedPort(this.port),a,"Timeout connecting to port");return t.on("close",(()=>{this.tunnelMayBeStale=!0})),t.on("error",(()=>{this.tunnelMayBeStale=!0})),t}catch(t){throw e.dispose(),t}}}},e=>{e.exports=r(2398)},(e,t,r)=>{r.r(t),r.d(t,{BasisWebSocketFactory:()=>s});var n=r(13);class s{constructor(e,t,r){this.manager=e,this.product=t,this.extensions=r}create(e){const t=new n.BasisWebSocket({bearer:this.manager.bearer,product:this.product,socketId:this.manager.nextSocketId(),extensions:this.extensions,url:e},this.manager.version);return t.initialize(),t}}},(e,t,r)=>{r.r(t),r.d(t,{BasisWebSocket:()=>o});var n=r(14),s=r(1),i=r(2);class o extends s.ServerWebSocket{constructor(e,t){super(e,t),this._options=e,this.onDataEmitter=new n.EventEmitter,this.onData=this.onDataEmitter.event,this.onOpenEmitter=new n.EventEmitter,this.onOpen=this.onOpenEmitter.event,this.onCloseEmitter=new n.EventEmitter,this.onClose=this.onCloseEmitter.event,this.onErrorEmitter=new n.EventEmitter,this.onError=this.onErrorEmitter.event,this.waitingForOpen=!0,this.SOCKET_TYPE="Basis Socket"}async initialize(){try{await super.initialize()}catch(e){return e instanceof i.TimeoutError&&(e=new s.NetworkError(e)),void this.onErrorEmitter.fire(e)}}onMessage(e){this.waitingForOpen?(this.onOpenEmitter.fire(),this.waitingForOpen=!1):this.onDataEmitter.fire(e)}async upgradeToWebSocketConnection(){const e=this._options.url.replace(/skipWebSocketFrames=false/gim,"skipWebSocketFrames=true");this.send((new TextEncoder).encode(this.createHandshakeRequest(e)))}createHandshakeRequest(e){return[`GET ${e} HTTP/1.1`,"Connection: Upgrade","Upgrade: websocket",`Sec-WebSocket-Key: ${this.randomString(32)}`,"\r\n"].join("\r\n")}randomString(e=16){const t=new Uint32Array(e);return crypto.getRandomValues(t),t.toString()}}},e=>{e.exports=r(9016)},(e,t,r)=>{r.r(t),r.d(t,{TunnelProvider:()=>s});var n=r(14);class s{constructor(e){this.rpc=e,this.features={elevation:!1,public:!1},this.tunnelFactory=async(e,t)=>{let r;try{r=await this.rpc.call("forward",{port:e.remoteAddress.port})}catch(e){throw new Error(`Could not forward port: ${e}`)}const s=new n.EventEmitter,i=this.rpc.onClose((()=>s.fire()));return s.event((()=>i.dispose())),{remoteAddress:e.remoteAddress,localAddress:r.uri,public:!1,onDidDispose:s.event,dispose:async()=>{try{await this.rpc.call("unforward",{port:e.remoteAddress.port})}catch{}s.fire()}}}}}},e=>{e.exports=r(1139)}],i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}};return s[e](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var s=Object.create(null);o.r(s);var i={};e=e||[null,n({}),n([]),n(n)];for(var a=2&r&&t;"object"==typeof a&&!~e.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((e=>i[e]=()=>t[e]));return i.default=()=>t,o.d(s,i),s},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a=o(0),c=t;for(var l in a)c[l]=a[l];a.__esModule&&Object.defineProperty(c,"__esModule",{value:!0})})()},9496:e=>{"use strict";e.exports=require("vscode")},9491:e=>{"use strict";e.exports=require("assert")},852:e=>{"use strict";e.exports=require("async_hooks")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6206:e=>{"use strict";e.exports=require("console")},2057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},8188:e=>{"use strict";e.exports=require("module")},1808:e=>{"use strict";e.exports=require("net")},7742:e=>{"use strict";e.exports=require("node:process")},2477:e=>{"use strict";e.exports=require("node:stream/web")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},9512:e=>{"use strict";e.exports=require("timers")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},1267:e=>{"use strict";e.exports=require("worker_threads")},9796:e=>{"use strict";e.exports=require("zlib")},8177:(e,t,r)=>{if(!globalThis.ReadableStream)try{const e=r(7742),{emitWarning:t}=e;try{e.emitWarning=()=>{},Object.assign(globalThis,r(2477)),e.emitWarning=t}catch(r){throw e.emitWarning=t,r}}catch(e){Object.assign(globalThis,r(5952))}try{const{Blob:e}=r(4300);e&&!e.prototype.stream&&(e.prototype.stream=function(e){let t=0;const r=this;return new ReadableStream({type:"bytes",async pull(e){const n=r.slice(t,Math.min(r.size,t+65536)),s=await n.arrayBuffer();t+=s.byteLength,e.enqueue(new Uint8Array(s)),t===r.size&&e.close()}})})}catch(e){}},2398:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DataViewIndexOutOfBoundsError:()=>U,DecodeError:()=>S,Decoder:()=>K,EXT_TIMESTAMP:()=>b,Encoder:()=>x,ExtData:()=>v,ExtensionCodec:()=>R,decode:()=>z,decodeArrayStream:()=>ee,decodeAsync:()=>Z,decodeMulti:()=>W,decodeMultiStream:()=>te,decodeStream:()=>re,decodeTimestampExtension:()=>P,decodeTimestampToTimeSpec:()=>C,encode:()=>k,encodeDateToTimeSpec:()=>E,encodeTimeSpecToTimestamp:()=>_,encodeTimestampExtension:()=>T});var n,s,i,o=4294967295;function a(e,t,r){var n=Math.floor(r/4294967296),s=r;e.setUint32(t,n),e.setUint32(t+4,s)}function c(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var l=("undefined"==typeof process||"never"!==(null===(n=null===process||void 0===process?void 0:process.env)||void 0===n?void 0:n.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function u(e){for(var t=e.length,r=0,n=0;n<t;){var s=e.charCodeAt(n++);if(0!=(4294967168&s))if(0==(4294965248&s))r+=2;else{if(s>=55296&&s<=56319&&n<t){var i=e.charCodeAt(n);56320==(64512&i)&&(++n,s=((1023&s)<<10)+(1023&i)+65536)}r+=0==(4294901760&s)?3:4}else r++}return r}var h=l?new TextEncoder:void 0,d=l?"undefined"!=typeof process&&"force"!==(null===(s=null===process||void 0===process?void 0:process.env)||void 0===s?void 0:s.TEXT_ENCODING)?200:0:o,p=(null==h?void 0:h.encodeInto)?function(e,t,r){h.encodeInto(e,t.subarray(r))}:function(e,t,r){t.set(h.encode(e),r)};function f(e,t,r){for(var n=t,s=n+r,i=[],o="";n<s;){var a=e[n++];if(0==(128&a))i.push(a);else if(192==(224&a)){var c=63&e[n++];i.push((31&a)<<6|c)}else if(224==(240&a)){c=63&e[n++];var l=63&e[n++];i.push((31&a)<<12|c<<6|l)}else if(240==(248&a)){var u=(7&a)<<18|(c=63&e[n++])<<12|(l=63&e[n++])<<6|63&e[n++];u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u)}else i.push(a);i.length>=4096&&(o+=String.fromCharCode.apply(String,i),i.length=0)}return i.length>0&&(o+=String.fromCharCode.apply(String,i)),o}var g,m=l?new TextDecoder:null,y=l?"undefined"!=typeof process&&"force"!==(null===(i=null===process||void 0===process?void 0:process.env)||void 0===i?void 0:i.TEXT_DECODER)?200:0:o,v=function(e,t){this.type=e,this.data=t},w=(g=function(e,t){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},g(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),S=function(e){function t(r){var n=e.call(this,r)||this,s=Object.create(t.prototype);return Object.setPrototypeOf(n,s),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:t.name}),n}return w(t,e),t}(Error),b=-1;function _(e){var t,r=e.sec,n=e.nsec;if(r>=0&&n>=0&&r<=17179869183){if(0===n&&r<=4294967295){var s=new Uint8Array(4);return(t=new DataView(s.buffer)).setUint32(0,r),s}var i=r/4294967296,o=4294967295&r;return s=new Uint8Array(8),(t=new DataView(s.buffer)).setUint32(0,n<<2|3&i),t.setUint32(4,o),s}return s=new Uint8Array(12),(t=new DataView(s.buffer)).setUint32(0,n),a(t,4,r),s}function E(e){var t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),s=Math.floor(n/1e9);return{sec:r+s,nsec:n-1e9*s}}function T(e){return e instanceof Date?_(E(e)):null}function C(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var r=t.getUint32(0);return{sec:4294967296*(3&r)+t.getUint32(4),nsec:r>>>2};case 12:return{sec:c(t,4),nsec:t.getUint32(0)};default:throw new S("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}function P(e){var t=C(e);return new Date(1e3*t.sec+t.nsec/1e6)}var A={type:b,encode:T,decode:P},R=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(A)}return e.prototype.register=function(e){var t=e.type,r=e.encode,n=e.decode;if(t>=0)this.encoders[t]=r,this.decoders[t]=n;else{var s=1+t;this.builtInEncoders[s]=r,this.builtInDecoders[s]=n}},e.prototype.tryToEncode=function(e,t){for(var r=0;r<this.builtInEncoders.length;r++)if(null!=(n=this.builtInEncoders[r])&&null!=(s=n(e,t)))return new v(-1-r,s);for(r=0;r<this.encoders.length;r++){var n,s;if(null!=(n=this.encoders[r])&&null!=(s=n(e,t)))return new v(r,s)}return e instanceof v?e:null},e.prototype.decode=function(e,t,r){var n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new v(t,e)},e.defaultCodec=new e,e}();function I(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var x=function(){function e(e,t,r,n,s,i,o,a){void 0===e&&(e=R.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=100),void 0===n&&(n=2048),void 0===s&&(s=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),this.extensionCodec=e,this.context=t,this.maxDepth=r,this.initialBufferSize=n,this.sortKeys=s,this.forceFloat32=i,this.ignoreUndefined=o,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.getUint8Array()},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>d){var t=u(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),p(e,this.bytes,this.pos),this.pos+=t}else t=u(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,r){for(var n=e.length,s=r,i=0;i<n;){var o=e.charCodeAt(i++);if(0!=(4294967168&o)){if(0==(4294965248&o))t[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<n){var a=e.charCodeAt(i);56320==(64512&a)&&(++i,o=((1023&o)<<10)+(1023&a)+65536)}0==(4294901760&o)?(t[s++]=o>>12&15|224,t[s++]=o>>6&63|128):(t[s++]=o>>18&7|240,t[s++]=o>>12&63|128,t[s++]=o>>6&63|128)}t[s++]=63&o|128}else t[s++]=o}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var r=I(e);this.writeU8a(r)},e.prototype.encodeArray=function(e,t){var r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large array: ".concat(r));this.writeU8(221),this.writeU32(r)}for(var n=0,s=e;n<s.length;n++){var i=s[n];this.doEncode(i,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var r=0,n=0,s=t;n<s.length;n++)void 0!==e[s[n]]&&r++;return r},e.prototype.encodeMap=function(e,t){var r=Object.keys(e);this.sortKeys&&r.sort();var n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large map object: ".concat(n));this.writeU8(223),this.writeU32(n)}for(var s=0,i=r;s<i.length;s++){var o=i[s],a=e[o];this.ignoreUndefined&&void 0===a||(this.encodeString(o),this.doEncode(a,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,r){var n=r/4294967296,s=r;e.setUint32(t,n),e.setUint32(t+4,s)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),a(this.view,this.pos,e),this.pos+=8},e}(),O={};function k(e,t){return void 0===t&&(t=O),new x(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encode(e)}function M(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var N=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var r=0;r<this.maxKeyLength;r++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,r){e:for(var n=0,s=this.caches[r-1];n<s.length;n++){for(var i=s[n],o=i.bytes,a=0;a<r;a++)if(o[a]!==e[t+a])continue e;return i.str}return null},e.prototype.store=function(e,t){var r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)},e.prototype.decode=function(e,t,r){var n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;var s=f(e,t,r),i=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(i,s),s},e}(),D=function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},L=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,s){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,s,(t=e[r](t)).done,t.value)}))}}},B=function(e){return this instanceof B?(this.v=e,this):new B(e)},q=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){s[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=s[e](t)).value instanceof B?Promise.resolve(r.value.v).then(c,l):u(i[0][2],r)}catch(e){u(i[0][3],e)}var r}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}},j=new DataView(new ArrayBuffer(0)),F=new Uint8Array(j.buffer),U=function(){try{j.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),$=new U("Insufficient data"),H=new N,K=function(){function e(e,t,r,n,s,i,a,c){void 0===e&&(e=R.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=o),void 0===n&&(n=o),void 0===s&&(s=o),void 0===i&&(i=o),void 0===a&&(a=o),void 0===c&&(c=H),this.extensionCodec=e,this.context=t,this.maxStrLength=r,this.maxBinLength=n,this.maxArrayLength=s,this.maxMapLength=i,this.maxExtLength=a,this.keyDecoder=c,this.totalPos=0,this.pos=0,this.view=j,this.bytes=F,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=I(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=I(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),r=I(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,r=this.pos;return new RangeError("Extra ".concat(t.byteLength-r," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return D(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,r,n,s,i,o,a,c;return i=this,o=void 0,c=function(){var i,o,a,c,l,u,h,d;return D(this,(function(p){switch(p.label){case 0:i=!1,p.label=1;case 1:p.trys.push([1,6,7,12]),t=L(e),p.label=2;case 2:return[4,t.next()];case 3:if((r=p.sent()).done)return[3,5];if(a=r.value,i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{o=this.doDecodeSync(),i=!0}catch(e){if(!(e instanceof U))throw e}this.totalPos+=this.pos,p.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=p.sent(),n={error:c},[3,12];case 7:return p.trys.push([7,,10,11]),r&&!r.done&&(s=t.return)?[4,s.call(t)]:[3,9];case 8:p.sent(),p.label=9;case 9:return[3,11];case 10:if(n)throw n.error;return[7];case 11:return[7];case 12:if(i){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,o]}throw u=(l=this).headByte,h=l.pos,d=l.totalPos,new RangeError("Insufficient data in parsing ".concat(M(u)," at ").concat(d," (").concat(h," in the current buffer)"))}}))},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{s(c.next(e))}catch(e){t(e)}}function n(e){try{s(c.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(r,n)}s((c=c.apply(i,o||[])).next())}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return q(this,arguments,(function(){var r,n,s,i,o,a,c,l,u;return D(this,(function(h){switch(h.label){case 0:r=t,n=-1,h.label=1;case 1:h.trys.push([1,13,14,19]),s=L(e),h.label=2;case 2:return[4,B(s.next())];case 3:if((i=h.sent()).done)return[3,12];if(o=i.value,t&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(o),r&&(n=this.readArraySize(),r=!1,this.complete()),h.label=4;case 4:h.trys.push([4,9,,10]),h.label=5;case 5:return[4,B(this.doDecodeSync())];case 6:return[4,h.sent()];case 7:return h.sent(),0==--n?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=h.sent())instanceof U))throw a;return[3,10];case 10:this.totalPos+=this.pos,h.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=h.sent(),l={error:c},[3,19];case 14:return h.trys.push([14,,17,18]),i&&!i.done&&(u=s.return)?[4,B(u.call(s))]:[3,16];case 15:h.sent(),h.label=16;case 16:return[3,18];case 17:if(l)throw l.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(n=e-128)){this.pushMapState(n),this.complete();continue e}t={}}else if(e<160){if(0!=(n=e-144)){this.pushArrayState(n),this.complete();continue e}t=[]}else{var r=e-160;t=this.decodeUtf8String(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)r=this.lookU8(),t=this.decodeUtf8String(r,1);else if(218===e)r=this.lookU16(),t=this.decodeUtf8String(r,2);else if(219===e)r=this.lookU32(),t=this.decodeUtf8String(r,4);else if(220===e){if(0!==(n=this.readU16())){this.pushArrayState(n),this.complete();continue e}t=[]}else if(221===e){if(0!==(n=this.readU32())){this.pushArrayState(n),this.complete();continue e}t=[]}else if(222===e){if(0!==(n=this.readU16())){this.pushMapState(n),this.complete();continue e}t={}}else if(223===e){if(0!==(n=this.readU32())){this.pushMapState(n),this.complete();continue e}t={}}else if(196===e){var n=this.lookU8();t=this.decodeBinary(n,1)}else if(197===e)n=this.lookU16(),t=this.decodeBinary(n,2);else if(198===e)n=this.lookU32(),t=this.decodeBinary(n,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)n=this.lookU8(),t=this.decodeExtension(n,1);else if(200===e)n=this.lookU16(),t=this.decodeExtension(n,2);else{if(201!==e)throw new S("Unrecognized type byte: ".concat(M(e)));n=this.lookU32(),t=this.decodeExtension(n,4)}this.complete();for(var s=this.stack;s.length>0;){var i=s[s.length-1];if(0===i.type){if(i.array[i.position]=t,i.position++,i.position!==i.size)continue e;s.pop(),t=i.array}else{if(1===i.type){if(void 0,"string"!=(o=typeof t)&&"number"!==o)throw new S("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new S("The key __proto__ is not allowed");i.key=t,i.type=2;continue e}if(i.map[i.key]=t,i.readCount++,i.readCount!==i.size){i.key=null,i.type=1;continue e}s.pop(),t=i.map}}return t}var o},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new S("Unrecognized array type byte: ".concat(M(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new S("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new S("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var r;if(e>this.maxStrLength)throw new S("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw $;var n,s=this.pos+t;return n=this.stateIsMapKey()&&(null===(r=this.keyDecoder)||void 0===r?void 0:r.canBeCached(e))?this.keyDecoder.decode(this.bytes,s,e):e>y?function(e,t,r){var n=e.subarray(t,t+r);return m.decode(n)}(this.bytes,s,e):f(this.bytes,s,e),this.pos+=t+e,n},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new S("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw $;var r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new S("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,r=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,r},e.prototype.readI64=function(){var e=c(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),V={};function z(e,t){return void 0===t&&(t=V),new K(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decode(e)}function W(e,t){return void 0===t&&(t=V),new K(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeMulti(e)}var G=function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Y=function(e){return this instanceof Y?(this.v=e,this):new Y(e)},Q=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){s[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=s[e](t)).value instanceof Y?Promise.resolve(r.value.v).then(c,l):u(i[0][2],r)}catch(e){u(i[0][3],e)}var r}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}};function X(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}function J(e){return null!=e[Symbol.asyncIterator]?e:function(e){return Q(this,arguments,(function(){var t,r,n,s;return G(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,Y(t.read())];case 3:return r=i.sent(),n=r.done,s=r.value,n?[4,Y(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return X(s),[4,Y(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e)}function Z(e,t){return void 0===t&&(t=V),r=this,n=void 0,i=function(){var r;return function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(this,(function(n){return r=J(e),[2,new K(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeAsync(r)]}))},new((s=void 0)||(s=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function a(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof s?r:new s((function(e){e(r)}))).then(o,a)}c((i=i.apply(r,n||[])).next())}));var r,n,s,i}function ee(e,t){void 0===t&&(t=V);var r=J(e);return new K(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeArrayStream(r)}function te(e,t){void 0===t&&(t=V);var r=J(e);return new K(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeStream(r)}function re(e,t){return void 0===t&&(t=V),te(e,t)}},9016:(e,t,r)=>{"use strict";function n(e,t){return t?t.aborted?Promise.resolve(void 0):new Promise((r=>{const n=s(e,(e=>{t.removeEventListener("abort",i),r(e)})),i=()=>{n.dispose(),t.removeEventListener("abort",i),r(void 0)};t.addEventListener("abort",i)})):new Promise((t=>s(e,t)))}r.r(t),r.d(t,{EventEmitter:()=>i,once:()=>s,toPromise:()=>n});const s=(e,t)=>{const r=e((e=>{t(e),r.dispose()}));return r};class i{constructor(){this.event=(e,t,r)=>{const n=this.add(t?e.bind(t):e);return r?.push(n),n}}get size(){return this.listeners?"function"==typeof this.listeners?1:this.listeners.length:0}fire(e){if(this.listeners)if("function"==typeof this.listeners)this.listeners(e);else for(const t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?"function"==typeof this.listeners?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if("function"==typeof this.listeners)return void(this.listeners===e&&(this.listeners=void 0));const t=this.listeners.indexOf(e);-1!==t&&(2===this.listeners.length?this.listeners=0===t?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}}},9453:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(7842);const s=class extends n.Z{#e=0;#t="";constructor(e,t,r={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(e,r),null===r&&(r={});const n=void 0===r.lastModified?Date.now():Number(r.lastModified);Number.isNaN(n)||(this.#e=n),this.#t=String(t)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](e){return!!e&&e instanceof n.Z&&/^(File)$/.test(e[Symbol.toStringTag])}}},6459:(e,t,r)=>{"use strict";r.d(t,{t6:()=>a.Z,$B:()=>o.Z,xB:()=>u,SX:()=>l,e2:()=>h,RA:()=>d});const n=require("node:fs"),s=require("node:path");var i=r(4841),o=r(9453),a=r(7842);const{stat:c}=n.promises,l=(e,t)=>p((0,n.statSync)(e),e,t),u=(e,t)=>c(e).then((r=>p(r,e,t))),h=(e,t)=>c(e).then((r=>f(r,e,t))),d=(e,t)=>f((0,n.statSync)(e),e,t),p=(e,t,r="")=>new a.Z([new g({path:t,size:e.size,lastModified:e.mtimeMs,start:0})],{type:r}),f=(e,t,r="")=>new o.Z([new g({path:t,size:e.size,lastModified:e.mtimeMs,start:0})],(0,s.basename)(t),{type:r,lastModified:e.mtimeMs});class g{#r;#n;constructor(e){this.#r=e.path,this.#n=e.start,this.size=e.size,this.lastModified=e.lastModified}slice(e,t){return new g({path:this.#r,lastModified:this.lastModified,size:t-e,start:this.#n+e})}async*stream(){const{mtimeMs:e}=await c(this.#r);if(e>this.lastModified)throw new i("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,n.createReadStream)(this.#r,{start:this.#n,end:this.#n+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}},7842:(e,t,r)=>{"use strict";async function*n(e,t=!0){for(const r of e)if("stream"in r)yield*r.stream();else if(ArrayBuffer.isView(r))if(t){let e=r.byteOffset;const t=r.byteOffset+r.byteLength;for(;e!==t;){const n=Math.min(t-e,65536),s=r.buffer.slice(e,e+n);e+=s.byteLength,yield new Uint8Array(s)}}else yield r;else{let e=0,t=r;for(;e!==t.size;){const r=t.slice(e,Math.min(t.size,e+65536)),n=await r.arrayBuffer();e+=n.byteLength,yield new Uint8Array(n)}}}r.d(t,{Z:()=>i}),r(8177);const s=class e{#s=[];#i="";#o=0;#a="transparent";constructor(t=[],r={}){if("object"!=typeof t||null===t)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if("function"!=typeof t[Symbol.iterator])throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if("object"!=typeof r&&"function"!=typeof r)throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");null===r&&(r={});const n=new TextEncoder;for(const r of t){let t;t=ArrayBuffer.isView(r)?new Uint8Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)):r instanceof ArrayBuffer?new Uint8Array(r.slice(0)):r instanceof e?r:n.encode(`${r}`),this.#o+=ArrayBuffer.isView(t)?t.byteLength:t.size,this.#s.push(t)}this.#a=`${void 0===r.endings?"transparent":r.endings}`;const s=void 0===r.type?"":String(r.type);this.#i=/^[\x20-\x7E]*$/.test(s)?s:""}get size(){return this.#o}get type(){return this.#i}async text(){const e=new TextDecoder;let t="";for await(const r of n(this.#s,!1))t+=e.decode(r,{stream:!0});return t+=e.decode(),t}async arrayBuffer(){const e=new Uint8Array(this.size);let t=0;for await(const r of n(this.#s,!1))e.set(r,t),t+=r.length;return e.buffer}stream(){const e=n(this.#s,!0);return new globalThis.ReadableStream({type:"bytes",async pull(t){const r=await e.next();r.done?t.close():t.enqueue(r.value)},async cancel(){await e.return()}})}slice(t=0,r=this.size,n=""){const{size:s}=this;let i=t<0?Math.max(s+t,0):Math.min(t,s),o=r<0?Math.max(s+r,0):Math.min(r,s);const a=Math.max(o-i,0),c=this.#s,l=[];let u=0;for(const e of c){if(u>=a)break;const t=ArrayBuffer.isView(e)?e.byteLength:e.size;if(i&&t<=i)i-=t,o-=t;else{let r;ArrayBuffer.isView(e)?(r=e.subarray(i,Math.min(t,o)),u+=r.byteLength):(r=e.slice(i,Math.min(t,o)),u+=r.size),o-=t,l.push(r),i=0}}const h=new e([],{type:String(n).toLowerCase()});return h.#o=a,h.#s=l,h}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&"object"==typeof e&&"function"==typeof e.constructor&&("function"==typeof e.stream||"function"==typeof e.arrayBuffer)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}};Object.defineProperties(s.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});const i=s},693:(e,t,r)=>{"use strict";r.d(t,{Ct:()=>p,au:()=>f});var n=r(7842),s=r(9453),{toStringTag:i,iterator:o,hasInstance:a}=Symbol,c=Math.random,l="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),u=(e,t,r)=>(e+="",/^(Blob|File)$/.test(t&&t[i])?[(r=void 0!==r?r+"":"File"==t[i]?t.name:"blob",e),t.name!==r||"blob"==t[i]?new s.Z([t],r,t):t]:[e,t+""]),h=(e,t)=>(t?e:e.replace(/\r?\n|\r/g,"\r\n")).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),d=(e,t,r)=>{if(t.length<r)throw new TypeError(`Failed to execute '${e}' on 'FormData': ${r} arguments required, but only ${t.length} present.`)};const p=class{#c=[];constructor(...e){if(e.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[i](){return"FormData"}[o](){return this.entries()}static[a](e){return e&&"object"==typeof e&&"FormData"===e[i]&&!l.some((t=>"function"!=typeof e[t]))}append(...e){d("append",arguments,2),this.#c.push(u(...e))}delete(e){d("delete",arguments,1),e+="",this.#c=this.#c.filter((([t])=>t!==e))}get(e){d("get",arguments,1),e+="";for(var t=this.#c,r=t.length,n=0;n<r;n++)if(t[n][0]===e)return t[n][1];return null}getAll(e,t){return d("getAll",arguments,1),t=[],e+="",this.#c.forEach((r=>r[0]===e&&t.push(r[1]))),t}has(e){return d("has",arguments,1),e+="",this.#c.some((t=>t[0]===e))}forEach(e,t){for(var[r,n]of(d("forEach",arguments,1),this))e.call(t,n,r,this)}set(...e){d("set",arguments,2);var t=[],r=!0;e=u(...e),this.#c.forEach((n=>{n[0]===e[0]?r&&(r=!t.push(e)):t.push(n)})),r&&t.push(e),this.#c=t}*entries(){yield*this.#c}*keys(){for(var[e]of this)yield e}*values(){for(var[,e]of this)yield e}};function f(e,t=n.Z){var r=`${c()}${c()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],i=`--${r}\r\nContent-Disposition: form-data; name="`;return e.forEach(((e,t)=>"string"==typeof e?s.push(i+h(t)+`"\r\n\r\n${e.replace(/\r(?!\n)|(?<!\r)\n/g,"\r\n")}\r\n`):s.push(i+h(t)+`"; filename="${h(e.name,1)}"\r\nContent-Type: ${e.type||"application/octet-stream"}\r\n\r\n`,e,"\r\n"))),s.push(`--${r}--`),new t(s,{type:"multipart/form-data; boundary="+r})}},3765:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AbortError:()=>j,Blob:()=>F.t6,FetchError:()=>d,File:()=>F.$B,FormData:()=>u.Ct,Headers:()=>C,Request:()=>q,Response:()=>I,blobFrom:()=>F.xB,blobFromSync:()=>F.SX,default:()=>$,fileFrom:()=>F.e2,fileFromSync:()=>F.RA,isRedirect:()=>A});const n=require("node:http"),s=require("node:https"),i=require("node:zlib"),o=require("node:stream"),a=require("node:buffer"),c=require("node:util");var l=r(7842),u=r(693);class h extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class d extends h{constructor(e,t,r){super(e,t),r&&(this.code=this.errno=r.code,this.erroredSysCall=r.syscall)}}const p=Symbol.toStringTag,f=e=>"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&"function"==typeof e.sort&&"URLSearchParams"===e[p],g=e=>e&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&/^(Blob|File)$/.test(e[p]),m=(0,c.promisify)(o.pipeline),y=Symbol("Body internals");class v{constructor(e,{size:t=0}={}){let r=null;null===e?e=null:f(e)?e=a.Buffer.from(e.toString()):g(e)||a.Buffer.isBuffer(e)||(c.types.isAnyArrayBuffer(e)?e=a.Buffer.from(e):ArrayBuffer.isView(e)?e=a.Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof o||(e instanceof u.Ct?r=(e=(0,u.au)(e)).type.split("=")[1]:e=a.Buffer.from(String(e))));let n=e;a.Buffer.isBuffer(e)?n=o.Readable.from(e):g(e)&&(n=o.Readable.from(e.stream())),this[y]={body:e,stream:n,boundary:r,disturbed:!1,error:null},this.size=t,e instanceof o&&e.on("error",(e=>{const t=e instanceof h?e:new d(`Invalid response body while trying to fetch ${this.url}: ${e.message}`,"system",e);this[y].error=t}))}get body(){return this[y].stream}get bodyUsed(){return this[y].disturbed}async arrayBuffer(){const{buffer:e,byteOffset:t,byteLength:r}=await w(this);return e.slice(t,t+r)}async formData(){const e=this.headers.get("content-type");if(e.startsWith("application/x-www-form-urlencoded")){const e=new u.Ct,t=new URLSearchParams(await this.text());for(const[r,n]of t)e.append(r,n);return e}const{toFormData:t}=await r.e(669).then(r.bind(r,4669));return t(this.body,e)}async blob(){const e=this.headers&&this.headers.get("content-type")||this[y].body&&this[y].body.type||"",t=await this.arrayBuffer();return new l.Z([t],{type:e})}async json(){const e=await this.text();return JSON.parse(e)}async text(){const e=await w(this);return(new TextDecoder).decode(e)}buffer(){return w(this)}}async function w(e){if(e[y].disturbed)throw new TypeError(`body used already for: ${e.url}`);if(e[y].disturbed=!0,e[y].error)throw e[y].error;const{body:t}=e;if(null===t)return a.Buffer.alloc(0);if(!(t instanceof o))return a.Buffer.alloc(0);const r=[];let n=0;try{for await(const s of t){if(e.size>0&&n+s.length>e.size){const r=new d(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(r),r}n+=s.length,r.push(s)}}catch(t){throw t instanceof h?t:new d(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t)}if(!0!==t.readableEnded&&!0!==t._readableState.ended)throw new d(`Premature close of server response while trying to fetch ${e.url}`);try{return r.every((e=>"string"==typeof e))?a.Buffer.from(r.join("")):a.Buffer.concat(r,n)}catch(t){throw new d(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t)}}v.prototype.buffer=(0,c.deprecate)(v.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer"),Object.defineProperties(v.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,c.deprecate)((()=>{}),"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});const S=(e,t)=>{let r,n,{body:s}=e[y];if(e.bodyUsed)throw new Error("cannot clone body after it is used");return s instanceof o&&"function"!=typeof s.getBoundary&&(r=new o.PassThrough({highWaterMark:t}),n=new o.PassThrough({highWaterMark:t}),s.pipe(r),s.pipe(n),e[y].stream=r,s=n),s},b=(0,c.deprecate)((e=>e.getBoundary()),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),_=(e,t)=>null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":f(e)?"application/x-www-form-urlencoded;charset=UTF-8":g(e)?e.type||null:a.Buffer.isBuffer(e)||c.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof u.Ct?`multipart/form-data; boundary=${t[y].boundary}`:e&&"function"==typeof e.getBoundary?`multipart/form-data;boundary=${b(e)}`:e instanceof o?null:"text/plain;charset=UTF-8",E="function"==typeof n.validateHeaderName?n.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){const t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},T="function"==typeof n.validateHeaderValue?n.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){const t=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}};class C extends URLSearchParams{constructor(e){let t=[];if(e instanceof C){const r=e.raw();for(const[e,n]of Object.entries(r))t.push(...n.map((t=>[e,t])))}else if(null==e);else{if("object"!=typeof e||c.types.isBoxedPrimitive(e))throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");{const r=e[Symbol.iterator];if(null==r)t.push(...Object.entries(e));else{if("function"!=typeof r)throw new TypeError("Header pairs must be iterable");t=[...e].map((e=>{if("object"!=typeof e||c.types.isBoxedPrimitive(e))throw new TypeError("Each header pair must be an iterable object");return[...e]})).map((e=>{if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");return[...e]}))}}}return t=t.length>0?t.map((([e,t])=>(E(e),T(e,String(t)),[String(e).toLowerCase(),String(t)]))):void 0,super(t),new Proxy(this,{get(e,t,r){switch(t){case"append":case"set":return(r,n)=>(E(r),T(r,String(n)),URLSearchParams.prototype[t].call(e,String(r).toLowerCase(),String(n)));case"delete":case"has":case"getAll":return r=>(E(r),URLSearchParams.prototype[t].call(e,String(r).toLowerCase()));case"keys":return()=>(e.sort(),new Set(URLSearchParams.prototype.keys.call(e)).keys());default:return Reflect.get(e,t,r)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){const t=this.getAll(e);if(0===t.length)return null;let r=t.join(", ");return/^content-encoding$/i.test(e)&&(r=r.toLowerCase()),r}forEach(e,t){for(const r of this.keys())Reflect.apply(e,t,[this.get(r),r,this])}*values(){for(const e of this.keys())yield this.get(e)}*entries(){for(const e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce(((e,t)=>(e[t]=this.getAll(t),e)),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce(((e,t)=>{const r=this.getAll(t);return e[t]="host"===t?r[0]:r.length>1?r:r[0],e}),{})}}Object.defineProperties(C.prototype,["get","entries","forEach","values"].reduce(((e,t)=>(e[t]={enumerable:!0},e)),{}));const P=new Set([301,302,303,307,308]),A=e=>P.has(e),R=Symbol("Response internals");class I extends v{constructor(e=null,t={}){super(e,t);const r=null!=t.status?t.status:200,n=new C(t.headers);if(null!==e&&!n.has("Content-Type")){const t=_(e,this);t&&n.append("Content-Type",t)}this[R]={type:"default",url:t.url,status:r,statusText:t.statusText||"",headers:n,counter:t.counter,highWaterMark:t.highWaterMark}}get type(){return this[R].type}get url(){return this[R].url||""}get status(){return this[R].status}get ok(){return this[R].status>=200&&this[R].status<300}get redirected(){return this[R].counter>0}get statusText(){return this[R].statusText}get headers(){return this[R].headers}get highWaterMark(){return this[R].highWaterMark}clone(){return new I(S(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(e,t=302){if(!A(t))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new I(null,{headers:{location:new URL(e).toString()},status:t})}static error(){const e=new I(null,{status:0,statusText:""});return e[R].type="error",e}get[Symbol.toStringTag](){return"Response"}}Object.defineProperties(I.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});const x=require("node:url"),O=require("node:net");function k(e,t=!1){return null==e?"no-referrer":(e=new URL(e),/^(about|blob|data):$/.test(e.protocol)?"no-referrer":(e.username="",e.password="",e.hash="",t&&(e.pathname="",e.search=""),e))}const M=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]);function N(e){return!!/^about:(blank|srcdoc)$/.test(e)||"data:"===e.protocol||!!/^(blob|filesystem):$/.test(e.protocol)||function(e){if(/^(http|ws)s:$/.test(e.protocol))return!0;const t=e.host.replace(/(^\[)|(]$)/g,""),r=(0,O.isIP)(t);return!(4!==r||!/^127\./.test(t))||!(6!==r||!/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t))||"localhost"!==e.host&&!e.host.endsWith(".localhost")&&"file:"===e.protocol}(e)}const D=Symbol("Request internals"),L=e=>"object"==typeof e&&"object"==typeof e[D],B=(0,c.deprecate)((()=>{}),".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)");class q extends v{constructor(e,t={}){let r;if(L(e)?r=new URL(e.url):(r=new URL(e),e={}),""!==r.username||""!==r.password)throw new TypeError(`${r} is an url with embedded credentials.`);let n=t.method||e.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(n)&&(n=n.toUpperCase()),!L(t)&&"data"in t&&B(),(null!=t.body||L(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw new TypeError("Request with GET/HEAD method cannot have body");const s=t.body?t.body:L(e)&&null!==e.body?S(e):null;super(s,{size:t.size||e.size||0});const i=new C(t.headers||e.headers||{});if(null!==s&&!i.has("Content-Type")){const e=_(s,this);e&&i.set("Content-Type",e)}let o=L(e)?e.signal:null;if("signal"in t&&(o=t.signal),null!=o&&("object"!=typeof(a=o)||"AbortSignal"!==a[p]&&"EventTarget"!==a[p]))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");var a;let c=null==t.referrer?e.referrer:t.referrer;if(""===c)c="no-referrer";else if(c){const e=new URL(c);c=/^about:(\/\/)?client$/.test(e)?"client":e}else c=void 0;this[D]={method:n,redirect:t.redirect||e.redirect||"follow",headers:i,parsedURL:r,signal:o,referrer:c},this.follow=void 0===t.follow?void 0===e.follow?20:e.follow:t.follow,this.compress=void 0===t.compress?void 0===e.compress||e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1,this.referrerPolicy=t.referrerPolicy||e.referrerPolicy||""}get method(){return this[D].method}get url(){return(0,x.format)(this[D].parsedURL)}get headers(){return this[D].headers}get redirect(){return this[D].redirect}get signal(){return this[D].signal}get referrer(){return"no-referrer"===this[D].referrer?"":"client"===this[D].referrer?"about:client":this[D].referrer?this[D].referrer.toString():void 0}get referrerPolicy(){return this[D].referrerPolicy}set referrerPolicy(e){this[D].referrerPolicy=function(e){if(!M.has(e))throw new TypeError(`Invalid referrerPolicy: ${e}`);return e}(e)}clone(){return new q(this)}get[Symbol.toStringTag](){return"Request"}}Object.defineProperties(q.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});class j extends h{constructor(e,t="aborted"){super(e,t)}}var F=r(6459);const U=new Set(["data:","http:","https:"]);async function $(e,t){return new Promise(((r,c)=>{const l=new q(e,t),{parsedURL:u,options:h}=(e=>{const{parsedURL:t}=e[D],r=new C(e[D].headers);r.has("Accept")||r.set("Accept","*/*");let n=null;if(null===e.body&&/^(post|put)$/i.test(e.method)&&(n="0"),null!==e.body){const t=(e=>{const{body:t}=e[y];return null===t?0:g(t)?t.size:a.Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null})(e);"number"!=typeof t||Number.isNaN(t)||(n=String(t))}n&&r.set("Content-Length",n),""===e.referrerPolicy&&(e.referrerPolicy="strict-origin-when-cross-origin"),e.referrer&&"no-referrer"!==e.referrer?e[D].referrer=function(e,{referrerURLCallback:t,referrerOriginCallback:r}={}){if("no-referrer"===e.referrer||""===e.referrerPolicy)return null;const n=e.referrerPolicy;if("about:client"===e.referrer)return"no-referrer";const s=e.referrer;let i=k(s),o=k(s,!0);i.toString().length>4096&&(i=o),t&&(i=t(i)),r&&(o=r(o));const a=new URL(e.url);switch(n){case"no-referrer":return"no-referrer";case"origin":return o;case"unsafe-url":return i;case"strict-origin":return N(i)&&!N(a)?"no-referrer":o.toString();case"strict-origin-when-cross-origin":return i.origin===a.origin?i:N(i)&&!N(a)?"no-referrer":o;case"same-origin":return i.origin===a.origin?i:"no-referrer";case"origin-when-cross-origin":return i.origin===a.origin?i:o;case"no-referrer-when-downgrade":return N(i)&&!N(a)?"no-referrer":i;default:throw new TypeError(`Invalid referrerPolicy: ${n}`)}}(e):e[D].referrer="no-referrer",e[D].referrer instanceof URL&&r.set("Referer",e.referrer),r.has("User-Agent")||r.set("User-Agent","node-fetch"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip, deflate, br");let{agent:s}=e;"function"==typeof s&&(s=s(t)),r.has("Connection")||s||r.set("Connection","close");const i=(e=>{if(e.search)return e.search;const t=e.href.length-1,r=e.hash||("#"===e.href[t]?"#":"");return"?"===e.href[t-r.length]?"?":""})(t);return{parsedURL:t,options:{path:t.pathname+i,method:e.method,headers:r[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:s}}})(l);if(!U.has(u.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${u.protocol.replace(/:$/,"")}" is not supported.`);if("data:"===u.protocol){const e=function(e){if(!/^data:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');const t=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===t||t<=4)throw new TypeError("malformed data: URI");const r=e.substring(5,t).split(";");let n="",s=!1;const i=r[0]||"text/plain";let o=i;for(let e=1;e<r.length;e++)"base64"===r[e]?s=!0:(o+=`;${r[e]}`,0===r[e].indexOf("charset=")&&(n=r[e].substring(8)));r[0]||n.length||(o+=";charset=US-ASCII",n="US-ASCII");const a=s?"base64":"ascii",c=unescape(e.substring(t+1)),l=Buffer.from(c,a);return l.type=i,l.typeFull=o,l.charset=n,l}(l.url),t=new I(e,{headers:{"Content-Type":e.typeFull}});return void r(t)}const p=("https:"===u.protocol?s:n).request,{signal:f}=l;let v=null;const w=()=>{const e=new j("The operation was aborted.");c(e),l.body&&l.body instanceof o.Readable&&l.body.destroy(e),v&&v.body&&v.body.emit("error",e)};if(f&&f.aborted)return void w();const b=()=>{w(),P()},_=p(u.toString(),h);f&&f.addEventListener("abort",b);const P=()=>{_.abort(),f&&f.removeEventListener("abort",b)};_.on("error",(e=>{c(new d(`request to ${l.url} failed, reason: ${e.message}`,"system",e)),P()})),function(e,t){const r=a.Buffer.from("0\r\n\r\n");let n,s=!1,i=!1;e.on("response",(e=>{const{headers:t}=e;s="chunked"===t["transfer-encoding"]&&!t["content-length"]})),e.on("socket",(t=>{const o=()=>{if(s&&!i){const e=new Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",(e=>{v&&v.body&&v.body.destroy(e)})(e)}},c=e=>{i=0===a.Buffer.compare(e.slice(-5),r),!i&&n&&(i=0===a.Buffer.compare(n.slice(-3),r.slice(0,3))&&0===a.Buffer.compare(e.slice(-2),r.slice(3))),n=e};t.prependListener("close",o),t.on("data",c),e.on("close",(()=>{t.removeListener("close",o),t.removeListener("data",c)}))}))}(_),process.version<"v14"&&_.on("socket",(e=>{let t;e.prependListener("end",(()=>{t=e._eventsCount})),e.prependListener("close",(r=>{if(v&&t<e._eventsCount&&!r){const e=new Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",v.body.emit("error",e)}}))})),_.on("response",(e=>{_.setTimeout(0);const n=function(e=[]){return new C(e.reduce(((e,t,r,n)=>(r%2==0&&e.push(n.slice(r,r+2)),e)),[]).filter((([e,t])=>{try{return E(e),T(e,String(t)),!0}catch{return!1}})))}(e.rawHeaders);if(A(e.statusCode)){const i=n.get("Location");let a=null;try{a=null===i?null:new URL(i,l.url)}catch{if("manual"!==l.redirect)return c(new d(`uri requested responds with an invalid redirect URL: ${i}`,"invalid-redirect")),void P()}switch(l.redirect){case"error":return c(new d(`uri requested responds with a redirect, redirect mode is set to error: ${l.url}`,"no-redirect")),void P();case"manual":break;case"follow":{if(null===a)break;if(l.counter>=l.follow)return c(new d(`maximum redirect reached at: ${l.url}`,"max-redirect")),void P();const i={headers:new C(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:S(l),signal:l.signal,size:l.size,referrer:l.referrer,referrerPolicy:l.referrerPolicy};if(!((e,t)=>{const r=new URL(t).hostname,n=new URL(e).hostname;return r===n||r.endsWith(`.${n}`)})(l.url,a)||(s=l.url,new URL(a).protocol!==new URL(s).protocol))for(const e of["authorization","www-authenticate","cookie","cookie2"])i.headers.delete(e);if(303!==e.statusCode&&l.body&&t.body instanceof o.Readable)return c(new d("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void P();303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==l.method)||(i.method="GET",i.body=void 0,i.headers.delete("content-length"));const u=function(e){const t=(e.get("referrer-policy")||"").split(/[,\s]+/);let r="";for(const e of t)e&&M.has(e)&&(r=e);return r}(n);return u&&(i.referrerPolicy=u),r($(new q(a,i))),void P()}default:return c(new TypeError(`Redirect option '${l.redirect}' is not a valid value of RequestRedirect`))}}var s;f&&e.once("end",(()=>{f.removeEventListener("abort",b)}));let a=(0,o.pipeline)(e,new o.PassThrough,(e=>{e&&c(e)}));process.version<"v12.10"&&e.on("aborted",b);const u={url:l.url,status:e.statusCode,statusText:e.statusMessage,headers:n,size:l.size,counter:l.counter,highWaterMark:l.highWaterMark},h=n.get("Content-Encoding");if(!l.compress||"HEAD"===l.method||null===h||204===e.statusCode||304===e.statusCode)return v=new I(a,u),void r(v);const p={flush:i.Z_SYNC_FLUSH,finishFlush:i.Z_SYNC_FLUSH};if("gzip"===h||"x-gzip"===h)return a=(0,o.pipeline)(a,i.createGunzip(p),(e=>{e&&c(e)})),v=new I(a,u),void r(v);if("deflate"===h||"x-deflate"===h){const t=(0,o.pipeline)(e,new o.PassThrough,(e=>{e&&c(e)}));return t.once("data",(e=>{a=8==(15&e[0])?(0,o.pipeline)(a,i.createInflate(),(e=>{e&&c(e)})):(0,o.pipeline)(a,i.createInflateRaw(),(e=>{e&&c(e)})),v=new I(a,u),r(v)})),void t.once("end",(()=>{v||(v=new I(a,u),r(v))}))}if("br"===h)return a=(0,o.pipeline)(a,i.createBrotliDecompress(),(e=>{e&&c(e)})),v=new I(a,u),void r(v);v=new I(a,u),r(v)})),(async(e,{body:t})=>{null===t?e.end():await m(t,e)})(_,l).catch(c)}))}},8492:e=>{"use strict";e.exports=JSON.parse('{"name":"@microsoft/dev-tunnels-management","version":"1.0.7398","description":"Tunnels library for Visual Studio tools","keywords":["Tunnels"],"author":"Microsoft","license":"MIT","dependencies":{"buffer":"^5.2.1","debug":"^4.1.1","vscode-jsonrpc":"^4.0.0","@microsoft/dev-tunnels-contracts":"^1.0.0","axios":"^0.21.1"},"main":"./index.js"}')},4369:e=>{"use strict";e.exports=JSON.parse('{"name":"@microsoft/dev-tunnels-ssh","version":"3.11.10","description":"SSH library for Dev Tunnels","repository":"https://github.com/microsoft/dev-tunnels-ssh.git","keywords":["SSH"],"author":"Microsoft","license":"MIT","dependencies":{"buffer":"^5.2.1","debug":"^4.1.1","diffie-hellman":"^5.0.3","vscode-jsonrpc":"^4.0.0"},"main":"./index.js"}')},9843:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},5232:e=>{"use strict";e.exports={version:"1.0.34"}}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var i=r[e]={exports:{}};return t[e].call(i.exports,i,i.exports,n),i.exports}n.m=t,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>e+".js",n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e={898:1},n.f.require=(t,r)=>{e[t]||(t=>{var r=t.modules,s=t.ids,i=t.runtime;for(var o in r)n.o(r,o)&&(n.m[o]=r[o]);i&&i(n);for(var a=0;a<s.length;a++)e[s[a]]=1})(require("./"+n.u(t)))};var s={};(()=>{"use strict";n.r(s),n.d(s,{activate:()=>j,deactivate:()=>F});var e=n(9496),t=n(3807),r=n(3758);const i="tunnel+";function o(e){const t=e.lastIndexOf("@");return-1===t?i+e:e.slice(0,t+1)+i+e.slice(t+1)}function a(e){if(e.startsWith(i))return e.substring(i.length)}class c{constructor(e,t,r){this.remote=e,this.folder=t,this.name=r}static fromUri(e){if("untitled"===e.scheme)return;const t=a(e.authority);return t?new c(t,e.path):void 0}static listIncludes(e,t){for(const r of e)if(r.remote===t.remote&&r.folder===t.folder)return!0;return!1}toUri(){return e.Uri.parse(`vscode-remote:/${o(this.remote)}${this.folder}`)}}class l{constructor(e){this.extensionContext=e,this.STORAGE_KEY="remote-tunnels.folder-history",this.historyData=e.globalState.get(this.STORAGE_KEY)??{}}async openFolders(e){for(const t of e)void 0===this.historyData[t.remote]?this.historyData[t.remote]=[t]:c.listIncludes(this.historyData[t.remote],t)||this.historyData[t.remote].push(t);this.extensionContext.globalState.update(this.STORAGE_KEY,this.historyData)}async removeFolder(e){void 0!==this.historyData[e.remote]&&c.listIncludes(this.historyData[e.remote],e)&&(this.historyData[e.remote]=this.historyData[e.remote].filter((t=>t.folder!==e.folder)),this.extensionContext.globalState.update(this.STORAGE_KEY,this.historyData))}getFolders(e){return this.historyData[e]??[]}}var u=n(1017);const h=JSON.parse('{"u2":"remote-server","G8":"ms-vscode","i8":"1.4.0","lE":"0c6ae279ed8443289764825290e4f9e2-1a736e7c-1324-4338-be46-fc2a58ae4d14-7255"}');async function d(e,t){let r=[],n=0;return new Promise(((s,i)=>{r.push(t.onLog((t=>{3===t.level&&e.report({message:t.line}),t.line.includes("Downloading VS Code Server")&&e.report({increment:0,total:100});const r=t.line.match(/.*server download progress.* \(((\d+?)\%)\)/);if(r){const[,t]=r,s=parseInt(t);e.report({message:"Downloading VS Code Server...",increment:s-n,total:100}),n=s}t.line.includes("Setting up server")&&e.report({message:t.line,increment:void 0,total:void 0})}))),r.push(t.onConnected((()=>{s()}))),r.push(t.onClose((()=>{s()})))})).finally((()=>{r.forEach((e=>e.dispose()))}))}function p(){return{commit:e.env.appCommit||"b3e4e68a0bc097f0ae7907b217c1119af9e03435",quality:void 0===e.env.appQuality||"stable"===e.env.appQuality?"stable":"insider"}}class f{constructor(t){this.disposables=[],this.outputChannel=e.window.createOutputChannel(t,{log:!0}),this.disposables.push(this.outputChannel)}showLog(){return this.outputChannel.show()}clear(){this.outputChannel.clear()}log(e,t,...r){if(!(e<this.outputChannel.logLevel))switch(t=t.replace(/\x1b\[\??[0-9]{0,3}(;[0-9]{1,3})?[a-zA-Z]/g,"").replace(/\u0008/g,"").replace(/\r/g,""),e){case 1:return this.outputChannel.trace(t,...r);case 2:return this.outputChannel.debug(t,...r);case 3:return this.outputChannel.info(t,...r);case 4:return this.outputChannel.warn(t,...r);case 5:return this.outputChannel.error(t,...r);default:throw new Error(`Unknown log level: ${e}`)}}dispose(){this.outputChannel.dispose()}logLevelToString(e){switch(e){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";default:return"unknown"}}}const g="https://aka.ms/vscode-dev-tunnel-limit",m=(t,r)=>{t instanceof f&&t.clear(),t.log(3,"=".repeat(15)+" Usage limits:"+"=".repeat(15)),0===r.length&&t.log(3,e.l10n.t("No limits are currently in place"));for(const e of r){const r=Math.round(100*(e.current||0)/(e.limit||1)),n=new Date(e.resetTime?1e3*e.resetTime:Date.now()).toLocaleString();t.log(3,`${e.name}: ${e.current} / ${e.limit} (${r}%), resets at ${n}`)}t.log(3,e.l10n.t("Learn more at {0}",g)),t.showLog()},y=e.l10n.t("A limit for this tunnel has been reached."),v={BandwidthPerUser:e.l10n.t("The bandwidth limit for this user has been reached.")},w=new Intl.RelativeTimeFormat(void 0,{numeric:"auto"});class S{constructor(e,n){this.logger=e,this.client=n,this._rpc=new t.DeferredPromise,this.tunnelProvider=this._rpc.p.then((e=>new r.TunnelProvider(e))),this.connectionManagers=new Map,this.rpc=this._rpc.p,this.tunnelFactory=async(e,t)=>{const r=await this.tunnelProvider;return await r.tunnelFactory(e,t)}}async getMatchingTunnel(t){if(t.includes(".")){const n=await e.commands.executeCommand("remote-tunnels.internal.getTunnelKeyFromHash");if(n){const[e,s]=t.split("."),i=new r.AccessTokenBasisClient("tunnel","vscode.dev.remote-server",(()=>Promise.resolve(n)));try{const t=await i.getTunnel({tunnelId:e,clusterId:s});if(t)return{tunnel:t,client:i}}catch{}}}const n=this.client.getValue(),s=await n.getTunnelForTag(t);return{client:n,tunnel:s}}async getConnectionDataForAuthority(n){const s=this.connectionManagers.get(n);if(s)return s;if(2!==n.split("+").length)throw Error(e.l10n.t("Cannot resolve remote machine name!"));const i=n.split("+")[1];this.logger.log(3,`Resolving ${n}...`);const{client:o,tunnel:a}=await this.getMatchingTunnel(i);if(!a||void 0===a.ports||0===a.ports.length)throw e.RemoteAuthorityResolverError.NotAvailable(e.l10n.t("Tunnel does not seem to be running. Cannot find port listening on remote machine"));this.logger.log(3,`Found tunnel (ID=${a.tunnelId}, Cluster=${a.clusterId})`);const c=a.ports?.[0]?.portNumber||31345,l={manager:new t.ConnectionManager({bearer:new r.BasisConnectionBearer(o,a,c)}),tunnel:a,tunnelName:i};return this.connectionManagers.set(n,l),l}async warnAboutUsageLimits(e){const t=await this.client.getValue().getManagementClient();return this.showAnyUsageLimitWarnings(await t.listUserLimits())}async showAnyUsageLimitWarnings(t){const r=t.find((e=>void 0!==e.limit&&e.current>=e.limit));if(!r)return;const n=e.l10n.t("Show Limits"),s=e.l10n.t("Learn More"),i=await e.window.showWarningMessage((({name:t,resetTime:r})=>{let n=t&&v[t]||y;if(r){const t=r-Date.now()/1e3,s=t>86400?w.format(t/3600,"hour"):w.format(t/86400,"day");n+=" "+e.l10n.t({message:"This limit will reset {0}.",args:[s],comment:'{0} is a localized string like "in 4 hours"'})}return n})(r),{modal:!0},n,s);i===s?e.env.openExternal(e.Uri.parse(g)):i===n&&m(this.logger,t)}async getConnectionManagerForAuthority(e){const{manager:t}=await this.getConnectionDataForAuthority(e);return t}async resolveExecServer(e){const{manager:r}=await this.getConnectionDataForAuthority(e),n=await r.bearer.checkedAcquire();return new t.ExecServer(n)}async resolve(n,s){this.logger.log(3,"Resolver invoked with authority",n);const{manager:i,tunnel:o,tunnelName:a}=await this.getConnectionDataForAuthority(n);this.warnAboutUsageLimits(o);const c=await(0,r.getConnectionToken)(o);return this._rpc.complete(i),e.commands.executeCommand("remote-tunnels.isConnectedToRemote",n,o,a),new e.ManagedResolvedAuthority((async()=>{const r=await i.bearer.checkedAcquire(),n=new t.ExecServer(r);0===S.nextSocketId&&e.window.withProgress({location:e.ProgressLocation.Notification,title:`Connecting to ${a}`},(e=>d(e,i)));const s=p(),o=await n.serve({extensions:[],quality:s.quality,commit_id:s.commit,socket_id:S.nextSocketId++,connection_token:c,compress:!0}),l=new e.EventEmitter,u=new e.EventEmitter;return o.onEnd.then((()=>l.fire())),r.onClose((e=>u.fire(e))),{send:e=>o.write(e),end:()=>o.end(),onDidEnd:l.event,onDidClose:u.event,onDidReceiveMessage:o.onData}}),c)}}S.nextSocketId=0;class b extends S{constructor(e,t,r,n){super(e,n),this.authProvider=r,this.disposables=[],this.rpc=this._rpc.p,this.tunnelFactory=async(e,t)=>{const r=await this.tunnelProvider;return await r.tunnelFactory(e,t)},this.disposables=t.subscriptions}async createProxyConnection(r){const n=p(),s={tunnelName:r,accessToken:this.authProvider.lastSession?.accessToken||await this.authProvider.getAccessToken(),provider:"github",httpProxy:e.workspace.getConfiguration("http").get("proxy")},i=await t.ProxyConnection.create({args:s,nonce:`v${h.i8} ${r}`,logger:this.logger,productInfo:n,serverPath:u.join(__dirname,"proxyServer.js")});return i.state!==t.ProxyConnection.State.Connected&&e.window.withProgress({location:e.ProgressLocation.Notification,title:`Connecting to ${s.tunnelName}`},(e=>d(e,i))),i}async warnAboutUsageLimitsOnProxy(e){return this.showAnyUsageLimitWarnings(await e.callOnProxy("getlimits",{}))}async resolve(t){if(2!==t.split("+").length)throw Error(e.l10n.t("Cannot resolve remote machine name!"));const n=t.split("+")[1];this.logger.log(3,`Resolving ${t}...`);const s=await this.createProxyConnection(n);this.disposables.push(s),s.onClose((e=>{console.error("Tunnel connection closed",e)}));const i=await s.localPort,o=await s.callOnProxy("gettunnel",{});if(void 0===o.value.ports||0===o.value.ports.length)throw e.RemoteAuthorityResolverError.NotAvailable(e.l10n.t("Tunnel does not seem to be running. Cannot find port listening on remote machine"));return this.warnAboutUsageLimitsOnProxy(s),s.onConnected((()=>{e.commands.executeCommand("remote-tunnels.isConnectedToRemote",t,o.value,n)})),this._rpc.complete(s),this.logger.log(3,"Remote resolution completed"),new e.ResolvedAuthority("127.0.0.1",i,await(0,r.getConnectionToken)(o.value))}}var _=n(2081),E=n(7672);class T{constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise(((e,t)=>{this.completeCallback=e,this.errorCallback=t}))}get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}complete(e){this.completeCallback(e),this.resolved=!0}error(e){this.errorCallback(e),this.rejected=!0}}const C=u.join(e.env.appRoot,"win32"===process.platform?"../../bin":"bin","stable"===e.env.appQuality?"code-tunnel":"code-tunnel-insiders")+("win32"===process.platform?".exe":"");class P{constructor(t,r){this.remoteAddress=t,this.privacy=r,this.disposeEmitter=new e.EventEmitter,this.onDidDispose=this.disposeEmitter.event}setPortFormat(e){this.localAddress=e.replace("{port}",String(this.remoteAddress.port))}dispose(){this.disposeEmitter.fire()}}class A{constructor(t,r){this.authProvider=t,this.logger=r,this.tunnels=new Set,this.stateChange=new e.EventEmitter,this._state={state:2}}get state(){return this._state}set state(e){this._state=e,this.stateChange.fire(e)}async provideTunnel(e){const t=new P(e.remoteAddress,e.privacy||"private");switch(this.tunnels.add(t),t.onDidDispose((()=>{this.tunnels.delete(t),0===this.tunnels.size?this.killRunningProcess():this.updateActivePortsIfRunning()})),this.state.state){case 3:case 2:await this.setupPortForwardingProcess();case 0:return this.updateActivePortsIfRunning(),new Promise(((e,r)=>{const n=this.stateChange.event((s=>{1===s.state?(t.setPortFormat(s.portFormat),n.dispose(),e(t)):3===s.state&&(n.dispose(),r(new Error(s.error)))}))}));case 1:return t.setPortFormat(this.state.portFormat),this.updateActivePortsIfRunning(),t}}isInStateWithProcess(e){return(0===this.state.state||1===this.state.state)&&this.state.process===e}killRunningProcess(){0!==this.state.state&&1!==this.state.state||(this.logger.log(3,"[forwarding] no more ports, stopping forwarding CLI"),this.state.process.kill(),this.state={state:2})}updateActivePortsIfRunning(){if(0===this.state.state||1===this.state.state){const e=[...this.tunnels].map((e=>e.remoteAddress.port));this.state.process.stdin.write(`${JSON.stringify(e)}\n`)}}async setupPortForwardingProcess(){const t=["--verbose","tunnel","forward-internal","--provider","github","--access-token",await this.authProvider.getAccessToken()];this.logger.log(3,"[forwarding] starting CLI");const r=(0,_.spawn)(C,t,{stdio:"pipe"});this.state={state:0,process:r};const n=new T;e.window.withProgress({location:e.ProgressLocation.Notification,title:e.l10n.t("Starting port forwarding system...")},(()=>n.p)),r.on("exit",(e=>{const t=`[forwarding] exited with code ${e}`;this.logger.log(3,t),n.complete(),this.isInStateWithProcess(r)&&(this.state={state:3,error:t})})),r.on("error",(e=>{this.logger.log(5,`[forwarding] ${e}`),n.complete(),this.isInStateWithProcess(r)&&(this.state={state:3,error:String(e)})})),r.stdout.pipe(E("\n")).on("data",(e=>this.logger.log(3,`[forwarding] ${e}`))).resume(),r.stderr.pipe(E("\n")).on("data",(e=>{try{const t=JSON.parse(e);t.port_format&&void 0!==t.port_format&&(this.state={state:1,portFormat:t.port_format,process:r},n.complete())}catch(t){this.logger.log(5,`[forwarding] ${e}`)}})).resume(),await new Promise(((e,t)=>{r.on("spawn",e),r.on("error",t)}))}}var R=n(3795);class I{constructor(e){this.executor=e,this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new I((()=>e(this.getValue())))}}const x=Symbol("unset");class O{constructor({context:e,scope:t,key:r,defaultValue:n}){this._value=x,this.key=r,this.defaultValue=n,this.storage=e["global"===t?"globalState":"workspaceState"]}read(){return this._value===x&&(this._value=this.storage.get(this.key,this.defaultValue)),this._value}write(e){this._value=e,this.storage.update(this.key,e)}}var k=n(1034),M=n.n(k);class N{constructor(e){this.reporter=function(e){const t=new(M())(`${h.G8}.${h.u2}`,h.i8,h.lE);return e.subscriptions.push(t),t}(e)}connectionRequest(e,t){this.reporter.sendTelemetryEvent("connectionRequest",{isWeb:`${t}`,method:e})}connected(e){this.reporter.sendTelemetryEvent("connected",{isWeb:`${e}`})}getTelemetryLevel(){return this.reporter.telemetryLevel}}const D="vscode.dev.remote-server",L="tunnel",B="path";let q;async function j(n){console.log("Initializing tunnel extension");const s=new f("Remote - Tunnels"),i=new N(n),o=class{constructor(e,t){this.providerId=e,this.scopes=t}static github(){return new this("github",["user:email","read:org"])}get lastSession(){return this._lastSession}async testSession(e){const t=await this.getSessionIfExisting();try{if(t)return await e(t)}catch{}return e(await this.forceNewSession())}async getAccessToken(){return(await this.getSession()).accessToken}async isAuthenticated(){return!!await this.getSessionIfExisting()}async getSessionIfExisting(){const t=await e.authentication.getSession(this.providerId,this.scopes);return t&&(this._lastSession=t),t}async getSession(){const t=await e.authentication.getSession(this.providerId,this.scopes,{createIfNone:!0});return this._lastSession=t,t}async forceNewSession(){const t=await e.authentication.getSession(this.providerId,this.scopes,{forceNewSession:!0});return this._lastSession=t,t}}.github(),u=new I((()=>new r.AccessTokenBasisClient("github",D,(()=>o.getAccessToken()))));n.subscriptions.push(function(t){return e.window.registerUriHandler({async handleUri(r){try{if("/open"===r.path){const n=new URLSearchParams(r.query),s=n.get(L),i=n.get(B);if(s&&i){const t=`vscode-remote://tunnel+${s}${i}`;e.commands.executeCommand("vscode.openFolder",e.Uri.parse(t),{forceNewWindow:!0})}else t.log(5,`Problems handling URI open: missing tunnel or path: ${r.toString(!0)}}`);return}t.log(5,`Unhandled URI: ${r.toString(!0)}`)}catch(e){t.log(5,`Problems handling URI: ${r.toString(!0)}`,e)}}})}(s));const h=new l(n);!function(t){const r=e.workspace.workspaceFolders;if(r){const n=[];for(const e of r){const t=a(e.uri.authority);t&&n.push(new c(t,e.uri.path,e.name))}n.length>0&&e.commands.executeCommand("remote-internal.setActiveFolders",n),t.openFolders(n)}}(h);const d=new b(s,n,o,u);n.subscriptions.push(e.workspace.registerRemoteAuthorityResolver("tunnel",d));const p=d.rpc,g=new O({context:n,scope:"global",key:"tunnelHostnames",defaultValue:{}});return e.workspace.getConfiguration().get("remote.tunnels.experimental.forwarding",!1)&&await(async(t,r,n)=>{n.subscriptions.push(await e.workspace.registerTunnelProvider(new A(t,r),{tunnelFeatures:{elevation:!1,privacyOptions:[{themeIcon:"globe",id:"public",label:e.l10n.t("Public")},{themeIcon:"lock",id:"private",label:e.l10n.t("Private")}]}}))})(o,s,n),n.subscriptions.push(e.commands.registerCommand("remote-tunnels.isConnectedToRemote",(async(s,o,a,c)=>{c&&i.connectionRequest("embedder",!1),i.connected(!1),new t.RemoteVersion("",(0,r.getProtocolVersionFromTags)(o)).shouldWarnOutdated()&&async function(){const t=e.l10n.t("Upgrade");await e.window.showWarningMessage(e.l10n.t("Your tunnel connection is outdated, please upgrade to the latest version to continue using tunnels."),{modal:!0},t)===t&&e.env.openExternal(e.Uri.parse("https://code.visualstudio.com/docs/remote/tunnels#_getting-started"))}(),function(t,r){n.subscriptions.push(e.workspace.registerResourceLabelFormatter({scheme:"vscode-remote",authority:t,formatting:{label:"${path}",separator:"/",workspaceSuffix:r,tildify:!0,normalizeDriveLetter:!0}}))}(s,a),o.tunnelId&&async function(e){const t=g.read();if(!t.hasOwnProperty(e)){const r=await p;try{const{value:n}=await r.call("gethostname",{});g.write({...t,[e]:{hostname:n}})}catch(e){console.warn("Error getting hostname",e)}}}(o.tunnelId),setTimeout((async()=>async function(t){try{const{up_to_date:e}=await t.call("update",{do_update:!1});if(e)return}catch{return}const r=async()=>{await e.window.withProgress({location:e.ProgressLocation.Notification,title:e.l10n.t("Updating the VS Code CLI"),cancellable:!1},(()=>t.call("update",{do_update:!0}))),e.window.showInformationMessage(e.l10n.t("VS Code CLI update complete."))};if(e.workspace.getConfiguration().get("remote.tunnel.alwaysUpdateCLI"))return void await r();const n=e.l10n.t("Always update"),s=e.l10n.t("Update"),i=await e.window.showInformationMessage(e.l10n.t("An update for the VS Code CLI on your remote server is available. Would you like to update now? Your current session won't be interrupted"),n,s,e.l10n.t("Not Now"));i===n&&e.workspace.getConfiguration().update("remote.tunnel.alwaysUpdateCLI",!0,e.ConfigurationTarget.Global),i!==s&&i!==n||await r()}(await p)),3e3),q=o})),e.commands.registerCommand("remote-tunnels.getStarted",(function(){e.commands.executeCommand("vscode.open","https://aka.ms/remote-tunnels-doc")})),e.commands.registerCommand("remote-tunnels.reportIssue",(()=>e.commands.executeCommand("vscode.openIssueReporter",n.extension.id))),e.commands.registerCommand("remote-tunnels.settings",(()=>e.commands.executeCommand("workbench.action.openSettings",`@ext:${n.extension.id}`))),e.commands.registerCommand("remote-tunnels.connectCurrentWindowToTunnel",(async()=>{U(o,i,g,!1)})),e.commands.registerCommand("remote-tunnels.connectNewWindowToTunnel",(async()=>{U(o,i,g,!0)})),e.commands.registerCommand("remote-tunnels.openOnDesktop",(async()=>await async function(e){}(n.extension.id))),e.commands.registerCommand("remote-tunnels.showUsageLimits",(async()=>{const t=await e.window.withProgress({location:e.ProgressLocation.Notification,title:e.l10n.t("Checking usage limits...")},(async()=>(await u.getValue().getManagementClient()).listUserLimits()));m(s,t)})),e.commands.registerCommand("remote-tunnels.internal.unregisterTunnel",(async e=>{const t=await u.getValue().getManagementClient();return await t.deleteTunnel(e)})),e.commands.registerCommand("remote-tunnels.internal.getTunnelsList",(async()=>{const e=await u.getValue().getManagementClient();return await e.listTunnels(void 0,void 0,{tags:["vscode-server-launcher"],requireAllTags:!0,includePorts:!0})})),e.commands.registerCommand("remote-tunnels.internal.getActiveRemote",(()=>q)),e.commands.registerCommand("remote-tunnels.internal.isAuthenticated",(()=>o.isAuthenticated())),e.commands.registerCommand("remote-tunnels.internal.getFoldersHistory",(e=>h.getFolders(e))),e.commands.registerCommand("remote-tunnels.internal.deleteFolderFromHistory",(async e=>await h.removeFolder(e))),e.commands.registerCommand("remote-tunnels.internal.connectToRemote",(async(e,t)=>(i.connectionRequest("explorer",!1),await $(e,t))))),Promise.resolve(p).then((()=>{e.commands.executeCommand("setContext","forwardedPortsViewEnabled",!0)})),{getConnectionManagerForAuthority:e=>d.getConnectionManagerForAuthority(e),getExecServerForAuthority:async e=>{const r=await d.getConnectionManagerForAuthority(e),n=await r.bearer.checkedAcquire();return new t.ExecServer(n)}}}function F(){}async function U(t,n,s,i=!0){const o=e.window.createQuickPick();let a;o.onDidAccept((async()=>{const t=o.activeItems[0];if(o.dispose(),!t)return;if(t.openHelp)return void e.commands.executeCommand("vscode.open","https://aka.ms/vscode-server-doc");const s=t.tunnel,a=(0,r.getTunnelNameFromTags)(s)??s.name??s.tunnelId;n.connectionRequest("quickPick",!1),$(a,i)})),o.ignoreFocusOut=!0,o.busy=!0,o.show();try{a=await t.testSession((async t=>{const n=new r.AccessTokenBasisClient("github",D,(async()=>t.accessToken),(()=>{const t=e.workspace.getConfiguration("http").get("proxy");return t?new R.HttpsProxyAgent(t):void 0})());return(await n.getManagementClient()).listTunnels(void 0,void 0,{tags:["vscode-server-launcher"],requireAllTags:!0,includePorts:!0})}))}catch(t){return o.dispose(),void e.window.showErrorMessage(e.l10n.t("{0}. You may need to sign out and back in.",String(t)))}const c=[],l=[],u=s.read();for(const e of a){const t=e,n=(0,r.getTunnelNameFromTags)(t);if(void 0===n)continue;const s={tunnel:t,label:n,description:u.hasOwnProperty(t.tunnelId)?u[t.tunnelId].hostname:void 0};t.status.hostConnectionCount?c.push(s):l.push(s)}const h=[];c.length&&h.push({label:e.l10n.t("Online"),kind:e.QuickPickItemKind.Separator},...c),l.length&&h.push({label:e.l10n.t("Offline"),kind:e.QuickPickItemKind.Separator},...l),h.push({label:"",kind:e.QuickPickItemKind.Separator}),h.push({label:l.length||c.length?e.l10n.t("Learn More"):e.l10n.t("Create a Tunnel"),description:e.l10n.t("View documentation for setting up remote server"),openHelp:!0}),0===h.length&&(o.placeholder=e.l10n.t("No tunnels found")),o.items=h,o.busy=!1}async function $(t,r){await e.commands.executeCommand("vscode.newWindow",{remoteAuthority:o(t),reuseWindow:!r})}})();var i=exports;for(var o in s)i[o]=s[o];s.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();